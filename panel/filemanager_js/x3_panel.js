/* X3.24.3 2018-01-13 */

var x3_modal_settings,x3_show_conf,x3_conf_button,x3_mtree,x3_modal_new_folder,x3_modal_new_zip_file,x3_modal_copy_selected,x3_modal_move_selected,x3_modal_remove_selected,x3_modal_uploader,container_id_tree,container_id_tree2,container_id_tree3,x3_html=$("html"),x3_win=$(window),x3_body=$("body"),x3_footer=x3_body.children(".footer"),x3_panel_container=x3_body.children(".x3-panel-container"),preloader=x3_panel_container.children("#preloader"),x3_content_show=x3_panel_container.find("#content_show"),x3_navbar_container=x3_panel_container.children(".navbar"),x3_welcome=x3_navbar_container.find("#welcome"),x3_navbar_nav=x3_navbar_container.find(".navbar-nav"),x3_search_input=x3_navbar_container.find("#searchInput"),left_sidebar=x3_panel_container.find("#left_sidebar"),scroll_button=x3_footer.find(".x3-scroll-up");function x3_open_modal(e){x3_modal_settings.find(".modal-body").html(e),x3_modal_settings.modal()}function firewall_error(e,t){"error"===e.toLowerCase()&&"forbidden"===t.toLowerCase()&&x3_open_modal('<p><span class="label label-danger" style="font-size: 1.8em; display: inline-block;">Firewall Detected!</span></p><p>Your server returns "Forbidden" when trying to POST X3 settings to <code>x3_settings.php</code>. This indicates that your server has a firewall, which is blocking the POST. You need to ask your host to disable the firewall (or disable some rules) for the <code>/panel/</code> directory.</p><p>There is nothing wrong with having a Firewall, but X3 needs to be able to SAVE settings obviously. The firewall is meant to protect your website, but your X3 panel is already protected by login for known users.</p>')}$(function(){x3_body.append('<div class="modal" id="modal-settings" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"></div></div></div></div>');var e=(x3_modal_settings=x3_body.children("#modal-settings")).find(".modal-body");x3_body.on("click","a.show-help, a.text-help, .panel-help",function(t){t.stopPropagation(),t.preventDefault();var a=$(this);if(a.data("help"))var n=x3_help[a.data("help")];else n=(a.siblings(".hidden").length>0?a.siblings(".hidden"):x3_content_show.find(a.data("hidden"))).html();e.html(n),x3_modal_settings.modal()});x3_content_show.on("click","#newFolder button.btn-primary",function(e){$(this);var t=x3_modal_new_folder.find("input#new_folder").val();t.length>0&&(new_folder_path=t,mkdir(x3_modal_new_folder.data("there")||null))});var t,a,n,i,o="",l=!1,s="",r=location.hostname+get_x3_path();x3_content_show.on("focus","#new_folder, #rename_new_name",function(e){var t=$(this),o=t.closest("#newFolder");a=t.siblings(".url-info"),n=t.siblings(".url-helper"),i=t.closest(".modal-content").find("button.btn-primary, button.btn-success"),o.length&&(s=(o.data("there")||here).split("./content")[1].replace(/\/\d+\./g,"/").replace(/\/$/,""))});function d(e,n){a.text()!==e&&(a.removeClass("label-warning label-danger"),a.text(e).addClass(n?"label-danger":"label-warning").velocity("stop").velocity({opacity:[1,0]},{duration:200})),n&&(clearTimeout(t),l=!0,t=setTimeout(function(){l=!1,a.text()!==o&&a.removeClass("label-danger").addClass("label-warning").text(o).velocity("stop").velocity({opacity:[1,0]},{duration:200})},2e3))}x3_body.on("keypress keyup focus","#new_folder, #rename_new_name:not(.input-move)",function(e){var t=String.fromCharCode(e.which);if("#$%^&*()+=[]'\"/\\|{}`~!@?".indexOf(t)>-1)return"keypress"==e.type&&d(t+" character not allowed in folder names.",!0),!1;var a=$(this),o=a.val(),c=o.split("."),p=c.length>1&&$.isNumeric(c[0])?o.replace(c[0]+".",""):o;n.toggle(0!==p.indexOf("_")&&p.length>0&&"/custom/files"!==s).html('<i class="glyphicon glyphicon-link"></i> '+r+s+"/<span>"+p+"</span>/"),32==e.which?(d("Empty spaces are not allowed in folder names",!0),"keyup"==e.type&&a.val(o.replace(/\s+/g,"-"))):l||d("",!1),i.prop("disabled",!p);var u=a.siblings(".panel");if(u.length){var h=u.find("#new_folder_title"),f=u.find("#new_folder_label"),m=(m=p.replace(/-+|_+/g," ").trim()).charAt(0).toUpperCase()+m.substring(1);h.attr("placeholder",m),f.attr("placeholder",m)}})}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)});function update_fixed(e){!0===e?x3_win.resize():setTimeout(function(){x3_win.resize()},500)}function x3_scroll_top(){x3_win.scrollTop()>75&&x3_html.velocity("stop").velocity("scroll",{duration:500,easing:"easeInOutCubic",complete:function(){button_is_hidden||(button_is_hidden=!0,scroll_button.velocity("stop").velocity("fadeOut",{duration:200}))}})}var button_is_hidden=!0;$(function(){setInterval(function(){var e=x3_win.scrollTop()>75;(button_is_hidden&&e||!button_is_hidden&&!e)&&(button_is_hidden=!button_is_hidden,scroll_button.velocity("stop").velocity(button_is_hidden?"fadeOut":"fadeIn",{duration:200}))},1e3),scroll_button.on("click",x3_scroll_top)});function main_menu_active(e){x3_navbar_nav.children(".active").removeClass("active"),x3_navbar_nav.children(e).addClass("active")}function get_x3_path(){var e=location.pathname.split("/").filter(function(e){return""!==e});e.pop();var t=e.join("/");return t?"/"+t:""}function myToggleBlock(e,t,a,n){if(!/editor-preview-active/.test(e.codemirror.getWrapperElement().lastChild.className)){n=void 0===n?a:n;var i,o=e.codemirror,l=a,s=n,r=o.getCursor("start"),d=o.getCursor("end");i=o.getSelection(),o.replaceSelection(l+i+s),r.ch+=a.length,d.ch=r.ch+i.length,o.setSelection(r,d),o.focus()}}function get_supports_local_storage(){try{var e=window.localStorage;e.setItem("t","y");var t=Boolean(e&&"localStorage"in window&&null!==window.localStorage&&"y"===e.getItem("t"));return e.removeItem("t"),t}catch(e){return!1}}var is_local_storage=get_supports_local_storage();function supports_local_storage(){return is_local_storage}!function(e,t,a,n,i){if(e&&void 0===n&&"undefined"===(n=require("underscore")))throw"Failed to load underscore.js";var o=/\[([0-9]*)\](?=\[|\.|$)/g,l={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},s={evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g},r="string"==typeof n.template("",{})?n.template:function(e,t,a){return n.template(e,a)(t)},d=function(e){return!(n.isUndefined(e)||n.isNull(e))},c=function(e,t){return"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,t)},p={util:{}},u=function(e){return d(e)&&(e=""+e)?e.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):""},h=function(e){return e.replace(/([ \!\"\#\$\%\&\'\(\)\*\+\,\.\/\:\;<\=\>\?\@\[\\\]\^\`\{\|\}\~])/g,"\\$1")};p.fieldTemplate=function(e){return'<div class="<%= cls.groupClass %> jsonform-node jsonform-error-<%= keydash %><%= elt.htmlClass ? " " + elt.htmlClass : "" %><%= (node.required && node.formElement && (node.formElement.type !== "checkbox") ? " jsonform-required" : "") %><%= (node.isReadOnly() ? " jsonform-readonly" : "") %><%= (node.disabled ? " jsonform-disabled" : "") %>" data-jsonform-type="<%= node.formElement.type %>"><% if (node.title && !elt.notitle && elt.inlinetitle !== true) { %><label class="<%= cls.labelClass %>" for="<%= node.id %>"><%= node.title %></label><% } %><div class="<%= cls.controlClass %>"><% if (node.description) { %><span class="help-block jsonform-description"><%= node.description %></span><% } %><% if (node.prepend || node.append) { %><div class="<%= node.prepend ? cls.prependClass : "" %> <%= node.append ? cls.appendClass : "" %>"><% if (node.prepend && node.prepend.indexOf("<button ") >= 0) { %><% if (cls.buttonAddonClass) { %><span class="<%= cls.buttonAddonClass %>"><%= node.prepend %></span><% } else { %><%= node.prepend %><% } %><% } %><% if (node.prepend && node.prepend.indexOf("<button ") < 0) { %><span class="<%= cls.addonClass %>"><%= node.prepend %></span><% } %><% } %>'+e+'<% if (node.append && node.append.indexOf("<button ") >= 0) { %><% if (cls.buttonAddonClass) { %><span class="<%= cls.buttonAddonClass %>"><%= node.append %></span><% } else { %><%= node.append %><% } %><% } %><% if (node.append && node.append.indexOf("<button ") < 0) { %><span class="<%= cls.addonClass %>"><%= node.append %></span><% } %><% if (node.prepend || node.append) { %></div><% } %><span class="help-block jsonform-errortext" style="display:none;"></span></div></div>'};var f='<div class="_jsonform-preview"><% if (value.type=="image") { %><img class="jsonform-preview" id="jsonformpreview-<%= id %>" src="<%= value.url %>" /><% } else { %><a href="<%= value.url %>"><%= value.name %></a> (<%= Math.ceil(value.size/1024) %>kB)<% } %></div><a href="#" class="<%= cls.buttonClass %> _jsonform-delete"><i class="<%= cls.iconClassPrefix %>-remove" title="Remove"></i></a> ',m=function(e,t,i){var o={template:'<input type="'+e+'" class="<%= fieldHtmlClass'+(t?" || cls.textualInputClass":"")+' %>" name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%><%= (node.isReadOnly() ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.required ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%> />',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){if(t.formElement&&t.formElement.autocomplete){(n=a(t.el).find("input")).autocomplete&&n.autocomplete(t.formElement.autocomplete)}if(t.formElement&&(t.formElement.tagsinput||"tagsvalue"===t.formElement.getValue)){if(!a.fn.tagsinput)throw new Error("tagsinput is not found");var n=a(t.el).find("input"),i=Array.isArray(t.value);i&&n.attr("value","").val(""),n.tagsinput(t.formElement?t.formElement.tagsinput||{}:{}),i&&t.value.forEach(function(e){n.tagsinput("add",e)})}if(t.formElement&&t.formElement.typeahead){if((n=a(t.el).find("input")).typeahead)if(Array.isArray(t.formElement.typeahead)){for(var o=1;o<t.formElement.typeahead.length;++o){var l=t.formElement.typeahead[o];if(l.source&&Array.isArray(l.source)){var s=l.source;l.source=function(e,t){var a=e.toLowerCase();t(s.filter(function(e){return e.toLowerCase().indexOf(a)>=0}).map(function(e){return"string"==typeof e?{value:e}:e}))}}}a.fn.typeahead.apply(n,t.formElement.typeahead)}else n.typeahead(t.formElement.typeahead)}}};return i&&(o=n.extend(o,i)),o},g=function(e,t){return{template:'<input type="'+e+'" class="<%= fieldHtmlClass'+(t?" || cls.textualInputClass":"")+' %>" name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%><%= (node.isReadOnly() ? " readonly=\'readonly\'" : "") %><%= (range.min !== undefined ? " min="+range.min : "")%><%= (range.max !== undefined ? " max="+range.max : "")%><%= (range.step !== undefined ? " step="+range.step : "")%><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.required ? " required=\'required\'" : "") %><%= (node.placeholder? "placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%> />',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(t,a){if(t.range={step:1},"range"==e&&(t.range.min=1,t.range.max=100),a&&a.schemaElement){a.formElement&&a.formElement.step?t.range.step=a.formElement.step:"number"==a.schemaElement.type&&(t.range.step="any");var n="any"===t.range.step?1:t.range.step;void 0!==a.schemaElement.minimum&&(a.schemaElement.exclusiveMinimum?t.range.min=a.schemaElement.minimum+n:t.range.min=a.schemaElement.minimum),void 0!==a.schemaElement.maximum&&(a.schemaElement.exclusiveMaximum?t.range.max=a.schemaElement.maximum-n:t.range.max=a.schemaElement.maximum)}}}};p.elementTypes={none:{template:""},root:{template:"<div><%= children %></div>"},text:m("text",!0),password:m("password",!0),date:m("date",!0,{onInsert:function(e,t){if(window.Modernizr&&window.Modernizr.inputtypes&&!window.Modernizr.inputtypes.date){var i=a(t.el).find("input");if(i.datepicker){var o={dateFormat:"yy-mm-dd"};t.formElement&&t.formElement.datepicker&&"object"==typeof t.formElement.datepicker&&n.extend(o,t.formElement.datepicker),i.datepicker(o)}}}}),datetime:m("datetime",!0),"datetime-local":m("datetime-local",!0,{onBeforeRender:function(e,t){e.value&&e.value.getTime&&(e.value=new Date(e.value.getTime()-6e4*e.value.getTimezoneOffset()).toISOString().slice(0,-1))}}),email:m("email",!0),month:m("month",!0),number:g("number",!0),search:m("search",!0),tel:m("tel",!0),time:m("time",!0),url:m("url",!0),week:m("week",!0),range:g("range"),color:{template:'<input type="text" <%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %>name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%><%= (node.required ? " required=\'required\'" : "") %> />',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){a(t.el).find("#"+h(t.id)).spectrum({preferredFormat:"hex",showInput:!0})}},textarea:{template:'<textarea id="<%= id %>" name="<%= node.name %>" class="<%= fieldHtmlClass || cls.textualInputClass %>" style="<%= elt.height ? "height:" + elt.height + ";" : "" %>width:<%= elt.width || "100%" %>;"<%= (node.disabled? " disabled" : "")%><%= (node.isReadOnly() ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.required ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0},wysihtml5:{template:'<textarea id="<%= id %>" name="<%= node.name %>" style="height:<%= elt.height || "300px" %>;width:<%= elt.width || "100%" %>;"<%= (node.disabled? " disabled" : "")%><%= (node.isReadOnly() ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.required ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){var n=function(){a(t.el).data("wysihtml5")||(a(t.el).data("wysihtml5_loaded",!0),a(t.el).find("#"+h(t.id)).wysihtml5({html:!0,link:!0,"font-styles":!0,image:!0,events:{load:function(){a(this.textareaElement).removeAttr("required")}}}))};if(window.jsonform_wysihtml5_setup)window.jsonform_wysihtml5_setup(n);else var i=window.setInterval(function(){window.wysihtml5&&(window.clearInterval(i),n())},1e3)}},ace:{template:'<div id="<%= id %>" style="position:relative;height:<%= elt.height || "300px" %>;"><div id="<%= id %>__ace" style="width:<%= elt.width || "100%" %>;height:<%= elt.height || "300px" %>;"></div><input type="hidden" name="<%= node.name %>" id="<%= id %>__hidden" value="<%= escape(value) %>"/></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){(e.value&&"object"==typeof e.value||Array.isArray(e.value))&&(e.value=i.stringify(e.value,null,2))},onInsert:function(e,t){var o=function(){var e=t.formElement||{},o=window.ace.edit(a(t.el).find("#"+h(t.id)+"__ace").get(0)),l="#"+h(t.id)+"__hidden";o.getSession().setNewLineMode("unix"),o.renderer.setShowPrintMargin(!1),o.setTheme("ace/theme/"+(e.aceTheme||"twilight")),e.aceMode&&o.getSession().setMode("ace/mode/"+e.aceMode),o.getSession().setTabSize(2);var s=t.value;null===s||void 0===s?s="":("object"==typeof s||Array.isArray(s))&&(s=i.stringify(s,null,2)),o.getSession().setValue(s);var r=n.debounce(function(){a(t.el).find(l).val(o.getSession().getValue()),a(t.el).find(l).change()},600);o.getSession().on("change",r),o.on("blur",function(){a(t.el).find(l).change(),a(t.el).find(l).trigger("blur")}),o.on("focus",function(){a(t.el).find(l).trigger("focus")})};if(window.jsonform_ace_setup)window.jsonform_ace_setup(o);else var l=window.setInterval(function(){window.ace&&(window.clearInterval(l),o())},1e3)}},checkbox:{template:'<div class="checkbox"><label><input type="checkbox" id="<%= id %>" name="<%= node.name %>" value="1" <% if (value) {%>checked<% } %><%= (node.disabled? " disabled" : "")%><%= (node.required && node.schemaElement && (node.schemaElement.type !== "boolean") ? " required=\'required\'" : "") %> /><span><%= (node.inlinetitle === true ? node.title : node.inlinetitle) || "" %></span></label></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){if(t.formElement.toggleNext){var n=!0===t.formElement.toggleNext?1:t.formElement.toggleNext,i="jsonform-toggle-next jsonform-toggle-next-"+n,o=1===n?a(t.el).next():"all"===n?a(t.el).nextAll():a(t.el).nextAll().slice(0,n);o.addClass("jsonform-toggle-next-target"),a(t.el).addClass(i).find(":checkbox").on("change",function(){var e=a(this).is(":checked");a(t.el).toggleClass("checked",e),o.toggle(e).toggleClass("jsonform-toggled-visible",e)}).change()}},getElement:function(e){return a(e).parent().parent().get(0)}},file:{template:'<input class="input-file" id="<%= id %>" name="<%= node.name %>" type="file" <%= (node.required ? " required=\'required\'" : "") %>/>',fieldtemplate:!0,inputfield:!0},"file-hosted-public":{template:"<span><% if (value && (value.type||value.url)) { %>"+f+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="<%= transloaditname %>" /><input data-transloadit-name="_transloadit_<%= transloaditname %>" type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return a(e).parent().get(0)},onBeforeRender:function(e,t){t.ownerTree._transloadit_generic_public_index?t.ownerTree._transloadit_generic_public_index++:t.ownerTree._transloadit_generic_public_index=1,e.transloaditname="_transloadit_jsonform_genericupload_public_"+t.ownerTree._transloadit_generic_public_index,t.ownerTree._transloadit_generic_elts||(t.ownerTree._transloadit_generic_elts={}),t.ownerTree._transloadit_generic_elts[e.transloaditname]=t},onChange:function(e,t){if(t.ownerTree._transloadit_bound)return!1;t.ownerTree._transloadit_bound=!0;var o=a(t.ownerTree.domRoot);o.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(e){var a=n.values(e.results);a=n.flatten(a),n.each(a,function(e){var a=t.ownerTree._transloadit_generic_elts[e.field].id,l=o.find("#"+h(a)),s=n.filter(n.keys(e.meta),function(t){return!!d(e.meta[t])});e.meta=n.pick(e.meta,s),l.val(i.stringify(e))}),t.ownerTree._transloadit_bound=!1,o.unbind("submit.transloadit"),n.delay(function(){console.log("submit form"),t.ownerTree.submit()},10)},onError:function(e){console.log("assembly error",e)}})},onInsert:function(e,t){a(t.el).find("a._jsonform-delete").on("click",function(e){return a(t.el).find("._jsonform-preview").remove(),a(t.el).find("a._jsonform-delete").remove(),a(t.el).find("#"+h(t.id)).val(""),e.preventDefault(),!1})},onSubmit:function(e,t){return!t.ownerTree._transloadit_bound}},"file-transloadit":{template:"<span><% if (value && (value.type||value.url)) { %>"+f+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="_transloadit_<%= node.name %>" /><input type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return a(e).parent().get(0)},onChange:function(e,t){if(t.ownerTree._transloadit_bound)return!1;t.ownerTree._transloadit_bound=!0;var o=a(t.ownerTree.domRoot);o.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(e){var a=n.values(e.results);a=n.flatten(a),n.each(a,function(e){var t=o.find('input[name="'+e.field.replace(/^_transloadit_/,"")+'"]'),a=n.filter(n.keys(e.meta),function(t){return!!d(e.meta[t])});e.meta=n.pick(e.meta,a),t.val(i.stringify(e))}),t.ownerTree._transloadit_bound=!1,o.unbind("submit.transloadit"),n.delay(function(){console.log("submit form"),t.ownerTree.submit()},10)},onError:function(e){console.log("assembly error",e)}})},onInsert:function(e,t){a(t.el).find("a._jsonform-delete").on("click",function(e){return a(t.el).find("._jsonform-preview").remove(),a(t.el).find("a._jsonform-delete").remove(),a(t.el).find("#"+h(t.id)).val(""),e.preventDefault(),!1})},onSubmit:function(e,t){return!t.ownerTree._transloadit_bound}},select:{template:'<select name="<%= node.name %>" id="<%= id %>" class="<%= fieldHtmlClass || cls.textualInputClass %>"<%= (node.disabled? " disabled" : "")%><%= (node.required ? " required=\'required\'" : "") %>> <% _.each(node.options, function(key, val) { if(key instanceof Object) { if (value === key.value) { %> <option selected value="<%= key.value %>"><%= key.title %></option> <% } else { %> <option value="<%= key.value %>"><%= key.title %></option> <% }} else { if (value === key) { %> <option selected value="<%= key %>"><%= key %></option> <% } else { %><option value="<%= key %>"><%= key %></option> <% }}}); %> </select>',fieldtemplate:!0,inputfield:!0},tagsinput:{template:'<select name="<%= node.name %><%= node.formElement.getValue === "tagsinput" ? "" : "[]" %>" id="<%= id %>" class="<%= fieldHtmlClass || cls.textualInputClass %>" multiple<%= (node.disabled? " disabled" : "")%><%= (node.required ? " required=\'required\'" : "") %>> </select>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){if(!a.fn.tagsinput)throw new Error("tagsinput is not found");var n=a(t.el).find("select");n.tagsinput(t.formElement?t.formElement.tagsinput||{}:{}),t.value&&t.value.forEach(function(e){n.tagsinput("add",e)})}},imageselect:{template:'<div><input type="hidden" name="<%= node.name %>" id="<%= node.id %>" value="<%= value %>" /><div class="dropdown"><a class="<%= node.value ? buttonClass : cls.buttonClass %>" data-toggle="dropdown" href="#"<% if (node.value) { %> style="max-width:<%= width %>px;max-height:<%= height %>px"<% } %>><% if (node.value) { %><img src="<% if (!node.value.match(/^https?:/)) { %><%= prefix %><% } %><%= node.value %><%= suffix %>" alt="" /><% } else { %><%= buttonTitle %><% } %></a><div class="dropdown-menu navbar" id="<%= node.id %>_dropdown"><div><% _.each(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class="<%= buttonClass %>" style="max-width:<%= width %>px;max-height:<%= height %>px"><% if (key instanceof Object) { %><img src="<% if (!key.value.match(/^https?:/)) { %><%= prefix %><% } %><%= key.value %><%= suffix %>" alt="<%= key.title %>" /></a><% } else { %><img src="<% if (!key.match(/^https?:/)) { %><%= prefix %><% } %><%= key %><%= suffix %>" alt="" /><% } %></a> <% }); %></div><div class="pagination-right"><a class="<%= cls.buttonClass %>">Reset</a></div></div></div></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var a=t.formElement||{},n=null,i=a.imageSelectorColumns||5;e.buttonTitle=a.imageSelectorTitle||"Select...",e.prefix=a.imagePrefix||"",e.suffix=a.imageSuffix||"",e.width=a.imageWidth||32,e.height=a.imageHeight||32,e.buttonClass=a.imageButtonClass||e.cls.buttonClass,t.options.length>i?(n=Math.ceil(t.options.length/i),e.columns=Math.ceil(t.options.length/n)):e.columns=i},getElement:function(e){return a(e).parent().get(0)},onInsert:function(e,t){a(t.el).on("click",".dropdown-menu a",function(e){e.preventDefault(),e.stopPropagation();var n=("img"===e.target.nodeName.toLowerCase()?a(e.target):a(e.target).find("img")).attr("src"),i=t.formElement||{},o=i.imagePrefix||"",l=i.imageSuffix||"",s=i.imageWidth||32,r=i.imageHeight||32;n?(0===n.indexOf(o)&&(n=n.substring(o.length)),n=n.substring(0,n.length-l.length),a(t.el).find("input").attr("value",n),a(t.el).find('a[data-toggle="dropdown"]').addClass(i.imageButtonClass).attr("style","max-width:"+s+"px;max-height:"+r+"px").html('<img src="'+(n.match(/^https?:/)?"":o)+n+l+'" alt="" />')):(a(t.el).find("input").attr("value",""),a(t.el).find('a[data-toggle="dropdown"]').removeClass(i.imageButtonClass).removeAttr("style").html(i.imageSelectorTitle||"Select..."))})}},iconselect:{template:'<div><input type="hidden" name="<%= node.name %>" id="<%= node.id %>" value="<%= value %>" /><div class="dropdown"><a class="<%= node.value ? buttonClass : cls.buttonClass %>" data-toggle="dropdown" href="#"<% if (node.value) { %> style="max-width:<%= width %>px;max-height:<%= height %>px"<% } %>><% if (node.value) { %><i class="<%= cls.iconClassPrefix %>-<%= node.value %>" /><% } else { %><%= buttonTitle %><% } %></a><div class="dropdown-menu navbar" id="<%= node.id %>_dropdown"><div><% _.each(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class="<%= buttonClass %>" ><% if (key instanceof Object) { %><i class="<%= cls.iconClassPrefix %>-<%= key.value %>" alt="<%= key.title %>" /></a><% } else { %><i class="<%= cls.iconClassPrefix %>-<%= key %>" alt="" /><% } %></a> <% }); %></div><div class="pagination-right"><a class="<%= cls.buttonClass %>">Reset</a></div></div></div></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var a=t.formElement||{},n=null,i=a.imageSelectorColumns||5;e.buttonTitle=a.imageSelectorTitle||"Select...",e.buttonClass=a.imageButtonClass||e.cls.buttonClass,t.options.length>i?(n=Math.ceil(t.options.length/i),e.columns=Math.ceil(t.options.length/n)):e.columns=i},getElement:function(e){return a(e).parent().get(0)},onInsert:function(e,t){a(t.el).on("click",".dropdown-menu a",function(e){e.preventDefault(),e.stopPropagation();var n=("i"===e.target.nodeName.toLowerCase()?a(e.target):a(e.target).find("i")).attr("class"),i=t.formElement||{};n?(n=n,a(t.el).find("input").attr("value",n),a(t.el).find('a[data-toggle="dropdown"]').addClass(i.imageButtonClass).html('<i class="'+n+'" alt="" />')):(a(t.el).find("input").attr("value",""),a(t.el).find('a[data-toggle="dropdown"]').removeClass(i.imageButtonClass).html(i.imageSelectorTitle||"Select..."))})}},radios:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><% if (!elt.inline) { %><div class="radio"><label><% } else { %><label class="radio<%= cls.inlineClassSuffix %>"><% } %><input type="radio" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>"<%= (node.disabled? " disabled" : "")%><%= (node.required ? " required=\'required\'" : "") %>/><span><%= (key instanceof Object ? key.title : key) %></span></label><%= elt.inline ? "" : "</div>" %> <% }); %></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){if(t.formElement.toggleNextMap){var n={};for(var i in t.formElement.toggleNextMap){var o=t.formElement.toggleNextMap[i],l=!0===o?1:o,s="jsonform-toggle-next jsonform-toggle-next-"+l,r=1===l?a(t.el).next():"all"===l?a(t.el).nextAll():a(t.el).nextAll().slice(0,l);r.addClass("jsonform-toggle-next-target"),n[i]=r}a(t.el).addClass(s).find(":radio").on("change",function(){var e=a(this),t=e.val(),i=e.is(":checked");if(i)for(var o in n){var l=n[o];o===t?l.toggle(i).toggleClass("jsonform-toggled-visible",i):l.toggle(!i).toggleClass("jsonform-toggled-visible",!i)}else for(var o in n){(l=n[o]).toggle(!1).toggleClass("jsonform-toggled-visible",!1)}}).change()}}},radiobuttons:{template:'<div id="<%= node.id %>"  class="<%= elt.htmlClass ? " " + elt.htmlClass : "" %>"><% _.each(node.options, function(key, val) { %><label class="<%= cls.buttonClass %>"><input type="radio" style="position:absolute;left:-9999px;" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>" /><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){var n="active",i=t.formElement||{};i.activeClass&&(n+=" "+i.activeClass),a(t.el).find("label").on("click",function(){a(this).parent().find("label").removeClass(n),a(this).addClass(n)}).find(":checked").closest("label").addClass(n)}},checkboxes:{template:'<div id="<%= node.id %>"><%= choiceshtml %><%= children %></div>',fieldtemplate:!0,inputfield:!0,childTemplate:function(e,t){if(!t.formElement.otherField)return e;var a="";t.formElement.otherField.asArrayValue&&t.otherValues&&(a+='<% value = node.parentNode.otherValues.join(", ") %>'),a+='<input type="checkbox"<%= value !== undefined && value !== null && value !== "" ? " checked=\'checked\'" : "" %>',(!t.formElement.otherField.asArrayValue&&!0!==t.formElement.otherField.novalue||!1===t.formElement.otherField.novalue)&&(a+=' name="'+t.key+"["+(void 0!==t.formElement.otherField.idx?t.formElement.otherField.idx:t.formElement.options.length)+']" value="'+(t.formElement.optionsAsEnumOrder?1:t.formElement.otherField.otherValue||"OTHER")+'"'),a+='<%= node.disabled? " disabled" : "" %> />',a+='<span><%= node.title || "Other" %> </span>';var n="other-field";return t.formElement.otherField.inline&&(a+='<div class="other-field-content">'+e+"</div>",n="inline-"+n),a=t.formElement.inline?'<label class="'+n+' checkbox<%= cls.inlineClassSuffix %>">'+a+"</label>":'<div class="'+n+' checkbox"><label>'+a+"</label></div>",t.formElement.otherField.inline||(a+='<div class="other-field-content">'+e+"</div>"),a},onBeforeRender:function(e,t){if(t&&t.schemaElement&&t.schemaElement.items){var a=t.formElement.options;if(a){var i='<input type="checkbox"<%= checked ? " checked=\'checked\'" : "" %> name="<%= name %>" value="<%= escape(value) %>"<%= node.disabled? " disabled" : "" %> /><span><%= title %></span>';i=t.formElement.inline?'<label class="checkbox'+e.cls.inlineClassSuffix+'">'+i+"</label>":'<div class="checkbox"><label>'+i+"</label></div>";var o="";if(t.formElement.otherField&&t.formElement.otherField.asArrayValue&&t.value){var s=a.map(function(e){return e.value}),d=[];t.value.forEach(function(e){n.include(s,e)||d.push(e)}),d.length>0&&(t.otherValues=d)}else delete t.otherValues;n.each(a,function(e,a){t.formElement.otherField&&e.value===(t.formElement.otherField.otherValue||"OTHER")?t.formElement.otherField.idx=a:o+=r(i,{name:t.key+"["+a+"]",value:t.formElement.optionsAsEnumOrder?1:e.value,checked:n.include(t.value,e.value),title:e.title,node:t,escape:u},l)}),t.formElement.otherField,e.choiceshtml=o}}},onInsert:function(e,t){var n=t.formElement.otherField&&t.formElement.otherField.inline?a(t.el).find(".inline-other-field :checkbox").first():a(t.el).find(".other-field :checkbox"),i=a(t.el).find(".other-field-content :input");function o(){n.prop("checked",function(e){var t=!1;return e.each(function(){var e=a(this);return e.is(":checkbox, :radio")&&e.prop("checked")?(t=!0,!1):e.is("button")?void 0:""!==a(this).val()?(t=!0,!1):void 0}),t}(i))}i.on("keyup",o).on("change",o).change(),n.on("change",function(){this.checked?(this.checked=!1,i.not(":checkbox,:radio,button").focus()):i.filter("input[type=text], textarea").val("")})}},checkboxbuttons:{template:'<div id="<%= node.id %>"><%= choiceshtml %></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var a=null,i=null,o='<label class="<%= cls.buttonClass %> '+e.fieldHtmlClass+'"><input type="checkbox" style="position:absolute;left:-9999px;" <% if (checked) { %> checked="checked" <% } %> name="<%= name %>" value="<%= value %>"<%= (node.disabled? " disabled" : "")%>/><span><%= title %></span></label>';t&&t.schemaElement&&t.schemaElement.items&&(a=t.formElement.options)&&(t.value&&Array.isArray(t.value)||(t.value=[]),i="",n.each(a,function(a,s){i+=r(o,{name:t.key+"["+s+"]",checked:n.include(t.value,a.value),value:a.value,title:a.title,node:t,cls:e.cls},l)}),e.choiceshtml=i)},onInsert:function(e,t){var n="active",i=t.formElement||{};i.activeClass&&(n+=" "+i.activeClass),a(t.el).find("label").on("click",function(){a(this).toggleClass(n,a(this).find("input:checkbox").prop("checked"))}).find(":checked").closest("label").addClass(n)}},array:{template:'<div id="<%= id %>"><ul class="_jsonform-array-ul" style="list-style-type:none;"><%= children %></ul><% if (!node.isReadOnly()) { %><span class="_jsonform-array-buttons"><a href="#" class="<%= cls.buttonClass %> _jsonform-array-addmore"><i class="<%= cls.iconClassPrefix %>-plus-sign" title="Add new"></i></a> <a href="#" class="<%= cls.buttonClass %> _jsonform-array-deletelast"><i class="<%= cls.iconClassPrefix %>-minus-sign" title="Delete last"></i></a></span><% } %></div>',fieldtemplate:!0,array:!0,childTemplate:function(e,t){return!t.isReadOnly()&&a("").sortable?'<li data-idx="<%= node.childPos %>"><span class="draggable line"><i class="<%= cls.iconClassPrefix %>-list" title="Move item"></i></span> <a href="#" class="_jsonform-array-item-delete"><i class="<%= cls.iconClassPrefix %>-remove" title="Remove item"></i></a>'+e+"</li>":'<li data-idx="<%= node.childPos %>">'+e+"</li>"},onInsert:function(e,t){var n=a(t.el).find("#"+h(t.id)),i=t.getArrayBoundaries(),o=function(e){var a=t.children.length-Math.max(i.minItems,0);if(n.find("> span > a._jsonform-array-deletelast").toggleClass("disabled",a<=1),n.find("> ul > li > a._jsonform-array-item-delete").toggle(a>1),a<1)return!1;t.deleteArrayItem(e),n.find("> span > a._jsonform-array-addmore").toggleClass("disabled",i.maxItems>=0&&t.children.length>=i.maxItems)};a("> span > a._jsonform-array-addmore",n).click(function(e){e.preventDefault(),e.stopPropagation();!function(e){if(i.maxItems>=0){var o=i.maxItems-t.children.length;if(n.find("> span > a._jsonform-array-addmore").toggleClass("disabled",o<=1),o<1)return!1}t.insertArrayItem(e,a("> ul",n).get(0));var l=t.children.length>i.minItems;n.find("> span > a._jsonform-array-deletelast").toggleClass("disabled",!l),n.find("> ul > li > a._jsonform-array-item-delete").toggle(l)}(t.children.length)});a("> ul > li",n).length;if(i.minItems>0)for(var l=t.children.length;l<i.minItems;l++)t.insertArrayItem(t.children.length,n.find("> ul").get(0));var s=t.children.length-Math.max(i.minItems,0);n.find("> span > a._jsonform-array-deletelast").toggleClass("disabled",s<=0),n.find("> ul > li > a._jsonform-array-item-delete").toggle(s>0),n.find("> span > a._jsonform-array-addmore").toggleClass("disabled",i.maxItems>=0&&t.children.length>=i.maxItems),a("> span > a._jsonform-array-deletelast",n).click(function(e){var a=t.children.length-1;e.preventDefault(),e.stopPropagation(),o(a)}),n.on("click","> ul > li > a._jsonform-array-item-delete",function(e){e.preventDefault();var n=a(e.currentTarget).parent();if(n.parent().parent().attr("id")==t.id){e.stopPropagation();var i=n.data("idx");o(i)}}),!t.isReadOnly()&&a(t.el).sortable&&(a("> ul",n).sortable(),a("> ul",n).bind("sortstop",function(e,i){!function(e,i){if(e!==i){var o=e<i?1:-1,l=0,s=a("> ul",n);for(l=e;l!==i;l+=o)t.children[l].switchValuesWith(t.children[l+o]),t.children[l].render(s.get(0)),t.children[l+o].render(s.get(0));var r=a(t.children[e].el),d=a(t.children[i].el);r.detach(),d.detach(),e<i?(0===e?s.prepend(r):a(t.children[e-1].el).after(r),a(t.children[i-1].el).after(d)):(0===i?s.prepend(d):a(t.children[i-1].el).after(d),a(t.children[e-1].el).after(r))}}(a(i.item).data("idx"),a(i.item).index())}))}},tabarray:{template:'<div id="<%= id %>"><div class="tabbable tabs-left"><ul class="nav nav-tabs"><%= tabs %></ul><div class="tab-content"><%= children %></div></div></div>',fieldtemplate:!0,array:!0,childTemplate:function(e){return'<div data-idx="<%= node.childPos %>" class="tab-pane">'+e+"</div>"},onBeforeRender:function(e,t){e.tabs=""},onInsert:function(e,t){var i=a(t.el).find("#"+h(t.id)),o=t.getArrayBoundaries(),l=function(e){var l="",s=!1;void 0===e&&((e=a("> .tabbable > .nav-tabs .active",i).data("idx"))?e=parseInt(e,10):(s=!0,e=0)),e>=t.children.length&&(e=t.children.length-1),n.each(t.children,function(e,a){var n=e.legend||e.title||"Item "+(a+1);l+='<li data-idx="'+a+'"><a class="draggable tab" data-toggle="tab">'+u(n),t.isReadOnly()||(l+=' <span href="#" class="_jsonform-array-item-delete"><i class="'+t.ownerTree.defaultClasses.iconClassPrefix+'-remove" title="Remove item"></i></span></a>'),l+="</li>"}),!t.isReadOnly()&&(o.maxItems<0||t.children.length<o.maxItems)&&(l+='<li data-idx="-1"><a class="tab _jsonform-array-addmore" title="'+(t.formElement.addMoreTooltip?u(t.formElement.addMoreTooltip):"Add new item")+'"><i class="'+t.ownerTree.defaultClasses.iconClassPrefix+'-plus-sign"></i> '+(t.formElement.addMoreTitle||"New")+"</a></li>"),a("> .tabbable > .nav-tabs",i).html(l);var r=o.minItems>=0&&t.children.length<=o.minItems;i.find("> .tabbable > .nav-tabs > li > a > ._jsonform-array-item-delete").toggle(!r),s&&a('> .tabbable > .nav-tabs [data-idx="0"]',i).addClass("active"),a('> .tabbable > .nav-tabs [data-toggle="tab"]',i).eq(e).click()},s=function(e){var a=t.children.length-Math.max(o.minItems,0);if(i.find("> a._jsonform-array-deleteitem").toggleClass("disabled",a<=1),i.find("> .tabbable > .nav-tabs > li > a > ._jsonform-array-item-delete").toggle(a>1),a<1)return!1;t.deleteArrayItem(e),l(),i.find("> a._jsonform-array-addmore").toggleClass("disabled",o.maxItems>=0&&t.children.length>=o.maxItems)},r=function(e){if(o.maxItems>=0){var a=o.maxItems-t.children.length;if(i.find("> a._jsonform-array-addmore").toggleClass("disabled",a<=1),a<1)return!1}t.insertArrayItem(e,i.find("> .tabbable > .tab-content").get(0)),l(e),i.find("> a._jsonform-array-deleteitem").toggleClass("disabled",t.children.length<=o.minItems)};if(a("> a._jsonform-array-deleteitem",i).click(function(e){var t=a("> .tabbable > .nav-tabs .active",i).data("idx");e.preventDefault(),e.stopPropagation(),s(t)}),i.on("click","> a._jsonform-array-addmore, > .tabbable > .nav-tabs > li > ._jsonform-array-addmore",function(e){var a=t.children.length;e.preventDefault(),e.stopPropagation(),r(a)}),i.on("click","> .tabbable > .nav-tabs > li > a > ._jsonform-array-item-delete",function(e){e.preventDefault(),e.stopPropagation();var t=a(e.currentTarget).closest("li").data("idx");s(t)}),a(t.el).on("legendUpdated",function(e){l(),e.preventDefault(),e.stopPropagation()}),!t.isReadOnly()&&a(t.el).sortable&&a("> .tabbable > .nav-tabs",i).sortable({containment:t.el,cancel:"._jsonform-array-addmore",tolerance:"pointer"}).on("sortchange",function(e,t){t.placeholder.index()==a(this).children().length-1&&-1==t.placeholder.prev().data("idx")&&t.placeholder.prev().before(t.placeholder)}).on("sortstop",function(e,n){var o=a(n.item).data("idx"),s=a(n.item).index();!function(e,n){if(e!==n){var o=e<n?1:-1,l=0,s=a("> .tabbable > .tab-content",i).get(0);for(l=e;l!==n;l+=o)t.children[l].switchValuesWith(t.children[l+o]),t.children[l].render(s),t.children[l+o].render(s)}}(o,s),l(s)}),o.minItems>=0){for(var d=t.children.length;d<o.minItems;d++)r(t.children.length);l(0)}else l();i.find("> a._jsonform-array-addmore").toggleClass("disabled",o.maxItems>=0&&t.children.length>=o.maxItems);var c=o.minItems>=0&&t.children.length<=o.minItems;i.find("> a._jsonform-array-deleteitem").toggleClass("disabled",c),i.find("> .tabbable > .nav-tabs > li > a > ._jsonform-array-item-delete").toggle(!c)}},help:{template:'<span <%= id ? \'id="\' + id + \'"\' : "" %> class="help-block" style="padding-top:5px"><%= node.helpvalue || elt.helpvalue %></span>',fieldtemplate:!0},msg:{template:"<%= elt.msg %>"},html:{template:"<%= elt.html %>"},textview:{template:'<pre id="<%= id %>" name="<%= node.name %>"><%= value %></pre>',inputfield:!0,fieldtemplate:!0},fieldset:{template:'<fieldset class="jsonform-node jsonform-error-<%= keydash %> <% if (elt.expandable) { %>expandable<% } %> <%= elt.htmlClass?elt.htmlClass:"" %>" <% if (id) { %> id="<%= id %>"<% } %> data-jsonform-type="fieldset"><% if (node.title || node.legend) { %><legend><%= node.title || node.legend %></legend><% } %><% if (elt.expandable) { %><div hidden class="<%= cls.groupClass %>"><% } %><%= children %><% if (elt.expandable) { %></div><% } %><span class="help-block jsonform-errortext" style="display:none;"></span></fieldset>'},advancedfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable jsonform-node jsonform-error-<%= keydash %> <%= elt.htmlClass?elt.htmlClass:"" %>" data-jsonform-type="advancedfieldset"><legend>Advanced options</legend><div hidden class="<%= cls.groupClass %>"><%= children %></div><span class="help-block jsonform-errortext" style="display:none;"></span></fieldset>'},authfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable jsonform-node jsonform-error-<%= keydash %> <%= elt.htmlClass?elt.htmlClass:"" %>" data-jsonform-type="authfieldset"><legend>Authentication settings</legend><div hidden class="<%= cls.groupClass %>"><%= children %></div><span class="help-block jsonform-errortext" style="display:none;"></span></fieldset>'},submit:{template:'<input type="submit" <% if (id) { %> id="<%= id %>" <% } %> class="btn btn-primary <%= elt.htmlClass?elt.htmlClass:"" %>" value="<%= value || node.title %>"<%= (node.disabled? " disabled" : "")%>/>'},button:{template:' <button <% if (id) { %> id="<%= id %>" <% } %> class="<%= cls.buttonClass %> <%= elt.htmlClass?elt.htmlClass:"" %>"><%= node.title %></button> '},actions:{template:'<div class="form-actions <%= elt.htmlClass?elt.htmlClass:"" %>"><%= children %></div>'},hidden:{template:'<input type="hidden" id="<%= id %>" name="<%= node.name %>" value="<%= escape(value) %>" <%= (node.disabled? " disabled" : "")%> />',inputfield:!0},selectfieldset:{template:'<fieldset class="tab-container <%= elt.htmlClass?elt.htmlClass:"" %>"><% if (node.legend) { %><legend><%= node.legend %></legend><% } %><% if (node.formElement.key) { %><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><% } else { %><a id="<%= node.id %>"></a><% } %><div class="tabbable"><div class="<%= cls.groupClass %><%= node.formElement.hideMenu ? " hide" : "" %>"><% if (node.title && !elt.notitle) { %><label class="<%= cls.labelClass %>" for="<%= node.id %>"><%= node.title %></label><% } %><div class="<%= cls.controlClass %>"><%= tabs %></div></div><div class="tab-content"><%= children %></div></div></fieldset>',inputfield:!0,getElement:function(e){return a(e).parent().get(0)},childTemplate:function(e){return'<div data-idx="<%= node.childPos %>" class="tab-pane<% if (node.active) { %> active<% } %>">'+e+"</div>"},onBeforeRender:function(e,t){var a=null,i=[];t.schemaElement&&(i=t.schemaElement.enum||[]),a=t.options?n.map(t.options,function(e,a){var o=t.children[a];return e instanceof Object?((e=n.extend({node:o},e)).title=e.title||o.legend||o.title||"Option "+(o.childPos+1),e.value=d(e.value)?e.value:d(i[a])?i[a]:a,e):{title:e,value:d(i[o.childPos])?i[o.childPos]:o.childPos,node:o}}):n.map(t.children,function(e,t){return{title:e.legend||e.title||"Option "+(e.childPos+1),value:i[e.childPos]||e.childPos,node:e}});var o=null;e.value&&(o=n.find(a,function(e){return e.value===t.value})),o||(o=n.find(a,function(e){return e.node.hasNonDefaultValue()})),o||(o=a[0]),o.node.active=!0,e.value=o.value;t.formElement;var l='<select class="nav '+e.cls.textualInputClass+'"'+(t.disabled?" disabled":"")+">";return n.each(a,function(e,t){l+='<option data-idx="'+t+'" value="'+e.value+'"'+(e.node.active?' class="active"':"")+">"+u(e.title)+"</option>"}),l+="</select>",e.tabs=l,e},onInsert:function(e,t){a(t.el).find("select.nav").first().on("change",function(e){var n=a(this).find("option:selected");a(t.el).find('input[type="hidden"]').first().val(n.attr("value"))})}},optionfieldset:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %>><%= children %></div>'},section:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %> class="jsonform-node jsonform-error-<%= keydash %> <%= elt.htmlClass?elt.htmlClass:"" %>"><%= children %></div>'},questions:{template:'<div><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><%= children %></div>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return a(e).parent().get(0)},onInsert:function(e,t){t.children&&0!==t.children.length&&(n.each(t.children,function(e){a(e.el).hide()}),a(t.children[0].el).show())}},question:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><% if (elt.optionsType === "radiobuttons") { %><label class="<%= cls.buttonClass%> <%= ((key instanceof Object && key.htmlClass) ? " " + key.htmlClass : "") %>"><% } else { %><% if (!elt.inline) { %><div class="radio"><% } %><label class="<%= elt.inline ? "radio"+cls.inlineClassSuffix : "" %> <%= ((key instanceof Object && key.htmlClass) ? " " + key.htmlClass : "") %>"><% } %><input type="radio" <% if (elt.optionsType === "radiobuttons") { %> style="position:absolute;left:-9999px;" <% } %>name="<%= node.id %>" value="<%= val %>"<%= (node.disabled? " disabled" : "")%>/><span><%= (key instanceof Object ? key.title : key) %></span></label><%= elt.optionsType !== "radiobuttons" && !elt.inline ? "</div>" : "" %> <% }); %></div>',fieldtemplate:!0,onInsert:function(e,t){var i="active",o=t.formElement||{};o.activeClass&&(i+=" "+o.activeClass),a(t.el).find('input[type="radio"]').on("change",function(e){var o=null,l=t.options[a(this).val()];t.parentNode&&t.parentNode.el&&(a(t.el).find("label").removeClass(i),a(this).parent().addClass(i),a(t.el).nextAll().hide(),a(t.el).nextAll().find('input[type="radio"]').prop("checked",!1),l.value&&a(t.parentNode.el).find('input[type="hidden"]').val(l.value),l.next&&(o=n.find(t.parentNode.children,function(e){return e.formElement&&e.formElement.qid===l.next}),a(o.el).show(),a(o.el).nextAll().hide(),a(o.el).nextAll().find('input[type="radio"]').prop("checked",!1)),l.href&&(l.target?window.open(l.href,l.target):window.location=l.href),l.submit&&setTimeout(function(){t.ownerTree.submit()},0))})}}},p.util.getObjKey=function(e,t,a){for(var i=e,l=t.split("."),s=null,r=null,d=null,c=0;c<l.length;c++){if(null===i||"object"!=typeof i)return null;if(d=(s=l[c]).replace(o,""),o.lastIndex=0,r=o.exec(s))for(i=i[d];;){if(!n.isArray(i))return null;if(i=i[parseInt(r[1],10)],!(r=o.exec(s)))break}else i=a&&!i[d]&&n.isArray(i)&&i[0]?i[0][d]:i[d]}return a&&n.isArray(i)&&i[0]?i[0]:i},p.util.getObjKeyEx=function(e,t,a){var n=e;if(null===t||void 0===t||""===t)return e;if("string"==typeof a&&a.length>0){if(t.slice(0,a.length)!==a)throw console.log([a,e,t]),new Error("key ["+t+"] does not match the objKey ["+a+"]");"."===(t=t.slice(a.length))[0]&&(t=t.slice(1))}var i=t.match(/^((([^\\\[.]|\\.)+)|\[(\d+)\])\.?(.*)$/);if(!i)throw new Error("bad format key: "+t);if("string"==typeof i[2]&&i[2].length>0)n=n[i[2]];else{if(!("string"==typeof i[4]&&i[4].length>0))throw new Error("impossible reach here");n=n[Number(i[4])]}return n&&i[5].length>0&&(n=this.getObjKeyEx(n,i[5])),n},p.util.setObjKey=function(e,t,a){for(var i=e,l=t.split("."),s=null,r=null,d=null,c=0;c<l.length-1;c++)if(d=(s=l[c]).replace(o,""),o.lastIndex=0,r=o.exec(s)){for(;n.isArray(i[d])||(i[d]=[]),i=i[d],d=parseInt(r[1],10),r=o.exec(s););"object"==typeof i[d]&&null!==i[d]||(i[d]={}),i=i[d]}else"object"==typeof i[d]&&null!==i[d]||(i[d]={}),i=i[d];if(d=(s=l[l.length-1]).replace(o,""),o.lastIndex=0,r=o.exec(s)){for(;n.isArray(i[d])||(i[d]=[]),i=i[d],d=parseInt(r[1],10),r=o.exec(s););i[d]=a}else i[d]=a};var _=function(e,t){var a=t.replace(/\./g,".properties.").replace(/\[[0-9]*\]/g,".items"),n=p.util.getObjKey(e,a,!0);if(n&&n.$ref)throw new Error("JSONForm does not yet support schemas that use the $ref keyword. See: https://github.com/joshfire/jsonform/issues/54");return n},v=function(e,t,a){a=a||0;var n=void 0;if(d(t)&&""!==t)if(e.default&&0==a)n=p.util.getObjKeyEx(e.default,t);else{var i=t.match(/^((([^\\\[.]|\\.)+)|\[(\d+)\])\.?(.*)$/);if(!i)throw new Error("bad format key: "+t);if("string"==typeof i[2]&&i[2].length>0)e=e.properties[i[2]];else{if(!("string"==typeof i[4]&&i[4].length>0))throw new Error("impossible reach here");e=e.items,a>0&&--a}e&&(n=e.default&&0==a?p.util.getObjKeyEx(e.default,i[5]):v(e,i[5],a))}else 0==a&&(n=e.default);return n},b=function(e,t){var a=0;if(!e)return null;if(!t||0===t.length)return e;return e.replace(o,function(e,n){var i=e;return d(t[a])&&(i="["+t[a]+"]"),a+=1,i})},y=function(e,t,a,i,o){var l=null;(i=i||{}).idx=i.idx||(a?a[a.length-1]:1),i.value=d(i.value)?i.value:"",i.getValue=i.getValue||function(t){return y(e,t,a,i,o)};var u=function(e,t){var a=null;return e&&e.length?(n.each(e,function(e){a||(e!==t?n.isString(e)||(e.key===t?a=e:e.items&&(a=u(e.items,t))):a={key:e})}),a):null},h=u(e.form||[],t),f=_(e.schema.properties,t);return o&&e.value&&(l=p.util.getObjKey(e.value,b(t,a))),d(l)||(h&&void 0!==h.value?l=h.value:f&&d(f.default)&&(l=f.default),l&&-1!==l.indexOf("{{values.")&&(l=l.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}')),l&&(l=r(l,i,s))),d(l)&&h&&c(h.titleMap,l)&&(l=r(h.titleMap[l],i,s)),l&&n.isString(l)&&f&&f.maxLength&&l.length>f.maxLength&&(l=l.substr(0,f.maxLength-1)+"…"),d(l)?l:null},w=function(){this.id=null,this.key=null,this.el=null,this.formElement=null,this.schemaElement=null,this.view=null,this.children=[],this.ownerTree=null,this.parentNode=null,this.childTemplate=null,this.legendChild=null,this.arrayPath=[],this.childPos=0};w.prototype.clone=function(e){var t=new w;return t.childPos=this.childPos,t.arrayPath=n.clone(this.arrayPath),t.ownerTree=this.ownerTree,t.parentNode=e||this.parentNode,t.formElement=this.formElement,t.schemaElement=this.schemaElement,t.view=this.view,t.children=n.map(this.children,function(e){return e.clone(t)}),t},w.prototype.hasNonDefaultValue=function(){if(this.formElement&&"hidden"==this.formElement.type)return!1;if(this.value&&!this.defaultValue)return!0;return!!n.find(this.children,function(e){return e.hasNonDefaultValue()})},w.prototype.getProperty=function(e,t){var a=this[e];return void 0===a&&t&&this.parentNode?this.parentNode.getProperty(e,!0):a},w.prototype.isReadOnly=function(){return this.getProperty("readOnly",!0)},w.prototype.appendChild=function(e){return e.parentNode=this,e.childPos=this.children.length,this.children.push(e),e},w.prototype.removeChild=function(){var e=this.children[this.children.length-1];if(e)return a(e.el).remove(),this.children.pop()},w.prototype.moveValuesTo=function(e){var t=this.getFormValues(e.arrayPath);e.resetValues(),e.computeInitialValues(t,!0)},w.prototype.switchValuesWith=function(e){var t=this.getFormValues(e.arrayPath),a=e.getFormValues(this.arrayPath);e.resetValues(),e.computeInitialValues(t,!0),this.resetValues(),this.computeInitialValues(a,!0)},w.prototype.resetValues=function(){var e=null;if(this.value=null,this.parentNode?(this.arrayPath=n.clone(this.parentNode.arrayPath),this.parentNode.view&&this.parentNode.view.array&&this.arrayPath.push(this.childPos)):this.arrayPath=[],this.view&&this.view.inputfield)e=a(":input",this.el).serializeArray(),n.each(e,function(e){a('[name="'+h(e.name)+'"]',a(this.el)).val("")},this);else if(this.view&&this.view.array)for(;this.children.length>0;)this.removeChild();n.each(this.children,function(e){e.resetValues()})},w.prototype.setChildTemplate=function(e){this.childTemplate=e,e.parentNode=this},w.prototype.getChildTemplate=function(){return this.childTemplate||this.view.array&&(this.formElement.items?key=this.formElement.items[0]||this.formElement.items:key=this.formElement.key+"[]",n.isString(key)&&(key={key:key}),this.setChildTemplate(this.ownerTree.buildFromLayout(key))),this.childTemplate},w.prototype.computeInitialValues=function(e,t,a){var i=this,o=null,l=1,c=0,u=this.ownerTree.formDesc.tpldata||{};if(a=a||0,this.parentNode?(this.arrayPath=n.clone(this.parentNode.arrayPath),this.parentNode.view&&this.parentNode.view.array&&this.arrayPath.push(this.childPos)):this.arrayPath=[],u.idx=this.arrayPath.length>0?this.arrayPath[this.arrayPath.length-1]+1:this.childPos+1,u.value="",u.getValue=function(t){return y(i.ownerTree.formDesc,t,i.arrayPath,u,!!e)},this.formElement&&(this.formElement.id?this.id=b(this.formElement.id,this.arrayPath):this.view&&this.view.array?this.id=h(this.ownerTree.formDesc.prefix)+"-elt-counter-"+n.uniqueId():this.parentNode&&this.parentNode.view&&this.parentNode.view.array?this.id=h(this.ownerTree.formDesc.prefix)+"-elt-counter-"+n.uniqueId():"button"!==this.formElement.type&&"selectfieldset"!==this.formElement.type&&"question"!==this.formElement.type&&"buttonquestion"!==this.formElement.type||(this.id=h(this.ownerTree.formDesc.prefix)+"-elt-counter-"+n.uniqueId()),this.formElement.key&&(this.key=b(this.formElement.key,this.arrayPath),this.keydash=this.key.replace(/\./g,"---")),this.name=b(this.formElement.name,this.arrayPath),n.each(["title","legend","description","append","prepend","inlinetitle","helpvalue","value","disabled","required","placeholder","readOnly"],function(e){n.isString(this.formElement[e])?(-1!==this.formElement[e].indexOf("{{values.")?this[e]=this.formElement[e].replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):this[e]=b(this.formElement[e],this.arrayPath),this[e]&&(this[e]=r(this[e],u,s))):this[e]=this.formElement[e]},this),this.formElement.options&&(this.options=n.map(this.formElement.options,function(e){var t=null;return n.isObject(e)&&e.title?(t=-1!==e.title.indexOf("{{values.")?e.title.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):b(e.title,i.arrayPath),n.extend({},e,{value:d(e.value)?e.value:"",title:r(t,u,s)})):e}))),this.view&&this.view.inputfield&&this.schemaElement){if(e)d(p.util.getObjKey(e,this.key))&&(this.value=p.util.getObjKey(e,this.key));else if(!t&&!d(this.value)){var f=v(i.ownerTree.formDesc.schema,this.key,a);d(f)&&(this.value=f,n.isString(this.value)&&(-1!==this.value.indexOf("{{values.")?this.value=this.value.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):this.value=b(this.value,this.arrayPath),this.value&&(this.value=r(this.value,u,s))),this.defaultValue=!0)}}else if(this.view&&this.view.array){l=1;var m=this.getArrayBoundaries().minItems;if(e){var g=p.util.getObjKeyEx(e,this.key);g&&Array.isArray(g)&&(l=g.length)}else if(t)m>=0&&(l=0);else{(f=v(i.ownerTree.formDesc.schema,this.key,a))&&Array.isArray(f)&&(l=f.length)}for(c=0;c<l;c++)this.appendChild(this.getChildTemplate().clone())}if(n.each(this.children,function(n){n.computeInitialValues(e,t,a)}),this.formElement&&this.formElement.valueInLegend)for(o=this;o;){if(o.parentNode&&o.parentNode.view&&o.parentNode.view.array&&(o.legendChild=this,o.formElement&&o.formElement.legend)){o.legend=b(o.formElement.legend,o.arrayPath),u.idx=o.arrayPath.length>0?o.arrayPath[o.arrayPath.length-1]+1:o.childPos+1,u.value=d(this.value)?this.value:"",o.legend=r(o.legend,u,s);break}o=o.parentNode}},w.prototype.getFormValues=function(e){var t={};if(!this.el)throw new Error("formNode.getFormValues can only be called on nodes that are associated with a DOM element in the tree");var o=a(":input",this.el).serializeArray();o=o.concat(a(":input[type=checkbox]:not(:disabled):not(:checked)[name]",this.el).map(function(){return{name:this.name,value:this.checked}}).get()),e&&n.each(o,function(t){t.name=b(t.name,e)});for(var l=this.ownerTree.formDesc.schema,s=0;s<o.length;s++){var r=o[s].name,d=_(l.properties,r),c=null,u=null;if(d)if(d._jsonform_checkboxes_as_array&&(c=r.match(/\[([0-9]*)\]$/)))r=r.replace(/\[([0-9]*)\]$/,""),u=p.util.getObjKey(t,r)||[],"value"===d._jsonform_checkboxes_as_array&&!1!==o[s].value&&""!==o[s].value?u.push(o[s].value):!0===d._jsonform_checkboxes_as_array&&"1"===o[s].value&&u.push(d.enum[parseInt(c[1],10)]),p.util.setObjKey(t,r,u);else if("tagsinput"!==d._jsonform_get_value_by_tagsinput)if("[]"!==r.slice(-2)||(r=r.slice(0,-2),"array"!==(d=_(l.properties,r)).type)){if("boolean"===d.type&&("0"===o[s].value||"false"===o[s].value?o[s].value=!1:""===o[s].value?o[s].value=null:o[s].value=!!o[s].value),"number"!==d.type&&"integer"!==d.type||n.isString(o[s].value)&&(o[s].value.length?isNaN(Number(o[s].value))||(o[s].value=Number(o[s].value)):o[s].value=null),"string"!==d.type||""!==o[s].value||d._jsonform_allowEmpty||(o[s].value=null),"object"===d.type&&n.isString(o[s].value)&&"{"===o[s].value.substring(0,1))try{o[s].value=i.parse(o[s].value)}catch(e){o[s].value={}}if("array"===d.type&&n.isString(o[s].value))if("["===o[s].value.substring(0,1))try{o[s].value=i.parse(o[s].value)}catch(e){o[s].value=[]}else o[s].value=null;"object"!==d.type||"null"!==o[s].value&&""!==o[s].value||(o[s].value=null),o[s].name&&null!==o[s].value&&p.util.setObjKey(t,o[s].name,o[s].value)}else(u=p.util.getObjKey(t,r)||[]).indexOf(o[s].value)<0&&(u.push(o[s].value),p.util.setObjKey(t,r,u));else{var h;if(e){var f=b(r,this.arrayPath);h=a(':input[name="'+f+'"]',this.el).tagsinput("items")}else h=a(':input[name="'+r+'"]',this.el).tagsinput("items");p.util.setObjKey(t,r,h)}}return t},w.prototype.render=function(e){var t=this.generate();this.setContent(t,e),this.enhance()},w.prototype.setContent=function(e,t){var n=a(e),i=t||(this.parentNode?this.parentNode.el:this.ownerTree.domRoot),o=null;this.el?a(this.el).replaceWith(n):(o=a(i).children().get(this.childPos))?a(o).before(n):a(i).append(n),this.el=n,this.updateElement(this.el)},w.prototype.updateElement=function(e){this.id&&(this.el=a("#"+h(this.id),e).get(0),this.view&&this.view.getElement&&(this.el=this.view.getElement(this.el)),!1!==this.fieldtemplate&&this.view&&this.view.fieldtemplate&&(this.el=a(this.el).parent().parent(),(this.prepend||this.append)&&(this.el=this.el.parent()),this.el=this.el.get(0)),this.parentNode&&this.parentNode.view&&this.parentNode.view.childTemplate&&(this.el=a(this.el).parent().get(0))),n.each(this.children,function(t){t.updateElement(this.el||e)})},w.prototype.generate=function(){var e={id:this.id,keydash:this.keydash,elt:this.formElement,schema:this.schemaElement,node:this,value:d(this.value)?this.value:"",cls:this.ownerTree.defaultClasses,escape:u},t=null;this.ownerTree.formDesc.onBeforeRender&&this.ownerTree.formDesc.onBeforeRender(e,this),this.view.onBeforeRender&&this.view.onBeforeRender(e,this),t=this.template?this.template:this.formElement&&this.formElement.template?this.formElement.template:this.view.template,!1!==this.fieldtemplate&&(this.fieldtemplate||this.view.fieldtemplate)&&(t=p.fieldTemplate(t)),this.parentNode&&this.parentNode.view&&this.parentNode.view.childTemplate&&(t=this.parentNode.view.childTemplate(t,this.parentNode));var a="";return n.each(this.children,function(e){a+=e.generate()}),e.children=a,e.fieldHtmlClass="",this.ownerTree&&this.ownerTree.formDesc&&this.ownerTree.formDesc.params&&this.ownerTree.formDesc.params.fieldHtmlClass&&(e.fieldHtmlClass=this.ownerTree.formDesc.params.fieldHtmlClass),this.formElement&&void 0!==this.formElement.fieldHtmlClass&&(e.fieldHtmlClass=this.formElement.fieldHtmlClass),r(t,e,l)},w.prototype.enhance=function(){var e=this,t=null,i=null,o=n.clone(this.ownerTree.formDesc.tpldata)||{};if(this.formElement&&(this.view.onInsert&&this.view.onInsert({target:a(this.el)},this),t=this.handlers||this.formElement.handlers,(i=this.onInsert||this.formElement.onInsert)&&i({target:a(this.el)},this),t&&n.each(t,function(e,t){"insert"===t&&e({target:a(this.el)},this)},this),this.el&&(this.onChange&&a(this.el).bind("change",function(t){e.onChange(t,e)}),this.view.onChange&&a(this.el).bind("change",function(t){e.view.onChange(t,e)}),this.formElement.onChange&&a(this.el).bind("change",function(t){e.formElement.onChange(t,e)}),this.onClick&&a(this.el).bind("click",function(t){e.onClick(t,e)}),this.view.onClick&&a(this.el).bind("click",function(t){e.view.onClick(t,e)}),this.formElement.onClick&&a(this.el).bind("click",function(t){e.formElement.onClick(t,e)}),this.onKeyUp&&a(this.el).bind("keyup",function(t){e.onKeyUp(t,e)}),this.view.onKeyUp&&a(this.el).bind("keyup",function(t){e.view.onKeyUp(t,e)}),this.formElement.onKeyUp&&a(this.el).bind("keyup",function(t){e.formElement.onKeyUp(t,e)}),t&&n.each(t,function(t,n){"insert"!==n&&a(this.el).bind(n,function(a){t(a,e)})},this)),this.formElement.legend&&this.legendChild&&this.legendChild.formElement)){function l(t){e.formElement&&e.formElement.legend&&e.parentNode&&(e.legend=b(e.formElement.legend,e.arrayPath),o.idx=e.arrayPath.length>0?e.arrayPath[e.arrayPath.length-1]+1:e.childPos+1,o.value=a(t.target).val(),e.legend=r(e.legend,o,s),a(e.parentNode.el).trigger("legendUpdated"))}a(this.legendChild.el).on("keyup",l),a(this.legendChild.el).on("change",l)}n.each(this.children,function(e){e.enhance()})},w.prototype.insertArrayItem=function(e,t){var a=0;void 0===e&&(e=this.children.length);var n=this.getChildTemplate().clone();for(this.appendChild(n),n.resetValues(),a=this.children.length-2;a>=e;a--)this.children[a].moveValuesTo(this.children[a+1]);for(this.children[e].resetValues(),this.children[e].computeInitialValues(null,!1,this.children[e].arrayPath.length),a=e;a<this.children.length;a++)this.children[a].render(t)},w.prototype.deleteArrayItem=function(e){var t=0;for(void 0===e&&(e=this.children.length-1),t=e;t<this.children.length-1;t++)this.children[t+1].moveValuesTo(this.children[t]),this.children[t].render();this.removeChild()},w.prototype.getArrayBoundaries=function(){if(!this.view||!this.view.array)return{minItems:-1,maxItems:-1};var e=function(t,a){var i=null,o=null,l={minItems:-1,maxItems:-1};return a=a||t,t.view&&t.view.array&&t!==a?l:t.key?(o=t.key.replace(/\[[0-9]+\]/g,"[]"),t!==a&&(o=o.replace(/\[\][^\[\]]*$/,"")),(i=_(t.ownerTree.formDesc.schema.properties,o))?(i.minItems>=0&&(l.minItems=i.minItems),i.minLength>=0&&(l.minItems=i.minLength),i.maxItems>=0&&(l.maxItems=i.maxItems),i.maxLength>=0&&(l.maxItems=i.maxLength),l):l):(n.each(t.children,function(t){var n=e(t,a);-1!==n.minItems&&(-1!==l.minItems?l.minItems=Math.max(l.minItems,n.minItems):l.minItems=n.minItems),-1!==n.maxItems&&(-1!==l.maxItems?l.maxItems=Math.min(l.maxItems,n.maxItems):l.maxItems=n.maxItems)}),l)};return e(this)};var x=function(){this.eventhandlers=[],this.root=null,this.formDesc=null};x.prototype.initialize=function(e){e=e||{},this.formDesc=n.clone(e),p.defaultClasses=(t=this.formDesc.isBootstrap2||p.isBootstrap2,t?{groupClass:"control-group",groupMarkClassPrefix:"",labelClass:"control-label",controlClass:"controls",iconClassPrefix:"icon",buttonClass:"btn",textualInputClass:"",prependClass:"input-prepend",appendClass:"input-append",addonClass:"add-on",inlineClassSuffix:" inline"}:{groupClass:"form-group",groupMarkClassPrefix:"has-",labelClass:"control-label",controlClass:"controls",iconClassPrefix:"glyphicon glyphicon",buttonClass:"btn btn-default",textualInputClass:"form-control",prependClass:"input-group",appendClass:"input-group",addonClass:"input-group-addon",buttonAddonClass:"input-group-btn",inlineClassSuffix:"-inline"});var t;this.defaultClasses=n.clone(p.defaultClasses),this.formDesc.defaultClasses&&n.extend(this.defaultClasses,this.formDesc.defaultClasses),this.formDesc.prefix=this.formDesc.prefix||"jsonform-"+n.uniqueId(),this.formDesc.schema&&!this.formDesc.schema.properties&&(this.formDesc.schema={properties:this.formDesc.schema});var a=[];function o(e){if(e&&e.properties){var t=Array.isArray(e.required)?e.required:[];for(var n in e.properties){var i=e.properties[n];if(!0===i.required)t.indexOf(n)<0&&t.push(n);else if(void 0!==i.required&&!1!==i.required&&!Array.isArray(i.required))throw new Error("field "+n+"'s required property should be either boolean or array of strings");if("object"===i.type?a.indexOf(i)<0&&(a.push(i),o(i)):delete i.required,"array"===i.type&&i.items){if(Array.isArray(i.items))throw new Error("the items property of array property "+n+" in the schema definition must be an object");"object"===i.items.type&&a.indexOf(i.items)<0&&(a.push(i.items),o(i.items))}}t.length>0?e.required=t:delete e.required}}if(o(this.formDesc.schema),this.formDesc.schema.definitions)for(var l in this.formDesc.schema.definitions)o(this.formDesc.schema.definitions[l]);this.formDesc._originalSchema=this.formDesc.schema,this.formDesc.schema=i.parse(i.stringify(this.formDesc.schema));var s=[];function r(e,t){Object.keys(e).forEach(function(a,n,i){var o=e[a];if(null!==o&&"object"==typeof o)if(o.$ref)if("#/definitions/"===o.$ref.slice(0,14)){var l=o.$ref.replace(/^#\/definitions\//,"");e[a]=t[l]}else console.log("Unresolved $ref: "+o.$ref);else s.indexOf(o)<0&&(r(o,t),s.push(o))})}this.formDesc.schema.definitions&&r(this.formDesc.schema,this.formDesc.schema.definitions),this.formDesc.form=this.formDesc.form||["*",{type:"actions",items:[{type:"submit",value:"Submit"}]}],this.formDesc.form=n.isArray(this.formDesc.form)?this.formDesc.form:[this.formDesc.form],this.formDesc.params=this.formDesc.params||{},this.root=new w,this.root.ownerTree=this,this.root.view=p.elementTypes.root,this.buildTree(),this.computeInitialValues()},x.prototype.buildTree=function(){n.each(this.formDesc.form,function(e){"*"===e?n.each(this.formDesc.schema.properties,function(e,t){this.formDesc.nonDefaultFormItems&&this.formDesc.nonDefaultFormItems.indexOf(t)>=0||this.root.appendChild(this.buildFromLayout({key:t}))},this):(n.isString(e)&&(e={key:e}),this.root.appendChild(this.buildFromLayout(e)))},this)},x.prototype.buildFromLayout=function(e,t){var a=null,i=new w,o=null;if(e.key&&this.formDesc.customFormItems){var l=this.formDesc.customFormItems[e.key];void 0!==l&&(l.key=e.key,e=l)}if((e=n.clone(e)).items&&(n.isArray(e.items)?e.items=n.map(e.items,n.clone):e.items=[n.clone(e.items)]),e.key){if(!(a=_(this.formDesc.schema.properties,e.key)))throw new Error('The JSONForm object references the schema key "'+e.key+'" but that key does not exist in the JSON schema');this.formDesc.onElementSchema&&this.formDesc.onElementSchema(e,a),e.name=e.name||e.key,e.title=e.title||a.title,e.description=e.description||a.description,e.readOnly=e.readOnly||a.readOnly||e.readonly||a.readonly;function s(e,t){var a=e.split("."),n=a.pop();if("[]"==n.slice(-2))return!1;var i=a.join("."),o=!1;if(i){var l=_(t.properties,i);(o=l.required&&l.required.indexOf(n)>=0)&&(o="[]"==i.slice(-2)||s(i,t))}else o=t.required&&t.required.indexOf(n)>=0;return o}e.required=!0===e.required||!0===a.required||s(e.key,this.formDesc.schema),e.id||(e.id=h(this.formDesc.prefix)+"-elt-"+e.key),e.allowEmpty&&(a._jsonform_allowEmpty=!0),e.type||("string"===a.type&&"color"===a.format?e.type="color":"number"!==a.type&&"integer"!==a.type||a.enum?"string"!==a.type&&"any"!==a.type||a.enum?"boolean"===a.type?e.type="checkbox":"object"===a.type?a.properties?e.type="fieldset":e.type="textarea":n.isUndefined(a.enum)?e.type=a.type:e.type="select":e.type="text":e.type="number");function r(e,t){e.options?Array.isArray(e.options)?e.options=e.options.map(function(e){return c(e,"value")?e:{value:e,title:e}}):"object"==typeof e.options&&(e.options=Object.keys(e.options).map(function(t){return{value:t,title:e.options[t]}})):e.titleMap?e.options=n.map(t,function(t){var a=t.toString();return{value:t,title:c(e.titleMap,a)?e.titleMap[a]:a}}):e.options=t.map(function(e){return{value:e,title:e.toString()}})}if(e.options)r(e);else if(a.enum||"boolean"===a.type){(u=a.enum)?e.optionsAsEnumOrder=!0:u="select"===e.type?["",!0,!1]:[!0,!1],r(e,u)}if(("checkboxes"===e.type||"checkboxbuttons"===e.type)&&a.items){var d=Array.isArray(a.items)?a.items[0]:a.items;if(e.options)r(e),d._jsonform_checkboxes_as_array="value";else{var u;(u=d.enum)&&(r(e,u),e.optionsAsEnumOrder=!0,d._jsonform_checkboxes_as_array="checkboxes"===e.type||"value")}}"tagsinput"===e.getValue&&(a._jsonform_get_value_by_tagsinput="tagsinput"),"object"===a.type&&n.each(a.properties,function(t,a){var n=e.key+"."+a;this.formDesc.nonDefaultFormItems&&this.formDesc.nonDefaultFormItems.indexOf(n)>=0||i.appendChild(this.buildFromLayout({key:n}))},this)}if(e.type||(e.type="text"),!(o=p.elementTypes[e.type]))throw new Error('The JSONForm contains an element whose type is unknown: "'+e.type+'"');if(a){if(!o.inputfield&&!o.array&&"selectfieldset"!==e.type&&"object"!==a.type)throw new Error('The JSONForm contains an element that links to an element in the JSON schema (key: "'+e.key+'") and that should not based on its type ("'+e.type+'")')}else if(o.inputfield&&"selectfieldset"!==e.type)throw new Error('The JSONForm defines an element of type "'+e.type+'" but no "key" property to link the input field to the JSON schema');if(e.iddot=h(e.id||""),i.formElement=e,i.schemaElement=a,i.view=o,i.ownerTree=this,e.handlers||(e.handlers={}),i.view.array);else if(e.items)n.each(e.items,function(e){n.isString(e)&&(e={key:e}),i.appendChild(this.buildFromLayout(e))},this);else if(e.otherField){var f=e.otherField;n.isString(f)?f=e.otherField={key:f,notitle:!0}:void 0===f.notitle&&(f.notitle=!0),void 0===f.inline&&(f.inline=e.inline),i.appendChild(this.buildFromLayout(f))}return i},x.prototype.computeInitialValues=function(){this.root.computeInitialValues(this.formDesc.value)},x.prototype.render=function(e){e&&(this.domRoot=e,this.root.render(),this.hasRequiredField()&&a(e).addClass("jsonform-hasrequired"),a(e).addClass("jsonform"))},x.prototype.forEachElement=function(e){var t=function(a){for(var n=0;n<a.children.length;n++)e(a.children[n]),t(a.children[n])};t(this.root)},x.prototype.validate=function(e){var n=p.getFormValue(this.domRoot),i=!1,o=this.formDesc;if(!1!==o.validate){var l=!1;if("object"!=typeof o.validate?t.ZSchema?(l=new t.ZSchema)._vendor="z-schema":t.jjv?(l=t.jjv())._vendor="jjv":t.JSONFormValidator&&((l=t.JSONFormValidator.createEnvironment("json-schema-draft-03"))._vendor="jsv"):l=o.validate,l)if(a(this.domRoot).jsonFormErrors(!1,o),"jjv"==l._vendor){(s=l.validate(this.formDesc._originalSchema,n))&&(i=[s])}else{var s=l.validate(n,this.formDesc._originalSchema);"z-schema"==l._vendor?(i=l.getLastErrors(),s=s?null:{errors:i}):s&&s.errors&&s.errors.length&&(i||(i=[]),i=i.concat(s.errors))}}return i&&!e&&(o.displayErrors?o.displayErrors(i,this.domRoot):a(this.domRoot).jsonFormErrors(i,o)),{errors:i,values:n}},x.prototype.submit=function(e){var t=function(){return e&&(e.preventDefault(),e.stopPropagation()),!1},a=p.getFormValue(this.domRoot),n=this.formDesc,i=!1;if(this.forEachElement(function(t){i||t.view.onSubmit&&(i=!t.view.onSubmit(e,t))}),i)return t();var o=this.validate();return n.onSubmit&&!n.onSubmit(o.errors,a)?t():o.errors?t():!(!n.onSubmitValid||n.onSubmitValid(a))&&t()},x.prototype.hasRequiredField=function(){return a(this.domRoot).find(".jsonform-required").length>0},p.getFormValue=function(e){var t=a(e).data("jsonform-tree");return t?t.root.getFormValues():null},a.fn.jsonFormErrors=function(e,t){var n=a(this).data("jsonform-tree");if(a("."+n.defaultClasses.groupMarkClassPrefix+"error",this).removeClass(n.defaultClasses.groupMarkClassPrefix+"error"),a("."+n.defaultClasses.groupMarkClassPrefix+"warning",this).removeClass(n.defaultClasses.groupMarkClassPrefix+"warning"),a(".jsonform-errortext",this).hide(),e){for(var i=[],o=0;o<e.length;o++){var l=e[o].uri||e[o].path;if(["OBJECT_DEPENDENCY_KEY","OBJECT_MISSING_REQUIRED_PROPERTY"].indexOf(e[o].code)>=0&&("/"!=l.slice(-1)&&(l+="/"),l+=e[o].params[0]),l){l=l.replace(/.*#\//,"").replace(/\//g,".").replace(/\.([0-9]+)(?=\.|$)/g,"[$1]");var s=".jsonform-error-"+h(l.replace(/\./g,"---"));i.push(s);var r=e[o].type||"error",d=a(s,this);"ARRAY_LENGTH_SHORT"==e[o].code&&["checkboxes","checkboxbuttons"].indexOf(d.data("jsonform-type"))>=0&&(e[o].message="Please select at least "+e[o].params[1]+(e[o].params[1]>1?" options":" option")+" above."),d.addClass(n.defaultClasses.groupMarkClassPrefix+r),d.find("> div > .jsonform-errortext, > .jsonform-errortext").text(e[o].message).show()}}i=i.join(",");var c=a(i,this),p=c.parents(".tab-pane"),u=a();p.each(function(){var e=a(this);u=u.add(e.closest(".tabbable").find("> .nav > li").eq(e.index()).addClass(n.defaultClasses.groupMarkClassPrefix+"error"))});var f=c.filter(":visible").get(0);!f&&u.length>0&&(f=u.get(0)),f&&f.scrollIntoView&&f.scrollIntoView(!0,{behavior:"smooth"})}},a.fn.jsonForm=function(e,t){if("values"===e)return p.getFormValue(this);if("submit"===e){return(o=this.data("jsonform-tree"))?o.submit():null}if("validate"===e){return(o=this.data("jsonform-tree"))?o.validate(t):null}e=n.defaults({},e,{submitEvent:"submit"});var o;return(o=new x).initialize(e),o.render(this.get(0)),e.transloadit&&this.append('<input type="hidden" name="params" value=\''+u(i.stringify(e.transloadit.params))+"'>"),this.data("jsonform-tree",o),e.submitEvent&&(this.unbind(e.submitEvent+".jsonform"),this.bind(e.submitEvent+".jsonform",function(e){o.submit(e)})),function(e){var t=function(e,t){t.find("> .active").removeClass("active"),e.addClass("active")},n=function(e,t){e.find("input, textarea, select").removeAttr("disabled"),e.parent().children(":not([data-idx="+t+"])").find("input, textarea, select").attr("disabled","disabled")},i=function(e){var i,o=a("option:selected",a(this)),l=a(this),s=o.get(0).getAttribute("data-idx")||o.attr("value");e.preventDefault(),o.hasClass("active")||(i=a(this).parents(".tabbable").eq(0).find("> .tab-content > [data-idx="+s+"]"),t(o,l),t(i,i.parent()),n(i,s))},o=function(e){a("a",a(this));var i=a(this).parents(".tabbable").first().find(".tab-content").first(),o=a(this).index(),l=i.find("[data-idx="+o+"]");e.preventDefault(),t(a(this),a(this).parent()),t(l,l.parent()),a(this).parent().hasClass("jsonform-alternative")&&n(l,o)};e.each(function(){a(this).delegate("select.nav","change",i),a(this).find("select.nav").each(function(){a(this).val(a(this).find(".active").attr("value"));var e=a(this).find("option:selected").get(0).getAttribute("data-idx")||a(this).find("option:selected").attr("value"),t=a(this).parents(".tabbable").eq(0).find("> .tab-content > [data-idx="+e+"]");n(t,e)}),a(this).delegate("ul.nav li","click",o),a(this).find("ul.nav li.active").click()})}(this),a(".expandable > div, .expandable > fieldset",this).hide(),this.on("click",".expandable > legend",function(){var e=a(this).parent();e.toggleClass("expanded"),a("> div",e).slideToggle(100)}),o},a.fn.jsonFormValue=function(){return p.getFormValue(this)},t.JSONForm||(t.JSONForm=p)}("undefined"!=typeof exports,"undefined"!=typeof exports?exports:window,"undefined"!=typeof jQuery?jQuery:{fn:{}},"undefined"!=typeof _?_:null,JSON),jQuery&&function(e){e.extend(e.fn,{fileTree:function(t,a){if(!t)t={};void 0==t.root&&(t.root="/"),void 0==t.script&&(t.script="jqueryFileTree.php"),void 0==t.folderEvent&&(t.folderEvent="click"),void 0==t.expandSpeed&&(t.expandSpeed=500),void 0==t.collapseSpeed&&(t.collapseSpeed=500),void 0==t.expandEasing&&(t.expandEasing=null),void 0==t.collapseEasing&&(t.collapseEasing=null),void 0==t.multiFolder&&(t.multiFolder=!0),void 0==t.loadMessage&&(t.loadMessage="Loading..."),e(this).each(function(){function n(a,n){if(n.search("%")>=0){var o=n.split("%"),l=o.length-1;o[l]=o[l].replace("/",""),e.get("filemanager_js/utf-8.txt",function(l){var s=l.split("\n"),r="";for(var d in o)if(d>0)for(var c in s)s[c].indexOf(o[d])>-1&&(r=(r=s[c].split(";"))[1].split("\t"),o[d]=r[1]);o=o.join(""),n=o+"/",e(a).addClass("wait"),e(".jqueryFileTree.start").remove(),e.post(t.script,{dir:n,sign:here},function(o){e(a).find(".start").html(""),e(a).removeClass("wait").append(o),t.root==n?e(a).find("UL:hidden").show():e(a).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing}),i(a)})})}else e(a).addClass("wait"),e(".jqueryFileTree.start").remove(),e.post(t.script,{dir:n,sign:here},function(o){e(a).find(".start").html(""),e(a).removeClass("wait").append(o),t.root==n?e(a).find("UL:hidden").show():e(a).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing}),i(a)})}function i(i){e(i).find("LI A").bind(t.folderEvent,function(){return e(this).parent().hasClass("directory")?e(this).parent().hasClass("collapsed")?(t.multiFolder||(e(this).parent().parent().find("UL").slideUp({duration:t.collapseSpeed,easing:t.collapseEasing}),e(this).parent().parent().find("LI.directory").removeClass("expanded").addClass("collapsed")),e(this).parent().find("UL").remove(),n(e(this).parent(),escape(e(this).attr("rel").match(/.*\//))),e(this).parent().removeClass("collapsed").addClass("expanded")):(e(this).parent().find("UL").slideUp({duration:t.collapseSpeed,easing:t.collapseEasing}),e(this).parent().removeClass("expanded").addClass("collapsed")):a(e(this).attr("rel")),!1}),"click"!=t.folderEvent.toLowerCase&&e(i).find("LI A").bind("click",function(){this_dir_selected=a(e(this).attr("rel"))})}e(this).html('<ul class="jqueryFileTree start"><li class="wait">'+t.loadMessage+"<li></ul>"),n(e(this),escape(t.root))})}}),e.extend(e.fn,{leftFileTree:function(t,a){if(!t)t={};void 0==t.root&&(t.root="/"),void 0==t.script&&(t.script="folderMenu.php"),void 0==t.folderEvent&&(t.folderEvent="click"),void 0==t.expandSpeed&&(t.expandSpeed=500),void 0==t.collapseSpeed&&(t.collapseSpeed=500),void 0==t.expandEasing&&(t.expandEasing=null),void 0==t.collapseEasing&&(t.collapseEasing=null),void 0==t.multiFolder&&(t.multiFolder=!0),void 0==t.loadMessage&&(t.loadMessage="Loading..."),e(this).each(function(){1==first_flag&&(e(this).html('<ul class="jqueryFileTree start"><li class="wait">'+t.loadMessage+"<li></ul>"),a=e(this),n=escape(t.root),e(a).addClass("wait"),e(".jqueryFileTree.start").remove(),e.post(t.script,{dir:n,sign:here},function(i){e(a).find(".start").html(""),e(a).removeClass("wait").append(i),t.root==n?e(a).find("UL:hidden").show():e(a).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing})}));var a,n})}})}(jQuery);var open_folders=new Array,repeat_flag=!0,lick=!0,open_all=!0;function fileTreeToggle(e,t){if(lick){if(!a)var a={};void 0==a.root&&(a.root="/"),void 0==a.script&&(a.script=e+"folderMenu.php"),void 0==a.folderEvent&&(a.folderEvent="click"),void 0==a.expandSpeed&&(a.expandSpeed=100),void 0==a.collapseSpeed&&(a.collapseSpeed=100),void 0==a.expandEasing&&(a.expandEasing=null),void 0==a.collapseEasing&&(a.collapseEasing=null),void 0==a.multiFolder&&(a.multiFolder=!0),void 0==a.loadMessage&&(a.loadMessage="Loading..."),liClick($("#left_folder_menu_box"),a,t)}}function liClick(e,t,a){$(e).attr("id");if(repeat_flag){repeat_flag=!1;var n=a.id;if("FILEMANAGER_NO_COLLAPSE"!=a.id){var i=document.getElementById(n).getAttribute("rel");document.getElementById(n).getAttribute("data-children");$(e).addClass("wait"),$(".jqueryFileTree.start").remove(),in_array(open_folders,a.id)?($("#"+n+" ul").remove(),removeItem(open_folders,a.id),$("#"+n).removeClass("expanded"),first_flag=$("#show_left_sidebar").html(),setTimeout(function(){repeat_flag=!0},500)):$.post(t.script,{dir:i,sign:here},function(o){$(e).find(".start").html(""),$(e).removeClass("wait").append(o),t.root==i?$(e).find("UL:hidden").show():($("#"+n+" ul").remove(),$(e).find("UL:hidden").appendTo("#"+n),$(e).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing}),open_folders.push(a.id),$("#"+n).addClass("expanded"),first_flag=$("#show_left_sidebar").html(),repeat_flag=!0),liBindTree(a,t)})}}}function liBindTree(e,t){$(e).bind(t.folderEvent,function(){first_flag=$("#show_left_sidebar").html()})}function liAutoOpen(e,t,a){$(e).attr("id");repeat_flag=!1;var n=a.id;if("FILEMANAGER_NO_COLLAPSE"!=a.id){var i=document.getElementById(n).getAttribute("rel");document.getElementById(n).getAttribute("data-children");$(e).addClass("wait"),$(".jqueryFileTree.start").remove(),in_array(open_folders,a.id)?($("#"+n+" ul").remove(),removeItem(open_folders,a.id),$("#"+n).removeClass("expanded"),first_flag=$("#show_left_sidebar").html(),setTimeout(function(){repeat_flag=!0},500)):$.post(t.script,{dir:i,sign:here},function(o){$(e).find(".start").html(""),$(e).removeClass("wait").append(o),t.root==i?$(e).find("UL:hidden").show():($("#"+n+" ul").remove(),$(e).find("UL:hidden").appendTo("#"+n),$(e).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing}),open_folders.push(a.id),$("#"+n).addClass("expanded"),first_flag=$("#show_left_sidebar").html(),repeat_flag=!0),liBindTree(a,t)})}}function open_all_dirs(e){var t=$(".left_open_all_dir");t.children().each(function(){if(""!=$(this).attr("data-class")&&$(this).addClass($(this).attr("data-class")),"yes"==$(this).attr("data-children")){if(!a)var a={};void 0==a.root&&(a.root="/"),void 0==a.script&&(a.script=e+"folderMenu.php"),void 0==a.folderEvent&&(a.folderEvent="click"),void 0==a.expandSpeed&&(a.expandSpeed=100),void 0==a.collapseSpeed&&(a.collapseSpeed=100),void 0==a.expandEasing&&(a.expandEasing=null),void 0==a.collapseEasing&&(a.collapseEasing=null),void 0==a.multiFolder&&(a.multiFolder=!0),void 0==a.loadMessage&&(a.loadMessage="Loading..."),liAutoOpen($("#left_folder_menu_box"),a,this),t.removeClass("left_open_all_dir"),setTimeout(function(){open_all_dirs(e)},1e3,e)}})}window.onload=setTimeout(function(){open_all_dirs(fileTreeUserFolder)},1e3,fileTreeUserFolder),$(document).bind("drop dragover",function(e){e.preventDefault()}),$(document).bind("dragover",function(e){var t=$("#dropzone"),a=window.dropZoneTimeout;a?clearTimeout(a):t.addClass("in");var n=!1,i=e.target;do{if(i===t[0]){n=!0;break}i=i.parentNode}while(null!=i);n?t.addClass("hover"):t.removeClass("hover"),window.dropZoneTimeout=setTimeout(function(){window.dropZoneTimeout=null,t.removeClass("in hover")},100)}),function(){var e={collapsed:!0,close_same_level:!0,duration:300,list_animation:!0,easing:"easeOutQuart",use_nodes:!1,skip_init:!1};function t(t,a){this.$el=$(t);var n=this;this.options=$.extend(e,a,this.$el.data("options")),$.fn.notNodeClick=function(){var e=$(this);e.closest("ul.mtree").find(".mtree-active").removeClass("mtree-active"),e.addClass("mtree-active")},$.fn.nodeClick=function(){var e=$(this),t=e.hasClass("mtree-open");t||e.closest("ul.mtree").find(".mtree-active").removeClass("mtree-active"),e.toggleClass("mtree-active",!t),n.options.close_same_level&&!t&&e.closest("ul").children(".mtree-open").closeNodes(),e.toggleClass("mtree-open mtree-closed"),e.children("ul").first().toggleList(!t),!t&&n.options.list_animation&&e.find("> ul > li, li.mtree-open > ul > li").css({opacity:0}).velocity("stop").velocity("list")},$.fn.closeNodes=function(){var e=$(this);e.children("ul").toggleList(!1,n.options.duration/3),e.toggleClass("mtree-open mtree-closed")},$.fn.toggleList=function(e,t){var a=$(this);if(e){var i=a.css("height");a.css({height:"auto",display:"block"});var o=a.outerHeight();a.css({height:i})}a.velocity("stop").velocity({height:e?o:0},{duration:n.options.duration,delay:t||0,easing:n.options.easing,display:e?"block":"none",complete:function(){e&&a.css("height","auto")}})},$.Velocity.Sequences.list=function(e,t,a,i){$.Velocity.animate(e,{opacity:[1,0],translateY:[0,-(a+1)]},{delay:a*(n.options.duration/i/2),duration:n.options.duration,easing:n.options.easing})},this.init()}t.prototype.init=function(){var e=this.$el.find("li");this.$nodes=e.has("ul"),this.$notNodes=e.not(":has(ul)"),this.$sublists=this.$el.find("ul"),this.options.use_nodes&&this.$nodes.prepend("<span class=mtree-icon></span>"),this.$nodeButtons=this.$nodes.children(":first-child"),this.$notNodeButtons=this.$notNodes.children(":first-child"),this.options.skip_init||this.setClasses(),this.$nodeButtons.on("click.mtree-node",function(e){preventJSClick(e)||($(this).parent("li").first().nodeClick(),e.preventDefault())}),this.$notNodeButtons.on("click.mtree-notNode",function(e){preventJSClick(e)||$(this).parent("li").first().notNodeClick()})},t.prototype.setClasses=function(){this.$el.addClass("mtree"),this.$nodes.addClass("mtree-node mtree-"+(this.options.collapsed?"closed":"open")),this.$sublists.css({overflow:"hidden",height:this.options.collapsed?0:"auto",display:this.options.collapsed?"none":"block"}),this.$nodeButtons.css("cursor","pointer"),this.$sublists.each(function(e,t){var a=$(this);a.addClass("mtree-level-"+(a.parentsUntil($("ul.mtree"),"ul").length+1))})},$.fn.mtree=function(e){return this.each(function(){$.data(this,"plugin_mtree")||$.data(this,"plugin_mtree",new t(this,e))})}}();var stylerConfig={layouts:{"topbar-center":"topbar-center topbar-fixed-up","topbar-float":"topbar-float topbar-fixed-up",sidebar:"sidebar","sidebar-right":"sidebar-right",slidemenu:"slidemenu topbar-center"},skins:{DAYLIGHT:"header","daylight 78a642":"daylight 78a642","daylight darkorange":"daylight darkorange","daylight tomato":"daylight tomato","daylight ffc000":"daylight ffc000","daylight salmon":"daylight salmon","daylight burlywood":"daylight burlywood","daylight yellowgreen":"daylight yellowgreen","daylight darkseagreen":"daylight darkseagreen","daylight skyblue":"daylight skyblue","daylight deeppink":"daylight deeppink","daylight palevioletred":"daylight palevioletred",TWILIGHT:"header","twilight brown":"twilight brown","twilight goldenrod":"twilight goldenrod","twilight peru":"twilight peru","twilight crimson":"twilight crimson","twilight mediumvioletred":"twilight mediumvioletred","twilight deeppink":"twilight deeppink","twilight steelblue":"twilight steelblue","twilight darkcyan":"twilight darkcyan","twilight seagreen":"twilight seagreen","twilight 78a642":"twilight 78a642",WHITE:"header","white coral":"white coral","white hotpink":"white hotpink","white lightskyblue":"white lightskyblue","white mediumaquamarine":"white mediumaquamarine","white yellowgreen":"white yellowgreen",BLACK:"header","black crimson":"black crimson","black mediumvioletred":"black mediumvioletred","black orange":"black orange","black olivedrab":"black olivedrab","black steelblue":"black steelblue",MELLOW:"header","mellow indianred":"mellow indianred","mellow darksalmon":"mellow darksalmon","mellow tan":"mellow tan","mellow darkseagreen":"mellow darkseagreen","mellow palevioletred":"mellow palevioletred",ORGANIC:"header","organic 78a642":"organic 78a642","organic indianred":"organic indianred","organic crimson":"organic crimson","organic hotpink":"organic hotpink","organic burlywood":"organic burlywood",SCIENCE:"header","science palevioletred":"science palevioletred","science indianred":"science indianred","science salmon":"science salmon","science burlywood":"science burlywood","science darkseagreen":"science darkseagreen"},fonts:{"EDITORS FAVORITES":"header","Lato Skinny":"Lato:300,300i,400,400i|paragraph:300|body:300|subheader:italic|topbar:uppercase|sidebar:uppercase,small|footer:italic|styled:italic",Lato:"Lato:400,400italic,700,700italic|subheader:italic|topbar:uppercase,large|sidebar:uppercase,small|footer:italic|styled:italic","Lato Fat":"Lato:400,700,900,400italic,700italic,900italic|logo:italic,900|header:italic,bold|subheader:italic|topbar:bold,uppercase|sidebar:bold,uppercase,small|footer:italic|styled:italic","Raleway - Amaranth":"Raleway:400,600|Amaranth","Open Sans - Fauna One":"Open+Sans:300,300italic,600,600italic|Fauna One|subheader:small|topbar:Fauna One,uppercase,small|sidebar:Fauna One,uppercase,xsmall","Ubuntu - Raleway":"Ubuntu:300,300italic,600,600italic|Raleway:300|topbar:uppercase,small","Merriweather - Alegreya Sans":"Merriweather:300,300italic,700,700italic|Alegreya+Sans:400,700|logo:700|header:700|menu:Alegreya Sans|topbar:uppercase|sidebar:uppercase|subheader:small","Ubuntu - Roboto Slab":"Ubuntu:300,300italic|Roboto+Slab:400|logo:small","Merriweather - Raleway":"Merriweather:300,300italic,700|Raleway:300|menu:Raleway|subheader:Raleway",custom0:"-","Raleway - Lobster":"Raleway:300,600,300italic|Lobster+Two:400|styled:italic|footer:italic","Merriweather - Berkshire Swash":"Merriweather:300,700,300italic|Berkshire+Swash|subheader:small","Open Sans - Paytone One":"Open+Sans:300italic,400,600|Paytone+One|subheader:small","Lato - Bubblegum Sans":"Lato:400,700,400italic|Bubblegum+Sans|subheader:small","Roboto - Shadows Into Light":"Roboto:300,300italic,700|Shadows Into Light Two|topbar:Shadows Into Light Two|sidebar:Shadows Into Light Two","Gudea - Rancho":"Gudea:400,700,400italic|Rancho|logo:large|topbar:Rancho,uppercase|sidebar:Rancho,uppercase,small|subheader:small",custom1:"-","Roboto [+Slab]":"Roboto:300italic,300|Roboto Slab:300,400|topbar:Roboto Slab|sidebar:Roboto Slab","PT Sans [+Narrow]":"PT Sans:400,700,400italic|PT Sans Narrow:400,700|logo:700|header:700|subheader:PT Sans Narrow|menu:PT Sans Narrow|topbar:uppercase|sidebar:uppercase","Roboto [+Condensed]":"Roboto:300,300italic,700|Roboto+Condensed:300|menu:Roboto+Condensed|sidebar:uppercase,small|topbar:small,uppercase|subheader:small|styled:Roboto+Condensed|footer:Roboto+Condensed","Alegreya Sans [+SC]":"Alegreya Sans:300,300italic,700|Alegreya Sans SC:400,400italic|styled:italic|footer:italic|topbar:Alegreya Sans SC|sidebar:Alegreya Sans SC","Alegreya [+SC]":"Alegreya:400,400italic,700|Alegreya SC:400|topbar:Alegreya SC|sidebar:Alegreya SC",Raleway:"Raleway:300,300italic,400,600|paragraph:300|logo:400|header:400|sidebar:uppercase,small|topbar:400,uppercase,small",Neuton:"Neuton:300,400,700,300italic|header:400|logo:400|subheader:300|paragraph:300,xxlarge|topbar:uppercase|sidebar:uppercase,small",Dosis:"Dosis:400,500,600|logo:500|header:500","SUPER STYLISH":"header","Cabin [+Sketch]":"Cabin:400,400italic,700|Cabin Sketch:700|logo:700|header:700|styled:Cabin|footer:Cabin","Handlee - Roboto":"Roboto:300,700,300italic|Handlee","Roboto Slab - Megrim":"Roboto Slab:300,700|Megrim|header:uppercase|logo:uppercase|subheader:small|topbar:uppercase","Noto Sans - Pacifico":"Noto Sans:400,700,400italic|Pacifico|subheader:small","PT Sans - Indie Flower":"PT Sans:400,700,400italic|Indie Flower|subheader:small|topbar:uppercase,small|sidebar:uppercase,small","Open Sans - Dancing Script":"Open+Sans:300,600,300italic|Dancing+Script:400,700|header:bold|logo:bold,xlarge|topbar:large","Lato - Just Another Hand":"Lato:300,300italic|Just Another Hand|logo:xxlarge|styled:large|topbar:Just Another Hand,xxlarge|sidebar:Just Another Hand,xxlarge|subheader:small","Droid Sans - Oleo Script":"Droid+Sans:400,400italic,700|Oleo+Script:400,700|sidebar:Oleo+Script|topbar:Oleo+Script,large|subheader:small","Open Sans - Lobster Two":"Open+Sans:300,600,300italic|Lobster+Two:400,700","Lato - Great Vibes":"Lato:300,300italic|Great+Vibes|logo:xxlarge|subheader:300|paragraph:300|styled:xlarge","Lato - Oldenburg":"Lato:300,300italic|Oldenburg|topbar:Oldenburg|sidebar:Oldenburg|subheader:small","Open Sans - Playfair Display":"Open+Sans:300italic,300,600|Playfair+Display:400|subheader:small","Roboto Condensed - Amatic SC":"Roboto+Condensed:300,300italic,700|Amatic+SC:700|topbar:Amatic SC,large|sidebar:Amatic SC,large","Nobile - Corben":"Open+Sans:300,300italic,600|Corben:400,700|logo:700,xsmall|subheader:small","Inconsolata - Special Elite":"Inconsolata:400,700|Special%20Elite|logo:small|topbar:Special Elite|sidebar:Special Elite|subheader:small|styled:Inconsolata","BEAUTIFUL SIBLINGS":"header","Open Sans [+Condensed]":"Open+Sans:300italic,300,600|Open Sans Condensed:300,700|menu:Open Sans Condensed|header:700|logo:700|subheader:Open Sans Condensed|topbar:uppercase|sidebar:uppercase","[+Slab] Roboto":"Roboto Slab:300,700|Roboto:900|logo:bold|header:bold","Ubuntu [+Condensed]":"Ubuntu:300,300italic,700|Ubuntu Condensed","[+Sans] Merriweather":"Merriweather Sans:300,300italic,700|Merriweather:400italic,700|logo:700|header:700|styled:italic|footer:italic|subheader:italic","Josefin Slab [+Sans]":"Josefin Slab:400,400italic,700|Josefin Sans:400|menu:Josefin Sans","Varela [+Round]":"Varela|Varela+Round|topbar:Varela+Round|sidebar:Varela+Round","POWERFUL SINGLES":"header",Roboto:"Roboto:300italic,300","Roboto Slab":"Roboto+Slab:300,400,700|paragraph:300|subheader:300","Roboto Condensed":"Roboto+Condensed:300italic,700italic,300,400,700|logo:700|header:700|paragraph:300|subheader:300|sidebar:uppercase,300|menu:300|topbar:400,uppercase,small|sidebar:uppercase,small","Droid Serif":"Droid+Serif:400,700,400italic|header:bold|logo:bold,small|subheader:italic,small|styled:italic|footer:italic","Open Sans":"Open+Sans:300,300italic,600,600italic|topbar:uppercase,small|sidebar:uppercase,small",Montserrat:"Montserrat:400,700|topbar:uppercase,small|sidebar:uppercase,xsmall",Ubuntu:"Ubuntu:300,300italic,400,400italic|subheader:300|paragraph:300",Merriweather:"Merriweather:300,300italic,400,400italic|paragraph:300|header:400|logo:400|subheader:italic|styled:italic|footer:italic|menu:italic",Lora:"Lora:400,700,400italic,700italic|subheader:italic|styled:italic|footer:italic|menu:italic","PT Sans":"PT+Sans:400,700,400italic,700italic|logo:700|header:700|subheader:italic|topbar:uppercase|sidebar:uppercase","PT Sans Narrow":"PT Sans Narrow:400,700|logo:bold|header:bold|topbar:uppercase|sidebar:uppercase,small","Noto Sans":"Noto Sans:400,700,400italic|subheader:italic,small|styled:italic|footer:italic","Yanone Kaffeesatz":"Yanone Kaffeesatz:300,400|logo:400|header:400|subheader:300|paragraph:300|menu:300|topbar:uppercase","Source Sans Pro":"Source Sans Pro:300,300italic,600,600italic|subheader:small|paragraph:300|topbar:uppercase",Cabin:"Cabin:400,600,400italic|subheader:italic|styled:italic,normal|footer:italic","Josefin Sans":"Josefin Sans:400,400italic",Marvel:"Marvel:400,400italic,700|header:700|logo:700","Titillium Web":"Titillium Web:300,300italic,600,600italic","GOOD COMBINATIONS":"header","Raleway - Bitter":"Raleway:300,600,300italic,600italic|Bitter:400|sidebar:small","Dosis - Cinzel":"Dosis:300,600|Cinzel|sidebar:large|styled:Dosis","Oxygen - Volkhov":"Oxygen:300,700|Volkhov:400|paragraph:300|subheader:300|logo:small","Gentium Basic - Open+Sans":"Gentium Basic:400,700,400italic|body:small|Open+Sans:400,600,800|header:800,uppercase|logo:bold,uppercase,xsmall|menu:Open+Sans|sidebar:uppercase,xsmall|topbar:uppercase,small|subheader:large","Open Sans - Bree Serif":"Open+Sans:300italic,300,600|Bree+Serif","Source Sans Pro - Bitter":"Source Sans Pro:300,300italic,600|Bitter:400|topbar:uppercase|small","PT Sans - Arvo":"PT+Sans:400,700,400italic|Arvo:400,400italic,700|topbar:|sidebar:|subheader:Arvo,small|styled:PT+Sans","Josefin Sans - Montaga":"Josefin+Sans:400,700,400italic|Montaga","Roboto - Yanone Kaffeesatz":"Roboto:300,300italic,700|Yanone+Kaffeesatz:400,700|logo:bold|header:bold|subheader:small|topbar:Yanone+Kaffeesatz,uppercase|sidebar:Yanone+Kaffeesatz,uppercase","Sintony - Rufina":"Sintony:400,700|Rufina:400,700|subheader:small|logo:bold|header:bold|topbar:|sidebar:","Source Sans Pro - Oxygen":"Source Sans Pro:300,600,300italic|Oxygen:400|sidebar:Oxygen|topbar:Oxygen","Lato - Oswald":"Lato:300,700,400italic|Oswald:300|sidebar:Oswald|topbar:Oswald|subheader:300","Lora - Ubuntu":"Lora:400,700,400italic|Ubuntu:300|menu:300,Ubuntu|subheader:small","Noto Sans - Montserrat":"Noto+Sans:400,700,400italic|Montserrat|menu:Montserrat",none:"none"},classes:""};stylerConfig.favs={"&#9733; RECOMMENDED &#9733;":"mine",Akaishi:["topbar-center topbar-fixed-up","twilight brown",stylerConfig.fonts["[+Sans] Merriweather"],"clear"],Andes:["topbar-center topbar-fixed-up","white coral",stylerConfig.fonts["Open Sans - Fauna One"],"clear"],Apennines:["topbar-center topbar-fixed-up","white hotpink",stylerConfig.fonts.Raleway,"clear"],Appalachian:["topbar-center topbar-fixed-up","daylight yellowgreen",stylerConfig.fonts["Sintony - Rufina"],"clear"],Aravalli:["topbar-center topbar-fixed-up","black crimson",stylerConfig.fonts["Open Sans - Bree Serif"],"clear"],Atlantika:["topbar-center topbar-fixed-up","organic 78a642",stylerConfig.fonts["[+Slab] Roboto"],"filled"],Atlas:["topbar-center topbar-fixed-up","twilight brown",stylerConfig.fonts["Roboto Condensed - Amatic SC"],"clear"],Bakossi:["topbar-center topbar-fixed-up","science salmon",stylerConfig.fonts["Gudea - Rancho"],"filled"],Beaufort:["topbar-center topbar-fixed-up","twilight goldenrod",stylerConfig.fonts.Marvel,"filled"],Belasitsa:["topbar-center topbar-fixed-up","twilight brown",stylerConfig.fonts["PT Sans Narrow"],"clear"],Bergamo:["topbar-center topbar-fixed-up","organic indianred",stylerConfig.fonts["Raleway - Amaranth"],"clear"],Bitterroot:["topbar-center topbar-fixed-up","daylight yellowgreen",stylerConfig.fonts.Neuton,"clear"],Camelsfoot:["topbar-center topbar-fixed-up","daylight palevioletred",stylerConfig.fonts["Open Sans - Lobster Two"],"clear"],Cantabrian:["topbar-center topbar-fixed-up","twilight darkcyan",stylerConfig.fonts["Alegreya Sans [+SC]"],"filled"],Carpathian:["topbar-center topbar-fixed-up","organic 78a642",stylerConfig.fonts["Droid Sans - Oleo Script"],"filled"],Caucasus:["topbar-center topbar-fixed-up","twilight mediumvioletred",stylerConfig.fonts["Open Sans - Paytone One"],"filled"],Cederberg:["topbar-center topbar-fixed-up","twilight seagreen",stylerConfig.fonts["Raleway - Amaranth"],"filled"],Chittagong:["topbar-center topbar-fixed-up","twilight steelblue",stylerConfig.fonts["PT Sans - Arvo"],"filled"],Chuckwalla:["topbar-center topbar-fixed-up","white mediumaquamarine",stylerConfig.fonts["Noto Sans - Pacifico"],"clear"],Cordillera:["topbar-center topbar-fixed-up","mellow indianred",stylerConfig.fonts["Alegreya Sans [+SC]"],"clear"],Dachstein:["topbar-center topbar-fixed-up","daylight yellowgreen",stylerConfig.fonts["PT Sans - Indie Flower"],"clear"],Dolomites:["topbar-center topbar-fixed-up","daylight salmon",stylerConfig.fonts["Merriweather - Alegreya Sans"],"filled"],Drakensberg:["topbar-center topbar-fixed-up","daylight palevioletred",stylerConfig.fonts["Sintony - Rufina"],"clear"],Genevieve:["topbar-center topbar-fixed-up","twilight steelblue",stylerConfig.fonts["Open Sans - Fauna One"],"clear"],Granatspitze:["topbar-center topbar-fixed-up","twilight seagreen",stylerConfig.fonts["Ubuntu - Raleway"],"clear"],Grossglockner:["topbar-float topbar-fixed-up","daylight ffc000",stylerConfig.fonts["Source Sans Pro - Bitter"],"clear"],Himalayas:["topbar-float topbar-fixed-up","daylight darkorange",stylerConfig.fonts["Open Sans - Fauna One"],"clear"],"Hindu Kush":["topbar-float topbar-fixed-up","twilight brown",stylerConfig.fonts["Merriweather - Raleway"],"filled"],Jayawijaya:["topbar-float topbar-fixed-up","mellow darksalmon",stylerConfig.fonts["Sintony - Rufina"],"clear"],Jotunheimen:["topbar-float topbar-fixed-up","twilight 78a642",stylerConfig.fonts.Dosis,"clear"],Karakoram:["topbar-float topbar-fixed-up","science darkseagreen",stylerConfig.fonts["Lato - Bubblegum Sans"],"filled"],Karwendel:["topbar-float topbar-fixed-up","organic hotpink",stylerConfig.fonts["Dosis - Cinzel"],"filled"],Khibinsky:["topbar-float topbar-fixed-up","black olivedrab",stylerConfig.fonts["Roboto [+Slab]"],"clear"],Kilimanjaro:["sidebar","mellow indianred",stylerConfig.fonts["Josefin Sans"],"clear"],Livigno:["sidebar","twilight brown",stylerConfig.fonts["Inconsolata - Special Elite"],"filled"],Lebombo:["sidebar","black olivedrab",stylerConfig.fonts["Merriweather - Alegreya Sans"],"filled"],Mandara:["sidebar","mellow palevioletred",stylerConfig.fonts["Open Sans - Paytone One"],"filled"],Mantiqueira:["sidebar","daylight yellowgreen",stylerConfig.fonts["Titillium Web"],"filled"],Pyrenees:["sidebar","black crimson",stylerConfig.fonts["Source Sans Pro - Bitter"],"clear"],"Saint Elias":["sidebar","daylight darkseagreen",stylerConfig.fonts["Merriweather - Berkshire Swash"],"clear"],"Santa Catalina":["sidebar","white hotpink",stylerConfig.fonts["PT Sans - Indie Flower"],"filled"],"Sierra Nevada":["sidebar","twilight steelblue",stylerConfig.fonts["Lato - Oswald"],"filled"],Snowdonia:["sidebar","daylight darkseagreen",stylerConfig.fonts["Roboto Slab - Megrim"],"clear"],Stanovoi:["sidebar","daylight salmon",stylerConfig.fonts.Ubuntu,"filled"],Swartberg:["sidebar","daylight darkseagreen",stylerConfig.fonts["[+Slab] Roboto"],"filled"],"Tian Shan":["sidebar","science darkseagreen",stylerConfig.fonts["Josefin Sans"],"filled"],Transantarctic:["sidebar","twilight peru",stylerConfig.fonts["Roboto Slab"],"clear"],Trollheimen:["sidebar","twilight brown",stylerConfig.fonts["Roboto - Shadows Into Light"],"filled"],Vanoise:["sidebar","daylight skyblue",stylerConfig.fonts["Roboto Slab - Megrim"],"filled"],Zagros:["sidebar","organic burlywood",stylerConfig.fonts["Ubuntu - Roboto Slab"],"filled"]},function(){x3_body.on("click","[data-popup-window]",function(e){if(!preventJSClick(e)){e.preventDefault(),e.stopImmediatePropagation();var t=$(this),a=t.data("href")||t.attr("href"),n=t.data("popup-window").split(","),i=n[0]||"mywindow";width=Math.min(screen.width,parseInt(n[1])||600),height=Math.min(screen.height,parseInt(n[2])||500),function(e,t,a,n){var i=Math.round(screen.width/2-a/2),o=Math.round(screen.height/2-n/2),l=window.open(e,t,"toolbar=no, location=yes, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no, width="+a+", height="+n+", top="+o+", left="+i);window.focus&&l.focus()}(a,i,width,height)}})}();var editor_templates={"Markdown Sample":"## Intro\nWe recommend using [markdown](https://help.github.com/articles/markdown-basics/) for basic content editing, because it is easy to read, faster to write and prevents html-coding mistakes which make break the page. You can use the markdown-syntax in the examples below, the toolbar or keyboard-shortcuts like `cmd-b` and `ctrl-b`.\n\nNew paragraphs should be separated by two blank lines. Styles *italic*, **bold** and ~~strikethrough~~ are easily added. Add links like [flamepix](https://flamepix.com) by using syntax `[text](url)`. Add a horizontal rule by including three hyphens:\n\n---\n\n## Links\nEasily add links into your content by adding `[link text]` in brackets, immediately followed by the `(url)` in parenthesis. Optionally, you can surround a link address in angle-brackets `<https://flamepix.com>`, and it will automtically be formatted as a link. Examples:\n\n* <http://imagevuex.com>\n* [mjau-mjau](https://mjau-mjau.com)\n* [relative link ../](../)\n\n## Lists\nUnordered lists can be started using the toolbar, or by typing `*`, `-` or `+`. Ordered lists can be started by typing `1.`.\n\n* Lists are piece of cake ...\n* They will auto-continue as you type ...\n* Double-enter will end a list\n\t* Tabs and shift-tabs works also ...\n\t* ... for nested lists\n\n## Image\nEmbed images by adding the image `[title]` in brackets, immediately followed by the image `(img url)` in parenthesis. **Tip!** Use `{{path}}` to refer the path of the current page, for example `![title]({{path}}/file.jpg)`.\n\n![Agent Smith](http://imagevuex.com/agent-smith.jpg)\n\n## Blockquote\nAdd blockquotes by preceding text on a new line with the `>` tag.\n\n> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi eget sem et dui pulvinar aliquam. Etiam sit amet nulla erat. Mauris aliquam euismod tellus, ac varius velit tincidunt ut.","Font Awesome Icons":'\x3c!-- Find your icon name here http://fontawesome.io/icons/ --\x3e\nHere is a camera <i class="fa fa-camera"></i> icon.\n<i class="fa fa-heart fa-2x" style="color:tomato;"></i>\n<i class="fa fa-trophy fa-5x"  style="color:gold;"></i>',"Comparison-slider plugin":'\x3c!-- Comparison slider demo and documentation: https://demo.imagevuex.com/examples/features/comparison-slider/ --\x3e\n<div class="comparison-slider x3-style-frame" data-orientation="horizontal" data-offset="0.5" data-hover="true">\n<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f648.svg">\n<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f435.svg">\n</div>',"Simple Contact Form":'<form data-abide class=contactform>\n\t<div>\n\t\t<input required type=text name="name" placeholder="Name">\n\t</div>\n\t<div>\n\t\t<input required type="email" name="email" placeholder="Email">\n\t</div>\n\t<div>\n\t\t<textarea required rows=6 name="message" placeholder="Message"></textarea>\n\t</div>\n\t<button type=submit>Send</button>\n</form>',"Columns 6/6":'<div class="row">\n  <div class="medium-6 columns">\n\t\t<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f98e.svg" alt="lizard">\n  </div>\n  <div class="medium-6 columns">\n  \t<p>Both left and right columns are set to 6/12 width. This creates a two columns equal-width columns, which collapse into a single column on small screens. Read more about the grid <a href=http://foundation.zurb.com/docs/components/grid.html>here</a>.</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus fringilla, risus ac lacinia consequat, ipsum augue posuere quam, eget commodo lorem augue vel dui. Sed elementum quis risus a volutpat. Vivamus fringilla, risus ac lacinia consequat, ipsum augue posuere quam, eget commodo lorem augue vel dui. Sed elementum quis risus a volutpat.</p>\n  </div>\n</div>',"Columns 4/8":'<div class="row">\n  <div class="medium-4 columns">\n\t\t<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f40a.svg" alt="crocodile">\n  </div>\n  <div class="medium-8 columns">\n  \t<p>Left column is set to use 4/12 columns width, while right column is set to take 8/12 columns width. This creates a two columns layout, which collapse into a single column on small screens. Read more about the grid <a href=http://foundation.zurb.com/docs/components/grid.html>here</a>.</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus fringilla, risus ac lacinia consequat, ipsum augue posuere quam, eget commodo lorem augue vel dui. Sed elementum quis risus a volutpat.</p>\n  </div>\n</div>',"Block-Grid 3,2,1":'\x3c!-- Evenly adjust content within a block-grid --\x3e\n\x3c!-- Read more: http://foundation.zurb.com/sites/docs/v/5.5.3/components/block_grid.html --\x3e\n<ul class=\'small-block-grid-1 medium-block-grid-2 large-block-grid-3\'>\n<li><div data-alert class="alert-box bg2"><strong>Block Grid</strong><br>Block grids give you a way to evenly separate contents of a list within a grid. If you want to create a row with a specific amount of elements that need to stay evenly spaced, the block grid is your friend.</div></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f693.svg"></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f691.svg"></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f692.svg"></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f699.svg"></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f695.svg"></li>\n</ul>',"About Me Example":'---\n\n<div class="row text-left">\n  <div class="medium-6 columns">\n    <div class="frame">\n      <figure>\x3c!-- Add your own image in below src --\x3e\n        <img alt="profile" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f3c2.svg">\n      </figure>\n    </div>\n  </div>\n\n  <div class="medium-6 columns">\n  <p><strong>Howdy!</strong><br>\n  My name is Bob Dobalina, and this website is my blog as well as a playground\n  for the Imagevue X3 gallery website system. <a href="https://demo.imagevuex.com" target="_blank">View Demo</a></p>\n\n  <p><strong>About me</strong><br>\n  I am interested in design, functionality, minimalism and performance. My hobbies are: sleeping, snoozing and watching TV.</p>\n\n  <p><strong>Article</strong><br>\n  More than a decade ago, when SWF was an emerging technology, this website became a very popular showcase of Flash. <a href="https://mjau-mjau.com/blog/rewind-web-2002/">See Post</a></p>\n  </div>\n</div>',"Embed Youtube":"<div class='flex-video widescreen x3-style-frame'>\n\t<iframe src='//www.youtube.com/embed/A3PDXmYoF5U' frameborder='0' allowfullscreen></iframe>\n</div>","Embed Vimeo":"<div class='flex-video widescreen vimeo x3-style-frame'>\n<iframe src='//player.vimeo.com/video/84067859' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>\n</div>","Embed Google Maps":"<div class='flex-video x3-style-frame' style='height:auto;'>\n<iframe src='https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d424396.3176723366!2d150.92243255000002!3d-33.7969235!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6b129838f39a743f%3A0x3017d681632a850!2sSydney+NSW%2C+Australia!5e0!3m2!1sen!2sth!4v1415268600966' frameborder='0' style='border:0'></iframe>\n</div>","Embed MP4 Video":'\x3c!-- Upload an MP4 video file to your page, and use the code below to embed the video into your content. The {{path}} variable will dynamically convert to the folder path --\x3e\n<video width="100%" preload="metadata" controls>\n<source src="{{path}}videofilename.mp4" type="video/mp4">\n</video>',"Popup Links":'\x3c!-- Basic image popup. You can replace the href tag with "{{path}}/filename.jpg" to load an image within the same folder. Demo and documentation: https://demo.imagevuex.com/examples/samples/popup/ --\x3e\n<a href="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f405.svg" data-popup>Tiger</a>\n\n\x3c!-- Open Youtube video in popup --\x3e\n<a href="https://www.youtube.com/embed/G46ygBKsTZI" data-popup>Youtube Video</a>\n\n\x3c!-- Open a website in browser popup-window. You can set window name, width and height  --\x3e\n<a href="https://flamepix.com" data-popup-window="name,800,600">flamepix.com</a>',"Carousel Plugin":'\x3c!-- content carousel. More info: https://demo.imagevuex.com/examples/plugins/carousel/ --\x3e\n<div data-carousel data-carousel-items=3 data-carousel-loop=true data-carousel-dots=true data-carousel-autoplay=3000 data-carousel-responsive=true data-carousel-shuffle=false>\n<div><h3>Camel</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f42b.svg" /></div>\n<div><h3>Fish</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f41f.svg" /></div>\n<div><h3>Squirrel</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f43f.svg" /></div>\n<div><h3>Goat</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f410.svg" /></div>\n<div><h3>Elephant</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f418.svg" /></div>\n<div><h3>Ox</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f402.svg" /></div>\n<div><h3>Whale</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f433.svg" /></div>\n<div><h3>Blowfish</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f421.svg" /></div>\n<div><h3>Turtle</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f422.svg" /></div>\n</div>',"Modal Plugin":'\x3c!-- Add the modal element anywhere in your content. It will be hidden until triggered. --\x3e\n<div id="modal_id1" class="reveal-modal" data-reveal aria-hidden="true" role="dialog">\n<a class="close-reveal-modal" aria-label="Close"><i class="fa fa-close"></i></a>\n<h2>Modal Title</h2>\n<p>Modal content/html here.</p>\n</div>\n\n\x3c!-- Include a link anywhere in your content to trigger a modal with a specific ID on click. Make sure the id of the modal element matches the data-reveal-id in the link! --\x3e\n<a href="#" data-reveal-id="modal_id1">Open Modal link</a>',"Tabs Plugin":'\x3c!-- Wrap all code inside a <section> with tabs-container class --\x3e\n\x3c!-- Optional style classes that can be included: tabs-style-1 OR tabs-style-2 --\x3e\n<section class="tabs-container tabs-radius tabs-anim tabs-color-active">\n\n\x3c!-- Create a ul list that contains the tab links --\x3e\n\x3c!-- include the vertical class if you want to use vertical orientation --\x3e\n<ul class="tabs" data-tab>\n<li class="tab-title active"><a href="#panel1">Tab 1</a></li>\n<li class="tab-title"><a href="#panel2">Tab 2</a></li>\n<li class="tab-title"><a href="#panel3">Tab 3</a></li>\n<li class="tab-title"><a href="#panel4">Tab 4</a></li>\n</ul>\n\n\x3c!-- Create a tabs content element that contains all tab contents  --\x3e\n\x3c!-- include the vertical class if you want to use vertical orientation --\x3e\n<div class="tabs-content">\n<div class="content active" id="panel1">\n<p>This is the first panel of the basic tab example.</p>\n</div>\n<div class="content" id="panel2">\n<p>This is the second panel of the basic tab example.</p>\n</div>\n<div class="content" id="panel3">\n<p>This is the third panel of the basic tab example.</p>\n</div>\n<div class="content" id="panel4">\n<p>This is the fourth panel of the basic tab example.</p>\n</div>\n</div>\n\n\x3c!-- Make sure #links in the <a> anchor tags correspond with id\'s in the tabs-content! --\x3e\n</section>',"Alert Box":'\x3c!-- You can use any of the following color-tags: success alert bg2 bg3 primary warning info --\x3e\n<div data-alert class="alert-box success">\n\n\x3c!-- close button below is optional --\x3e\n<a href="#" class="close close-x"></a>\n\nAdd your content/html here.\n</div>',"Toggle Content":'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus tristique quis justo luctus pulvinar. Nulla venenatis lacus eget sapien pretium dignissim. <span class="toggle-content">Duis feugiat magna vitae fermentum euismod. Sed venenatis finibus lorem. Phasellus vel ante nibh. Praesent nec metus condimentum, vulputate ex vel, molestie sem. Praesent molestie tortor in mi tristique, at commodo lorem volutpat. Integer elementum facilisis erat, in pellentesque turpis venenatis ac.</span><br><a href="#" class="toggle-button" data-close-text="less">more</a>\n\n<a href="#" class="toggle-button">What is a tomato?</a>\n<div class="toggle-content">The <strong style="color: tomato;">tomato</strong> is the edible, red fruit of Solanum lycopersicum, commonly known as a tomato plant, which belongs to the nightshade family, Solanaceae. The species originated in Central and South America. The Nahuatl (Aztec language) word tomatl gave rise to the Spanish word "tomate", from which the English word tomato originates.</div>',"Custom Form Example":'\x3c!-- More info on HTML forms: http://foundation.zurb.com/sites/docs/v/5.5.3/components/forms.html --\x3e\n\x3c!-- Always start your <form> with DATA-ABIDE attribute and "contactform" class --\x3e\n<form data-abide class="contactform text-left">\n\n\x3c!-- All form elements must contain NAME attributes--\x3e\n<div>\n<input type="text" name="name" placeholder="Name" required>\n</div>\n\n\x3c!-- Notice the REQUIRED attribute, which makes the input required --\x3e\n<div>\n<input type=\'email\' name=\'email\' placeholder=\'Email\' required>\n</div>\n\n<div>\n<input type="tel" name="Phone Number" placeholder="Phone number">\n</div>\n\n\x3c!--  Select lists --\x3e\n<div>\n<strong>Ice Cream Flavor</strong>\n<select name="Ice Cream Flavour">\n<option value="Vanilla flavor">Vanilla</option>\n<option value="Chocolate flavor">Chocolate</option>\n<option value="Strawberry flavor">Strawberry</option>\n<option value="Pistachio flavor">Pistachio</option>\n</select>\n</div>\n\n\x3c!--  With radio groups NAME should be the same across all radios in the group. --\x3e\n\x3c!--  Include CHECKED attribute to set default checked value --\x3e\n<div>\n<strong>Favorite color</strong><br>\n<input type="radio" name="Favorite Color" value="Red" id="radio1" checked><label for="radio1">Red</label>\n<input type="radio" name="Favorite Color" value="Blue" id="radio2"><label for="radio2">Blue</label>\n<input type="radio" name="Favorite Color" value="Green" id="radio3"><label for="radio3">Green</label>\n</div>\n\n\x3c!--  With checkboxes, set different NAME attributes. --\x3e\n\x3c!--  Include CHECKED attribute to set default checked values --\x3e\n<div>\n<strong>I like to</strong><br>\n<input type="checkbox" name="sleep" value="Yes!" id="check1" checked><label for="check1">Sleep</label>\n<input type="checkbox" name="snooze" value="As long as possble" id="check2"><label for="check2">Snooze</label>\n<input type="checkbox" name="doze" value="All the time" id="check3"><label for="check3">Doze</label>\n</div>\n\n\x3c!--  textarea input --\x3e\n<div>\n<strong>Message</strong>\n<textarea required rows="6" name="message" placeholder="Add your message"></textarea>\n</div>\n\n\x3c!--  SEND button --\x3e\n<button type=submit>Send</button>\n\n\x3c!-- End form --\x3e\n</form>'};!function(e){var t={allowFloat:!1,allowNegative:!1};e.fn.numericInput=function(n){var i=e.extend({},t,n),o=i.allowFloat,l=i.allowNegative;return this.keypress(function(t){var n=t.which,i=e(this).val();if(n>0&&(n<48||n>57))if(1==o&&46==n){if(1==l&&0==a(this)&&"-"==i.charAt(0))return!1;if(i.match(/[.]/))return!1}else{if(1!=l||45!=n)return 8==n;if("-"==i.charAt(0))return!1;if(0!=a(this))return!1}else if(n>0&&n>=48&&n<=57&&1==l&&"-"==i.charAt(0)&&0==a(this))return!1}),this};function a(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var a=e.createTextRange(),n=a.duplicate();return a.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",a),n.text.length}return 0}}(jQuery);function cf_getDomainID(){$.post("cloudflare.php",{action:"zones"},function(e){e.success&&e.result.length>0?(cf_domain_id=e.result[0].id,localStorage.setItem("cf_domain_id",cf_domain_id),cf_addButton()):cloudflare=!1},"json")}function cf_getUrl(){var e=location.pathname.split("/");return e[e.length-1].length<1&&e.pop(),e.pop(),location.protocol+"//"+location.host+e.join("/")+"/"}function cf_getRelPath(e){var t=e.replace("../../content/","").replace("../content/","").split("/");return $.each(t,function(e,a){a.indexOf(".")>-1&&$.isNumeric(a.split(".")[0])&&(t[e]=a.split(".")[1])}),t=t.join("/").replace(/\/?$/,"/").replace("index/","")}function cf_getAllFiles(){var e=cf_getUrl(),t=[];return $.each(json_menu,function(a,n){0!==n.link.indexOf("custom/")&&t.push(e+n.link)}),t.push(e),t.push(e+"custom/404/"),t.push(e+"sitemap"),t.push(e+"sitemap.xml"),t.push(e+"feed/"),t.push(e+"feed.xml"),t}function cf_getCurrentFile(){var e=cf_getUrl(),t=cf_getRelPath(localStorage.getItem("current_page")),a=[];return a.push("/"==t?e:e+t),a}function cf_purgeFiles(e){var t=e?cf_getAllFiles():cf_getCurrentFile();show_preloader(),x3_panel_container.addClass("cf-busy"),$.post("cloudflare.php",{action:"purge_files",zone_identifier:cf_domain_id,files:t},function(e){e.success?show_errors_on_nav(language.Cloudflare_Flush_Success,"green"):show_errors_on_nav(language.Cloudflare_Flush_Fail,"red"),x3_panel_container.removeClass("cf-busy")},"json")}function cf_addButton(){x3_navbar_nav.append('<li class="dropdown cloudflare-dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><span class="glyphicon glyphicon-cloud"></span></a><ul class="dropdown-menu pull-right dropdown-menu-right" role="menu"><li role="presentation" class="dropdown-header">CLOUDFLARE</li><li id=cf_flush_current><a href="#"><span class="glyphicon glyphicon-trash"></span>&nbsp; '+language.Cloudflare_Flush_Current_Page+'</a></li><li id=cf_flush_all><a href="#"><span class="glyphicon glyphicon-trash"></span>&nbsp; '+language.Cloudflare_Flush_All_Pages+"</a></li></ul></li>");var e=x3_navbar_nav.children(".cloudflare-dropdown"),t=e.children(".dropdown-menu");e.hoverIntent({over:function(a){t.velocity({opacity:1},{duration:200,display:"block"}),e.addClass("open")},out:function(){t.velocity("stop").css({opacity:0,display:"none"}),e.removeClass("open")},timeout:300}),e.on("click","#cf_flush_current",function(e){e.preventDefault(),cf_purgeFiles(!1)}),e.on("click","#cf_flush_all",function(e){e.preventDefault(),cf_purgeFiles(!0)})}var cf_domain_id,cf_checked=!1;function cf_load(){cloudflare&&!cf_checked&&supports_local_storage()&&(cf_checked=!0,null!==localStorage.getItem("cf_domain_id")?(cf_domain_id=localStorage.getItem("cf_domain_id"),cf_addButton()):setTimeout(function(){cf_getDomainID()},1e3))}x3_body.on("keypress.nospace, keyup.nospace",'input.file-link, [name="gallery.image.link"]',function(e){if(32==e.which)return!1;var t=$(this);t.parent().toggleClass("has-link",t.val().length>0)}).on("mouseenter",".file-data > a",function(e){var t=$(this),a=x3_content_show.find("a.view-page").attr("href"),n=t.closest("tr").data("name"),i=n.substr(0,n.lastIndexOf(".")),o=t.parent().children("input.file-link").val().replace("{file_name}",i).replace("{file_name_ext}",n),l=0===o.toLowerCase().indexOf("http")?o:0===o.indexOf("/")?".."+o:a+o;t.attr("href",l),"popup"===t.parent().find("label.active").data("name")?t.attr("data-popup-window",""):t.removeAttr("data-popup-window")}).on("focus","input.file-link",function(e){$(this).parent().addClass("has-focus")}).on("blur","input.file-link",function(e){$(this).parent().removeClass("has-focus")}).on("mouseenter",".file-data > input, .file-data > textarea",function(e){$(this).prev().addClass("has-hover")}).on("mouseleave",".file-data > input, .file-data > textarea",function(e){$(this).prev().removeClass("has-hover")}).on("click","a.set-preview, span.set-preview",function(e){e.preventDefault();var t=$(this).closest("tr").data("name");save_inject({image:t},function(e){if(e){var a=x3_content_show.find('input.form-control.selectized[name="image"]');a.length&&a[0].selectize.addItem(t,!0)}},"Changed folder preview image.")}).on("click",".hide-file",function(e){e.preventDefault();var t=$(this).closest("tr"),a=t.data("name"),n=t.hasClass("is-folder"),i=!n&&$.inArray(t.data("ext"),["jpg","jpeg","pjpeg"])>-1,o=!t.hasClass("is-hidden"),l=a+" "+lang(o?"Hide":"Unhide"),s={};if(n){var r=t.data("path");s[r.split("./content/")[1]]={hidden:o},set_folders(s,function(){toggle_row(t,o),toggle_menu_item(null,o,r),x3Notifier(l,null,null,"success")})}else s[a]={hidden:o},i&&current_settings.back.use_iptc&&(s.iptc_inject={},s.iptc_inject[a]={hidden:o?"1":"",path:t.data("path").replace("../../","../"),date:t.data("date")}),save_inject(s,function(e){toggle_row(t,o)},l)}).on("click",".td-folder",function(e){$(this).next().children("a").click()}).on("click",'input[name="settings.menu_manual"]',function(e){x3_navbar_nav.children("li#refresh").toggleClass("hidden",!$(this).is(":checked"))}).on("click",".previews-log td.dir > a",function(e){e.preventDefault(),showFileManager($(this).attr("href"))});function toggle_row(e,t,a){e||(e=rows_folders.filter('[data-path="'+a+'"]'));var n=lang(t?"Unhide":"Hide");e.toggleClass("is-hidden",t),e.find("span.hide-file").toggleClass("fa-eye",!t).toggleClass("fa-eye-slash",t).attr("title",n),e.find("a.hide-file").text(n)}function toggle_menu_item(e,t,a){e||(e=x3_panel_container.find("#left_folder_menu_box").find('a[data-href="'+a+'"]').parent()),e.length&&e.toggleClass("is-hidden",t)}function collectFiledata(e){var t={};return e.each(function(e,a){var n=$(this),i=n.find(".file-data"),o=n.data("name"),l=i.children(".file-title").val();description=i.children("textarea").val(),link=i.children(".file-link").val(),target=i.find("label.active").data("name"),custom_index=n.attr("data-custom"),hidden=n.hasClass("is-hidden");var s={};l&&(s.title=l),description&&(s.description=description),link&&(s.link=link,"auto"!==target&&(s.target=target)),custom_index&&(s.index=parseInt(custom_index)),hidden&&(s.hidden=!0),Object.keys(s).length&&(t[o]=s)}),!!Object.keys(t).length&&t}function set_folders(e,t){preloader.modal("show");var a={folders:JSON.stringify(e)};$.post("x3_settings.php",a).done(function(a){if(a.success)t&&t(),$.extend(!0,folders,e),Object.keys(e).forEach(function(e){folders.hasOwnProperty(e)&&folders[e].hasOwnProperty("index")&&!folders[e].index&&delete folders[e].index}),console.dir(folders);else{x3Notifier(a.error?a.error:"Error in x3_settings.php",null,null,"danger")}}).fail(function(e){x3Notifier("Failed to POST to x3_settings.php"+(e.statusText?": "+e.statusText:"."),null,null,"danger")}).always(function(){preloader.modal("hide")})}function update_folders_key_array(e,t,a,n){if(e&&t&&a){if(-1==a.indexOf("./content")&&0===a.indexOf(".")){var i=a.split("..");a=i[i.length-1]?"../content"+i[i.length-1]:"../content"}Array.isArray(e)||(e=[e]);var o=[],l=[];(e=remove_jpg(e)).length&&(e.forEach(function(e){o.push(t+"/"+e),l.push(a+"/"+e)}),update_folders_key(o,l,n))}}function update_folders_key(e,t,a){if(Object.keys(folders).length&&e&&t&&(Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]),e.length&&t.length))for(var n=0;n<e.length;n++){var i=get_content_path(e[n]),o=get_content_path(t[n]);i&&o&&Object.keys(folders).forEach(function(e){0===e.indexOf(i)&&(folders[e.replace(i,o)]=folders[e],a||delete folders[e])})}}function remove_folders_key(e,t){if(e&&Object.keys(folders).length)if(Array.isArray(e)&&t){if(!e.length)return;if(!(e=remove_jpg(e)).length)return;for(var a=0;a<e.length;a++){(n=get_content_path(t+"/"+e[a]))&&Object.keys(folders).forEach(function(e){0===e.indexOf(n)&&delete folders[e]})}}else{var n;(n=get_content_path(e))&&Object.keys(folders).forEach(function(e){0===e.indexOf(n)&&delete folders[e]})}}function get_content_path(e){var t="/content/";if(t=e.indexOf("."+t)>-1?"."+t:t,-1==e.indexOf(t))return e.replace(/\/\/+/g,"/").replace(/\/$/,"");var a=e.replace(/\/\/+/g,"/").replace(/\/$/,"").split(t);return a.shift(),a.join(t)}function remove_jpg(e){return e.filter(function(e){var t=e.split(".");return t.length<2||"jpg"!==t.pop().toLowerCase()})}function add_folders_key(e,t){var a={};a[e]=t,$.extend(folders,a)}x3_help={new_folder:"<h3>Create New Folder</h3><p>Creates a new child-page (subfolder) inside the current page. The name you give to the folder represents the page URL (slug) in browser, and should be short and simple.</p><h4>Numbered Folder Names</h4><em>* Optional</em><p>Unless you intend to use custom sorting (by drag and drop), you can add a number in front of the folder name to indicate the sort order of the page. The number will not display in the actual URL.</p><p>The following example creates a page with sort order 4:<br><strong><code>4.foldername</code></strong> : <code>yourwebsite.com/foldername/</code><br><em>* The initial number in folder name will NOT display in the URL.</em></p><h4>Folder names are <u>NOT</u> page titles</h4><p>Folder names are only used for the URL and to identify the page. You should use the page <code>title</code> option for extensive page titles, and the <code>label</code> setting for menu labels. The folder name should be as simple as possible, preferably a single lowercase word, without special characters or empty spaces.</p><h4>Empty spaces not allowed</h4><p>Empty spaces are NOT allowed in folder names. Even if they were allowed, it would create ugly url's that are bad for SEO: <code>/not%20nice%20url/</code>. If you need to use multiple words, separate them with hyphens- instead: <code>/nice-url/</code>.</p><h4>Other disallowed characters</h4><p>Other characters that are not allowed in folder names include <code>#$%^&*()+=[]'\"/\\|{}`~!@</code>. Most of these characters are simply not allowed in URL's, while some characters are disallowed because they break the functionality of X3.</p>",protect:'<h3>Page Password Protection</h3><p>Here you can add passwords to your pages. Simply locate the page in the <code>link</code> field, add a <code>username</code> and <code>password</code>, and click save. The specific page will now require login when accessed by any visitor.</p><h4>Users</h4><p><em>* Optional</em></p><p>Instead of adding a username and password per page link, you can instead include <code>users</code> to give specific users access to a page. Users are added separately from the <code>users</code> tab. The benefit of "users", is that you can assign a single login for a user, which may allow them access to multiple protected pages without re-entering login credentials. Also, it is sometimes easier to manage usernames and passwords in a users section for persistent usage.</p><p><em>* You should select either a user <strong>OR</strong> username+password, not both.</em></p><h4>Recursive Protection</h4><p>Link protection is recursive, which means the login for a specific link will inherit upon child pages. For example, a password applied to <code>galleries/</code> would also apply for child-pages <code>galleries/food/</code> and <code>galleries/landscape/</code>. If you are specifically protecting child-pages of already-protected parent-pages, the child-page login will outrank the parent-page login.</p><h4>Global Protect</h4><p>Use the special <code>*Global</code> link to protect your entire X3 website. Basically this is like protecting the / root page, and since link-protection is recursive, it will protect ALL pages - your entire website. <em>* You can still apply passwords to child-pages, which will outrank the global protection.</em></p><h4>Super Users</h4><p>There is a special <code>superuser</code> user, which can access ALL password-protected pages without even being assigned specifically for the link. A super-user should normally be reserved for gallery-owners who want to remember a single login that works on all password-protected pages. Create a super-user in the users-section by simply appending an asterisk* behind the username, for example <code>superuser*</code>. Since super-users are allowed access to ALL password-protected pages, they do not show up in the list of available users to assign from the links tab.</p><p><em>* The asterisk* character is part of the username, and needs to be included when logging in.</em></p><h4>Sessions</h4><p>Login uses WWW-Authenticate, which basically creates "sessions" in the browser that remembers the current authentication. This helps so the visitor doesn\'t need to re-authenticate, and it also allows a "user" to access all pages they are assigned to without having to enter login details more than once. This is a good thing of course, but since there is no "logout" for these sessions, it can make testing difficult from your browser since you may be logged in to a session already. Therefore, if you are testing your protected pages, you may need to use "New Incognito Window" (Google Chrome), or "New Private Window" (Safari, Firefox) for each test. These special windows do not inherit your browser sessions, so you can test properly. Just remember to to open/close the window for each test, because even private windows have temporary sessions until they are closed.</p>',"page-examples":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong class=title>Examples</strong><span class=content>This folder contains examples of various layouts for your pages. You can delete or hide this page. <strong>NB!</strong> For the sake of demonstration, all galleries in the examples section are set to load images from the <em>3.examples/assets</em> folder.</span></div>',"page-logo":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong class=title>Logo</strong><span class=content>Upload your logo here if you have selected <strong>image logo</strong> in <em>Settings &rsaquo; Style &rsaquo; Logo</em>.</span></div>',"page-audio":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong class=title>Audio Player Files</strong><span class=content>To enable audio, upload one or more mp3 files, and enable the audio player plugin from <em>settings &rsaquo; plugins &rsaquo; audio player</em>. If you get errors on mp3 file upload, it is likely because your server has a <strong>2MB upload_max_filesize</strong> limit in php.ini (see <a href="../?diagnostics" target=_blank>diagnostics</a>). If so, you will need to either increase upload_max_filesize on your server, or upload mp3 files by FTP.</span></div>',"page-404":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong class=title>404 "Page Not Found" Template</strong><span class=content>This page can be edited to change text and appearance of the page that appears when a page is not found.</span></div>',"page-custom":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom</strong><span class=content>This folder is for special features and custom files.</span></div>',"page-files":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom Files</strong><span class=content>Contains folders where you can store custom files to use in your website.</span></div>',"page-files-generic":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><span class=content>* Files in this folder can be used in pages and plugins with dynamic source path <strong>{{files}}/{{foldername}}/</strong>filename.jpg.</span></div>',"page-javascript":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom Javascript Files <span style=\'font-weight: 400;\'>[Advanced]</span></strong><span class=content>Upload custom javascript files here. <br><br>* Files with "include" in the name (for example <strong>"myscript.include.js"</strong>) will automatically load into the website.</span></div>',"page-images":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom images</strong><span class=content>Upload custom images here which can be used in your pages and plugins.<br><br>* Images in this folder can be used in pages and plugins with dynamic source path <strong>{{files}}/images/</strong>filename.jpg.</span></div>',"page-css":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom CSS Files <span style=\'font-weight: 400;\'>[Advanced]</span></strong><span class=content>Upload custom css files here.<br><br>* Files with "include" in the name (for example <strong>"mystyle.include.css"</strong>) will automatically load into the website.</span></div>',"page-index":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Home Page</strong><span class=content>The folder name <em>index</em> represents your home page. You can hide it from the menu by clicking the "hide" button. The index page cannot contain child pages (subfolders) and is just a placeholder for your home page.</span></div>',"page-content":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Content Folder</strong><span class=content>This is your main content folder where you add your page structure. This folder does not represent any page and is just the container for all your pages. Do not upload images into this folder.</span></div>',"page-assets":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Examples Gallery Assets</strong><span class=content>This is where we store images for galleries in the examples sample pages.</span></div>',"page-favicon":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Favicon</strong><span class=content>Add a custom favicon <a href=https://en.wikipedia.org/wiki/Favicon target=_blank>[wiki]</a> by deleting the default "favicon.png", and uploading your own icon in PNG format [32 x 32 px].<br><br><strong>Tip!</strong> Use a new filename (for example "favicon2.png") to prevent browser from caching old favicon file.</span></div>',preload:'<h3>Preload Site Object</h3><h4>What does it do?</h4><p>When this setting is enabled, your website will preload a data-object containing all pages of your website. The loading of this data-object occurs as an invisible process, after first page is loaded and displaying to the visitor. Once the site Object is loaded into the visitors browser, navigating to other pages on the website are instantaneous. This makes your website seems super-fast, and it requires less loading of individual pages.</p><p><em>* The Site Object only contains page text, so images and other assets will load as usual once each page displays.</em></p><h4>Should I be using it?</h4><p>Preloading the site object is a very powerful feature, but it is not beneficial in all cases. If your website has hundreds of pages, each with loads of images, it will become too heavy and counter-productive. If you have a relatively light website (say less than 40 pages), without excessive amounts of images in each folder, then you can try it.</p><h4>Heavy Process</h4><p>As you will likely experience, creating the site object is a very heavy process, that could take a long time to process on your server, or even time-out. The reason for this, is because the script needs to loop through- and create all pages in a single process. The time required for processing, depends entirely on the power of your server, and the depth of your content (pages and images). If you get a timeout when clicking the button, it is a clear indication that you shouldn\'t be using this feature. If your server manages to create the site object, it will get cached, and will load relativey fast for visitors.</p><h4>Instructions</h4><p>If you want to use this feature, you will need to need to enable the preload site object from your main settings. Then, each time you make changes to your gallery, you will need to click the "create" button below to refresh the site object. You don\'t need to create the site object after every change you make, only when you are done editing and want to "publish" the website.</p><p><em>* You don\'t need to refresh the site object if you are testing individual pages. The site object is only used when navigating between pages, and does not apply to the page you start from.<em></p>',authorize:"<h3>Authorize</h3><p>Checks if your domain is authorized to used X3.</p>",menu:"<h3>Create Menu</h3><p>Click the button to create- and <u>cache</u> your X3 website menu. Once the menu is created, it will be cached until next time you make any changes to your X3 website. The cached menu fragment will allow separate pages to build faster.</p><h4>Do I need this?</h4><p>No - This operation is optional because the menu will be created- and cached on the first page visit regardless. This process may be helpful for X3 websites with a heavy menu structure where you wish to pre-cache the menu before loading any pages.</p><h4>About Menu Caching</h4><p>Every time you make <u>any</u> change to your X3 website, the menu needs to get re-created and cached. The menu creation is a relatively heavy process, because it requires X3 to loop through <u>all</u> folders in your content, read the data file and gather information about all files. The speed of this process is proportional to the amount of folders and files in your content, and the speed of your server.</p>",htaccess:"<h2>"+(conf_editor||"")+"</h2><p><em>* This is an advanced feature. Do NOT edit this file unless you know what you are doing.</em></p><p>This page displays the content of the <code>"+(conf_editor||"")+"</code> file in your root X3 directory. The "+(conf_editor||"")+" file is necessary for X3 to be able to run properly. This feature is mainly used to diagnose issues, but can also be used to edit the "+(conf_editor||"")+" file if it is writable.</p>"+("htaccess"===conf_editor?"<h3>Custom rules</h3><p>If you need to add custom rules, you should wrap them inside <code># custom rules start</code> and <code># custom rules end</code> tags, so they are copied when you apply X3 updates. For example:</p><pre><code># custom rules start<br><br>YOUR CUSTOM RULES HERE<br><br># custom rules end</code></pre>":""),reset:"<h3>Reset</h3><p>This setting resets your global settings to default, by simply deleting the <code>config/config.user.json</code> file. It does NOT affect page-settings stored in your pages/folders. </p>",templates:"<h3>Setting Templates</h3><p>Setting templates are tested combinations of settings, which can be applied to folders- and gallery. Basically, they are just shortcuts for certain layout-combinations, which you otherwise can apply normally. You don't need to use setting templates, but they offer a quick way to achieve specific layouts.</p><p><strong>Important</strong><br>Default setting templates only change a <em>few</em> related options each, and many settings will remain default. Therefore, it is likely you may wish to make some adjustments after applying a template. Templates may not affect specific layout details, tooltips- or captions, so results may depend on your defaults.</p><h4>Custom Templates</h4><p>Create your own templates by selecting the <code>Save Current Settings As...</code> option. This will allow you to save current settings as a custom template.</p><p><em>* You still need to click SAVE after applying a template.</em></p>",image_title:"<h3>Image Title</h3><p>Add a unique title for your image. Titles may display in gallery layouts and in the image popup. <em>* You can use any characters in image title</em>.</p><h4>Some html allowed</h4><p>You are allowed to use the following html tags in image titles:<br><code>&lt;code&gt;&lt;a&gt;&lt;span&gt;&lt;em&gt;&lt;i&gt;&lt;b&gt;&lt;strong&gt;&lt;small&gt;&lt;s&gt;</code></p><h4>Dynamic Values</h4><p>You can use the following values in titles, which are replaced dynamically. This may be useful if you are including file names, or links that refer to the image name.</p><p><code>{file_name_ext}</code> is replaced by the file name.<br><code>{file_name}</code> is replaced by the file name <em>without</em> extension.<br><code>{path}</code> is replaced by the path of current folder.<br><code>{image_path}</code> is replaced by the path to the image.</p>",image_description:"<h3>Image Description</h3><p>Add a unique description for your image. Descriptions may display in gallery layouts and in the image popup. <em>* You can use any characters in image description</em>.</p><h4>Some html allowed</h4><p>You are allowed to use the following html tags in image descriptions:<br><code>&lt;a&gt;&lt;span&gt;&lt;em&gt;&lt;i&gt;&lt;b&gt;&lt;strong&gt;&lt;small&gt;&lt;s&gt;&lt;br&gt;&lt;mark&gt;&lt;img&gt;&lt;kbd&gt;&lt;code&gt;&lt;button&gt;</code></p><h4>Dynamic Values</h4><p>You can use the following values in default description, which are replaced dynamically. This may be useful if you are including file names, or links that refer to the image name.</p><p><code>{file_name_ext}</code> is replaced by the file name.<br><code>{file_name}</code> is replaced by the file name <em>without</em> extension.<br><code>{path}</code> is replaced by the path of current folder.<br><code>{image_path}</code> is replaced by the path to the image.</p>",image_link:"<h3>Image Link</h3><p>If you set an image link, clicking an image will open the link instead of the image. You can use absolute- or relative links. <em>* If you want to link to an X3 page, you should use a relative path so that the link is loaded by ajax.</em></p><p><code>https://flamepix.com</code><br><em>* Absolute link.</em></p><p><code>/pagex/pagey/</code><br><em>* Link is relative to domain name.</em></p><p><code>pagex/pagey/</code><br><em>* Link is relative to current page.</em></p><h4>Dynamic Values</h4><p>You can use the following variables in your links, which are replaced dynamically:</p><p><code>{file_name_ext}</code> is replaced by the file name.<br><code>{file_name}</code> is replaced by the file name <em>without</em> extension.<br><code>{path}</code> is replaced by the file path of current folder.<br><code>{image_path}</code> is replaced by the path to the image.</p><h3>Target</h3><p>Target decides in what window to open the link.</p><p><code>auto</code> Uses default target, or automatically determines target depending on the link.<br><code>_self</code> Opens the link in the same window.<br><code>_blank</code> Opens the link in a new window (normally a new tab).<br><code>popup</code> Opens the link in a popup window.<br><code>X3 popup</code> Opens link in native X3 popup. <em>* Good for Youtube embeds, images and simple content, but should <u>not</u> be used when linking to full websites.</em></p>",custom_sort:"<h2>Custom Sort</h2><p>This mode allows you to drag-and-drop items into a custom sorting order. After you have sorted items, click the &quot;save&quot; button.</p><p>Files and folders are by default sorted by name. When you add new files or folders, they will automatically be sorted by name also. However, if you have already applied custom sorting, new files and folders will be added to the top of the list.</p>",previews:"<h2>Update Preview Images</h2><p>This tool will attempt to set preview images for your pages, unless already set correctly.</p><p><em>What are page preview images?</em><br>Page preview image is a unique image that identifies a page. It is used in category listing pages, in the mega menu, and also when sharing the page.</p><p><em>Do my pages need preview images?</em><br>No, but if you are using the mega menu, you may want to have unique preview images for each page. If you don't set a unique preview image, default preview image will be used.</p><p><em>Why isn't this process automatic?</em><br>This process is too slow to be handled automatically by the frontend.</p><p><em>How does this tool help?</em><br>You might have forgotten to set a preview image? Perhaps you want your category pages to inherit preview image from a child folder? Maybe you renamed an image that is used for preview? This tool will correct issues for you.</p><p><em>This tool will attempt to perform the following on all your pages:</em></p><strong>If preview image is set</strong><ol><li>Checks if the preview image is valid.</li><li>Checks if <code>preview.jpg</code> exists in folder.</li><li>Tries to set first image from the page gallery.</li><li>If the page has no images, tries to set first image from page gallery assets.</li><li>If no success, you will be notified 'Cannot locate image'.</li></ol><strong>If preview image is <u>NOT</u> set</strong><ol><li>Checks if <code>preview.jpg</code> exists in folder.</li><li>Tries to set first image from the page gallery.</li><li>If page has no images, tries to set first image from gallery assets.</li><li>If page has no assets assigned, tries to set image from first image in last child folder.</li><li>If no success, preview will be left empty.</li></ol>",refresh:"<h2>Refresh Menu</h2><p>Click this button to refresh your site main menu.</p><h4>Why isn't this process automatic?</h4><p>Building the menu can be a slow process because it requires looping through all pages, extracting data, and looping through images. Why re-build the menu each time you make a change if the change does not affect the menu? Use this button to publish your site menu when required. Pages will get created faster when the menu is cached.</p><h4>Can I set it to automatic?</h4><p><strong>Yes.</strong> Go to <em>Settings › Advanced › Menu Processing</em>, and disable <em>Manual refresh</em>. If you disable this feature, the site menu will be re-created every time you make <em>any</em> changes from the panel. Depending on the depth of your content and the speed of your server, this could drastically slow down page creation time.</p><p><em>* Manual menu refresh does not affect output speed of already-cached pages.</em></p>",vertical_split:"<h3>Split View</h3><p>The split view setting allows you to split each item into two columns, with image on one side and caption on the other. This setting works best with the <code>vertical</code> layout, but can also be used with <code>grid</code> and <code>carousel</code>.</p><p><em>* Below is an example of an item displaying in split view.</em></p><div style='overflow:auto;'><div style='width:50%; padding: .5em; float:left;'><div style='background:#CCC; padding: 2em 0;text-align: center;font-size:2em;'>image</div></div><div style='width:50%; padding: .5em; float:left;'><div style=''><strong>Title</strong><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean accumsan justo vulputate arcu posuere scelerisque. Mauris at sollicitudin ante.</p></div></div></div><h4>Ratio</h4><p>The split view is based on a 12-column grid, and default ratio <strong>6</strong> means the columns will split into two equally-sized columns. If you increase the ratio, the left column will occupy more space. The ratio can be set from <strong>2 to 10</strong>, indicating how many columns the left side should occupy. Normally, you should be considering values between 4 and 8 for any functional layout.</p><p><em>* Example of ratio to set 4, which means left side will occupy 33.3% of the available width</em></p><div style='overflow:auto;'><div style='width:33.3%; padding: .5em; float:left;'><div style='background:#CCC; padding: 2em 0;text-align: center;font-size:2em;'>image</div></div><div style='width:66.6%; padding: .5em; float:left;'><div style=''><strong>Title</strong><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean accumsan justo vulputate arcu posuere scelerisque. Mauris at sollicitudin ante.</p></div></div></div><h4>Invert</h4><p>By default, the split is inverted so that preview-image is on the left, and text is on the right. If you disable invert, the text will be on the left, and image on the right.</p>",page_title:"<h2>Page Title</h2><p>This is the main title of your page. If you don't set a page title, title will be inherited from <em>folder name</em>. Page title is used for the following:</p><ul><li><code>&lt;h1&gt;</code> large title at the top of page content.</li><li><code>&lt;title&gt;</code> meta tag used for SEO and social sharing.</li><li>Page/folder listing pages.</li><li>Carousel- and list mega menu.</li></ul><h4>HTML Tags</h4><p><em>Some</em> html tags are allowed in the page title:<br><span class=code-inline-block><code>&lt;a&gt;</code><code>&lt;span&gt;</code><code>&lt;em&gt;</code><code>&lt;i&gt;</code><code>&lt;b&gt;</code><code>&lt;strong&gt;</code><code>&lt;small&gt;</code><code>&lt;s&gt;</code></span></p><p><em>*Html tags are stripped from menu items.</em></p>",menu_label:"<h2>Menu Label</h2><p>Use the menu label to set a short title for the main menu. If you don't set a menu label, label will be inherited from <em>folder name</em>. Unlike titles, menu labels should be as short as possible, so they fit nicely into the menu.</p><h4>HTML Tags</h4><p><em>Some</em> html tags are allowed in the menu label:<br><span class=code-inline-block><code>&lt;span&gt;</code><code>&lt;em&gt;</code><code>&lt;i&gt;</code><code>&lt;b&gt;</code><code>&lt;strong&gt;</code><code>&lt;small&gt;</code><code>&lt;img&gt;</code><code>&lt;svg&gt;</code></span></p><p><em>* Mega menu <em>carousel</em> will use titles instead of label.</em><br><em>* label can also be used in folders-listings.</em></p>",page_link:"<h2>Link URL</h2><p>If you want to create the page as alink to another page/website, add the URL for the page you want to link to. You can use <em>root-relative</em> urls to other pages in your X3 website, <em>relative</em> urls to child-pages of the current page, or <em>absolute</em> links to external websites.</p><h3>Examples</h3><p><code>/galleries/food/</code><br>Link to another page in your website with a root-relative url. When you include a slash before the relative url, it will look for the url relative to your website root. <em> * When linking to a page within your X3 website, the page will load with AJAX in the same window.</em></p><p><code>child-folder/</code><br>Link to a child-page of the current page by omitting the opening slash.</p><p><code>http://imagevuex.com</code><br>Link to an external website by adding absolute url.</p><p><code>file.pdf</code><br>Link to a file located in the page.</p>",page_link_target:"<h2>Link Target</h2><p>Use this setting to decide the target for the link.</p><p><strong>auto</strong><br>Window target will be determined automatically: Relative links will open in same <code>_self</code> window, while absolute links and files will open in a new <code>_blank</code> window.</p><p><strong>_self</strong><br>Link will always open in the same <code>_self</code> browser window.</p><p><strong>_blank</strong><br>Link will always open in a new <code>_blank</code> browser window.</p><p><strong>Popup Window</strong><br>Link will open in a native browser popup window. <em>* Mobile devices will revert to a new tab/window.</em></p><p><strong>X3 Popup</strong><br>Link will open in the native X3 popup, useful and elegant for image and video links.</p><p><strong>X3 Modal</strong><br>Displays the content of this page in an X3 modal popup. <em>* ignores the link</em></p>",page_hidden:"<h2>Hide Page</h2><p>Hidden pages will not display in the menu or page layouts, but are still available by URL.<p>"};function update_iptc_data(e,t){Object.keys(e).forEach(function(a){var n=t.filter('[data-name="'+a+'"]');if(n.length){var i=e[a];i.hasOwnProperty("title")&&n.data("title",i.title),i.hasOwnProperty("description")&&n.data("description",i.description),i.hasOwnProperty("link")&&n.data("link",i.link),i.hasOwnProperty("target")&&n.data("link-target",i.target),i.hasOwnProperty("index")&&n.data("index",i.index)}})}function collect_iptc_files(e){var t={};return e.each(function(e){var a=$(this),n=a.data("name"),i=a.find(".file-data"),o=i.children(".file-title").val(),l=i.children("textarea").val(),s=i.children(".file-link").val(),r="auto"==(r=i.find("label.active").data("name"))?"":r,d=a.attr("data-custom"),c={};is_different(o,a.data("title"))&&(c.title=o),is_different(l,a.data("description"))&&(c.description=l),is_different(s,a.data("link"))&&(c.link=s),is_different(r,a.data("link-target"))&&(c.target=r),is_different(d,a.data("index"))&&(c.index=parseInt(d)),Object.keys(c).length&&(t[n]=c,t[n].path=a.data("path").replace("../../","../"),t[n].date=a.data("date"))}),!!Object.keys(t).length&&t}function is_different(e,t){return!(!e&&!t)&&e!=t}var current_nav,current_dir_path,mtree_menu_expanded=!1,mtree_menu_open=[],mtree_state_loaded=!1,files_checked=!1,page_selected_items={},current_folder_images=[],x3_user_dir="user"===user?core_user_dir:root_dir_name;function createContextMenu(){x3_body.append('<div id="context-menu" style="" class="dropdown">\t<ul class="dropdown-menu" role="menu" aria-labelledby="context-menu">\t<li role="presentation" class="dropdown-header">Content</li>\t<li role="presentation" class="cm-hide"><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-pencil"></span></a></li>\t<li role="presentation" class=cm-rename><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-pencil"></span>'+language.Rename+'</a></li>\t<li role="presentation" class="cm-delete"><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-remove"></span>'+language.Delete+'</a></li>\t<li role="presentation" class=cm-move><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-move"></span>'+language.Move+'</a></li>\t<li role="presentation" class=cm-copy><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-transfer"></span>'+language.Copy+'</a></li>\t<li role="presentation" class=cm-upload><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-plus"></span>'+language.Upload+'</a></li>\t<li role="presentation" class=cm-new><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-file"></span>'+language.Create_New_Folder+"</a></li>\t</ul>\t</div>");var e=x3_body.children("#context-menu");e.find("li.cm-rename > a, li.cm-move > a, li.cm-copy > a").click(function(t){t.preventDefault();var a=here;here=e.data("path").replace(/\/$/,""),x3_content_show.children("#showConf").on("hidden.bs.modal",function(e){setTimeout(function(){here=a},1),x3_content_show.children("#showConf").off("hidden.bs.modal")})}),e.find("li.cm-hide > a").click(function(t){t.preventDefault();var a=e.data("path"),n=!e.data("hidden"),i={};i[a.split("./content/")[1]]={hidden:n},set_folders(i,function(){toggle_row(null,n,a),toggle_menu_item(e.data("listitem"),n,a),a===current_dir_path&&x3_content_show.children(".x3-manager").toggleClass("is-hidden",n).find(".btn-hide").toggleClass("active",n),x3Notifier(e.data("name")+" "+lang(n?"Hide":"Unhide"),null,null,"success")})}),e.find("li.cm-delete > a").click(function(t){t.preventDefault(),remove_dir(e.data("path"),e.data("name"),"first"),x3_content_show.children("#showConf").modal("show")}),e.find("li.cm-rename > a").click(function(t){t.preventDefault(),rename_dir(e.data("path"),e.data("name"),"first"),x3_content_show.children("#showConf").modal("show")}),e.find("li.cm-move > a").click(function(t){t.preventDefault(),rename_dir(e.data("path"),e.data("name"),"move"),x3_content_show.children("#showConf").modal("show")}),e.find("li.cm-copy > a").click(function(t){t.preventDefault(),copy_dir(e.data("path"),e.data("name"),"first"),x3_content_show.children("#showConf").modal("show")}),e.find("li.cm-upload > a").click(function(t){t.preventDefault(),showUploader(e.data("path"));var a=x3_content_show.children(".modal#uploader"),n=a.find(".modal-title").text();a.find(".modal-title").text("Upload to "+e.data("name")),a.find(".modal-footer > button").hide(),a.find(".modal-footer").append('<button type="button" class="btn btn-default btn-temp" data-dismiss="modal" onclick="show_preloader(); setTimeout(function(){loading_from_file = false; hide_preloader(); have_action = \'yes\'; active_page_tab = \'#gallery\'; showFileManager(\''+e.data("path")+"')}, 1000);\">Click to see uploaded files.</button>"),a.on("hidden.bs.modal",function(e){var t=$(this);t.find(".modal-title").text(n),t.find(".modal-footer > button.btn-temp").remove(),t.find(".modal-footer > button").show(),a.off("hidden.bs.modal")}),a.modal("show")}),e.find("li.cm-new > a").click(function(t){t.preventDefault(),x3_modal_new_folder.data("there",e.data("path")),x3_modal_new_folder.modal("show")}),x3_content_show.on("show.bs.modal","#newFolder",function(e){var t=$(this),a=(t.data("there")||here)+"//";t.find("label > span.path").text(a.replace(/\.\.\//g,"").replace(/\.\//g,"").replace("content/","").replace("///","").replace("//",""))}).on("hidden.bs.modal","#newFolder",function(e){$(this).removeData("there")})}var json_menu;function createMtree(e){var t=x3_panel_container.find("#left_folder_menu_box > ul");t.mtree({use_nodes:!0,skip_init:!1,close_same_level:!1}),json_menu=[],protectPageAfter(),t.find("a").each(function(e,t){var a=$(this),n=a.parent("li"),i=a.text(),o=a.data("href").split("./content/")[1],l="_"+o.replace(/\./g,"_").replace(/\//g,"__"),s=o.split("/"),r=0===i.indexOf("_"),d=r||folders&&folders.hasOwnProperty(o)&&folders[o].hasOwnProperty("hidden")&&folders[o].hidden;n.attr("id",l).append('<span class=mtree-tools>&nbsp;<span class="glyphicon glyphicon-wrench"></span></span>'),d&&n.addClass("is-hidden"+(r?" is-name-hidden":"")),$.each(s,function(e,t){t.indexOf(".")>-1&&$.isNumeric(t.split(".")[0])&&(s[e]=t.split(".")[1])}),(s=s.join("/").replace(/\/?$/,"/").replace("index/","")).length>0&&(0!=s.indexOf("custom/")||0===s.indexOf("custom/files/")&&"custom/files/"!==s)&&0!=s.indexOf("services/")&&json_menu.push({link:s,label:s,path:o})});var a=t.children("#_custom");a.add(a.find("ul, li")).addClass("no-drag"),a.appendTo(t),a.find("#_custom__files").appendTo(a.children("ul")),cf_load(),t.siblings("#menu-expand").length<1&&t.before('<button id="menu-expand">+ '+language.Menu_Expand+"</button>"),x3_body.children("#context-menu").length<1&&createContextMenu(),mtree_state_loaded||(supports_local_storage()&&null!==localStorage.getItem("mtree_state")&&(mtree_menu_open=JSON.parse(localStorage.getItem("mtree_state"))),mtree_state_loaded=!0),mtreeEvents()}function updateMtree(){x3_panel_container.find("#left_folder_menu_box > ul").mtree({use_nodes:!1,skip_init:!0,close_same_level:!1}),mtreeEvents()}var fixed_timer;function toggleMenuFixed(){var e=x3_content_show.find("#menu-container");e.length&&(clearTimeout(fixed_timer),fixed_timer=setTimeout(function(){$.isScrollToFixed(e)&&(e.height()>x3_win.height()-50||x3_win.width()<992)?e.trigger("detach.ScrollToFixed"):!$.isScrollToFixed(e)&&e.height()<x3_win.height()-50&&x3_win.width()>=992&&e.scrollToFixed({zIndex:2,marginTop:40})},300))}x3_win.on("resize.menu_scrolltofixed",$.debounce(500,toggleMenuFixed));function mtreeEvents(){var e=x3_panel_container.find("#left_folder_menu_box"),t=e.children("ul"),a=x3_body.children("#context-menu");t.find("ul:not(.no-drag)").add(t).filter(function(e){return $(this).children().length>1}).each(function(e,t){var a=$(t);a.addClass("is-sortable"),Sortable.create(t,{animation:100,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",filter:".no-drag",onEnd:function(){console.log("onEnd!")},onSort:function(){var e=!0,t=a.children(":not(#_custom)"),n={};t.each(function(t,a){a.setAttribute("data-custom",t+1),n[a.getAttribute("data-content-path")]={index:t+1},e&&t!==parseInt(a.getAttribute("data-sort"))&&(e=!1)}),e&&(t.attr("data-custom","0"),Object.keys(n).forEach(function(e){n[e].index=0})),Object.keys(n).length&&set_folders(n,function(){if(rows_folders.length){var t=a.parent("li"),i=t.length?t.attr("data-dir"):x3_user_dir;(i===current_dir_path||!current_dir_path&&x3_user_dir===i)&&(rows_folders.each(function(e,t){var a=get_content_path(t.getAttribute("data-path"));n.hasOwnProperty(a)&&t.setAttribute("data-custom",n[a].index)}),3===active_gallery_sort&&sort_elements(rows_folders,"custom"),reset_sort_button.toggleClass("disabled",e))}x3Notifier("Sorted!",null,null,"success"),e&&x3Notifier("Sorting reset to alphabetic order",null,null,"success")})}})}),t.on("click",".mtree-icon",function(){mtreeSaveState(t),toggleMenuFixed()}),mtreeLoadState(t),t.hoverIntent({over:function(e){var a=$(this).siblings(".mtree-tools");a.addClass("current_intent"),t.find(".current_hover").not(".current_intent").hide().removeClass("current_hover"),a.hasClass("current_hover")||a.velocity({opacity:1},{duration:200,display:"block"}).addClass("current_hover"),a.removeClass("current_intent")},out:function(){},selector:"a"}).on("mouseover","a",function(e){t.contextmenu("closemenu",e),a.off("mouseleave.closemenu"),t.find("li.current-li-active").removeClass("current-li-active"),$(this).parent("li").addClass("current-li-active")}).on("mouseleave",function(e){t.find(".current_hover").hide().removeClass("current_hover")}),t.hoverIntent({over:function(e){t.contextmenu("show",e),a.on("mouseleave.closemenu",function(e){t.contextmenu("closemenu",e),a.off("mouseleave.closemenu")})},out:function(){},selector:".mtree-tools"}),t.find("a").click(function(e){e.preventDefault();var a=$(this);t.find(".menu_active").removeClass("menu_active"),a.parent("li").addClass("menu_active"),showFileManager(a.data("href"))});var n=a;t.contextmenu({target:"#context-menu",before:function(e,a){e.preventDefault();var i=t.find(".current-li-active");i.addClass("current-context-active");var o=i.children("a").data("href"),l=o.split("/"),s=l[l.length-1],r=i.hasClass("is-hidden"),d=i.hasClass("is-name-hidden");return n.data("path",o),n.data("name",s),n.data("listitem",i),n.data("hidden",r),n.find(".dropdown-header").text(s),n.find(".hidden").removeClass("hidden"),n.find(".cm-hide > a").text(lang(r?"Unhide":"Hide")),o.indexOf("content/custom/files/")>-1?n.find(".cm-hide, .cm-move, .cm-copy, .cm-new").addClass("hidden"):o.endsWith("content/custom/files")?n.find(".cm-hide, .cm-rename, .cm-delete, .cm-move, .cm-copy, .cm-upload").addClass("hidden"):o.indexOf("content/custom/")>-1?n.find(".cm-hide, .cm-rename, .cm-delete, .cm-move, .cm-copy, .cm-new").addClass("hidden"):o.endsWith("content/custom")?n.find(".cm-hide, .cm-rename, .cm-delete, .cm-move, .cm-upload, .cm-new").addClass("hidden"):(o.endsWith("content/1.index")||o.endsWith("content/index"))&&n.find(".cm-new").addClass("hidden"),d&&n.find(".cm-hide").addClass("hidden"),!0}}),n.on("hide.bs.context",function(){t.find(".current-context-active").removeClass("current-context-active")}),e.children("#menu-expand").click(function(e){mtree_menu_expanded?t.find(".mtree-open").removeClass("mtree-open mtree-active").addClass("mtree-closed").children("ul").css({height:"0px",display:"none"}):t.find(".mtree-closed").removeClass("mtree-closed").addClass("mtree-open").children("ul").css({height:"auto",display:"block"}),toggleMenuFixed(),mtreeSaveState(t)}),mtreeActive(t),t.show()}function mtreeActive(e){(e=e||x3_panel_container.find("#left_folder_menu_box > ul")).find(".menu_active").removeClass("menu_active"),e.find('a[data-href="'+here.replace(/\/+$/,"")+'"]').parent("li").addClass("menu_active")}function mtreeSaveState(e){mtree_menu_open.length=0,e.find(".mtree-open").has("ul").each(function(e,t){var a=$(this).attr("id");-1===a.indexOf("/")&&mtree_menu_open.push(a)}),supports_local_storage()&&localStorage.setItem("mtree_state",JSON.stringify(mtree_menu_open)),set_mtree_expanded(e)}function mtreeLoadState(e){e.find(".mtree-open").removeClass("mtree-open mtree-active").addClass("mtree-closed").children("ul").css({height:"0px",display:"none"}),$.each(mtree_menu_open,function(t,a){e.find("#"+a).has("ul").removeClass("mtree-closed").addClass("mtree-open").children("ul").css({height:"auto",display:"block"})}),set_mtree_expanded(e)}function set_mtree_expanded(e){mtree_menu_expanded=0!==mtree_menu_open.length&&0!==e.children(".mtree-open").has("ul").length,x3_content_show.find("#menu-expand").text(mtree_menu_expanded?"- "+language.Menu_Collapse:"+ "+language.Menu_Expand)}x3_content_show.on("keyup",".modal input.form-control",function(e){if(13==e.keyCode){var t=$(this).closest(".modal");t.find(".btn-key").length&&t.find(".btn-key").click()}}),x3_panel_container.find("#searchInput").on("keyup",function(e){13==e.keyCode&&$(this).parent().siblings(".top_search_btn").click()}),x3_content_show.on("click.tablerow",".manage-table tr",function(e){var t=e.target.nodeName.toLowerCase();if("td"==t||"tr"==t){$(this).find('input[type="checkbox"]').click()}});var active_page_tab=supports_local_storage()&&null!==localStorage.getItem("active_page_tab")?localStorage.getItem("active_page_tab"):"#page";function x3BeforeShowFileManager(){var e=x3_content_show.height();x3_content_show.css("height",e),x3_win.scrollTop()>300&&x3_html.velocity("stop").velocity("scroll",{duration:600,easing:"easeInOutCubic"})}function x3ShowFileManager(){var e=supports_local_storage()&&null!==localStorage.getItem("current_page")?localStorage.getItem("current_page"):"";here=e,showFileManager(e)}supports_local_storage()&&x3_content_show.on("click",".col-md-9 > .alert > .close",function(e){e.preventDefault();var t=$(this).parent().data("path");localStorage.setItem("help-"+t,"hide")});function replace_dynamic_path(e,t,a){return e.replace("{{dynamic_path}}","Files in this folder can be accessed from content and plugins by using dynamic path <strong>{{files}}/"+t+"/</strong>filename."+a)}function x3AfterShowFileManager(e){x3_show_conf=x3_content_show.children("#showConf"),x3_conf_button=x3_show_conf.find("#confButton"),x3_mtree=x3_content_show.find("ul.mtree"),x3_modal_new_folder=x3_content_show.children("#newFolder"),x3_modal_new_zip_file=x3_content_show.children("#newzipFile"),x3_modal_copy_selected=x3_content_show.children("#copySelected"),x3_modal_move_selected=x3_content_show.children("#moveSelected"),x3_modal_remove_selected=x3_content_show.children("#removeSelected"),x3_modal_uploader=x3_content_show.children("#uploader"),container_id_tree=x3_show_conf.find("#container_id_tree"),container_id_tree2=x3_modal_move_selected.find("#container_id_tree2"),container_id_tree3=x3_modal_copy_selected.find("#container_id_tree3");var t=x3_content_show.children(".x3-manager"),a=t.find(".manage_box_show"),n=a.children(".col-md-3"),i=a.children(".col-md-9"),o=(manage_container=i.find(".manage-container")).children(".table.manage-table"),l=o.children(".popup-parent"),s=l.children("tr"),r=i.children(".current-folder-btns"),d=i.find(".selected-actions");if(t.addClass("level-"+(e?get_content_path(e).split("/").length:0)),rows_folders=s.filter('[data-isfile="0"]'),rows_files=s.filter('[data-isfile="1"]'),table_body=l,x3_modal_new_folder.find("#new_folder_link").on("keypress keyup focus",function(e){x3_modal_new_folder.find(".new-folder-target-container").toggleClass("hidden",!$(this).val())}),supports_local_storage()){var c=!(null==localStorage.getItem("new_folder_options_open")||!localStorage.getItem("new_folder_options_open")),p=x3_modal_new_folder.find('a[data-toggle="collapse"]');x3_modal_new_folder.find(".new-folder-options").toggleClass("in",c),p.text(c?"- Less settings":"+ More settings"),p.on("click",function(e){c=!c,localStorage.setItem("new_folder_options_open",c?"1":""),p.text(c?"- Less settings":"+ More settings")})}if(x3_show_conf.add(x3_modal_new_folder).add(x3_modal_new_zip_file).on("shown.bs.modal",function(){$(this).find("input.form-control").first().focus().select()}),o.on("click",".dropdown-menu a",function(e){e.preventDefault()}),r.children(".btn-group").on("click","button",function(e){x3_show_conf.modal("show")}),r.children(".btn-uploader").on("click",function(e){x3_modal_uploader.modal("show")}),r.children(".btn-new").on("click",function(e){x3_modal_new_folder.modal("show")}),l.on("click",".td-button a:not(.set-preview):not(.hide-file)",function(e){e.preventDefault(),x3_show_conf.modal("show")}),!t.is("#page_search")&&(!supports_local_storage()||supports_local_storage()&&"hide"!==localStorage.getItem("help-"+e))){var u=e.split("/").pop(),h=i.children("hr"),f="";"3.examples"==u?f=x3_help["page-examples"]:e.endsWith("content/1.index")?f=x3_help["page-index"]:e.endsWith("content/custom")?f=x3_help["page-custom"]:e.endsWith("content/custom/logo")?f=x3_help["page-logo"]:e.endsWith("content/custom/audio")?f=x3_help["page-audio"]:e.endsWith("content/custom/404")?f=x3_help["page-404"]:e.endsWith("content/custom/favicon")?f=x3_help["page-favicon"]:e.endsWith("content/custom/files")?f=x3_help["page-files"]:e.endsWith("content/custom/files/javascript")?f=x3_help["page-javascript"]:e.endsWith("content/custom/files/css")?f=x3_help["page-css"]:e.endsWith("content/custom/files/images")?f=x3_help["page-images"]:e.indexOf("content/custom/files/")>-1?f=x3_help["page-files-generic"].replace(/{{foldername}}/g,u):e.indexOf("examples/assets")>-1?f=x3_help["page-assets"]:e.length<1&&(f=x3_help["page-content"]),f&&h.after(f);var m=h.siblings(".alert");m.data("path",e),m.one("closed.bs.alert",update_fixed),update_fixed(!0)}n.find(".new-root-page").click(function(e){var t="user"===user?core_user_dir:root_dir_name;x3_modal_new_folder.data("there",t).modal("show")}),current_folder_images=[],s.length&&s.each(function(e,t){var a=$(this);1==a.data("isimage")&&current_folder_images.push(a.data("name"))}),toggleMenuFixed(),current_dir_path=e,supports_local_storage()&&localStorage.setItem("current_page",e);var g=i.children("#myTab"),_=g.find("a");if(_.length>1){var v=_.filter('a[href="'+active_page_tab+'"]');v.length&&v.is(":visible")?v.tab("show"):_.filter(":visible").tab("show")}else _.tab("show");g.on("click","a",function(e){active_page_tab=$(this).attr("href"),supports_local_storage()&&localStorage.setItem("active_page_tab",active_page_tab)}).on("shown.bs.tab","a",function(e){update_fixed(!0)}),x3_content_show.css("height","");var b=e||x3_user_dir,y=b.endsWith("./content")?"":b.split("./content/")[1],w=y.split("/"),x=w[w.length-1],k="custom"==w[0],C=folders&&folders.hasOwnProperty(y)&&folders[y].hasOwnProperty("hidden")&&folders[y].hidden,S=!1;if($.each(w,function(e,t){if(0===t.indexOf("_"))return C=S=!0,!1;t.indexOf(".")>-1&&$.isNumeric(t.split(".")[0])&&(w[e]=t.split(".")[1])}),"/"===(w=w.join("/").replace(/\/?$/,"/").replace("index/",""))&&(w=""),!S&&y&&i.find(".page-title").prepend('<a href="../'+w+'" target="_blank" class="view-page" title="'+language.View_Page+'"><span class="glyphicon glyphicon-new-window"></span></a>'),y&&!k&&!S){r.children(".btn-group").prepend('<button type="button" class="btn btn-default btn-group-filemanager btn-hide'+(C?" active":"")+'">'+lang("Hide")+"</button>");var j=r.find(".btn-hide");j.on("click",function(e){e.stopImmediatePropagation();var a={};a[y]={hidden:!C},set_folders(a,function(){C=!C,j.toggleClass("active",C),t.toggleClass("is-hidden",C),toggle_menu_item(null,C,b),x3Notifier(x+" "+lang(C?"Hide":"Unhide"),null,null,"success")})})}k&&t.addClass("is-custom"),C&&t.addClass("is-hidden"),S&&t.addClass("is-name-hidden"),x3_navbar_nav.find("#website-link > a").attr("href","../"+(0===w.indexOf("custom/")||S?"":w)),S||i.children(".title-url").attr("href","../"+w).children("span").first().text(location.hostname+get_x3_path()+"/"+w),files_checked=!1,d.find("button").addClass("disabled"),x3SetSelected(),x3SetByteSize(),setPreviewImageActive(),is_custom_sort=!1,is_custom_sort_folders=!1;var T=0,E=0;s.each(function(e,t){var a="0"==(t=$(this)).attr("data-isfile"),n=t.attr("data-name"),i=t.attr("data-path").split("./content/")[1],o=void 0!=t.data("hidden");if(t.addClass(a?"is-folder":"is-file"),a?T++:E++,a&&folders&&folders.hasOwnProperty(i)&&(folders[i].hasOwnProperty("hidden")&&folders[i].hidden&&(o=!0),folders[i].hasOwnProperty("index")&&t.attr("data-custom",folders[i].index)),void 0!=page_settings&&!a&&page_settings.hasOwnProperty(n)){var l=page_settings[n];l.hasOwnProperty("index")&&t.attr("data-custom",l.index),l.hasOwnProperty("hidden")&&(o=l.hidden)}var s=0===n.indexOf("_"+(a?"":"_"));if(s&&(o=!0),o&&t.addClass("is-hidden"+(s?" is-name-hidden":"")),t.is('[data-isimage="1"]')){t.find("ul.dropdown-menu").children('[role="presentation"]').after('<li><a href=# class="set-preview">Set as preview image</a></li>'),t.children(".td-name").prepend('<span class="fa fa-flag set-preview" title="Set as folder preview image"></span>')}if(!s){var r=lang(o?"Unhide":"Hide");t.children(".td-name").prepend('<span class="fa fa-eye'+(o?"-slash":"")+' hide-file" title="'+r+'"></span>'),t.find("ul.dropdown-menu").children('[role="presentation"]').after('<li><a href=# class="hide-file">'+r+"</a></li>")}}),manage_container.addClass(T>0?"has-folders":"no-folders").addClass(E>0?"has-files":"no-files").toggleClass("is-empty",0===T&&0===E),x3SetSort(active_gallery_sort,0==active_gallery_sort),x3FileManagerThumbs(),x3FileManagerView(active_gallery_view);var I=i.find(".manage-list-buttons");I.children(".selected-actions").css("min-height",I.children(".list-actions").outerHeight(!0)),I.scrollToFixed({zIndex:5})}function updatePreviewImage(e){var t=e?e.data("name"):null;setTimeout(function(){save_inject({image:t},function(a){if(a&&e){var n=x3_content_show.find('input.form-control.selectized[name="image"]');n.length&&n[0].selectize.addItem(t,!0),e.addClass("preview-image")}},"Updated preview image: "+t,!1)},500)}function setPreviewImageActive(){var e=x3_content_show.children(".x3-manager").not("#page_search");if(e.length){var t=e.find(".manage-table"),a=t.find('tr[data-isimage="1"]');if(t.find("tr.preview-image").removeClass("preview-image"),a.length)if(page_settings.image&&-1===page_settings.image.indexOf("/")){var n=a.filter('[data-name="'+page_settings.image+'"]');if(n.length)n.addClass("preview-image");else if(!page_settings.gallery.assets){updatePreviewImage(n=(i=a.filter('[data-name="preview.jpg"]')).length?i:a.first())}}else if(!page_settings.image&&a.length){var i;updatePreviewImage(n=(i=a.filter('[data-name="preview.jpg"]')).length?i:a.first())}}}function x3FileManagerThumbs(){var e=[],t=window.devicePixelRatio>1?"200":"100",a=x3_content_show.find(".manage-table");a.find("tr").each(function(a,n){n=$(this);e[a]={name:n.data("name"),path:n.data("path").replace("../content/../content/","../content/"),encoded:n.data("encoded"),ext:n.data("ext"),isfile:n.data("isfile"),isimage:n.data("isimage")};var i=e[a].ext.toLowerCase();if(-1!==$.inArray(i,["jpg","jpeg","png","gif"])){var o=e[a].path.replace("../../","../").replace("content","render/w"+t+"-c1:1");p='<td class="td-thumb td-jpg"><span class="glyphicon glyphicon-picture"></span><a href="'+e[a].path.replace("../../","../")+'" class="popup" data-width="'+n.find("a.popup").data("width")+'" data-height="'+n.find("a.popup").data("height")+'" data-name="'+n.find("a.popup").data("name")+'" data-filesize="'+n.find("a.popup").data("filesize")+'" rel="group2"><img src="'+o+'" /></a></td>',n.find(".td-name a").attr("href",e[a].path.replace("../../","../"))}else p="zip"===i?'<td class="td-thumb td-file"><span class="fa fa-file-zip-o"></span></td>':"js"===i||"css"===i?'<td class="td-thumb td-file"><span class="fa fa-code"></span></td>':"mp3"===i?'<td class="td-thumb td-file"><span class="glyphicon glyphicon-volume-up"></span></td>':"mp4"==i?'<td class="td-thumb td-file"><span class="fa fa-film"></span></td>':"1"==e[a].isimage?'<td class="td-thumb td-picture"><span class="glyphicon glyphicon-picture"></span></td>':"1"==e[a].isfile?'<td class="td-thumb td-file"><span class="glyphicon glyphicon-file"></span></td>':'<td class="td-thumb td-folder"><span class="glyphicon glyphicon-folder-close"></span></td>';if(n.find(".td-checkbox").after(p),"1"==e[a].isfile){var l=n.data("title"),s=n.data("description"),r=n.data("link"),d=n.data("link-target");if(void 0!=page_settings&&e[a].name in page_settings){var c=page_settings[e[a].name];c.title&&(l=c.title),c.description&&(s=c.description),c.link&&(r=c.link),c.target&&(d=c.target)}d="auto"!=d&&d;var p;(p=n.children(".td-name")).append('<div class="file-data'+(r?" has-link":"")+'"><i class="fa fa-question panel-help" data-help="image_title"></i><input type="text" class="form-control file-title" placeholder="Title"><i class="fa fa-question panel-help" data-help="image_description"></i><textarea class="form-control" rows="3" placeholder="Description">'+(s||"")+'</textarea><a href=# class="fa fa-link" target=_blank></a><i class="fa fa-question panel-help" data-help="image_link"></i><input type="text" class="form-control file-link" placeholder="Link"><div class="btn-group btn-group-sm" data-toggle="buttons"><label class="btn btn-default'+(d?"":" active")+'" data-name="auto"><input type="radio"'+(d?"":" checked")+'>auto</label><label class="btn btn-default" data-name="_self"><input type="radio">_self</label><label class="btn btn-default" data-name="_blank"><input type="radio">_blank</label><label class="btn btn-default" data-name="popup"><input type="radio">popup window</label><label class="btn btn-default" data-name="x3_popup"><input type="radio">X3 popup</label></div></div>'),l&&p.find(".file-title").val(l),r&&p.find(".file-link").val(r),d&&p.find('[data-name="'+d+'"]').addClass("active").children("input").prop("checked",!0)}else n.children(".td-name").append('<div class="folder-data"><span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span></div>')}),setTimeout(function(){autosize(a.find("textarea"))},1)}var gallery_views,active_gallery_view=supports_local_storage()&&null!==localStorage.getItem("active_gallery_view")?Math.min(4,Number(localStorage.getItem("active_gallery_view"))):1;$(document).ready(function(){gallery_views=[["list","align-justify","btn-xs",language.List],["small","list","btn-sm",language.Small_Thumbs],["big","th-list","btn-sm",language.Large_Thumbs],["edit","pencil","btn-sm",language.Edit_Mode],["grid","th","btn-sm","grid"]]});function x3FileManagerView(e){var t=x3_content_show.find(".manage-container");t.removeClass("view-list view-small view-big view-edit view-grid").addClass("view-"+gallery_views[e][0]),t.siblings(".manage-list-buttons").find(".btn-view > span").removeClass().addClass("glyphicon glyphicon-"+gallery_views[e][1]),t.find(".td-button button").removeClass("btn-xs btn-sm").addClass(gallery_views[e][2]),x3ToggleEditview(3==e)}function x3ToggleEditview(e){x3_content_show.find(".manage-table").find('a, button, input[type="checkbox"]').prop("tabIndex",!e||-1)}x3_content_show.on("click.view",".btn-view",function(e){active_gallery_view=active_gallery_view>=gallery_views.length-1?0:active_gallery_view+1,supports_local_storage()&&localStorage.setItem("active_gallery_view",active_gallery_view),x3FileManagerView(active_gallery_view),x3_content_show.find(".list-actions > .button-helper").text(gallery_views[active_gallery_view][3])}),x3_content_show.hoverIntent({over:function(e){var t=$(this);t.siblings(".button-helper").text(t.data("title")).velocity({opacity:1},{duration:200})},out:function(e){$(this).siblings(".button-helper").text("").velocity("stop").css("opacity",0)},selector:".list-actions > *"}),x3_content_show.on("mouseover",".selected-actions button",function(e){var t=$(this),a=t.closest(".selected-actions").children(".selected-text"),n=t.hasClass("disabled"),i=selected.length+" "+a.data("lang");i=n?i:t.text()+" "+i,a.text(i).addClass(n?"nonselected":"ishover")}).on("mouseout",".selected-actions",function(e){var t=$(this).closest(".selected-actions").children(".selected-text");t.text(selected.length+" "+t.data("lang")).removeClass("ishover nonselected")}),x3_content_show.hoverIntent({over:function(e){var t=$(this);t.data("hover-items")||t.data("hover-items",t.find(".td-button .btn-group, span.set-preview, span.hide-file")),t.data("hover-items").velocity({opacity:1},{duration:200})},out:function(){$(this).data("hover-items").velocity("stop").css("opacity",0)},timeout:200,selector:".manage-table tr"}),x3_content_show.hoverIntent({over:function(e){$(this).find(".dropdown-menu").velocity({opacity:1},{duration:200,display:"block"})},out:function(){$(this).find(".dropdown-menu").velocity("stop").hide()},timeout:200,selector:".td-button .btn-group"});function select_all(){var e=x3_content_show.find(".manage-table tr");files_checked=!files_checked,e.find(".td-checkbox > input").prop("checked",files_checked),selected.length=0,files_checked&&e.each(function(e,t){selected.push($(this).data("name"))}),e.toggleClass("is-checked",files_checked),updateSelectAll(),selectUpdate(),x3SaveSelected()}function updateSelectAll(){var e=x3_content_show.find("#select_all"),t=files_checked?e.data("unselect"):e.data("select");e.toggleClass("active",files_checked).data("title",t),e.siblings(".button-helper").text(t)}function selectUpdate(){var e=x3_content_show.find(".manage-table"),t=x3_content_show.find(".manage-list-buttons"),a=e.find("input:checkbox"),n=a.length,i=a.filter(":checked").length,o=t.find(".selected-text"),l=i>0;o.text(i+" "+o.data("lang")).toggleClass("has-selection",i>0),t.find(".selected-actions button").toggleClass("disabled",!l).toggleClass("btn-primary",l),files_checked&&i<n?(files_checked=!1,updateSelectAll()):files_checked||n!=i||(files_checked=!0,updateSelectAll())}function x3SaveSelected(){page_selected_items[here]=[],x3_content_show.find(".manage-table tr").each(function(e,t){(t=$(this)).hasClass("is-checked")&&page_selected_items[here].push(t.data("name"))}),supports_local_storage()&&localStorage.setItem("selected_"+here,JSON.stringify(page_selected_items[here]))}function x3SetSelected(){var e=[];if(void 0!=page_selected_items[here]&&page_selected_items[here].length>0?e=page_selected_items[here]:supports_local_storage()&&null!==localStorage.getItem("selected_"+here)&&(e=JSON.parse(localStorage.getItem("selected_"+here))),e.length>0){selected.length=0;var t=x3_content_show.find(".manage-table tr");$.each(e,function(e,a){var n=t.filter('[data-name="'+a+'"]');n.length&&(n.addClass("is-checked").find(".td-checkbox > input").prop("checked",!0),selected.push(n.data("name")))}),x3SaveSelected(),selectUpdate()}}x3_content_show.on("click.checkbox",".td-checkbox > input",function(e){var t=$(this);t.closest("tr").toggleClass("is-checked",t.is(":checked")),x3SaveSelected(),selectUpdate()});function x3SetByteSize(){x3_content_show.find(".manage-table tr").each(function(e,t){var a=(t=$(this)).data("filesize")||"";a.indexOf("GB")>-1?a=1e9*parseInt(a):a.indexOf("MB")>-1?a=1e6*parseInt(a):a.indexOf("KB")>-1&&(a=1e3*parseInt(a)),t.attr("data-filesize",parseInt(a)),t.data("filesize",parseInt(a))})}var sortable_files,sortable_folders,gallery_sort=[["sort","-by-alphabet"],["filesize","-by-attributes-alt"],["date","-by-order"],["custom",""]],active_gallery_sort=supports_local_storage()&&null!==localStorage.getItem("active_gallery_sort")?Math.min(3,Number(localStorage.getItem("active_gallery_sort"))):0,is_custom_sort=!1,is_custom_sort_folders=!1;function sort_elements(e,t,a){e.sort(function(e,a){var n=e.getAttribute("data-"+t)-a.getAttribute("data-"+t);return n?"filesize"!=t&&"date"!=t||(n*=-1):n=e.getAttribute("data-sort")-a.getAttribute("data-sort"),n}),e.detach().prependTo(a||table_body)}function reset_sort(){var e={};function t(e){if(x3Notifier("Folder sorting reset to alphabetic order",null,null,"success"),sort_elements(rows_folders,"sort"),rows_folders.removeAttr("data-custom"),!e){var t=x3_panel_container.find("#left_folder_menu_box"),a=current_dir_path?t.find('li[data-dir="'+current_dir_path+'"]').children("ul"):t.children("ul"),n=a.children(":not(#_custom)");n.length&&(n.attr("data-custom","0"),sort_elements(n,"sort",a))}}rows_folders.each(function(){var t=get_content_path(this.getAttribute("data-path")),a=this.getAttribute("data-custom");t&&a&&folders.hasOwnProperty(t)&&folders[t].hasOwnProperty("index")&&0!==folders[t].index&&(e[t]={index:0})}),Object.keys(e).length?set_folders(e,t):t(!0),reset_sort_button.addClass("disabled")}var rows_folders,rows_files,table_body,manage_container,reset_sort_button;function x3SetSort(e,t){var a=gallery_sort[e][0];t||sort_elements(rows_files,a),sort_elements(rows_folders,a),toggleSortButton(e),"custom"===a&&(rows_files.length||rows_folders.length)?manage_container.hasClass("custom-sort")||(manage_container.prepend('<div class=custom-sort-help><a href=# class="text-help" data-help="custom_sort">Custom Sort</a><span class="can-sort"> - Drag items into order, and click <em>save</em>.</span></div>'),manage_container.addClass("custom-sort"),sortable_files=rows_files.length>1&&add_custom_sort(!0),sortable_folders=rows_folders.length>1&&add_custom_sort()):manage_container.hasClass("custom-sort")&&(manage_container.children(".custom-sort-help").remove(),manage_container.removeClass("custom-sort"),sortable_files&&sortable_files.destroy(),sortable_folders&&sortable_folders.destroy());var n="custom"===a&&rows_folders.length>1,i=manage_container.parent().children(".manage-list-buttons"),o=rows_folders.last(),l=n&&o.attr("data-custom")&&"0"!==o.attr("data-custom");(reset_sort_button=i.find(".reset-sort")).toggleClass("hidden",!n).toggleClass("disabled",!l),i.find(".button-helper").toggleClass("hidden",n)}function add_custom_sort(e){return Sortable.create(table_body[0],{filter:e?".is-folder":".is-file",draggable:e?".is-file":".is-folder",animation:100,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",onStart:function(e){manage_container.addClass("is-sorting")},onEnd:function(t){e&&(is_custom_sort=!0),e||(is_custom_sort_folders=!0),manage_container.removeClass("is-sorting"),setTimeout(function(){},100);for(var a=e?'[data-isfile="1"]':'[data-isfile="0"]',n=table_body.children("tr").filter(a),i=!0,o=e?rows_folders.length:0,l=0;l<n.length;l++)n[l].setAttribute("data-custom",l+1),i&&l+o!==parseInt(n[l].getAttribute("data-sort"))&&(i=!1);i&&n.attr("data-custom","0"),i||e||reset_sort_button.removeClass("disabled")}})}function toggleSortButton(e){var t=x3_content_show.find(".btn-sort");t.html('<span class="glyphicon glyphicon-sort'+gallery_sort[e][1]+'"></span> '+t.data(gallery_sort[e][0])).data("title",t.data("sortby")+" "+t.data(gallery_sort[active_gallery_sort][0]))}x3_content_show.on("click.sort",".btn-sort",function(e){active_gallery_sort=active_gallery_sort>=gallery_sort.length-1?0:active_gallery_sort+1,supports_local_storage()&&localStorage.setItem("active_gallery_sort",active_gallery_sort),x3SetSort(active_gallery_sort),x3_content_show.find(".list-actions > .button-helper").text($(this).data("title"))}),x3_content_show.on("click.sort",".reset-sort:not(.disabled)",reset_sort),x3_navbar_nav.on("click.pageclass","li:not(.dropdown)",function(e){var t=$(this).attr("id");x3_panel_container.toggleClass("fileManager","fileManager"==t),current_nav=t,supports_local_storage()&&void 0!==t&&localStorage.setItem("current_nav",t)});function x3NavPage(){if(current_nav="fileManager",supports_local_storage()){var e=localStorage.getItem("current_nav");null!==e?"setting"==e?(showSetting(),current_nav="setting"):"users"==e?(showUsers(),current_nav="users"):"editProfile"==e?(showEditProfile(),current_nav="editProfile"):"protect"==e?(protectPage(),current_nav="protect"):"tools"==e?(showTools(),current_nav="tools"):"auth"==e?(authPage(),current_nav="auth"):x3ShowFileManager():x3ShowFileManager()}else x3ShowFileManager();"fileManager"===current_nav&&x3_panel_container.addClass("fileManager")}function x3Notifier(e,t,a,n){var i="danger"==n?"ban":"warning"==n?"warning":"check";$.bootstrapGrowl('<i class="fa fa-'+i+'"></i>&nbsp;&nbsp;'+e||"nothing.",{type:n||"info x3-note",offset:{from:"bottom",amount:20},align:"right",width:a||"auto",delay:t||1e3,allow_dismiss:!1})}var x3_settings=supports_local_storage()&&null!==localStorage.getItem("x3_settings")?JSON.parse(localStorage.getItem("x3_settings")):{};function x3UpdateSettings(e){$.extend(x3_settings,e),supports_local_storage()&&localStorage.setItem("x3_settings",JSON.stringify(x3_settings))}x3_content_show.on("click","a.popup",function(e){e.preventDefault();var t=$(this),a=t.closest(".popup-parent"),n=t.closest("tr").index('tr[data-isimage="1"]'),i=t.attr("rel"),o=[];(void 0===i?t:a.find('a.popup[rel="'+i+'"]')).each(function(e,t){var a="<span>"+(t=$(this)).data("name")+"</span><span>"+t.data("width")+" x "+t.data("height")+"</span><span>"+t.data("filesize")+"</span>",n=t.closest("tr").find(".file-data"),i=n.children("input").val(),l=n.children("textarea").val();(i||l)&&(a+="<div>",i&&(a+="<span class=caption-title>"+i+"</span>"),l&&(a+=l),a+="</div>"),o.push({src:t.attr("href"),w:t.data("width"),h:t.data("height"),title:a})});var l={index:n,showHideOpacity:!0,bgOpacity:.95,history:!1,barsSize:{top:0,bottom:0},captionEl:!0,shareEl:!1};new PhotoSwipe(pswp[0],PhotoSwipeUI_Default,o,l).init()}),supports_local_storage()&&(null!==localStorage.getItem("last_user")&&localStorage.getItem("last_user")!==user&&(localStorage.removeItem("current_nav"),localStorage.removeItem("current_page")),localStorage.setItem("last_user",user));function lang(e){if(e){var t=e.replace(/\s+/g,"_");return language[t]?language[t]:e}}var ajax_load_path="user"===user?"filemanager_user/":"";function navigate_to_path(e){if(""==e)return alert(lang("Select_nav_error")),!1;"../"==e&&(e=""),show_preloader(),setTimeout(function(){hide_preloader(),showFileManager(e)},1e3)}function copy_selected(){console.log("new_name1: "+new_name),console.log("COPY > From: "+here+" > TO: "+new_name),new_name?(x3_modal_copy_selected.find("#selected_copy").val(""),x3_modal_copy_selected.modal("hide"),show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{copy_selected:selected,this_path:here,copy_path:new_name},function(e,t){"success"==t?(have_action="yes","true"==e?(loading_from_file=lang("Files and folders has been copied."),loading_from_file_status="green",reload_sidebar=!0,update_folders_key_array(selected,here,new_name,!0)):(loading_from_file='<div class="alert alert-error"><center>'+lang("Error! Can not copy")+" "+e+".</center></div>",loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3)):alert("Please input path!")}function move_selected(){console.log("MOVE_SELECTED > From: "+here+" > TO: "+new_name),new_name?(x3_modal_move_selected.modal("hide"),show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{move_selected:selected,this_path:here,move_path:new_name},function(e,t){have_action="yes","success"==t?("true"==e?(loading_from_file=lang("Files and folders has been moved."),loading_from_file_status="green",reload_sidebar=!0,update_folders_key_array(selected,here,new_name,!1)):(loading_from_file=lang("Error! Can not move")+" "+e+".",loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3)):alert("Please input path!")}function remove_selected(){x3_modal_remove_selected.modal("hide"),show_preloader(),console.log("remove_selected: "+selected),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{remove_selected:selected,this_path:here},function(e,t){"success"==t?(have_action="yes","true"==e?(loading_from_file=lang("Files and folders has been removed."),loading_from_file_status="green",reload_sidebar=!0,remove_folders_key(selected,here)):(loading_from_file=lang("Error! Can not remove")+" "+e+". "+lang("Please Wait..."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3)}function showUploader(e){console.log("showUploader("+e+")"),$.post(ajax_load_path+"filemanager_uploader.php",{upload_dir:e},function(e,t){"success"==t?x3_modal_uploader.find("#show_uploader").html(e):alert("Error: "+t)})}function set_new_zipFile_name(e){if(-1!=e.indexOf(".zip"))return alert(lang("Please write zip file name without extension.")),!1;zip_file_name=e}function set_selected(e,t,a){var n=$.inArray(e,selected);a?-1===n&&selected.push(e):n>-1&&selected.splice(n,1)}function removeItem(e,t){var a=$.inArray(t,e);a>-1&&e.splice(a,1)}function in_array(e,t){return $.inArray(t,e)>-1}function cleanArray(e){for(var t=new Array,a=0;a<e.length;a++)e[a]&&t.push(e[a]);return t}function check_is_real_root(){return".."==core_user_dir||"../"==core_user_dir}function show_this_dir_file(e,t,a,n,i){0==e?(page=1,this_dir_path=n,showFileManager(this_dir_path)):0==a&&window.open(ajax_load_path+"download.php?show="+i,ajax_load_path+"download.php?show="+i)}function rename_file(e,t,a){filext=e.substr((Math.max(0,e.lastIndexOf("."))||1/0)+1),filext="."+filext;var n=t.replace(/\.[^/.]+$/,"");if(console.log("new_name1: "+new_name),"first"==a)is_rename=!0,x3_show_conf.find("#confLable").html(lang("Rename")+" "+t),x3_show_conf.find("#container_id_tree").html(lang("Write a new name.")),x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control" id="rename_new_name" placeholder="'+lang("New File Name")+'" style="float: left; margin-top: 0px;" onchange="is_rename = true; set_new_name(this.value);" value="'+n+'" /><input type="hidden" class="input-small" id="rename_new_ext" value="'+filext+'" style="float: left; margin-top: 0px;" onchange="//filext = this.value;"/></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+lang("Cancel")+'</button><button class="btn btn-success btn-key" onclick="rename_file(\''+e+"', '"+t+"', 'r')\">"+lang("Rename")+"</button></div></div>");else if("move"==a)x3_show_conf.find("#confLable").html(lang("Move")+" "+t),x3_show_conf.find("#container_id_tree").html(lang("Choose your target directory.")),old_name=e.replace(here,""),old_name=old_name.replace(filext,""),is_move=!0,x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control input-move" id="rename_new_name" placeholder="'+lang("New File Path")+'" style="float: left; margin-top: 0px;" onchange="is_move = true; set_new_name(this.value);"/><input type="hidden" class="input-small" id="rename_new_ext" value="'+filext+'" style="float: left; margin-top: 0px;" onchange="//filext = this.value;"/></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+lang("Cancel")+'</button><button class="btn btn-info" onclick="showInlineTree()">'+lang("Browse")+'</button><button class="btn btn-success" onclick="rename_file(\''+e+"', '"+t+"', 'm')\">"+lang("Move")+"</button></div></div>");else{x3_show_conf.modal("hide");new_name;if(!is_move){var i=e.split("/");i[i.length-1]=i[i.length-1].replace(t,new_name),new_name=i.join("/")}console.log("rename_file("+e+", "+t+")"),console.log("new_name2: "+new_name),new_name=normalize_new_name(new_name),console.log("new_name3: "+new_name),show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{filename:e,newName:new_name},function(e,t){if(have_action="yes","success"==t){if("true"==e){if("r"==a)var n=lang("File has been renamed");if("m"==a)n=lang("File has been moved");loading_from_file=n,loading_from_file_status="green"}else{if("r"==a)n=lang("File has not been renamed");if("m"==a)n=lang("File has not been moved");loading_from_file=n,loading_from_file_status="red"}"true"==is_root?showFileManager(""):showFileManager(here)}else alert("Error: "+t),hide_preloader()})},1e3)}}function copy_file(e,t,a){if(filext=e.substr((Math.max(0,e.lastIndexOf("."))||1/0)+1),filext="."+filext,"first"==a)x3_show_conf.find("#confLable").html(lang("Copy")+" "+t),x3_show_conf.find("#container_id_tree").html(lang("Choose your target directory.")),old_name=e.replace(here,""),old_name=old_name.replace(filext,""),x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control" id="copy_new_name" placeholder="'+lang("New Folder Path")+'" style="float: left; margin-top: 0px;" onchange="set_new_name(this.value);"/></div><input type="hidden" class="form-control" id="rename_new_ext" value="'+filext+'" style="float: left; margin-top: 0px;" onchange="//filext = this.value;"/><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+lang("Cancel")+'</button><button class="btn btn-info" onclick="showInlineTree()">'+lang("Browse")+'</button><button class="btn btn-success" onclick="copy_file(\''+e+"', '"+t+"', 'rename')\">"+lang("Copy")+"</button></div></div>");else{x3_show_conf.modal("hide");new_name;console.log("copy_file("+e+", "+t+")"),console.log("new_name2: "+new_name),new_name=normalize_new_name(new_name),console.log("new_name3: "+new_name),show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{filename:e,newName:new_name,copy_this:"ok"},function(e,t){have_action="yes","success"==t?("true"==e?(loading_from_file=lang("File has been copied."),loading_from_file_status="green"):(loading_from_file=lang("File has not been copied."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3)}}function remove_file(e,t,a){console.log("remove_file("+e+", "+t+")"),"first"==a?(x3_show_conf.find("#confLable").html(lang("Remove")+" "+t),x3_show_conf.find("#container_id_tree").html(lang("Do you want to remove this file")),x3_show_conf.find("#confButton").html('<button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+lang("Cancel")+'</button><button class="btn btn-danger" onclick="remove_file(\''+e+"', '"+t+"','rename')\">"+lang("Remove")+"</button>")):(x3_show_conf.modal("hide"),show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{removeFileName:e},function(e,t){have_action="yes","success"==t?("true"==e?(loading_from_file=lang("File has been deleted."),loading_from_file_status="green"):(loading_from_file=lang("File has not been deleted."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3))}function addslashes(e){return e.replace(/\\/g,"\\\\").replace(/\u0008/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/'/g,"\\'").replace(/"/g,'\\"')}function mkdir(e){x3_modal_new_folder.modal("hide"),show_preloader();var t=e||here,a={mkdir_path:new_folder_path,this_place:t};console.log("mkdir("+e+")"),console.log("new_here: "+t),console.log("new_folder_path: "+new_folder_path);["title","label","link","target"].forEach(function(e){var t=x3_modal_new_folder.find("#new_folder_"+e).val();t&&"auto"!=t&&(a[e]=t)});var n=x3_modal_new_folder.find("#new_folder_hidden").prop("checked");if(n){a.hidden=!0;var i=get_content_path(t+"/"+new_folder_path)}setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",a,function(e,a){"success"==a?(have_action="yes",reload_sidebar=!0,"already"===e?(loading_from_file=lang("already exists."),loading_from_file_status="red"):"true"==e?(loading_from_file=lang("Folder has been created."),loading_from_file_status="green",n&&add_folders_key(i,{hidden:!0})):(loading_from_file=lang("Folder has not been created."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(t)):(alert("Error: "+a),hide_preloader())}),new_folder_path=""},100)}function create_zip(){console.log("create_zip("+here+"/"+zip_file_name+")"),""==selected||null==selected?alert(lang("Please select files and folders")):(x3_modal_new_zip_file.modal("hide"),show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{create_zip:selected,this_place:here,zip_name:zip_file_name},function(e,t){"success"==t?("true"==e?(loading_from_file=lang("Zip file has been created."),loading_from_file_status="green"):(loading_from_file=lang("Zip file has not been created."),loading_from_file_status="red"),showFileManager(here)):(alert("Error: "+t),hide_preloader())}),zip_file_name=""},1e3))}function set_new_name(e){if(1==is_rename){"super"===user&&(is_rename=!1);if(-1!=e.indexOf("/"))return alert(lang("Please write new folder/file name.")),!1}if(1==is_move){if(-1==e.indexOf("/"))return alert(lang("Please write new folder/file path.")),!1}if(-1!=e.indexOf("'"))return alert(lang("Please don't use quotation in server folders.")),!1;if(-1!=e.indexOf('"'))return alert(lang("Please don't use quotation in server folders.")),!1;var t=x3_show_conf.find("#rename_new_ext");t.length&&(filext=t.val()),new_name=e.replace(/\/\//g,"/")+filext,console.log("set_new_name: "+new_name),filext=""}function rename_dir(e,t,a){var n=(e=filemanager_slash_fix(e)).match(".index$")||e.match("/index$")?'<div class="alert alert-danger" role="alert">Are you sure you want to rename the index home page?</div>':"";if("first"==a)x3_show_conf.find("#confLable").html(lang("Rename")+" "+t),x3_show_conf.find("#container_id_tree").html(n+lang("Write a new name.")+"<div class=modal-help>* Make sure to save any unsaved settings before you rename a folder.</div>"),x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control is-dir" id="rename_new_name" placeholder="'+lang("New Folder Name")+'" style="float: left; margin-top: 0px;" onchange="is_rename = true; set_new_name(this.value);" value="'+t+'" /></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+lang("Cancel")+'</button><button class="btn btn-success btn-key" onclick="rename_dir(\''+e+"', '"+t+"', 'r')\">"+lang("Rename")+"</button></div></div>");else if("move"==a)x3_show_conf.find("#confLable").html(lang("Move")+" "+t),x3_show_conf.find("#container_id_tree").html(lang("Choose your target directory.")),old_name=e.replace(here,""),old_name=old_name.replace(filext,""),is_move=!0,x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control is-dir" id="rename_new_name_dir" placeholder="'+lang("New Folder Path")+'" style="float: left; margin-top: 0px;" onchange="is_move = true; set_new_name(this.value);"/></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+lang("Cancel")+'</button><button class="btn btn-info" onclick="showInlineTree()">'+lang("Browse")+'</button><button class="btn btn-success" onclick="is_move = true; rename_dir(\''+e+"', '"+t+"', 'm')\">"+lang("Move")+"</button></div></div>");else{if(console.log("[RENAME/MOVE]"),!new_name)return alert("Please input a new "+(is_move?"path":"name")+"!"),void(is_move=!1);x3_show_conf.modal("hide"),here==e&&is_move&&(new_name=new_name.replace("../",""));var i=new_name;if(!is_move){var o=e.split("/");o[o.length-1]=o[o.length-1].replace(t,new_name),new_name=o.join("/")}here==e&&is_move&&(new_name=new_name+"/"+t);var l=here;console.log("new_name2: "+new_name),new_name=normalize_new_name(new_name),console.log("new_name3: "+new_name),0===new_name.indexOf(e)&&is_move?(new_name="",is_move=!1,alert("Can't move folder into itself!")):(is_move=!1,show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{dirname:e,newName:new_name},function(n,o){if(have_action="yes","success"==o){if("true"==n){if("r"==a)var s=lang("Folder has been renamed.");if("m"==a)s=lang("Folder has been moved.");this_dir_path=new_name.replace(i,""),e==l&&"m"==a&&(this_dir_path=e.replace(t,"")),e==l&&"r"==a&&(this_dir_path=new_name),loading_from_file=s,loading_from_file_status="green",reload_sidebar=!0;var r=e.split("/"),d="menu_"+r[r.length-1].replace(".","_"),c="menu_"+i.replace(".","_"),p=x3_mtree.find("#"+d);p.length&&p.hasClass("mtree-open")&&(p.attr("id",c),mtreeSaveState()),update_folders_key(e,new_name,!1)}else{if("r"==a)s=lang("Folder has not been renamed.");if("m"==a)s=lang("Folder has not been moved.");this_dir_path=e.replace(t,""),loading_from_file=s,loading_from_file_status="red"}"true"==is_root?showFileManager(""):showFileManager(this_dir_path)}else alert("Error: "+o),hide_preloader()})},1e3))}}function normalize_new_name(e){if(console.log("normalize_new_name("+e+")"),e.indexOf("/content/")>-1)e=e.split("/content/")[1];else if(e.indexOf("./")>-1){var t=e.split("./");e=t[t.length-1]}return e=("super"===user?"":"../")+("../content/"+e).replace(/\/\//g,"/").replace(/\/$/,""),console.log("normalized: "+e),e}function copy_dir(e,t,a){if(e=filemanager_slash_fix(e),"first"==a)x3_show_conf.find("#confLable").html(lang("Copy")+" "+t),x3_show_conf.find("#container_id_tree").html(lang("Choose your target directory.")),old_name=e.replace(here,""),old_name=old_name.replace(filext,""),x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control" id="copy_new_name_dir" placeholder="'+lang("New Folder Path")+'" style="float: left; margin-top: 0px;" onchange="set_new_name(this.value);"/></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+lang("Cancel")+'</button><button class="btn btn-info" onclick="showInlineTree()">'+lang("Browse")+'</button><button class="btn btn-success" onclick="copy_dir(\''+e+"', '"+t+"', 'rename')\">"+lang("Copy")+"</button></div></div>");else{if(console.log("copy_dir("+e+")"),console.log("new_name1: "+new_name),!new_name)return alert("Please input a new path!"),void(is_move=!1);x3_show_conf.modal("hide"),here==e&&(new_name=new_name.replace("../",""));var n=new_name;console.log("new_name2: "+new_name),here==e&&(new_name=new_name+"/"+t);var i=here;new_name=normalize_new_name(new_name),console.log("new_name3: "+new_name),0===new_name.indexOf(e)?(alert("Can't copy dir into itself!"),new_name=""):(show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{dirname:e,newName:new_name,copy_this:"ok"},function(a,o){have_action="yes","success"==o?("true"==a?(this_dir_path=new_name.replace(n,""),reload_sidebar=!0,loading_from_file=lang("Folder has been copied."),loading_from_file_status="green",update_folders_key(e,new_name,!0)):(this_dir_path=e.replace(t,""),loading_from_file=lang("Folder has not been copied."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):(i==e&&(this_dir_path=i),showFileManager(this_dir_path))):(alert("Error: "+o),hide_preloader())})},1e3))}}function remove_dir(e,t,a){var n=(e=e.replace(/\/$/,"")).match(".index$")||e.match("/index$")?'<div class="alert alert-danger" role="alert">Are you sure you want to delete your home page?</div>':"";"first"==a?(x3_show_conf.find("#confLable").html(lang("Remove")+" "+t),x3_show_conf.find("#container_id_tree").html(n+lang("Do you want to remove this folder")),x3_show_conf.find("#confButton").html('<button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+lang("Cancel")+'</button><button class="btn btn-danger" onclick="remove_dir(\''+e+"', '"+t+"','rename')\">"+lang("Remove")+"</button>")):(console.log("remove_dir("+e+")"),e=normalize_new_name(e),console.log("normalize_new_name(name) == "+e),x3_show_conf.modal("hide"),show_preloader(),setTimeout(function(){$.post(ajax_load_path+"ajax_manage_dir.php",{removeDirName:e},function(a,n){if(have_action="yes","success"==n){"true"==a?(reload_sidebar=!0,loading_from_file=lang("Folder has been deleted."),loading_from_file_status="green",remove_folders_key(e)):(loading_from_file=lang("Folder has not been deleted."),loading_from_file_status="red");var i=e.split("/");i[i.length-1]=i[i.length-1].replace(t,""),this_dir_path=i.join("/"),"true"==is_root?showFileManager(""):showFileManager(this_dir_path)}else alert("Error: "+n),hide_preloader()})},1e3))}function showInlineTree(){if("super"===user){var e=root_dir_name_parent_count;container_id_tree.is(":visible")&&container_id_tree.fileTree({root:root_dir_name+"/",script:ajax_load_path+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(t){var a="";if("truez"==is_root)var n=t.replace(root_dir_name+"/","");else{n=t.replace(root_dir_name+"/","../");var i=here.split("/");removeItem(i,""),i=i.length;var o=here.split("/");removeItem(o,""),i-=2;for(var l=0;l<o.length;l++)if(""==o[l]&&l!=o.length-1){i+=2,i-=3;break}if(i>=1)for(var s=e;s<i;s++)a+="../"}n=n.substring(0,n.length-1);var r=x3_show_conf.find("#copy_new_name");r.length&&("true"==is_root?r.val(n+old_name):r.val(a+n+old_name),filext=x3_show_conf.find("#rename_new_ext"));var d=x3_show_conf.find("#rename_new_name");d.length&&("true"==is_root?d.val(n+old_name):d.val(a+n+old_name),filext=x3_show_conf.find("#rename_new_ext"));var c=x3_show_conf.find("#copy_new_name_dir");c.length&&("true"==is_root?c.val(n+old_name):c.val(a+n+old_name),filext="");var p=x3_show_conf.find("#rename_new_name_dir");p.length&&("true"==is_root?p.val(n+old_name):p.val(a+n+old_name),filext=""),set_new_name(a+n+old_name)}),container_id_tree2.is(":visible")&&container_id_tree2.fileTree({root:root_dir_name+"/",script:ajax_load_path+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(t){var a="";if("true"==is_root)var n=t.replace(root_dir_name+"/","");else{n=t.replace(root_dir_name+"/","../");var i=here.split("/");removeItem(i,""),i=i.length;var o=here.split("/");removeItem(o,""),i-=2;for(var l=0;l<o.length;l++)if(""==o[l]&&l!=o.length-1){i+=2,i-=3;break}if(i>=1)for(var s=e;s<i;s++)a+="../"}n=n.substring(0,n.length-1);var r=x3_modal_move_selected.find("#selected_move");r.length&&("true"==is_root?r.val(n+old_name):r.val(a+n+old_name)),set_new_name(a+n)}),container_id_tree3.is(":visible")&&container_id_tree3.fileTree({root:root_dir_name+"/",script:ajax_load_path+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(t){var a="";if("true"==is_root)var n=t.replace(root_dir_name+"/","");else{n=t.replace(root_dir_name+"/","../");var i=here.split("/");removeItem(i,""),i=i.length;var o=here.split("/");removeItem(o,""),i-=2;for(var l=0;l<o.length;l++)if(""==o[l]&&l!=o.length-1){i+=2,i-=3;break}if(i>=1)for(var s=e;s<i;s++)a+="../"}n=n.substring(0,n.length-1);var r=x3_modal_copy_selected.find("#selected_copy");r.length&&("true"==is_root?r.val(n+old_name):r.val(a+n+old_name)),set_new_name(a+n)})}else container_id_tree.is(":visible")&&container_id_tree.fileTree({root:map_path,script:ajax_load_path+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(e){var t="",a=e,n=here.split("/");removeItem(n,""),n=n.length;var i=here.split("/");removeItem(i,""),n-=2;for(var o=0;o<i.length;o++)if(""==i[o]&&o!=i.length-1){n+=2,n-=3;break}if(n>=1)for(var l=0;l<n;l++)t+="../";a=a.substring(0,a.length-1);var s=x3_show_conf.find("#copy_new_name");if(s.length){var r=(u=a.split("/")).indexOf(user_folder_name);for(l=0;l<=r;l++)delete u[l];h=(h=cleanArray(u)).join("/"),s.val(h+old_name),filext=x3_show_conf.find("#rename_new_ext").val()}var d=x3_show_conf.find("#rename_new_name");if(d.length){for(r=(u=a.split("/")).indexOf(user_folder_name),l=0;l<=r;l++)delete u[l];h=(h=cleanArray(u)).join("/"),d.val(h+old_name),filext=x3_show_conf.find("#rename_new_ext").val()}var c=x3_show_conf.find("#copy_new_name_dir");if(c.length){for(r=(u=a.split("/")).indexOf(user_folder_name),l=0;l<=r;l++)delete u[l];h=(h=(h=cleanArray(u)).join("/")).replace("//","/"),c.val(h+old_name),filext=""}var p=x3_show_conf.find("#rename_new_name_dir");if(p.length){var u;for(r=(u=a.split("/")).indexOf(user_folder_name),l=0;l<=r;l++)delete u[l];var h;h=(h=cleanArray(u)).join("/"),p.val(h+old_name),filext=""}var f=t+a;f.split("../").length-1<=1&&check_is_real_root()&&(f=f.replace("../","")),set_new_name(a+"/"+old_name)}),container_id_tree2.is(":visible")&&container_id_tree2.fileTree({root:map_path,script:ajax_load_path+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(e){var t="",a=e,n=here.split("/");removeItem(n,""),n=n.length;var i=here.split("/");removeItem(i,""),n-=2;for(var o=0;o<i.length;o++)if(""==i[o]&&o!=i.length-1){n+=2,n-=3;break}if(n>=1)for(var l=0;l<n;l++)t+="../";a=a.substring(0,a.length-1);var s=x3_modal_move_selected.find("#selected_move");if(s.length){var r=a.split("/"),d=r.indexOf(user_folder_name);for(l=0;l<=d;l++)delete r[l];var c=cleanArray(r);c=(c=c.join("/")).replace("//","/"),s.val(c+old_name)}var p=t+a;p.split("../").length-1<=1&&check_is_real_root()&&(p=p.replace("../","")),set_new_name(a)}),container_id_tree3.is(":visible")&&container_id_tree3.fileTree({root:map_path,script:ajax_load_path+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(e){var t="",a=e,n=here.split("/");removeItem(n,""),n=n.length;var i=here.split("/");removeItem(i,""),n-=2;for(var o=0;o<i.length;o++)if(""==i[o]&&o!=i.length-1){n+=2,n-=3;break}if(n>=1)for(var l=0;l<n;l++)t+="../";a=a.substring(0,a.length-1);var s=x3_modal_copy_selected.find("#selected_copy");if(s.length){var r=a.split("/"),d=r.indexOf(user_folder_name);for(l=0;l<=d;l++)delete r[l];var c=cleanArray(r);c=c.join("/"),s.val(c+old_name)}var p=t+a;p.split("../").length-1<=1&&check_is_real_root()&&(p=p.replace("../","")),set_new_name(a)})}function showFileManager(e){"undefined"==typeof my_sort&&(my_sort="name"),"undefined"==typeof loading_from_file_status&&(loading_from_file_status="blue"),"undefined"==typeof page&&(page=1),"undefined"==typeof countShow&&(countShow=10),"undefined"==typeof search&&(search=""),"undefined"==typeof have_action&&(have_action="no");var t="super"===user?root_dir_name:"../",a=""==e||e==t?1:0;0==loading_from_file&&preloader.modal("show"),x3BeforeShowFileManager(),$.post(ajax_load_path+"ajax_show_filemanager.php",{showFilemanager:"super"===user?core_admin_id:core_user_id,root:a,my_dir_path:e,sort_type:my_sort,page:page,countShow:countShow,have_action:have_action,search:search},function(t,a){if(t.trim())if("success"==a){var n=x3_content_show.find("#show_left_sidebar");!0!==first_flag&&n.length>0&&(first_flag=n.html()),main_menu_active("#fileManager"),0==loading_from_file?preloader.modal("hide"):show_errors_on_nav(loading_from_file,loading_from_file_status),loading_from_file=!1,search="",have_action="no",x3_content_show.show(),x3_content_show.html(t);var i=x3_content_show.find("#show_left_sidebar");reload_sidebar?show_left_folder_menu():1==first_flag?(left_sidebar.children("#left_folder_menu_box").appendTo(i),first_flag=i.html()):(i.html(first_flag),updateMtree()),lick=!0,x3AfterShowFileManager(e)}else lick=!0,alert("<center>Can not load page, click to exit. SERVER STATUS: "+a+"</center>");else window.location.replace("login.php")})}function show_left_folder_menu(){if(reload_sidebar){reload_sidebar=!1;var e=x3_content_show.find("#show_left_sidebar");e.children("#left_folder_menu_box").remove(),left_sidebar.html('<div id="left_folder_menu_box"></div>');var t=left_sidebar.children("#left_folder_menu_box");e.html("Please wait..."),t.load("x3_menu.php",{dir:"super"===user?root_dir_name+"/":core_user_dir+"/",user:user},function(){e.html(""),t.appendTo(e),createMtree(),first_flag=e.html()})}else left_sidebar.children("#left_folder_menu_box").load("x3_menu.php",{dir:"super"===user?root_dir_name+"/":core_user_dir+"/",user:user},function(e){createMtree(),initShowFileManager()})}function showSetting(){preloader.modal("show"),$.post(ajax_load_path+"ajax_show_setting.php",{showSetting:"super"===user?core_admin_id:core_user_id},function(e,t){if(!e.trim())return window.location.replace("login.php"),!1;"success"==t?(main_menu_active("#setting"),preloader.modal("hide"),x3_content_show.show(),x3_content_show.html(e)):alert("<center>Can not load page, click to exit. SERVER STATUS: "+t+"</center>")})}function showEditProfile(){preloader.modal("show"),$.post(ajax_load_path+"ajax_show_profile.php",{showProfile:"super"===user?core_admin_id:core_user_id},function(e,t){"success"==t?(main_menu_active("#editProfile"),preloader.modal("hide"),x3_content_show.show(),x3_content_show.html(e)):alert("<center>Can not load page, click to exit. SERVER STATUS: "+t+"</center>")})}function showUsers(){preloader.modal("show"),$.post(ajax_load_path+"ajax_show_users.php",{showUser:"super"===user?core_admin_id:core_user_id},function(e,t){"success"==t?(main_menu_active("#users"),preloader.modal("hide"),x3_content_show.show(),x3_content_show.html(e)):alert("<center>Can not load page, click to exit. SERVER STATUS: "+t+"</center>")})}function showAddUser(){console.log("showAddUser()"),preloader.modal("show"),$.post(ajax_load_path+"ajax_add_user.php",{showAddUser:"super"===user?core_admin_id:core_user_id},function(e,t){"success"==t?(main_menu_active("#users"),preloader.modal("hide"),x3_content_show.show(),x3_content_show.html(e)):alert("<center>Can not load page, click to exit. SERVER STATUS: "+t+"</center>")})}function show_errors_on_nav(e,t){"red"==t?t="#D9534F":"green"==t?t="#5CB85C":"blue"==t&&(t="#428BCA"),x3_scroll_top(),x3_welcome.attr("data-content","<center><span style='color: "+t+";'>"+e+"</span></center>"),x3_welcome.popover("show"),setTimeout(function(){x3_welcome.popover("hide")},3e3)}function show_preloader(){x3_scroll_top(),x3_win.scrollTop()>75&&x3_html.velocity("stop").velocity("scroll",{duration:500,easing:"easeInOutCubic",complete:function(){button_is_hidden||(button_is_hidden=!0,scroll_button.velocity("stop").velocity("fadeOut",{duration:200}))}}),x3_welcome.attr("data-content","<center><img src='filemanager_assets/img.php?img=preloader'/></center>"),x3_welcome.popover("show")}function hide_preloader(){x3_scroll_top(),x3_welcome.attr("data-content",""),x3_welcome.popover("hide")}x3_navbar_nav.children("#editProfile").add(x3_navbar_container.find(".editProfile")).click(function(e){loading_from_file=!1,showEditProfile()}),x3_navbar_nav.children("#fileManager").click(function(e){loading_from_file=!1,page=1,x3ShowFileManager()}),x3_navbar_nav.children("#setting").click(function(e){loading_from_file=!1,showSetting()}),x3_navbar_nav.children("#users").click(function(e){loading_from_file=!1,showUsers()}),x3_navbar_nav.children("#addUser").click(function(e){loading_from_file=!1,showAddUser()}),x3_navbar_nav.find('a[href="#"]').click(function(e){e.preventDefault()}),x3_footer.after('<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button><button class="pswp__button pswp__button--share" title="Share"></button><button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button><button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button><button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div>');var pswp=x3_body.children(".pswp");$(function(){if(session_maxlifetime&&session_maxlifetime>=300){var e=Math.round(800*session_maxlifetime);function t(){$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",data:{session_refresh:!0}}).done(function(a){a&&a.success&&setTimeout(t,e)})}setTimeout(t,e)}}),selected_lang&&supports_local_storage&&localStorage.setItem("selected_lang",selected_lang);function preventJSClick(e){if((e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)&&void 0!==e.currentTarget.href&&e.currentTarget.href.length>0)return!0}function filemanager_slash_fix(e){return e.replace(/\/\/+/g,"/").replace(/\/$/,"")}var protectPage,protectPageAfter;$(function(){var e=[],t=!1,a=supports_local_storage()&&null!==localStorage.getItem("protected_tab")?localStorage.getItem("protected_tab"):"#protect-access";x3_content_show.on("keyup","#form-users .row:first-child input",function(e){var t=$(this).closest(".row"),a=t.find("#users_username_form").val(),n=t.find("#users_password_form").val();if(a.length>0&&n.length>0&&t.is(":first-child")){var i=x3_content_show.find("#protect-users #form-users");i.prepend(s("","")),i.find(".row:first-child").css("display","none").velocity("slideDown",{duration:500,delay:10,easing:"easeOutQuart"})}}),x3_content_show.on("click",".x3-protect .btn-remove",function(e){var t=$(this).closest(".row");t.velocity("slideUp",{duration:200,complete:function(){t.remove()}})}),x3_navbar_nav.on("click","#protect",function(e){e.preventDefault(),protectPage()}),x3_content_show.on("click",".btn-save-protect",function(e){e.preventDefault(),function(){preloader.modal("show");var e={},t=x3_content_show.find("#form-access");if(e.access={},t.children().length>1){var a=[];t.children().each(function(t,n){var i=$(this),o=i.find("#link_form").val()||"",l=i.find("#users_form").val()||"",s=i.find("#username_form").val()||"",r=i.find("#password_form").val()||"";o.length>0&&($.inArray(o,a)>-1&&x3Notifier('<strong>Warning: Link "'+o+'"</strong><br>'+language.warning_multiple_links,3e3,null,"warning"),a.push(o),e.access[o]={},s.length>0&&(e.access[o].username=s),r.length>0&&(e.access[o].password=r),l.length>0&&(e.access[o].users=[],$.each(l,function(t,a){e.access[o].users.push(a)})))})}e.users={};var i=x3_content_show.find("#form-users");if(i.children().length>1){var o=[];i.children().each(function(t,a){var n=$(this),i=n.find("#users_username_form").val()||"",l=n.find("#users_password_form").val()||"";i.length>0&&l.length>0&&(e.users[i]=l),$.inArray(i,o)>-1&&l.length>0&&x3Notifier('<strong>Warning: Username "'+i+'"</strong><br>'+language.warning_multiple_usernames,3e3,null,"warning"),i.length>0&&0==l.length&&x3Notifier("<strong>Warning</strong><br>"+language.usernames_without_passwords,3e3,null,"warning"),0==i.length&&l.length>0&&x3Notifier("<strong>Warning</strong><br>"+language.passwords_without_usernames,3e3,null,"warning"),i.length>0&&l.length>0&&o.push(i)})}console.dir(e),$.ajax({method:"POST",url:"x3_protect.php",dataType:"json",data:{protect:JSON.stringify(e)}}).done(function(e,t,a){void 0!=e.error?(console.log("Error: "+e.error),x3Notifier(language.Error+": "+e.error,null,null,"danger")):(console.log("success"),x3Notifier(language.Saved,null,null,"success"),n=e,l())}).fail(function(e,t,a){console.log("error"),e.responseText?(x3Notifier(language.Error+" -> textStatus: "+t,null,null,"danger"),console.log("textStatus: "+t),console.log("errorThrown: "+a)):window.location.replace("login.php")}).always(function(){preloader.modal("hide")})}()}),x3_content_show.on("click",".x3-protect .nav-tabs a",function(t){var i=$(this);a=i.attr("href"),supports_local_storage()&&localStorage.setItem("protected_tab",a);var o=x3_content_show.children(".x3-protect"),l=o.offset().top;if(x3_win.scrollTop()>l&&x3_win.scrollTop(l),"#protect-access"===i.attr("href")){var s=[],r=[],d=o.find("#form-users").children();d.length>0&&d.each(function(e,t){var a=$(this),n=a.find("#users_username_form").val()||"",i=a.find("#users_password_form").val()||"";n.length>0&&"*"!==n.slice(-1)&&(s.push(n),r.push(i))}),n.users={},$.each(s,function(e,t){n.users[t]=r[e]});var c=o.find("#form-access").children(".access-item");0===$(s).not(e).length&&0===$(e).not(s).length&&0!=s.length||($.each(c,function(e,t){var a=$(this).find(".select-users")[0].selectize;s.length>0&&$.each(s,function(e,t){a.addOption({value:t,text:t})}),$.each(a.options,function(e,t){-1==$.inArray(e,s)&&a.removeOption(e)}),0==s.length?a.disable():a.enable()}),e=s)}});var n,i="\t<div class='x3-panel-section x3-protect'>\t\t<div class=protect-controls>\t\t<button type=button class='btn btn-primary btn-save-protect'>"+language.Save+"</button>\t\t<button type=button data-help=protect class='btn btn-default btn-protect-help panel-help'><i class='fa fa-question'></i></button>    <ul class='nav nav-tabs' role='tablist'>\t    <li role=presentation class=active><a href=#protect-access aria-controls=protect-access role=tab data-toggle=tab>"+language.Links+"</a></li>\t    <li role=presentation><a href=#protect-users aria-controls=protect-users role=tab data-toggle=tab>"+language.Users+"</a></li>    </ul>    </div>    <div id=myTabContent class=tab-content>      <div role=tabpanel class='tab-pane active in' id=protect-access></div>      <div role=tabpanel class='tab-pane fade' id=protect-users></div>    </div>  </div>";protectPageAfter=function(){t&&x3_navbar_nav.children("li#protect").hasClass("active")&&o()},protectPage=function(){preloader.modal("show"),void 0==n||t?$.getJSON("x3_protect.php",function(e,a){x3_navbar_nav.children("li.active").removeClass("active"),x3_navbar_nav.children("li#protect").addClass("active"),"success"==a?void 0!=e.error?(console.log("Error: "+e.error),x3Notifier(language.Error+": "+e.error,null,null,"danger")):void 0!=json_menu?(n=e,o()):(n=e,t=!0,console.log("log: waiting for menu ...")):(console.log("Error -> success: "+a),x3Notifier(language.Error+" -> success: "+a,null,null,"danger"))}).fail(function(){window.location.replace("login.php")}):(x3_navbar_nav.children("li.active").removeClass("active"),x3_navbar_nav.children("li#protect").addClass("active"),o())};function o(){t=!1,preloader.modal("hide"),x3_content_show.html(i);var e=x3_content_show.children(".x3-protect");e.find(".nav-tabs").find('a[href="'+a+'"]').tab("show"),x3_content_show.velocity("fadeIn",{duration:500}),l(),e.find(".protect-controls").scrollToFixed({zIndex:2})}function l(){!function(){var e="<form id=form-access name=form-access>";$.each(n.access,function(t,a){var n=void 0==t||0==t.length?"":t,i=void 0==a.username?"":a.username,o=void 0==a.password?"":a.password;e+=r(n,a.users,i,o)}),e+="</form>";var t=x3_content_show.find("#protect-access");t.html(e);var a=t.children("#form-access");a.prepend(r("","","",""));var i=a.children(".access-item");$.each(i,function(e,t){d($(this))})}(),function(){var e="<form id=form-users name=form-users>";$.each(n.users,function(t,a){e+=s(t,a)}),e+="</form>";var t=x3_content_show.find("#protect-users");t.html(e),t.children("#form-users").prepend(s("",""))}()}function s(e,t){var a='<div class=row>\t\t<div class="form-group col-xs-5">\t\t<div class="input-group">\t\t<div class="input-group-addon"><span class="glyphicon glyphicon-user" aria-hidden="true"></span></div>\t\t<label class="sr-only" for="users_username_form">'+language.Username+'</label>\t\t<input type="text" id="users_username_form" name="username" class="form-control" placeholder="'+language.Username+'" value="'+e+'">\t\t</div>\t\t</div>';return a+='\t\t<div class="form-group col-xs-5">\t\t<div class="input-group">\t\t<div class="input-group-addon"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span></div>\t\t<label class="sr-only" for="users_password_form">'+language.Password+'</label>\t\t<input type="text" id="users_password_form" name="password" class="form-control" placeholder="'+language.Password+'" value="'+t+'">\t\t</div>\t\t</div>',a+='\t\t<div class="col-xs-2">\t\t<button type="button" class="btn btn-default btn-remove" tabIndex=-1><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>\t\t</div>',a+="</div>"}function r(e,t,a,i){var o='\t\t<div class="access-item row">\t\t<div class="col-xs-10">\t\t<div class="form-group">    <input type="text" id="link_form" name="link" class="form-control select-link" placeholder="'+language.Link+'" value="'+e+'">\t\t</div>',l="";return $.each(n.users,function(e,a){"*"!==e.slice(-1)&&(l+='<option value="'+e+'" '+(void 0!=t&&$.inArray(e,t)>-1?"selected":"")+">"+e+"</option>")}),o+='\t\t<div class="form-group">\t\t<select multiple class="form-control select-users" id=users_form placeholder="'+language.Users+'">'+l+"</select>\t\t</div>",o+='<div class=row>\t\t<div class="form-group col-sm-6">\t\t<div class="input-group">\t\t<div class="input-group-addon"><span class="glyphicon glyphicon-user" aria-hidden="true"></span></div>\t\t<label class="sr-only" for="username_form">'+language.Username+'</label>\t\t<input type="text" id="username_form" name="username" class="form-control" placeholder="'+language.Username+'" value="'+a+'">\t\t</div>\t\t</div>',o+='\t\t<div class="form-group col-sm-6">\t\t<div class="input-group">\t\t<div class="input-group-addon"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span></div>\t\t<label class="sr-only" for="password_form">'+language.Password+'</label>\t\t<input type="text" id="password_form" name="password" class="form-control" placeholder="'+language.Password+'" value="'+i+'">\t\t</div>\t\t</div>\t\t</div>\t\t</div>',o+='\t\t<div class=col-xs-2>\t\t<button type="button" class="btn btn-default btn-remove" tabIndex=-1><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>\t\t</div>',0==e.length&&(o+='\t\t\t<div class="col-xs-12 passwords-help">\t\t\t* '+language.passwords_help+"\t\t\t</div>"),o+="</div>"}function d(e){var t=e.find(".select-link"),a=json_menu.slice(),i=t.val().split(",");-1==$.inArray("*",i)&&a.unshift({link:"*",label:"*GLOBAL"}),$.each(i,function(e,t){var n="*"==t?"*GLOBAL":t;a.unshift({link:t,label:n})});var o=e;t.selectize({valueField:"link",labelField:"label",searchField:["link"],options:a})[0].selectize.on("item_add",function(){var e=x3_content_show.find("#form-access");if(o.is(":first-child")){e.prepend(r("","","",""));var t=e.find(".row:first-child");t.css("display","none").velocity("slideDown",{duration:500,delay:10,easing:"easeOutQuart"}),d(t)}});var l=e.find(".select-users").selectize();Object.keys(n.users).length<1?l[0].selectize.disable():l[0].selectize.enable()}}),$(function(){x3_navbar_nav.on("click","li#refresh > a",function(e){e.preventDefault();var t=$(this),a=t.html(),n=new Date;t.attr("disabled",!0).width(t.width()).text("Refreshing ..."),$.getJSON("menu_create.php").done(function(e){if(e.success)var t=new Date,a="Menu refreshed in "+((Number(t)-Number(n))/1e3).toFixed(2)+" seconds.";else if(e.error)a="Error: "+e.error+" seconds.";else a="Error :(";x3Notifier(a,2e3,null,"success")}).fail(function(e,t,a){console.dir(e);x3Notifier(t+" : "+a,2e3,null,"danger")}).always(function(e,i,o){var l=new Date,s=Number(l)-Number(n),r=Math.max(1,1e3-Number(s));setTimeout(function(){t.html(a).attr("disabled",!1)},r)})})}),$(function(){key.filter=function(e){return!0},key("⌘+s, ctrl+s",function(e,t){var a=x3_content_show.find("#json-form");return a.length&&a.submit(),!1})});var get_x3_settings,current_settings,settings_loaded=!1;!function(){var e,t,a,n,i,o,l=!1,s=!1,r=!(!supports_local_storage()||null===localStorage.getItem("x3_diagnostics_was_disabled")),d={};$.each(stylerConfig.skins,function(e,t){if("header"!==t){var a=e.split(" ")[0],n=t.split(" ")[1];void 0==d[a]&&(d[a]=[]),d[a].push({item:n})}});$.getJSON("settings-schema.json?v="+x3_panel_version,function(t){l=!0,e=t}).fail(function(){console.log("Error: Can't load panel/settings-schema.json")});$.ajax({method:"POST",url:"x3_settings.php",dataType:"json",data:{get_settings:!0},success:function(e,t,a){settings_loaded=!0,current_settings=e},error:function(e,t,a){console.log("Error: "+t),x3Notifier(language.Error+" -> textStatus: "+t,null,null,"danger")}});function c(){e.value=current_settings,e.onSubmit=function(e,t){e?(console.log("Errors"),console.dir(e)):(console.log("form valid!"),function(e){if(console.log("save SETTINGS"),!s){s=!0;var t=i.children(".btn-settings-save");t.button("loading"),preloader.modal("show"),x3_license&&(e.x=x3_license),$.ajax({method:"POST",url:"x3_settings.php",dataType:"json",data:{settings:JSON.stringify(e)},success:function(t,a,n){if(t.success){var i=!current_settings.back.panel.use_db&&(current_settings.back.panel.username!==e.back.panel.username||current_settings.back.panel.password!==e.back.panel.password);if(current_settings=e,x3Notifier(language.Saved,null,null,"success"),console.log("Success"),i&&location.replace("logout.php"),p(),!current_settings.settings.diagnostics&&!r){var l=o.children(".diagnostics-alias-container");l.length&&(r=!0,supports_local_storage()&&localStorage.setItem("x3_diagnostics_was_disabled",!0),l.remove(),x3_win.resize())}}else x3Notifier(language.Error+": "+t.error,2e3,null,"danger"),console.log("Error: "+t.error)},complete:function(){setTimeout(function(){t.button("reset")},1e3),preloader.modal("hide"),s=!1}}).fail(function(e,t,a){e.responseText?(x3Notifier(language.Error+" -> textStatus: "+t,null,null,"danger"),firewall_error(t,a)):window.location.replace("login.php")})}}(t)),console.log(t)},t.append('<input style="display:none;" type="text" name="somefakename" /><input style="display:none;" type="password" name="anotherfakename" />'),t.jsonForm(e);function l(){var e=u.filter(":checked").val();h.toggle(e.indexOf("topbar")>-1),f.toggle("slidemenu"===e)}var c=t.find(".x3-layout-settings"),u=c.find('[name="style.layout.layout"]'),h=c.find(".jsonform-error-style---layout---fixed, .jsonform-error-style---layout---wide"),f=c.find(".jsonform-error-style---layout---overlay");if(u.change(l),l(),!r){var m=t.find('[name="settings.diagnostics"]');if(m.is(":checked")){o.children("h3").after('<div class="diagnostics-alias-container text-center"><div class="alert alert-info text-left" role="alert" style="display: inline-block;"><strong>Diagnostics Active</strong><br><span class="content">To disable diagnostics and activate your X3 website, uncheck the option below and click save.<br><label style="margin: .7em 0;"><input type="checkbox" id="diagnostics_alias" name="diagnostics_alias" checked> &nbsp;Show Diagnostics</label><br><em>* Diagnostics can be re-enabled from the "Advanced" section below.</em></span></div></div>');var g=o.children(".diagnostics-alias-container").find("#diagnostics_alias"),_=m.add(g);_.change(function(e){_.prop("checked",$(this).is(":checked"))})}}x3_win.width()>992&&i.scrollToFixed({zIndex:5}),t.find("a.btn-create-site-object").on("click",function(e){e.preventDefault(),current_settings.settings.diagnostics?x3Notifier('Disable "Show Diagnostics", and click SAVE before you run this task.',4e3,null,"danger"):current_settings.settings.preload?createSiteObject(!0):x3Notifier("SAVE settings before you run this task.",4e3,null,"danger")});var v=t.find(".json-form-style-settings"),b=v.find('input[name="style.skin.primary_color"]'),y=v.find('input[name="style.skin.skin"]'),w=y.parent("label"),x=v.find('textarea[name="style.font.font"]');var k=b.val();b.selectize({persist:!1,create:!0,maxItems:1,valueField:"item",labelField:"item",searchField:"item",options:d[w.filter(".active").children("input").val()]})[0].selectize.createItem(k),y.change(function(){!function(e){var t=b[0].selectize,a=t.getValue();t.clearOptions(),t.load(function(n){n(d[e]),t.createItem(a)})}($(this).val())});var C=x.val(),S=[];$.each(stylerConfig.fonts,function(e,t){"header"!==t&&"-"!==t&&S.push({label:e,link:t})}),x.before("<select></select><label>Source</label>");x.siblings("select").selectize({items:[C],create:!1,maxItems:1,valueField:"link",labelField:"label",searchField:["link"],options:S,onChange:function(e){x.val(e)}});autosize(t.find("textarea")),function(){a=t.children().children("fieldset");var o="";$.each(a,function(t,a){var n=$(this),i=e.form[t].title;o+='<label class="btn btn-primary"><input type="radio" name="options" id="option'+(t+1)+'" autocomplete="off" checked>'+i+"</label>",n.data("height",n.outerHeight(!0))}),i.children(".btn-group").html(o).after('<button data-loading-text="Saving ..." type="button" class="btn btn-settings-save btn-primary">Save</button>'),i.removeClass("invisible"),n=supports_local_storage()&&null!==localStorage.getItem("x3_settings_tab")?Number(localStorage.getItem("x3_settings_tab")):0,i.find("label.btn").eq(n).addClass("active"),a.not(a.eq(n)).css("display","none"),i.on("click","label.btn",function(e){!function(e){var n=e,i=a.eq(n);t.css("min-height",i.data("height")),a.not(i).filter(":visible").velocity({opacity:0},{duration:100,display:"none",complete:function(){i.filter(":hidden").velocity({opacity:1},{duration:200,display:"block"})}}),supports_local_storage()&&localStorage.setItem("x3_settings_tab",n)}($(this).index())})}();t.find('[data-jsonform-type="ace"]').each(function(e,t){var a=$(this).children(".controls").children("div"),n=a.children("div").attr("id"),i=ace.edit(n);a.css("height","auto"),i.setAutoScrollEditorIntoView(!0),i.setOption("maxLines",100),i.setOption("minLines",5),i.getSession().setUseWrapMode(!0),i.$blockScrolling=1/0}),t.find(".alt-title").each(function(e,t){var a=(t=$(this)).find(".help-block").first().html();t.prev("legend").html(a),t.remove()}),t.find(".settings_selectize").each(function(e,t){var a=$(this),n=a.find(".selectize-items"),i=n.hasClass("selectize-single"),o=n.text().split(","),l=i?[a.find("input").val()]:a.find("input").val().split(","),s=[];$.each(l,function(e,t){-1==$.inArray(t,o)&&o.push(t)}),$.each(o,function(e,t){s.push({item:t})});var r={create:n.hasClass("selectize-create"),valueField:"item",labelField:"item",searchField:"item",options:s};i&&(r.maxItems=1,r.delimiter=null);a.find("input").selectize(r)[0].selectize.enable()}),p(),i.children(".btn-settings-save").on("click",function(e){t.length&&t.submit()})}get_x3_settings=function(){if(o=x3_content_show.children(".x3-settings"),i=o.children(".filter-buttons"),t=o.children("#json-form"),l&&settings_loaded)c();else var e=setInterval(function(){l&&settings_loaded&&(clearInterval(e),"setting"==current_nav&&c())},1e3)};function p(){var e=t.find("fieldset.settings-plugins"),a=e.find('input[name="plugins.image_background.enabled"]');a.closest("fieldset").toggleClass("is-active",a.is(":checked")&&e.find('input[name="plugins.image_background.src"]').val().length>0);var n=e.find('input[name="plugins.background.enabled"]');n.closest("fieldset").toggleClass("is-active",n.is(":checked")&&(e.find('input[name="plugins.background.src"]').val().length>0||e.find('input[name="plugins.background.color"]').val().length>0));var i=e.find('input[name="plugins.fotomoto.enabled"]');i.closest("fieldset").toggleClass("is-active",i.is(":checked")&&e.find('input[name="plugins.fotomoto.store_id"]').val().length>0);var o=e.find('input[name="plugins.audioplayer.enabled"]');o.closest("fieldset").toggleClass("is-active",o.is(":checked"));var l=e.find('input[name="accounts.chat"]');l.closest("fieldset").toggleClass("is-active",l.val().length>0);var s=e.find('input[name="accounts.disqus_shortname"]');s.closest("fieldset").toggleClass("is-active",s.val().length>0);(r=e.find('input[name="settings.pagenav"]')).closest("fieldset").toggleClass("is-active",r.is(":checked"));var r;(r=e.find('input[name="plugins.cookie_consent.enabled"]')).closest("fieldset").toggleClass("is-active",r.is(":checked"))}var u;x3_content_show.on("mousedown","a.show-help",function(e){u=$(this).closest(".form-group").find("label.active.btn-primary")}).on("mouseup","a.show-help",function(e){var t=$(this).parent(".control-label");setTimeout(function(){t.removeClass("active btn-primary"),u.addClass("active btn-primary")},1)})}();var get_x3_page_settings,page_settings,save_inject;!function(){var e,t,a,n,i,o,l,s,r,d,c,p,u,h,f=!1,m=!1,g=!1,_=!1,v='<div class="filter-buttons invisible"><div class="btn-group btn-group-sm" data-toggle="buttons"></div></div><form id=json-form></form>',b="<a href=# class=show-help></a><div class=hidden>"+x3_help.templates+"</div>",y={},w={},x={},k=custom_setting_templates?0:1;function C(){2===++k&&($.extend(!0,y,x,w),m=!0)}$.getJSON("setting-templates.json?v="+x3_panel_version,function(e){x=e,C()}).fail(function(){x3Notifier(language.Error+": Can't load panel/setting-templates.json",null,null,"danger"),console.log("Error: Can't load panel/setting-templates.json")}),custom_setting_templates&&$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",cache:!1,data:{get_templates:!0},success:function(e,t,a){w=e,C()},error:function(e,t,a){x3Notifier(language.Error+" -> textStatus: "+t,null,null,"danger"),console.log("Templates Error: "+t)}}),$.getJSON("settings-page-schema.json?v="+x3_panel_version,function(t){f=!0,e=t}).fail(function(){console.log("Error: Can't load panel/settings-page-schema.json")});function S(a,n,i,s,r){if(console.log("save PAGE"),!g){void 0===r&&(r=!0),g=!0,l.button("loading"),r&&preloader.modal("show");var d={},c=!1,p={};function u(e){3===active_gallery_sort&&"#gallery"===active_page_tab&&(x3Notifier("Changed to "+e+' "custom" sorting',null,null,"success"),a[e].sortby="custom",t.find("."+e+"-sorting").find('input[value="custom"]').click())}if(n)d.inject=!0,a.hasOwnProperty("iptc_inject")&&(d.files=$.extend(!0,{},a.iptc_inject),delete a.iptc_inject);else{var h=rows_files;if(h.length){if(current_settings.back.use_iptc){var f=h.filter(function(){return $.inArray(this.getAttribute("data-ext"),["jpg","jpeg","pjpeg"])>-1});f.length&&(c=collect_iptc_files(f))&&(d.files=c)}if(h.length){var m=collectFiledata(h);m&&$.extend(!0,a,m)}is_custom_sort&&"custom"!==page_settings.gallery.sortby&&u("gallery"),is_custom_sort=!1}rows_folders.length&&is_custom_sort_folders&&(rows_folders.each(function(){var e=get_content_path(this.getAttribute("data-path")),t=this.getAttribute("data-custom");e&&t&&(p[e]={index:parseInt(t)})}),Object.keys(p).length&&(d.folders=JSON.stringify(p),"custom"!==page_settings.folders.sortby&&u("folders")),is_custom_sort_folders=!1)}d.page_settings=JSON.stringify(a),d.path=o,console.log("iptc OB:"),console.dir(c),$.ajax({method:"POST",url:"x3_settings.php",dataType:"json",data:d,success:function(t,o,l){if(t.success){if(x3Notifier(s||language.Saved,null,null,"success"),console.log("Success"),$.extend(!0,page_settings,a),n&&(e.value=page_settings,i&&i(!0)),c&&update_iptc_data(c,f),Object.keys(p).length){$.extend(!0,folders,p);var r=x3_panel_container.find("#left_folder_menu_box"),d=current_dir_path?r.find('li[data-dir="'+current_dir_path+'"]').children("ul"):r.children("ul");if(d.length){var u=d.children(":not(#_custom)");u.each(function(e,t){var a=t.getAttribute("data-content-path");p.hasOwnProperty(a)&&t.setAttribute("data-custom",p[a].index)}),sort_elements(u,"custom",d)}}setPreviewImageActive(),E()}else x3Notifier(language.Error+": "+t.error,2e3,null,"danger"),console.log("Error: "+t.error)},complete:function(){setTimeout(function(){l.button("reset")},1e3),r&&preloader.modal("hide"),g=!1}}).fail(function(e,t,a){e.responseText?(x3Notifier(language.Error+" -> textStatus: "+t,null,null,"danger"),console.log("Save Error: "+t),n&&i&&i(!1),firewall_error(t,a)):window.location.replace("login.php")})}}save_inject=function(e,t,a,n){S(e,!0,t,a,n)};function j(){var e=t.find('input[name="gallery.assets"], input[name="folders.assets"]'),a=json_menu.slice();e.each(function(e,t){$(this).selectize({create:!1,maxItems:1,valueField:"link",labelField:"label",searchField:["link"],options:a})})}function T(o){var f=x3_content_show.find(".x3-page-settings-container");f.append(v),t=f.children("#json-form"),o.content&&(o.content=o.content.replace(/</g,"&lt;").replace(/>/g,"&gt;")),e.value=o,_||(e.onSubmit=function(e,t){var a="markdown"===current_settings.back.panel.editor?s.value():h.summernote("code");if(t.content=a,m.val(a),e)console.log("Errors"),console.dir(e);else{if(console.log("form valid!"),console.dir(t),"apply"==_||"paste"==_||"paste-all"==_){if(f.css("height",f.outerHeight()),f.empty(),"paste"==_){$.each(["title","label","description","date","image","content","link","menu"],function(e,t){t in p&&delete p[t]})}var n="apply"==_?r:p;T($.extend(!0,{},current_settings,t,n)),f.css("height","auto");x3Notifier("apply"==_?c+" template applied to "+d+" settings.":"Successfully pasted settings from clipboard.",null,null,"success")}else"get"==_?u=t:"copy"==_?(x3Notifier("Current settings successfully copied.",null,null,"success"),i.find("a.settings-paste, a.settings-paste-all").parent("li").removeClass("disabled"),p=t):S(t);_=!1}}),t.jsonForm(e);var m=t.find('textarea[name="content"]');function g(e,t){e.toggle("grid"===t||"vertical"===t||"carousel"===t)}var k=t.find(".gallery-layout-selector").find(".tabbable").children(".form-group").find("select"),C=t.find(".gallery-split-view-setting"),I=t.find(".folders-layout-selector").find(".tabbable").children(".form-group").find("select"),O=t.find(".folders-split-view-setting");k.on("change",function(e){g(C,$(this).val())}),g(C,k.val()),I.on("change",function(e){g(O,$(this).val())}),g(O,I.val()),autosize(t.find("textarea"));if(t.find('[data-jsonform-type="ace"]').each(function(e,t){var a=$(this).children(".controls").children("div"),n=a.children("div").attr("id"),i=ace.edit(n);a.css("height","auto"),i.setAutoScrollEditorIntoView(!0),i.setOption("maxLines",100),i.setOption("minLines",5),i.getSession().setUseWrapMode(!0),i.$blockScrolling=1/0}),t.find(".alt-title").each(function(e,t){var a=(t=$(this)).find(".help-block").first().html();t.prev("legend").html(a),t.remove()}),void 0!==json_menu)j();else var A=setInterval(function(){void 0!==json_menu&&(clearInterval(A),j())},500);if(t.find(".settings_selectize").each(function(e,t){var a=$(this),n=a.find(".selectize-items"),i=n.text().split(","),o=a.find("input").val().split(","),l=[];$.each(o,function(e,t){-1==$.inArray(t,i)&&i.push(t)}),$.each(i,function(e,t){l.push({item:t})});var s={create:n.hasClass("selectize-create"),valueField:"item",labelField:"item",searchField:"item",options:l};n.hasClass("selectize-single")&&(s.maxItems=1,s.delimiter=null);a.find("input").selectize(s)[0].selectize.enable()}),setTimeout(function(){if(current_folder_images.length){t.find('input[name="image"], input[name="plugins.image_background.src"], input[name="plugins.background.src"]').each(function(e,t){var a=[];t=$(this);$.each(current_folder_images,function(e,t){a.push({item:t})}),-1==$.inArray(t.val(),current_folder_images)&&a.unshift({item:t.val()});t.selectize({create:!0,maxItems:1,delimiter:null,valueField:"item",labelField:"item",searchField:"item",options:a})[0].selectize.enable()})}},10),"html"===current_settings.back.panel.editor){m.css("display","none"),m.after('<div class="html-editor"></div>'),h=m.siblings(".html-editor");var P={minHeight:300,codemirror:{theme:"default",lineWrapping:!0,viewportMargin:1/0},toolbar:[["style",["style"]],["format",["bold","italic","underline","clear"]],["color",["color"]],["size",["fontsize"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","video","hr"]],["right",["codeview","fullscreen"]]]};summernote_lang&&(P.lang=summernote_lang),h.summernote(P),h.summernote("code",m.text())}else{s=new SimpleMDE({element:m[0],spellChecker:!1,autoDownloadFontAwesome:!1,toolbar:["preview","side-by-side","fullscreen","bold","italic","heading-1","heading-2","heading-3","|","quote","unordered-list","ordered-list",{name:"center",action:function(e){myToggleBlock(e,"center","<center markdown=1>","</center>")},className:"fa fa-align-center",title:"Align center"},"horizontal-rule","|","link","image","|"],previewRender:function(e){return SimpleMDE.prototype.markdown(e.replace(/{{path}}/g,here+"/"))}}),1===n&&setTimeout(function(){s.codemirror.refresh()},10);var F=t.find(".editor-toolbar"),N="",M=Object.keys(editor_templates).sort();$.each(M,function(e,t){N+='<li><a href="#">'+t+"</a></li>"});var D="";setTimeout(function(){if(here&&current_folder_images.length){var e=F.children(".fa-picture-o");e.hide();var t=get_x3_path()+"/content/"+here.split("../content/")[1]+"/",a=supports_local_storage()&&null!==localStorage.getItem("dropdown_images_popup")&&localStorage.getItem("dropdown_images_popup")?" checked":"",n=supports_local_storage()&&null!==localStorage.getItem("dropdown_images_frame")&&localStorage.getItem("dropdown_images_frame")?" checked":"",i=current_folder_images.length>15,o=i?10:5,l=!i&&"devicePixelRatio"in window&&window.devicePixelRatio>1?"w200":"w100",r=t.replace("/content/","/render/"+l+"-c1:1/");D+='<div class="dropdown editor-dropdown"><a class="btn-images dropdown-toggle fa fa-picture-o" data-toggle="dropdown" role="button" aria-expanded="true"></a><div class="dropdown-images dropdown-menu pull-right dropdown-menu-right'+(i?" dropdown-images-small":"")+'" role="menu"><div class="dropdown-images-name"><span>Select image</span></div>';var d=0;image_count=0,$.each(current_folder_images,function(e,a){if(d++,image_count++,D+='<img data-name="'+a+'" data-path="'+t+a+'" src="'+r+a+'">',image_count>=100)return!1;d===o&&(d=0,e<current_folder_images.length-1&&(D+="<br>"))}),D+='<div class="dropdown-images-options"><input type="checkbox" id="dropdown_images_popup" name="dropdown_images_popup"'+a+'><label for="dropdown_images_popup">Popup link</label><input type="checkbox" id="dropdown_images_frame" name="dropdown_images_frame"'+n+'><label for="dropdown_images_frame">Frame</label></div></div></div>'}D+='<div class="dropdown editor-dropdown"><a class="btn-templates dropdown-toggle fa fa-magic" data-toggle="dropdown" role="button" aria-expanded="false"></a><ul class="dropdown-templates dropdown-menu pull-right dropdown-menu-right" role="menu" aria-labelledby="dropdown-templates"><li class="dropdown-header">Insert Template</li>'+N+"</ul></div>",F.append(D),F.find(".dropdown-templates").on("click","a",function(e){e.preventDefault();var t=editor_templates[$(this).text()];s.codemirror.replaceSelection(t),s.codemirror.focus()});var c=F.find(".dropdown-images");if(c.length){var p=c.parent(".dropdown"),u=c.children(".dropdown-images-name"),h=c.find("#dropdown_images_popup"),f=c.find("#dropdown_images_frame");supports_local_storage()&&h.add(f).change(function(){localStorage.setItem(this.id,this.checked?1:"")}),F.find(".btn-images").click(function(t){p.is(":visible")&&(c.velocity("stop").css({opacity:0,display:"none"}),p.removeClass("open")),e.click()}),c.on("click","img",function(e){var t=$(this).data("name"),a='<img src="'+("{{path}}"+t)+'" '+(f.prop("checked")?'class="x3-style-frame" ':"")+'alt="" />';h.prop("checked")&&(a='<a href="{{path}}'+t+'" data-popup>'+a+"</a>"),u.addClass("inserted").html(t+' &nbsp;<i class="glyphicon glyphicon-ok"></i>'),s.codemirror.replaceSelection(a+"\n"),s.codemirror.focus()}).on("mouseenter","img",function(e){u.html($(this).data("name"))}).on("mouseleave","img",function(e){u.removeClass("inserted").html("<span>Select image</span>")})}},10),F.prepend('<button data-loading-text="Saving ..." type="button" class="btn btn-settings-save editor-save btn-primary">Save</button>')}t.find(".template-selector").each(function(e,a){var n=$(this),i=n.hasClass("template-gallery")?"Gallery":"Folders";n.prepend("<div class=setting_templates>"+b+'<select><option value="" disabled selected>'+i+" Setting Templates</option></select></div>"),i=i.toLowerCase();var o=n.find("select"),l="",s=Object.keys(x[i]).length,p=[];$.each(Object.keys(y[i]),function(e,t){e===s&&(l+='<option value="" disabled>---</option>'),l+="<option>"+t+"</option>",p.push(t)}),supports_local_storage()&&(l+='<option class=last-option disabled>---</option><option value="save">Save Current Settings As...</option>'),o.append(l),o.on("change",function(){if("save"==$(this).val()){var e=prompt("Save current "+i+"-settings as template:");if(e&&$.inArray(e,p)>-1)x3Notifier("Please use a unique name!",3e3,null,"danger");else if(e){_="get",t.length&&t.submit();var a={};a[i]={},a[i][e]={},a[i][e][i]=u[i],preloader.modal("show"),$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",cache:!1,data:{save_template:JSON.stringify(a)},success:function(t,a,n){t.success?x3Notifier('Template "'+e+'" saved.',null,null,"success"):(x3Notifier("Save template error:<br>"+t.fail+"<br><br>Template will be available temporarily until you refresh page.",3e3,null,"warning"),console.log("Save template error: "+t.fail))},error:function(e,t,a){x3Notifier("Save template error:<br>"+t+"<br><br>Template will be available temporarily until you refresh page.",3e3,null,"warning"),console.log("Save template error: "+t)},complete:function(){preloader.modal("hide")}});var n="";$.isEmptyObject(w[i])&&(n+="<option class=last-option disabled>---</option>"),n+="<option>"+e+"</option>",o.children('[value="save"]').prev().before(n),p.push(e),$.extend(!0,w,a),$.extend(!0,y,a)}o.val("")}else c=$(this).val(),d=i,r=y[i][c],_="apply",t.length&&t.submit()})}),E(),(l=x3_content_show.find(".btn-settings-save, .save-page")).on("click",function(e){t.length&&t.submit()}),function(){a=t.children().children("fieldset");var o="";$.each(a,function(t,a){var n=e.form[t].title;o+='<label class="btn btn-default"><input type="radio" name="options" id="option'+(t+1)+'" autocomplete="off" checked>'+n+"</label>";var i=$(this);i.data("height",i.outerHeight(!0))});var l=(i=x3_content_show.find(".filter-buttons")).children(".btn-group");i.prepend("<h3>"+x3_content_show.find(".col-md-9 > h3").text()+"</h3>"),l.html(o).after('<button data-loading-text="Saving ..." type="button" class="btn btn-settings-save btn-primary">Save</button>'),i.removeClass("invisible"),n=supports_local_storage()&&null!==localStorage.getItem("x3_settings_page_tab")?Number(localStorage.getItem("x3_settings_page_tab")):0,l.children("label.btn").eq(n).addClass("active"),a.not(a.eq(n)).css("display","none");l.after('<div class="dropdown dropdown-copy-paste"><button type="button" class="btn btn-sm btn-default btn-copy-paste dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-paste"></i></button>    <ul class="dropdown-menu pull-right dropdown-menu-right" role="menu" aria-labelledby="copymenu">    <li class="dropdown-header">Copy-Paste Settings</li>    <li><a href="#" class=settings-copy data-process=copy><i class="fa fa-copy"></i> Copy</a></li>    <li><a href="#" class=settings-paste data-process=paste><i class="fa fa-paste"></i> Paste</a></li>    <li><a href="#" class=settings-paste-all data-process=paste-all><i class="fa fa-paste"></i> Paste All</a></li>    <li role="separator" class="divider"></li>    <li><a href="#" class="settings-copy-help text-help" data-process=copy-paste-help><i class="fa fa-question-circle"></i> Help</a><div class=hidden><h3>Copy-Paste Page Settings</h3><p>This feature allows you to copy settings from one page to another. This is useful when you want to create a page with an identical layout as an existing page. Simply navigate to the source page, click <code>copy</code>, then navigate to the new page and click <code>paste</code>.</p><h4>Copy</h4><p>Copies settings from the current page into clipboard.</p><h4>Paste</h4><p>Pastes settings from clipboard into the current page. This function will only paste layout-related settings, and will <em>ignore</em> unique page details, content, link and menu.</p><h4>Paste All</h4><p>Same as above, but this function will paste <em>all</em> page settings, including details, content, link and menu. This will basically paste an identical copy of the source page, overwriting all existing settings, so it is likely you will want to make some changes after paste.</p><p><em>* You still need to click save after pasting settings.</em></p></div></li>  \t</ul></div>'),setTimeout(function(){i.children(".dropdown-copy-paste").add(t.find(".editor-dropdown")).hoverIntent({over:function(e){var t=$(this),a=t.find(".dropdown-menu");a.velocity({opacity:1},{duration:200,display:"block"}),t.addClass("open")},out:function(){var e=$(this),t=e.find(".dropdown-menu");t.velocity("stop").css({opacity:0,display:"none"}),e.removeClass("open")},timeout:300})},11),i.find("a.settings-paste, a.settings-paste-all").parent("li").toggleClass("disabled",void 0===p),l.on("click",".btn",function(e){var n=$(this);!function(e){var n=x3_content_show.find(".x3-page-settings-container"),i=n.offset().top,o=e,l=a.eq(o);x3_win.scrollTop()>i?n.velocity("scroll",{duration:500,easing:"easeInOutCubic",complete:function(){t.css("min-height",l.data("height")),a.not(l).filter(":visible").hide(),l.filter(":hidden").show()}}):(t.css("min-height",l.data("height")),a.not(l).filter(":visible").hide(),l.filter(":hidden").show());setTimeout(function(){t.css("min-height",l.data("height"))},1e3),supports_local_storage()&&localStorage.setItem("x3_settings_page_tab",o)}(n.index()),"markdown"===current_settings.back.panel.editor&&1==n.index()&&s.codemirror.refresh()}),i.find(".dropdown-menu").on("click","a",function(e){e.preventDefault();var a=$(this);"copy-paste-help"!==a.data("process")&&(_=a.data("process"),t.length&&t.submit())})}(),x3_win.width()>992&&i.scrollToFixed({zIndex:5})}x3_content_show.on("click",".save-page, .x3-page-settings .btn-settings-save",function(e){t.length&&t.submit()}),get_x3_page_settings=function(e,t){if(page_settings=$.extend(!0,{},current_settings,e),console.dir(page_settings),o=t,f&&settings_loaded&&m)T(page_settings);else var a=setInterval(function(){f&&settings_loaded&&m&&(clearInterval(a),"fileManager"==current_nav&&T(page_settings))},1e3)};function E(){var e=t.find("fieldset.plugins"),a=e.find('input[name="plugins.image_background.enabled"]');a.closest("fieldset").toggleClass("is-active",a.is(":checked")&&e.find('input[name="plugins.image_background.src"]').val().length>0);var n=e.find('input[name="plugins.background.enabled"]');n.closest("fieldset").toggleClass("is-active",n.is(":checked")&&(e.find('input[name="plugins.background.src"]').val().length>0||e.find('input[name="plugins.background.color"]').val().length>0));var i=e.find('input[name="plugins.video_background.src"]');i.closest("fieldset").toggleClass("is-active",i.val().length>0);var o=e.find('input[name="plugins.fotomoto.enabled_page"]').closest("fieldset");page_settings.plugins.fotomoto.enabled&&page_settings.plugins.fotomoto.store_id?o.toggleClass("is-active",page_settings.plugins.fotomoto.enabled_page):o.hide();var l=e.find('input[name="layout.disqus"]').closest("fieldset");page_settings.accounts&&page_settings.accounts.disqus_shortname?l.toggleClass("is-active",page_settings.layout.disqus):l.hide()}}();var authPage,x3_license=supports_local_storage()&&null!==localStorage.getItem("x3_license")?parseInt(localStorage.getItem("x3_license")):1;!function(){var e,t,a,n,i="https://auth.photo.gallery/",o=window.location.hostname,l=!1,s={domain:o,product:3};function r(e){x3_license=200===e.status?e.parameters&&e.parameters.type&&"2"==e.parameters.type?2:1:0,supports_local_storage()&&localStorage.setItem("x3_license",x3_license),x3_body.removeClass("x3-auth-0 x3-auth-1 x3-auth-2").addClass("x3-auth-"+x3_license),location.search.indexOf("override")>-1&&x3_body.addClass("x3-override"),l=[e.status,e.message]}$.post(i,s,function(e){if(r(e),0===x3_license&&supports_local_storage())if(null!==localStorage.getItem("x3_license_time")){Date.now()-parseInt(localStorage.getItem("x3_license_time"))>2592e5&&(x3_open_modal('<p><span class="label label-danger" style="font-size: 1.5em; display: inline-block;">No X3 License Found</span></p><p>The website <strong>'+o+'</strong> is not licensed to use X3. If you wish to continue using X3, please consider purchasing a license.</p><p><a href="https://imagevuex.com/buy/" target="_blank" class="btn btn-primary">Purchase X3 License</a></p>'),localStorage.setItem("x3_license_time",Date.now()))}else localStorage.setItem("x3_license_time",Date.now())},"json"),$(function(){authPage=function(){t=x3_content_show.find(".x3-auth"),a=t.children(".auth-res"),n=a.children("div"),e=t.children(".btn-auth"),l?d(l[0],l[1]):o(),e.on("click",o)};function o(){e.button("loading"),n.html('<div><span class="label label-default">...</span></div>'),$.ajax({type:"POST",data:s,url:i,dataType:"json",success:function(e){console.dir(e),r(e),d(e.status,e.message)}}).fail(function(){d(300,"Can't connect to "+i)}).always(function(){e.button("reset")})}function d(e,t){var a=200==parseInt(e)?"success":"danger",i=200==parseInt(e)?"ok":"remove";t=301==parseInt(e)?"No license found for this domain.":t;x3_license&&200==parseInt(e)&&(t=2===x3_license?"X3 Private License":"X3 Professional License");var o='<span class="label label-'+a+'"><span class="glyphicon glyphicon-'+i+'" aria-hidden="true"></span>'+t+"</span>";301==parseInt(e)&&(o+='<br><a href="https://imagevuex.com/buy/" target=_blank class="btn btn-primary" style="margin-top:1.5em; font-size: 12px;">Purchase X3 License</a>'),n.html(o),x3Notifier(t,2e3,null,a)}})}();var tools_htaccess_init,tools_auth_template="\t<div class=x3-auth>\t\t<h3>Authorize X3<i class='help-icon panel-help pull-right fa fa-question-circle' data-help='authorize'></i></h3>\t\t<div class=auth-res>\t\t\t<strong>domain:</strong> "+window.location.hostname+"\t\t\t<div><span class='label label-default'>...</span></div>\t\t</div><br>\t\t<button type=button class='btn btn-primary btn-auth' data-loading-text='Checking License ...'><span class='glyphicon glyphicon-repeat' aria-hidden=true></span> &nbsp;Re-check</button>  </div>";$(function(){var e,t,a,n=!0,i=!1;function o(e,t){var a=x3_content_show.find("#tools-htaccess");a.find(".alert").remove();var n='<div class="alert alert-'+t+' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+e+"</div>";a.append(n)}function l(a){e.button("loading");var n=t.getValue();$.ajax({url:"x3_htaccess.php",method:"POST",dataType:"html",cache:!1,data:{data:n}}).done(function(e){"ok"==e?(i=n,x3Notifier(".htaccess file saved!",2e3,null,"success")):x3Notifier("Can't write to .htaccess file!",2e3,null,"danger")}).fail(function(e,t,a){console.dir(e);x3Notifier(t+": "+a,3e3,null,"danger")}).always(function(){setTimeout(function(){e.button("reset")},1e3)})}function s(i){0==i.indexOf("nowrite")&&(i=i.replace("nowrite",""),o("If this file was writeable, you could save changes directly from the panel.","warning"),n=!1),a.append('<div id="htaccess-editor"></div>'),(t=ace.edit("htaccess-editor")).setOption("maxLines",1/0),t.setOption("minLines",5),t.setAutoScrollEditorIntoView(!0),t.getSession().setUseWrapMode(!0),t.$blockScrolling=1/0,t.setTheme("ace/theme/tomorrow_night");var s="htaccess"===conf_editor?"apache_conf":"xml";t.getSession().setMode("ace/mode/"+s),t.setValue(i,-1),n&&(a.append('<button type="button" class="btn btn-primary btn-process btn-save-htaccess" data-loading-text="Saving ...">Save</button>'),(e=a.children(".btn-save-htaccess")).on("click",l))}tools_htaccess_init=function(){(a=x3_content_show.find("#tools-htaccess")).children("#htaccess-editor").length<1&&(i?s(i):(show_preloader(),$.ajax({url:"x3_htaccess.php",method:"POST",dataType:"html",cache:!1,data:{action:"load"}}).done(function(e){if("nofile"==e)x3Notifier(t="Cannot find .htaccess file in application root!",2e3,null,"danger"),o(t,"danger");else if("noread"==e)x3Notifier(t=".htaccess file is not readable!",2e3,null,"warning"),o(t,"warning");else if(e.length<1){var t;x3Notifier(t=".htaccess file seems to be empty!",2e3,null,"warning"),o(t,"warning")}else x3Notifier(".htaccess loaded!",2e3,null,"success"),i=e,s(e)}).fail(function(e,t){console.dir(e);var a=e.status+" "+e.statusText;x3Notifier(a,2e3,null,"danger"),o(a,"danger")}).always(function(){hide_preloader()})))}});var showTools,tools_htaccess_template="<h3>"+(conf_editor||"")+" editor<i class='help-icon panel-help pull-right fa fa-question-circle' data-help='htaccess'></i></h3>";$(function(){var e=window.location.hostname,t=-1==$.inArray(e,["flamepix.com","imagevuex.com","localhost","127.0.0.1","photo.gallery"])&&-1==e.indexOf("flamepix.com")&&-1==e.indexOf("photo.gallery");showTools=function(){main_menu_active("#tools"),x3_content_show.html(a);var e=x3_content_show.children(".x3-tools").children(".tabs-container").children(".nav-tabs");e.find('a[href="#tools-previews"]').one("shown.bs.tab",function(e){tools_previews_init()}).end().find('a[href="#tools-touch"]').one("shown.bs.tab",function(e){tools_touch_init()}).end().find('a[href="#tools-reset"]').one("shown.bs.tab",function(e){tools_reset_init()}).end().find('a[href="#tools-site"]').one("shown.bs.tab",function(e){tools_preload_init()}).end().find('a[href="#tools-phpinfo"]').one("shown.bs.tab",function(e){tools_phpinfo_init()}).end().find('a[href="#tools-htaccess"]').one("shown.bs.tab",function(e){tools_htaccess_init()}).end().find('a[href="#tools-updates"]').one("shown.bs.tab",function(e){tools_updates_init()});var t=supports_local_storage()&&null!==localStorage.getItem("panel_tools_tab")?localStorage.getItem("panel_tools_tab"):"tools-auth",n=e.find('a[href="#'+t+'"]');n.length&&n.tab("show"),x3_content_show.velocity("fadeIn",{duration:500}),"tools-auth"===t?authPage():e.find('a[href="#tools-auth"]').one("shown.bs.tab",function(e){authPage()}),e.on("shown.bs.tab",'a[data-toggle="tab"]',function(e){supports_local_storage()&&localStorage.setItem("panel_tools_tab",String(e.target).split("#")[1])})},x3_navbar_nav.find("li#tools > a").on("click",function(e){e.preventDefault(),showTools()});var a="\t<div class='x3-panel-section x3-tools'>\t\t<div class='tabs-container'>    <ul class='nav nav-tabs' role='tablist'>    \t"+(t?"<li role=presentation id=tab-tools-auth class=active><a href=#tools-auth aria-controls=tools-auth role=tab data-toggle=tab>Authorize</a></li>":"")+(conf_editor?"<li role=presentation id=tab-tools-htaccess><a href=#tools-htaccess aria-controls=tools-htaccess role=tab data-toggle=tab>"+conf_editor+"</a></li>":"")+"    \t<li role=presentation id=tab-tools-phpinfo class=flamepix-hidden><a href=#tools-phpinfo aria-controls=tools-phpinfo role=tab data-toggle=tab>PHPinfo</a></li>\t    <li role=presentation><a href=#tools-site aria-controls=tools-site role=tab data-toggle=tab>Preload</a></li>\t    <li role=presentation><a href=#tools-reset aria-controls=tools-reset role=tab data-toggle=tab>Reset</a></li>\t    <li role=presentation id=tab-tools-touch><a href=#tools-touch aria-controls=tools-touch role=tab data-toggle=tab>Cache</a></li>\t    <li role=presentation id=tab-tools-previews><a href=#tools-previews aria-controls=tools-previews role=tab data-toggle=tab>Previews</a></li>\t    <li role=presentation id=tab-tools-updates><a href=#tools-updates aria-controls=tools-upates role=tab data-toggle=tab>X3 Updates</a></li>    </ul>    </div>    <div id=myTabContent class=tab-content>      <div role=tabpanel class='tab-pane fade tools-mini active in' id=tools-auth>"+tools_auth_template+"</div>      <div role=tabpanel class='tab-pane fade' id=tools-htaccess>"+tools_htaccess_template+"</div>      <div role=tabpanel class='tab-pane fade flamepix-hidden' id=tools-phpinfo>"+tools_phpinfo_template+"</div>      <div role=tabpanel class='tab-pane fade tools-mini' id=tools-site>"+tools_site_template+"</div>      <div role=tabpanel class='tab-pane fade tools-mini' id=tools-reset>"+tools_reset_template+"</div>      <div role=tabpanel class='tab-pane fade tools-mini' id=tools-touch>"+tools_touch_template+"</div>      <div role=tabpanel class='tab-pane fade' id=tools-previews>"+tools_previews_template+"</div>      <div role=tabpanel class='tab-pane fade tools-mini' id=tools-updates>"+tools_updates_template+"</div>    </div>  </div>"});var tools_phpinfo_init;$(function(){var e=!1;tools_phpinfo_init=function(){e?x3_content_show.find("#myphpinfo").html(e):(show_preloader(),$.ajax({url:"x3_tools.php",method:"POST",dataType:"html",cache:!1,data:{phpinfo:!0}}).done(function(t){t.length<1?x3Notifier("phpinfo() seems to be empty :(",2e3,null,"warning"):(x3Notifier("phpinfo loaded!",2e3,null,"success"),e=t,x3_content_show.find("#myphpinfo").html(t))}).fail(function(e,t){console.dir(e);var a=e.status+" "+e.statusText;x3Notifier(a,2e3,null,"danger"),x3_content_show.find("#myphpinfo").html(a)}).always(function(){hide_preloader()}))}});var createSiteObject,tools_preload_init,tools_phpinfo_template="<div id=myphpinfo></div>";$(function(){var e;createSiteObject=function(t){if(current_settings.settings.diagnostics)x3Notifier("You cannot create site object while diagnostics are enabled.",3e3,null,"warning");else if(current_settings.settings.preload){var a=t?x3_content_show.find(".btn-create-site-object"):e,n=a.text(),i=new Date;a.attr("disabled",!0).text("Creating site object ..."),$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",data:{site_object:!0}}).done(function(e){if(e.success){var t=new Date;x3Notifier("Site object created in "+((Number(t)-Number(i))/1e3).toFixed(2)+" seconds.",2e3,null,"success")}else void 0!==e.error?x3Notifier(e.error,2e3,null,"danger"):x3Notifier("Error",2e3,null,"danger")}).fail(function(e,t,a){console.dir(e);x3Notifier(t+": "+a,2e3,null,"danger")}).always(function(){a.text(n).attr("disabled",!1)})}else x3Notifier('This feature requires you to have "Preload entire website" enabled in main settings.',3e3,null,"warning")},tools_preload_init=function(){(e=x3_content_show.find(".btn-preload")).on("click",function(){createSiteObject(!1)})}});var tools_previews_init,tools_site_template="<h3>Preload Site Object <i class='help-icon panel-help pull-right fa fa-question-circle' data-help='preload'></i></h3><p class=boxed>Click the button below to refresh the site object, required if you are using the <em>preload</em> option in settings. <strong><a href=# class=show-help data-hidden='.preload_help'>More Info [?]</a></strong></p><p><em>*Depending on the amount of folders and the speed of your server, this process could take up to 60 seconds or even fail.</em></p><button type=button class='btn btn-primary btn-process btn-preload' data-loading-text='Creating Site Object ...'>Create site object</button>";$(function(){var e,t,a="";function n(){if(e.length){e.children(".previews-log").remove();var n=t.text();t.attr("disabled",!0).text("Updating ..."),$.ajax({method:"POST",url:"x3_previews.php",dataType:"html"}).done(function(t){x3Notifier("Previews updated",2e3,null,"success"),a="<div class=previews-log>"+t+"</div>",e.append(a)}).fail(function(e,t,a){console.dir(e);x3Notifier(t+": "+a,2e3,null,"danger")}).always(function(){setTimeout(function(){t.attr("disabled",!1).text(n)},1e3)})}}tools_previews_init=function(){e=x3_content_show.find("#tools-previews"),t=e.find(".btn-previews"),a&&e.find("table").length<1&&e.append(a),x3_navbar_nav.find("li#refresh").is(":visible")&&e.find(".remember").length<1&&e.find(".boxed").append('<em class="remember"><br><br>* Remember to refresh menu after update, if there are changes.<em>'),t.on("click",n)}});var tools_reset_init,tools_previews_template="<h3>Update Preview Images<i class='help-icon panel-help pull-right fa fa-question-circle' data-help='previews'></i></h3><p class=boxed>This tool will try to automatically set preview images for your pages, unless they are already set correctly.</p><button type=button class='btn btn-primary btn-process btn-previews' data-setting-text='Updating ...'>Update Preview Images</button>";$(function(){var e;function t(){e.button("loading"),$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",data:{reset_settings:!0}}).done(function(e){"already"==e.success?x3Notifier("Settings are already deleted",2e3,null,"primary"):e.success?(x3Notifier("Settings Successfully Reset. Logging out ...",2e3,null,"success"),setTimeout(function(){location.replace("logout.php")},2e3)):void 0!==e.error?x3Notifier(e.error,2e3,null,"danger"):x3Notifier("Error",2e3,null,"danger")}).fail(function(e,t,a){console.dir(e);x3Notifier(t+": "+a,2e3,null,"danger")}).always(function(){setTimeout(function(){e.button("reset")},1e3)})}tools_reset_init=function(){(e=x3_content_show.find(".btn-reset")).on("click",t)}});var tools_touch_init,tools_reset_template="<h3>Reset Settings<i class='help-icon panel-help pull-right fa fa-question-circle' data-help='reset'></i></h3><p class=boxed>Click below button to reset settings to default. The reset includes username and password, so you will automatically be logged out after reset.</p><p><em>*Reset will not affect your individual page settings.</em></p><button type=button class='btn btn-primary btn-process btn-reset' data-loading-text='Resetting settings to default ...'>Reset Settings</button>";$(function(){var e;function t(){var t=e.text();e.attr("disabled",!0).text("Clearing ..."),$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",data:{touch:!0}}).done(function(e){e.success?x3Notifier(e.success,2e3,null,"success"):void 0!==e.warning?x3Notifier(e.warning,2e3,null,"warning"):void 0!==e.error?x3Notifier(e.error,2e3,null,"danger"):x3Notifier("Error",2e3,null,"danger")}).fail(function(e,t,a){console.dir(e);x3Notifier(t+": "+a,2e3,null,"danger")}).always(function(){setTimeout(function(){e.text(t).attr("disabled",!1)},1e3)})}tools_touch_init=function(){(e=x3_content_show.find(".btn-touch")).on("click",t)}});var tools_updates_init,tools_touch_template="<h3>Clear Page Cache</h3><p class=boxed>This tool allows you to clear the X3 page cache, so that new pages are created. This process is not necessary, because pages are <em>always</em> recreated if you make any changes from the panel. It may however be useful if you are making changes by FTP, or if you simply want to clear the page cache as part of maintenance.</p><button type=button class='btn btn-primary btn-process btn-touch' data-invalidating-text='Clearing ...'>Clear Page Cache</button>";!function(){var e,t,a="https://imagevuex.com",n=a+"/d/",i=a+"/download/";function o(){show_preloader(),$.post(n,{latest:!0,json:!0}).done(function(e){console.dir(e),e&&e.status?(x3Notifier("X3 updates loaded",2e3,null,"success"),function(e){var a=location.search.indexOf("force_update")>-1,n=!!e.version&&"X"+e.version,o=e.text?e.text:'<strong>X3 Updater</strong> <span class="label label-warning">Beta</span><br>We recommend using the X3 updater to automatically install latest version of X3.',l='<div style="margin-bottom:0;" class="alert alert-danger" role="alert">';if(a||function(e,t){if(!e||!t)return!1;var a=e.split(".").map(function(e){return parseInt(e)}),n=t.split(".").map(function(e){return parseInt(e)});{if(a[0]>n[0])return!0;if(a[0]===n[0])return a[1]>n[1]||a[1]===n[1]&&a[2]>n[2]}return!1}(e.version,x3_version)){var s="<br><br>";if(has_ziparchive?root_writeable?has_curl?s+=x3_license||location.search.indexOf("ignore_license")>-1?'<button class="btn btn-primary btn-updater">Update to '+n+" now!</button>":'<div class="alert alert-danger text-center" role="alert" style="font-size: inherit; margin-bottom: 0;">A valid X3 license is required to update X3.<br><a href="https://imagevuex.com/buy/" target="_blank" class="btn btn-danger" style="margin-top: .7em;">Purchase X3 License</a></div>':s+=l+"You server is missing PHP <a href=http://php.net/manual/en/book.curl.php target=_blank>cURL</a>, required to download update from remote server.</div>":s+=l+"You will need to enable <strong>write permissions</strong> on your root X3 directory before you can proceed with the X3 updater.</div>":s+=l+"You server is missing PHP <a href=http://php.net/manual/en/class.ziparchive.php target=_blank>ZipArchive</a> class.</div>",t.append('<div class="panel panel-primary text-left"><div class="panel-heading">New version <strong>'+n+'</strong> available!</div><div class="panel-body">'+o+s+'</div></div><div class="panel panel-default text-left"><div class="panel-heading">Manually update to <strong>'+n+'</strong></div><div class="panel-body">If you for technical reasons can\'t use the X3 updater above, you can update X3 manually:<br><br>1. <a href="'+i+'X3.latest.update.zip">Download</a> latest X3 update.<br>2. Unzip the downloaded ZIP file.<br>3. Upload update files into your X3 directory by FTP.<br>4. After update, go to your <a href="../?diagnostics">diagnostics</a> page.</div></div>'),!x3_license)return;var r=t.find(".btn-updater");r.length&&r.on("click",function(e){r.addClass("disabled").text("Loading updater ..."),show_preloader(),$.post("x3_tools.php",{copy_updater:!0}).done(function(e){if(e.success)x3Notifier("Updater loaded!",2e3,null,"success"),r.text("Redirecting ..."),window.location.href="../x3_updater.php";else{var t=e.msg?e.msg:"Failed to download X3 updater.";x3Notifier(t,2e3,null,"danger"),r.after(l+t+"</div>"),r.remove()}}).fail(function(e){x3Notifier("Failed to start updater",2e3,null,"danger")}).always(function(e){hide_preloader()})})}else t.append('<div class="alert alert-success">You are already using latest release <strong>X'+x3_version+"</strong>!</div>")}(e)):x3Notifier("Failed to load X3 updates",2e3,null,"danger")}).fail(function(e){x3Notifier("Failed to load X3 updates",2e3,null,"danger"),t.append('<div id="ad-container" style="position:absolute;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=" id="ad"></div>');var a=t.children("#ad-container");a.is(":visible")||t.append('<div class="alert alert-danger" role="alert">You seem to have an <strong>Adblock</strong> extension which is preventing X3 from loading remote data. Please disable adblock for this page.</div>'),a.remove()}).always(function(e){hide_preloader()})}tools_updates_init=function(){e=x3_content_show.find("#tools-updates"),t=e.children(".x3-updates"),o()}}();var x3Uploader,tools_updates_template="<div class=x3-updates>\t<h3>X3 Updates</h3></div>",thumbsize=window.devicePixelRatio>1?"200":"100";$(function(){var e,t,a,n,i,o,l=window.devicePixelRatio>1?2:1,s=!/Android(?!.*Chrome)|Opera/.test(window.navigator&&navigator.userAgent);function r(t){(i+=t)>0&&!e.hasClass("hasqueue")?e.addClass("hasqueue"):i<1&&e.hasClass("hasqueue")&&e.removeClass("hasqueue"),e.find(".queue-text").text(i+" files in upload queue.")}function d(){var e={disableImageResize:!a.is(":checked")||!s,imageMaxWidth:Number(n.find("#resize-width").val()),imageMaxHeight:Number(n.find("#resize-height").val()),imageQuality:Number(n.find("#resize-quality").val())/100};x3UpdateSettings(e),o.fileupload("option",e)}x3Uploader=function(c){e=x3_content_show.children(".modal#uploader"),o=e.find("#fileupload"),t=e.find(".resize-options"),a=t.find(".resize-toggle input"),n=t.find(".resize-inputs"),i=0;var p={disableImageResize:Boolean(x3_settings.disableImageResize)||!Boolean(c.img_resize)||!s,imageMaxWidth:Number(x3_settings.imageMaxWidth||c.img_resize_width),imageMaxHeight:Number(x3_settings.imageMaxHeight||c.img_resize_height),imageQuality:Number(x3_settings.imageQuality||Number(c.img_resize_quality)/100)};a.prop("checked",!p.disableImageResize).parent("label").toggleClass("active",!p.disableImageResize),n.toggle(!p.disableImageResize),n.find("#resize-width").val(p.imageMaxWidth),n.find("#resize-height").val(p.imageMaxHeight),n.find("#resize-quality").val(100*p.imageQuality),e.removeClass("hasqueue isuploaded"),n.on("change","input",function(e){d()}),a.change(function(){setTimeout(function(){var e=a.is(":checked");n.toggle(e),d()},10)}),e.find('.resize-options input[type="number"]').on("input",function(e){var t=Number($(this).attr("maxlength"));this.value.length>t&&(this.value=this.value.slice(0,t))}).on("blur",function(e){0==this.value.length?this.value=$(this).attr("placeholder"):Number(this.value)<parseInt($(this).attr("min"))?this.value=$(this).attr("min"):Number(this.value)>parseInt($(this).attr("max"))&&(this.value=$(this).attr("max")),this.value=Number(this.value)}).numericInput(),e.find("button.view").click(function(t){e.find(".modal-footer > button").last().click()}),o.fileupload({dropZone:o.find("#dropzone"),url:c.path,disableImageResize:p.disableImageResize,imageMaxWidth:p.imageMaxWidth,imageMaxHeight:p.imageMaxHeight,imageQuality:p.imageQuality,loadImageMaxFileSize:4e7,disableVideoPreview:!0,previewMaxWidth:100*l,previewMaxHeight:50*l,previewMinWidth:100*l,previewMinHeight:50*l,previewOrientation:c.orientation,imageOrientation:c.orientation,acceptFileTypes:c.acceptFileTypes}).bind("fileuploadadded",function(t,a){var n=e.find("tr.template-download");e.hasClass("isuploaded")&&n.length&&n.remove(),!0!==a.files.error&&r(1)}).bind("fileuploadfailed",function(e,t){!0!==t.files.error&&r(-1)}).bind("fileuploadstart",function(t,a){e.addClass("isuploading")}).bind("fileuploadstop",function(t){e.removeClass("isuploading").addClass("isuploaded"),i=0,r(0)})}});