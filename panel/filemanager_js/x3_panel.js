/* www.photo.gallery X3.27.6 2019-03-05 */

var e,x3_show_conf,x3_conf_button,x3_mtree,x3_modal_new_folder,x3_modal_new_zip_file,x3_modal_copy_selected,x3_modal_move_selected,x3_modal_remove_selected,x3_modal_uploader,container_id_tree,container_id_tree2,container_id_tree3,t=$("html"),a=$(window),n=$("body"),i=n.children(".footer"),o=n.children(".x3-panel-container"),l=o.children("#preloader"),s=o.find("#content_show"),r=o.children(".navbar"),d=r.find("#welcome"),c=r.find(".navbar-nav"),x3_search_input=r.find("#searchInput"),u=o.find("#left_sidebar"),p=i.find(".x3-scroll-up");function h(t){e.find(".modal-body").html(t),e.modal()}function m(e,t){"error"===e.toLowerCase()&&"forbidden"===t.toLowerCase()&&h('<p><span class="label label-danger" style="font-size: 1.8em; display: inline-block;">Firewall Detected!</span></p><p>Your server returns "Forbidden" when trying to POST X3 settings to <code>x3_settings.php</code>. This indicates that your server has a firewall, which is blocking the POST. You need to ask your host to disable the firewall (or disable some rules) for the <code>/panel/</code> directory.</p><p>There is nothing wrong with having a Firewall, but X3 needs to be able to SAVE settings obviously. The firewall is meant to protect your website, but your X3 panel is already protected by login for known users.</p>')}function f(e){!0===e?a.resize():setTimeout(function(){a.resize()},500)}function g(){a.scrollTop()>75&&t.velocity("stop").velocity("scroll",{duration:500,easing:"easeInOutCubic",complete:function(){v||(v=!0,p.velocity("stop").velocity("fadeOut",{duration:200}))}})}!function(){n.append('<div class="modal" id="modal-settings" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body"></div></div></div></div>');var t=(e=n.children("#modal-settings")).find(".modal-body");n.on("click","a.show-help, a.text-help, .panel-help",function(a){a.stopPropagation(),a.preventDefault();var n=$(this);if(n.data("help"))var i=x3_help[n.data("help")];else i=(n.siblings(".hidden").length>0?n.siblings(".hidden"):s.find(n.data("hidden"))).html();t.html(i),e.modal()}),s.on("click","#newFolder button.btn-primary",function(e){$(this);var t=x3_modal_new_folder.find("input#new_folder").val();t.length>0&&function(e){new_folder_path=e,kt(x3_modal_new_folder.data("there")||null)}(t)});var a,i,o,l,r="",d=!1,c="",u=location.hostname+y();function p(e,t){i.text()!==e&&(i.removeClass("label-warning label-danger"),i.text(e).addClass(t?"label-danger":"label-warning").velocity("stop").velocity({opacity:[1,0]},{duration:200})),t&&(clearTimeout(a),d=!0,a=setTimeout(function(){d=!1,i.text()!==r&&i.removeClass("label-danger").addClass("label-warning").text(r).velocity("stop").velocity({opacity:[1,0]},{duration:200})},2e3))}s.on("focus","#new_folder, #rename_new_name",function(e){var t=$(this),a=t.closest("#newFolder");i=t.siblings(".url-info"),o=t.siblings(".url-helper"),l=t.closest(".modal-content").find("button.btn-primary, button.btn-success"),a.length&&(c=(a.data("there")||here).split("./content")[1].replace(/\/\d+\./g,"/").replace(/\/$/,""))}),n.on("keypress keyup focus","#new_folder, #rename_new_name:not(.input-move)",function(e){var t=String.fromCharCode(e.which);if("#$%^&*()+=[]'\"/\\|{}`~!@?,".indexOf(t)>-1)return"keypress"==e.type&&p(t+" character not allowed in folder names.",!0),!1;var a=$(this),n=a.val(),i=n.split("."),s=i.length>1&&$.isNumeric(i[0])?n.replace(i[0]+".",""):n;o.toggle(0!==s.indexOf("_")&&s.length>0&&"/custom/files"!==c).html('<i class="glyphicon glyphicon-link"></i> '+u+c+"/<span>"+s+"</span>/"),32==e.which?(p("Empty spaces are not allowed in folder names",!0),"keyup"==e.type&&a.val(n.replace(/\s+/g,"-"))):d||p("",!1),l.prop("disabled",!s);var r=a.siblings(".panel");if(r.length){var h=r.find("#new_folder_title"),m=r.find("#new_folder_label"),f=(f=s.replace(/-+|_+/g," ").trim()).charAt(0).toUpperCase()+f.substring(1);h.attr("placeholder",f),m.attr("placeholder",f)}})}(),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)});var v=!0;function b(e){c.children(".active").removeClass("active"),c.children(e).addClass("active")}function y(){var e=location.pathname.split("/").filter(function(e){return""!==e});e.pop();var t=e.join("/");return t?"/"+t:""}function w(e,t,a,n){if(!/editor-preview-active/.test(e.codemirror.getWrapperElement().lastChild.className)){n=void 0===n?a:n;var i,o=e.codemirror,l=a,s=n,r=o.getCursor("start"),d=o.getCursor("end");i=o.getSelection(),o.replaceSelection(l+i+s),r.ch+=a.length,d.ch=r.ch+i.length,o.setSelection(r,d),o.focus()}}!function(){setInterval(function(){var e=a.scrollTop()>75;(v&&e||!v&&!e)&&(v=!v,p.velocity("stop").velocity(v?"fadeOut":"fadeIn",{duration:200}))},1e3),p.on("click",g)}();var x=!!window.localStorage&&function(){try{var e="x3_test";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}();function k(){return x}function C(){var e=location.hostname.split(".");return e.length>3&&(e=e.slice(e.length-3)),3===e.length&&(e[1].length>3||"www"===e[0])&&(e=e.slice(1)),e.join(".")}function S(e){return atob(e)}var T=window[S("dXNlcng=")]===S("ZnA="),j=!T&&k()&&null!==localStorage.getItem(S("eDNfbGljZW5zZQ=="))?parseInt(localStorage.getItem(S("eDNfbGljZW5zZQ=="))):1;function E(e){return is_guest&&pt(e||"Guest user cannot make changes.",3e3,null,"danger"),is_guest}function I(e,t){return-1!=(t||location.search).search("[?&]"+e+"($|=|&)")}var O=I("debug")||"x3.locl"==location.host;function P(e,t,a){if(O){var n=["X3 panel /",e];t&&n.push(t),console[a||"log"].apply(this,n)}}!function(e,t,a,n,i){if(e&&void 0===n&&"undefined"===(n=require("underscore")))throw"Failed to load underscore.js";var o=/\[([0-9]*)\](?=\[|\.|$)/g,l={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},s={evaluate:/\{\[([\s\S]+?)\]\}/g,interpolate:/\{\{([\s\S]+?)\}\}/g},r="string"==typeof n.template("",{})?n.template:function(e,t,a){return n.template(e,a)(t)},d=function(e){return!(n.isUndefined(e)||n.isNull(e))},c=function(e,t){return"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,t)},u={util:{}},p=function(e){return d(e)&&(e=""+e)?e.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):""},h=function(e){return e.replace(/([ \!\"\#\$\%\&\'\(\)\*\+\,\.\/\:\;<\=\>\?\@\[\\\]\^\`\{\|\}\~])/g,"\\$1")};u.fieldTemplate=function(e){return'<div class="<%= cls.groupClass %> jsonform-node jsonform-error-<%= keydash %><%= elt.htmlClass ? " " + elt.htmlClass : "" %><%= (node.required && node.formElement && (node.formElement.type !== "checkbox") ? " jsonform-required" : "") %><%= (node.isReadOnly() ? " jsonform-readonly" : "") %><%= (node.disabled ? " jsonform-disabled" : "") %>" data-jsonform-type="<%= node.formElement.type %>"><% if (node.title && !elt.notitle && elt.inlinetitle !== true) { %><label class="<%= cls.labelClass %>" for="<%= node.id %>"><%= node.title %></label><% } %><div class="<%= cls.controlClass %>"><% if (node.description) { %><span class="help-block jsonform-description"><%= node.description %></span><% } %><% if (node.prepend || node.append) { %><div class="<%= node.prepend ? cls.prependClass : "" %> <%= node.append ? cls.appendClass : "" %>"><% if (node.prepend && node.prepend.indexOf("<button ") >= 0) { %><% if (cls.buttonAddonClass) { %><span class="<%= cls.buttonAddonClass %>"><%= node.prepend %></span><% } else { %><%= node.prepend %><% } %><% } %><% if (node.prepend && node.prepend.indexOf("<button ") < 0) { %><span class="<%= cls.addonClass %>"><%= node.prepend %></span><% } %><% } %>'+e+'<% if (node.append && node.append.indexOf("<button ") >= 0) { %><% if (cls.buttonAddonClass) { %><span class="<%= cls.buttonAddonClass %>"><%= node.append %></span><% } else { %><%= node.append %><% } %><% } %><% if (node.append && node.append.indexOf("<button ") < 0) { %><span class="<%= cls.addonClass %>"><%= node.append %></span><% } %><% if (node.prepend || node.append) { %></div><% } %><span class="help-block jsonform-errortext" style="display:none;"></span></div></div>'};var m='<div class="_jsonform-preview"><% if (value.type=="image") { %><img class="jsonform-preview" id="jsonformpreview-<%= id %>" src="<%= value.url %>" /><% } else { %><a href="<%= value.url %>"><%= value.name %></a> (<%= Math.ceil(value.size/1024) %>kB)<% } %></div><a href="#" class="<%= cls.buttonClass %> _jsonform-delete"><i class="<%= cls.iconClassPrefix %>-remove" title="Remove"></i></a> ',f=function(e,t,i){var o={template:'<input type="'+e+'" class="<%= fieldHtmlClass'+(t?" || cls.textualInputClass":"")+' %>" name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%><%= (node.isReadOnly() ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.required ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%> />',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){t.formElement&&t.formElement.autocomplete&&((n=a(t.el).find("input")).autocomplete&&n.autocomplete(t.formElement.autocomplete));if(t.formElement&&(t.formElement.tagsinput||"tagsvalue"===t.formElement.getValue)){if(!a.fn.tagsinput)throw new Error("tagsinput is not found");var n=a(t.el).find("input"),i=Array.isArray(t.value);i&&n.attr("value","").val(""),n.tagsinput(t.formElement&&t.formElement.tagsinput||{}),i&&t.value.forEach(function(e){n.tagsinput("add",e)})}if(t.formElement&&t.formElement.typeahead&&(n=a(t.el).find("input")).typeahead)if(Array.isArray(t.formElement.typeahead)){for(var o=1;o<t.formElement.typeahead.length;++o){var l=t.formElement.typeahead[o];if(l.source&&Array.isArray(l.source)){var s=l.source;l.source=function(e,t){var a=e.toLowerCase();t(s.filter(function(e){return e.toLowerCase().indexOf(a)>=0}).map(function(e){return"string"==typeof e?{value:e}:e}))}}}a.fn.typeahead.apply(n,t.formElement.typeahead)}else n.typeahead(t.formElement.typeahead)}};return i&&(o=n.extend(o,i)),o},g=function(e,t){return{template:'<input type="'+e+'" class="<%= fieldHtmlClass'+(t?" || cls.textualInputClass":"")+' %>" name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%><%= (node.isReadOnly() ? " readonly=\'readonly\'" : "") %><%= (range.min !== undefined ? " min="+range.min : "")%><%= (range.max !== undefined ? " max="+range.max : "")%><%= (range.step !== undefined ? " step="+range.step : "")%><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.required ? " required=\'required\'" : "") %><%= (node.placeholder? "placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%> />',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(t,a){if(t.range={step:1},"range"==e&&(t.range.min=1,t.range.max=100),a&&a.schemaElement){a.formElement&&a.formElement.step?t.range.step=a.formElement.step:"number"==a.schemaElement.type&&(t.range.step="any");var n="any"===t.range.step?1:t.range.step;void 0!==a.schemaElement.minimum&&(a.schemaElement.exclusiveMinimum?t.range.min=a.schemaElement.minimum+n:t.range.min=a.schemaElement.minimum),void 0!==a.schemaElement.maximum&&(a.schemaElement.exclusiveMaximum?t.range.max=a.schemaElement.maximum-n:t.range.max=a.schemaElement.maximum)}}}};u.elementTypes={none:{template:""},root:{template:"<div><%= children %></div>"},text:f("text",!0),password:f("password",!0),date:f("date",!0,{onInsert:function(e,t){if(window.Modernizr&&window.Modernizr.inputtypes&&!window.Modernizr.inputtypes.date){var i=a(t.el).find("input");if(i.datepicker){var o={dateFormat:"yy-mm-dd"};t.formElement&&t.formElement.datepicker&&"object"==typeof t.formElement.datepicker&&n.extend(o,t.formElement.datepicker),i.datepicker(o)}}}}),datetime:f("datetime",!0),"datetime-local":f("datetime-local",!0,{onBeforeRender:function(e,t){e.value&&e.value.getTime&&(e.value=new Date(e.value.getTime()-6e4*e.value.getTimezoneOffset()).toISOString().slice(0,-1))}}),email:f("email",!0),month:f("month",!0),number:g("number",!0),search:f("search",!0),tel:f("tel",!0),time:f("time",!0),url:f("url",!0),week:f("week",!0),range:g("range"),color:{template:'<input type="text" <%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %>name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>"<%= (node.disabled? " disabled" : "")%><%= (node.required ? " required=\'required\'" : "") %> />',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){a(t.el).find("#"+h(t.id)).spectrum({preferredFormat:"hex",showInput:!0})}},textarea:{template:'<textarea id="<%= id %>" name="<%= node.name %>" class="<%= fieldHtmlClass || cls.textualInputClass %>" style="<%= elt.height ? "height:" + elt.height + ";" : "" %>width:<%= elt.width || "100%" %>;"<%= (node.disabled? " disabled" : "")%><%= (node.isReadOnly() ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.required ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0},wysihtml5:{template:'<textarea id="<%= id %>" name="<%= node.name %>" style="height:<%= elt.height || "300px" %>;width:<%= elt.width || "100%" %>;"<%= (node.disabled? " disabled" : "")%><%= (node.isReadOnly() ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.required ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){var n=function(){a(t.el).data("wysihtml5")||(a(t.el).data("wysihtml5_loaded",!0),a(t.el).find("#"+h(t.id)).wysihtml5({html:!0,link:!0,"font-styles":!0,image:!0,events:{load:function(){a(this.textareaElement).removeAttr("required")}}}))};if(window.jsonform_wysihtml5_setup)window.jsonform_wysihtml5_setup(n);else var i=window.setInterval(function(){window.wysihtml5&&(window.clearInterval(i),n())},1e3)}},ace:{template:'<div id="<%= id %>" style="position:relative;height:<%= elt.height || "300px" %>;"><div id="<%= id %>__ace" style="width:<%= elt.width || "100%" %>;height:<%= elt.height || "300px" %>;"></div><input type="hidden" name="<%= node.name %>" id="<%= id %>__hidden" value="<%= escape(value) %>"/></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){(e.value&&"object"==typeof e.value||Array.isArray(e.value))&&(e.value=i.stringify(e.value,null,2))},onInsert:function(e,t){var o=function(){var e=t.formElement||{},o=window.ace.edit(a(t.el).find("#"+h(t.id)+"__ace").get(0)),l="#"+h(t.id)+"__hidden";o.getSession().setNewLineMode("unix"),o.renderer.setShowPrintMargin(!1),o.setTheme("ace/theme/"+(e.aceTheme||"twilight")),e.aceMode&&o.getSession().setMode("ace/mode/"+e.aceMode),o.getSession().setTabSize(2);var s=t.value;null===s||void 0===s?s="":("object"==typeof s||Array.isArray(s))&&(s=i.stringify(s,null,2)),o.getSession().setValue(s);var r=n.debounce(function(){a(t.el).find(l).val(o.getSession().getValue()),a(t.el).find(l).change()},600);o.getSession().on("change",r),o.on("blur",function(){a(t.el).find(l).change(),a(t.el).find(l).trigger("blur")}),o.on("focus",function(){a(t.el).find(l).trigger("focus")})};if(window.jsonform_ace_setup)window.jsonform_ace_setup(o);else var l=window.setInterval(function(){window.ace&&(window.clearInterval(l),o())},1e3)}},checkbox:{template:'<div class="checkbox"><label><input type="checkbox" id="<%= id %>" name="<%= node.name %>" value="1" <% if (value) {%>checked<% } %><%= (node.disabled? " disabled" : "")%><%= (node.required && node.schemaElement && (node.schemaElement.type !== "boolean") ? " required=\'required\'" : "") %> /><span><%= (node.inlinetitle === true ? node.title : node.inlinetitle) || "" %></span></label></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){if(t.formElement.toggleNext){var n=!0===t.formElement.toggleNext?1:t.formElement.toggleNext,i="jsonform-toggle-next jsonform-toggle-next-"+n,o=1===n?a(t.el).next():"all"===n?a(t.el).nextAll():a(t.el).nextAll().slice(0,n);o.addClass("jsonform-toggle-next-target"),a(t.el).addClass(i).find(":checkbox").on("change",function(){var e=a(this).is(":checked");a(t.el).toggleClass("checked",e),o.toggle(e).toggleClass("jsonform-toggled-visible",e)}).change()}},getElement:function(e){return a(e).parent().parent().get(0)}},file:{template:'<input class="input-file" id="<%= id %>" name="<%= node.name %>" type="file" <%= (node.required ? " required=\'required\'" : "") %>/>',fieldtemplate:!0,inputfield:!0},"file-hosted-public":{template:"<span><% if (value && (value.type||value.url)) { %>"+m+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="<%= transloaditname %>" /><input data-transloadit-name="_transloadit_<%= transloaditname %>" type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return a(e).parent().get(0)},onBeforeRender:function(e,t){t.ownerTree._transloadit_generic_public_index?t.ownerTree._transloadit_generic_public_index++:t.ownerTree._transloadit_generic_public_index=1,e.transloaditname="_transloadit_jsonform_genericupload_public_"+t.ownerTree._transloadit_generic_public_index,t.ownerTree._transloadit_generic_elts||(t.ownerTree._transloadit_generic_elts={}),t.ownerTree._transloadit_generic_elts[e.transloaditname]=t},onChange:function(e,t){if(t.ownerTree._transloadit_bound)return!1;t.ownerTree._transloadit_bound=!0;var o=a(t.ownerTree.domRoot);o.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(e){var a=n.values(e.results);a=n.flatten(a),n.each(a,function(e){var a=t.ownerTree._transloadit_generic_elts[e.field].id,l=o.find("#"+h(a)),s=n.filter(n.keys(e.meta),function(t){return!!d(e.meta[t])});e.meta=n.pick(e.meta,s),l.val(i.stringify(e))}),t.ownerTree._transloadit_bound=!1,o.unbind("submit.transloadit"),n.delay(function(){P("submit form"),t.ownerTree.submit()},10)},onError:function(e){P("assembly error",e)}})},onInsert:function(e,t){a(t.el).find("a._jsonform-delete").on("click",function(e){return a(t.el).find("._jsonform-preview").remove(),a(t.el).find("a._jsonform-delete").remove(),a(t.el).find("#"+h(t.id)).val(""),e.preventDefault(),!1})},onSubmit:function(e,t){return!t.ownerTree._transloadit_bound}},"file-transloadit":{template:"<span><% if (value && (value.type||value.url)) { %>"+m+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="_transloadit_<%= node.name %>" /><input type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return a(e).parent().get(0)},onChange:function(e,t){if(t.ownerTree._transloadit_bound)return!1;t.ownerTree._transloadit_bound=!0;var o=a(t.ownerTree.domRoot);o.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(e){var a=n.values(e.results);a=n.flatten(a),n.each(a,function(e){var t=o.find('input[name="'+e.field.replace(/^_transloadit_/,"")+'"]'),a=n.filter(n.keys(e.meta),function(t){return!!d(e.meta[t])});e.meta=n.pick(e.meta,a),t.val(i.stringify(e))}),t.ownerTree._transloadit_bound=!1,o.unbind("submit.transloadit"),n.delay(function(){P("submit form"),t.ownerTree.submit()},10)},onError:function(e){P("assembly error",e)}})},onInsert:function(e,t){a(t.el).find("a._jsonform-delete").on("click",function(e){return a(t.el).find("._jsonform-preview").remove(),a(t.el).find("a._jsonform-delete").remove(),a(t.el).find("#"+h(t.id)).val(""),e.preventDefault(),!1})},onSubmit:function(e,t){return!t.ownerTree._transloadit_bound}},select:{template:'<select name="<%= node.name %>" id="<%= id %>" class="<%= fieldHtmlClass || cls.textualInputClass %>"<%= (node.disabled? " disabled" : "")%><%= (node.required ? " required=\'required\'" : "") %>> <% _.each(node.options, function(key, val) { if(key instanceof Object) { if (value === key.value) { %> <option selected value="<%= key.value %>"><%= key.title %></option> <% } else { %> <option value="<%= key.value %>"><%= key.title %></option> <% }} else { if (value === key) { %> <option selected value="<%= key %>"><%= key %></option> <% } else { %><option value="<%= key %>"><%= key %></option> <% }}}); %> </select>',fieldtemplate:!0,inputfield:!0},tagsinput:{template:'<select name="<%= node.name %><%= node.formElement.getValue === "tagsinput" ? "" : "[]" %>" id="<%= id %>" class="<%= fieldHtmlClass || cls.textualInputClass %>" multiple<%= (node.disabled? " disabled" : "")%><%= (node.required ? " required=\'required\'" : "") %>> </select>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){if(!a.fn.tagsinput)throw new Error("tagsinput is not found");var n=a(t.el).find("select");n.tagsinput(t.formElement&&t.formElement.tagsinput||{}),t.value&&t.value.forEach(function(e){n.tagsinput("add",e)})}},imageselect:{template:'<div><input type="hidden" name="<%= node.name %>" id="<%= node.id %>" value="<%= value %>" /><div class="dropdown"><a class="<%= node.value ? buttonClass : cls.buttonClass %>" data-toggle="dropdown" href="#"<% if (node.value) { %> style="max-width:<%= width %>px;max-height:<%= height %>px"<% } %>><% if (node.value) { %><img src="<% if (!node.value.match(/^https?:/)) { %><%= prefix %><% } %><%= node.value %><%= suffix %>" alt="" /><% } else { %><%= buttonTitle %><% } %></a><div class="dropdown-menu navbar" id="<%= node.id %>_dropdown"><div><% _.each(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class="<%= buttonClass %>" style="max-width:<%= width %>px;max-height:<%= height %>px"><% if (key instanceof Object) { %><img src="<% if (!key.value.match(/^https?:/)) { %><%= prefix %><% } %><%= key.value %><%= suffix %>" alt="<%= key.title %>" /></a><% } else { %><img src="<% if (!key.match(/^https?:/)) { %><%= prefix %><% } %><%= key %><%= suffix %>" alt="" /><% } %></a> <% }); %></div><div class="pagination-right"><a class="<%= cls.buttonClass %>">Reset</a></div></div></div></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var a=t.formElement||{},n=null,i=a.imageSelectorColumns||5;e.buttonTitle=a.imageSelectorTitle||"Select...",e.prefix=a.imagePrefix||"",e.suffix=a.imageSuffix||"",e.width=a.imageWidth||32,e.height=a.imageHeight||32,e.buttonClass=a.imageButtonClass||e.cls.buttonClass,t.options.length>i?(n=Math.ceil(t.options.length/i),e.columns=Math.ceil(t.options.length/n)):e.columns=i},getElement:function(e){return a(e).parent().get(0)},onInsert:function(e,t){a(t.el).on("click",".dropdown-menu a",function(e){e.preventDefault(),e.stopPropagation();var n=("img"===e.target.nodeName.toLowerCase()?a(e.target):a(e.target).find("img")).attr("src"),i=t.formElement||{},o=i.imagePrefix||"",l=i.imageSuffix||"",s=i.imageWidth||32,r=i.imageHeight||32;n?(0===n.indexOf(o)&&(n=n.substring(o.length)),n=n.substring(0,n.length-l.length),a(t.el).find("input").attr("value",n),a(t.el).find('a[data-toggle="dropdown"]').addClass(i.imageButtonClass).attr("style","max-width:"+s+"px;max-height:"+r+"px").html('<img src="'+(n.match(/^https?:/)?"":o)+n+l+'" alt="" />')):(a(t.el).find("input").attr("value",""),a(t.el).find('a[data-toggle="dropdown"]').removeClass(i.imageButtonClass).removeAttr("style").html(i.imageSelectorTitle||"Select..."))})}},iconselect:{template:'<div><input type="hidden" name="<%= node.name %>" id="<%= node.id %>" value="<%= value %>" /><div class="dropdown"><a class="<%= node.value ? buttonClass : cls.buttonClass %>" data-toggle="dropdown" href="#"<% if (node.value) { %> style="max-width:<%= width %>px;max-height:<%= height %>px"<% } %>><% if (node.value) { %><i class="<%= cls.iconClassPrefix %>-<%= node.value %>" /><% } else { %><%= buttonTitle %><% } %></a><div class="dropdown-menu navbar" id="<%= node.id %>_dropdown"><div><% _.each(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class="<%= buttonClass %>" ><% if (key instanceof Object) { %><i class="<%= cls.iconClassPrefix %>-<%= key.value %>" alt="<%= key.title %>" /></a><% } else { %><i class="<%= cls.iconClassPrefix %>-<%= key %>" alt="" /><% } %></a> <% }); %></div><div class="pagination-right"><a class="<%= cls.buttonClass %>">Reset</a></div></div></div></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var a=t.formElement||{},n=null,i=a.imageSelectorColumns||5;e.buttonTitle=a.imageSelectorTitle||"Select...",e.buttonClass=a.imageButtonClass||e.cls.buttonClass,t.options.length>i?(n=Math.ceil(t.options.length/i),e.columns=Math.ceil(t.options.length/n)):e.columns=i},getElement:function(e){return a(e).parent().get(0)},onInsert:function(e,t){a(t.el).on("click",".dropdown-menu a",function(e){e.preventDefault(),e.stopPropagation();var n=("i"===e.target.nodeName.toLowerCase()?a(e.target):a(e.target).find("i")).attr("class"),i=t.formElement||{};n?(n=n,a(t.el).find("input").attr("value",n),a(t.el).find('a[data-toggle="dropdown"]').addClass(i.imageButtonClass).html('<i class="'+n+'" alt="" />')):(a(t.el).find("input").attr("value",""),a(t.el).find('a[data-toggle="dropdown"]').removeClass(i.imageButtonClass).html(i.imageSelectorTitle||"Select..."))})}},radios:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><% if (!elt.inline) { %><div class="radio"><label><% } else { %><label class="radio<%= cls.inlineClassSuffix %>"><% } %><input type="radio" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>"<%= (node.disabled? " disabled" : "")%><%= (node.required ? " required=\'required\'" : "") %>/><span><%= (key instanceof Object ? key.title : key) %></span></label><%= elt.inline ? "" : "</div>" %> <% }); %></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){if(t.formElement.toggleNextMap){var n={};for(var i in t.formElement.toggleNextMap){var o=t.formElement.toggleNextMap[i],l=!0===o?1:o,s="jsonform-toggle-next jsonform-toggle-next-"+l,r=1===l?a(t.el).next():"all"===l?a(t.el).nextAll():a(t.el).nextAll().slice(0,l);r.addClass("jsonform-toggle-next-target"),n[i]=r}a(t.el).addClass(s).find(":radio").on("change",function(){var e=a(this),t=e.val(),i=e.is(":checked");if(i)for(var o in n){var l=n[o];o===t?l.toggle(i).toggleClass("jsonform-toggled-visible",i):l.toggle(!i).toggleClass("jsonform-toggled-visible",!i)}else for(var o in n){(l=n[o]).toggle(!1).toggleClass("jsonform-toggled-visible",!1)}}).change()}}},radiobuttons:{template:'<div id="<%= node.id %>"  class="<%= elt.htmlClass ? " " + elt.htmlClass : "" %>"><% _.each(node.options, function(key, val) { %><label class="<%= cls.buttonClass %>"><input type="radio" style="position:absolute;left:-9999px;" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>" /><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,t){var n="active",i=t.formElement||{};i.activeClass&&(n+=" "+i.activeClass),a(t.el).find("label").on("click",function(){a(this).parent().find("label").removeClass(n),a(this).addClass(n)}).find(":checked").closest("label").addClass(n)}},checkboxes:{template:'<div id="<%= node.id %>"><%= choiceshtml %><%= children %></div>',fieldtemplate:!0,inputfield:!0,childTemplate:function(e,t){if(!t.formElement.otherField)return e;var a="";t.formElement.otherField.asArrayValue&&t.otherValues&&(a+='<% value = node.parentNode.otherValues.join(", ") %>'),a+='<input type="checkbox"<%= value !== undefined && value !== null && value !== "" ? " checked=\'checked\'" : "" %>',(!t.formElement.otherField.asArrayValue&&!0!==t.formElement.otherField.novalue||!1===t.formElement.otherField.novalue)&&(a+=' name="'+t.key+"["+(void 0!==t.formElement.otherField.idx?t.formElement.otherField.idx:t.formElement.options.length)+']" value="'+(t.formElement.optionsAsEnumOrder?1:t.formElement.otherField.otherValue||"OTHER")+'"'),a+='<%= node.disabled? " disabled" : "" %> />',a+='<span><%= node.title || "Other" %> </span>';var n="other-field";return t.formElement.otherField.inline&&(a+='<div class="other-field-content">'+e+"</div>",n="inline-"+n),a=t.formElement.inline?'<label class="'+n+' checkbox<%= cls.inlineClassSuffix %>">'+a+"</label>":'<div class="'+n+' checkbox"><label>'+a+"</label></div>",t.formElement.otherField.inline||(a+='<div class="other-field-content">'+e+"</div>"),a},onBeforeRender:function(e,t){if(t&&t.schemaElement&&t.schemaElement.items){var a=t.formElement.options;if(a){var i='<input type="checkbox"<%= checked ? " checked=\'checked\'" : "" %> name="<%= name %>" value="<%= escape(value) %>"<%= node.disabled? " disabled" : "" %> /><span><%= title %></span>';i=t.formElement.inline?'<label class="checkbox'+e.cls.inlineClassSuffix+'">'+i+"</label>":'<div class="checkbox"><label>'+i+"</label></div>";var o="";if(t.formElement.otherField&&t.formElement.otherField.asArrayValue&&t.value){var s=a.map(function(e){return e.value}),d=[];t.value.forEach(function(e){n.include(s,e)||d.push(e)}),d.length>0&&(t.otherValues=d)}else delete t.otherValues;n.each(a,function(e,a){t.formElement.otherField&&e.value===(t.formElement.otherField.otherValue||"OTHER")?t.formElement.otherField.idx=a:o+=r(i,{name:t.key+"["+a+"]",value:t.formElement.optionsAsEnumOrder?1:e.value,checked:n.include(t.value,e.value),title:e.title,node:t,escape:p},l)}),t.formElement.otherField,e.choiceshtml=o}}},onInsert:function(e,t){var n=t.formElement.otherField&&t.formElement.otherField.inline?a(t.el).find(".inline-other-field :checkbox").first():a(t.el).find(".other-field :checkbox"),i=a(t.el).find(".other-field-content :input");function o(){var e;n.prop("checked",(e=!1,i.each(function(){var t=a(this);return t.is(":checkbox, :radio")&&t.prop("checked")?(e=!0,!1):t.is("button")?void 0:""!==a(this).val()?(e=!0,!1):void 0}),e))}i.on("keyup",o).on("change",o).change(),n.on("change",function(){this.checked?(this.checked=!1,i.not(":checkbox,:radio,button").focus()):i.filter("input[type=text], textarea").val("")})}},checkboxbuttons:{template:'<div id="<%= node.id %>"><%= choiceshtml %></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var a,i=null,o='<label class="<%= cls.buttonClass %> '+e.fieldHtmlClass+'"><input type="checkbox" style="position:absolute;left:-9999px;" <% if (checked) { %> checked="checked" <% } %> name="<%= name %>" value="<%= value %>"<%= (node.disabled? " disabled" : "")%>/><span><%= title %></span></label>';t&&t.schemaElement&&t.schemaElement.items&&(a=t.formElement.options)&&(t.value&&Array.isArray(t.value)||(t.value=[]),i="",n.each(a,function(a,s){i+=r(o,{name:t.key+"["+s+"]",checked:n.include(t.value,a.value),value:a.value,title:a.title,node:t,cls:e.cls},l)}),e.choiceshtml=i)},onInsert:function(e,t){var n="active",i=t.formElement||{};i.activeClass&&(n+=" "+i.activeClass),a(t.el).find("label").on("click",function(){a(this).toggleClass(n,a(this).find("input:checkbox").prop("checked"))}).find(":checked").closest("label").addClass(n)}},array:{template:'<div id="<%= id %>"><ul class="_jsonform-array-ul" style="list-style-type:none;"><%= children %></ul><% if (!node.isReadOnly()) { %><span class="_jsonform-array-buttons"><a href="#" class="<%= cls.buttonClass %> _jsonform-array-addmore"><i class="<%= cls.iconClassPrefix %>-plus-sign" title="Add new"></i></a> <a href="#" class="<%= cls.buttonClass %> _jsonform-array-deletelast"><i class="<%= cls.iconClassPrefix %>-minus-sign" title="Delete last"></i></a></span><% } %></div>',fieldtemplate:!0,array:!0,childTemplate:function(e,t){return!t.isReadOnly()&&a("").sortable?'<li data-idx="<%= node.childPos %>"><span class="draggable line"><i class="<%= cls.iconClassPrefix %>-list" title="Move item"></i></span> <a href="#" class="_jsonform-array-item-delete"><i class="<%= cls.iconClassPrefix %>-remove" title="Remove item"></i></a>'+e+"</li>":'<li data-idx="<%= node.childPos %>">'+e+"</li>"},onInsert:function(e,t){var n=a(t.el).find("#"+h(t.id)),i=t.getArrayBoundaries(),o=function(e){var a=t.children.length-Math.max(i.minItems,0);if(n.find("> span > a._jsonform-array-deletelast").toggleClass("disabled",a<=1),n.find("> ul > li > a._jsonform-array-item-delete").toggle(a>1),a<1)return!1;t.deleteArrayItem(e),n.find("> span > a._jsonform-array-addmore").toggleClass("disabled",i.maxItems>=0&&t.children.length>=i.maxItems)};a("> span > a._jsonform-array-addmore",n).click(function(e){e.preventDefault(),e.stopPropagation(),function(e){if(i.maxItems>=0){var o=i.maxItems-t.children.length;if(n.find("> span > a._jsonform-array-addmore").toggleClass("disabled",o<=1),o<1)return!1}t.insertArrayItem(e,a("> ul",n).get(0));var l=t.children.length>i.minItems;n.find("> span > a._jsonform-array-deletelast").toggleClass("disabled",!l),n.find("> ul > li > a._jsonform-array-item-delete").toggle(l)}(t.children.length)});a("> ul > li",n).length;if(i.minItems>0)for(var l=t.children.length;l<i.minItems;l++)t.insertArrayItem(t.children.length,n.find("> ul").get(0));var s=t.children.length-Math.max(i.minItems,0);n.find("> span > a._jsonform-array-deletelast").toggleClass("disabled",s<=0),n.find("> ul > li > a._jsonform-array-item-delete").toggle(s>0),n.find("> span > a._jsonform-array-addmore").toggleClass("disabled",i.maxItems>=0&&t.children.length>=i.maxItems),a("> span > a._jsonform-array-deletelast",n).click(function(e){var a=t.children.length-1;e.preventDefault(),e.stopPropagation(),o(a)}),n.on("click","> ul > li > a._jsonform-array-item-delete",function(e){e.preventDefault();var n=a(e.currentTarget).parent();if(n.parent().parent().attr("id")==t.id){e.stopPropagation();var i=n.data("idx");o(i)}}),!t.isReadOnly()&&a(t.el).sortable&&(a("> ul",n).sortable(),a("> ul",n).bind("sortstop",function(e,i){!function(e,i){if(e!==i){var o=e<i?1:-1,l=0,s=a("> ul",n);for(l=e;l!==i;l+=o)t.children[l].switchValuesWith(t.children[l+o]),t.children[l].render(s.get(0)),t.children[l+o].render(s.get(0));var r=a(t.children[e].el),d=a(t.children[i].el);r.detach(),d.detach(),e<i?(0===e?s.prepend(r):a(t.children[e-1].el).after(r),a(t.children[i-1].el).after(d)):(0===i?s.prepend(d):a(t.children[i-1].el).after(d),a(t.children[e-1].el).after(r))}}(a(i.item).data("idx"),a(i.item).index())}))}},tabarray:{template:'<div id="<%= id %>"><div class="tabbable tabs-left"><ul class="nav nav-tabs"><%= tabs %></ul><div class="tab-content"><%= children %></div></div></div>',fieldtemplate:!0,array:!0,childTemplate:function(e){return'<div data-idx="<%= node.childPos %>" class="tab-pane">'+e+"</div>"},onBeforeRender:function(e,t){e.tabs=""},onInsert:function(e,t){var i=a(t.el).find("#"+h(t.id)),o=t.getArrayBoundaries(),l=function(e){var l="",s=!1;void 0===e&&((e=a("> .tabbable > .nav-tabs .active",i).data("idx"))?e=parseInt(e,10):(s=!0,e=0)),e>=t.children.length&&(e=t.children.length-1),n.each(t.children,function(e,a){var n=e.legend||e.title||"Item "+(a+1);l+='<li data-idx="'+a+'"><a class="draggable tab" data-toggle="tab">'+p(n),t.isReadOnly()||(l+=' <span href="#" class="_jsonform-array-item-delete"><i class="'+t.ownerTree.defaultClasses.iconClassPrefix+'-remove" title="Remove item"></i></span></a>'),l+="</li>"}),!t.isReadOnly()&&(o.maxItems<0||t.children.length<o.maxItems)&&(l+='<li data-idx="-1"><a class="tab _jsonform-array-addmore" title="'+(t.formElement.addMoreTooltip?p(t.formElement.addMoreTooltip):"Add new item")+'"><i class="'+t.ownerTree.defaultClasses.iconClassPrefix+'-plus-sign"></i> '+(t.formElement.addMoreTitle||"New")+"</a></li>"),a("> .tabbable > .nav-tabs",i).html(l);var r=o.minItems>=0&&t.children.length<=o.minItems;i.find("> .tabbable > .nav-tabs > li > a > ._jsonform-array-item-delete").toggle(!r),s&&a('> .tabbable > .nav-tabs [data-idx="0"]',i).addClass("active"),a('> .tabbable > .nav-tabs [data-toggle="tab"]',i).eq(e).click()},s=function(e){var a=t.children.length-Math.max(o.minItems,0);if(i.find("> a._jsonform-array-deleteitem").toggleClass("disabled",a<=1),i.find("> .tabbable > .nav-tabs > li > a > ._jsonform-array-item-delete").toggle(a>1),a<1)return!1;t.deleteArrayItem(e),l(),i.find("> a._jsonform-array-addmore").toggleClass("disabled",o.maxItems>=0&&t.children.length>=o.maxItems)},r=function(e){if(o.maxItems>=0){var a=o.maxItems-t.children.length;if(i.find("> a._jsonform-array-addmore").toggleClass("disabled",a<=1),a<1)return!1}t.insertArrayItem(e,i.find("> .tabbable > .tab-content").get(0)),l(e),i.find("> a._jsonform-array-deleteitem").toggleClass("disabled",t.children.length<=o.minItems)};if(a("> a._jsonform-array-deleteitem",i).click(function(e){var t=a("> .tabbable > .nav-tabs .active",i).data("idx");e.preventDefault(),e.stopPropagation(),s(t)}),i.on("click","> a._jsonform-array-addmore, > .tabbable > .nav-tabs > li > ._jsonform-array-addmore",function(e){var a=t.children.length;e.preventDefault(),e.stopPropagation(),r(a)}),i.on("click","> .tabbable > .nav-tabs > li > a > ._jsonform-array-item-delete",function(e){e.preventDefault(),e.stopPropagation();var t=a(e.currentTarget).closest("li").data("idx");s(t)}),a(t.el).on("legendUpdated",function(e){l(),e.preventDefault(),e.stopPropagation()}),!t.isReadOnly()&&a(t.el).sortable&&a("> .tabbable > .nav-tabs",i).sortable({containment:t.el,cancel:"._jsonform-array-addmore",tolerance:"pointer"}).on("sortchange",function(e,t){t.placeholder.index()==a(this).children().length-1&&-1==t.placeholder.prev().data("idx")&&t.placeholder.prev().before(t.placeholder)}).on("sortstop",function(e,n){var o=a(n.item).data("idx"),s=a(n.item).index();!function(e,n){if(e!==n){var o=e<n?1:-1,l=0,s=a("> .tabbable > .tab-content",i).get(0);for(l=e;l!==n;l+=o)t.children[l].switchValuesWith(t.children[l+o]),t.children[l].render(s),t.children[l+o].render(s)}}(o,s),l(s)}),o.minItems>=0){for(var d=t.children.length;d<o.minItems;d++)r(t.children.length);l(0)}else l();i.find("> a._jsonform-array-addmore").toggleClass("disabled",o.maxItems>=0&&t.children.length>=o.maxItems);var c=o.minItems>=0&&t.children.length<=o.minItems;i.find("> a._jsonform-array-deleteitem").toggleClass("disabled",c),i.find("> .tabbable > .nav-tabs > li > a > ._jsonform-array-item-delete").toggle(!c)}},help:{template:'<span <%= id ? \'id="\' + id + \'"\' : "" %> class="help-block" style="padding-top:5px"><%= node.helpvalue || elt.helpvalue %></span>',fieldtemplate:!0},msg:{template:"<%= elt.msg %>"},html:{template:"<%= elt.html %>"},textview:{template:'<pre id="<%= id %>" name="<%= node.name %>"><%= value %></pre>',inputfield:!0,fieldtemplate:!0},fieldset:{template:'<fieldset class="jsonform-node jsonform-error-<%= keydash %> <% if (elt.expandable) { %>expandable<% } %> <%= elt.htmlClass?elt.htmlClass:"" %>" <% if (id) { %> id="<%= id %>"<% } %> data-jsonform-type="fieldset"><% if (node.title || node.legend) { %><legend><%= node.title || node.legend %></legend><% } %><% if (elt.expandable) { %><div hidden class="<%= cls.groupClass %>"><% } %><%= children %><% if (elt.expandable) { %></div><% } %><span class="help-block jsonform-errortext" style="display:none;"></span></fieldset>'},advancedfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable jsonform-node jsonform-error-<%= keydash %> <%= elt.htmlClass?elt.htmlClass:"" %>" data-jsonform-type="advancedfieldset"><legend>Advanced options</legend><div hidden class="<%= cls.groupClass %>"><%= children %></div><span class="help-block jsonform-errortext" style="display:none;"></span></fieldset>'},authfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable jsonform-node jsonform-error-<%= keydash %> <%= elt.htmlClass?elt.htmlClass:"" %>" data-jsonform-type="authfieldset"><legend>Authentication settings</legend><div hidden class="<%= cls.groupClass %>"><%= children %></div><span class="help-block jsonform-errortext" style="display:none;"></span></fieldset>'},submit:{template:'<input type="submit" <% if (id) { %> id="<%= id %>" <% } %> class="btn btn-primary <%= elt.htmlClass?elt.htmlClass:"" %>" value="<%= value || node.title %>"<%= (node.disabled? " disabled" : "")%>/>'},button:{template:' <button <% if (id) { %> id="<%= id %>" <% } %> class="<%= cls.buttonClass %> <%= elt.htmlClass?elt.htmlClass:"" %>"><%= node.title %></button> '},actions:{template:'<div class="form-actions <%= elt.htmlClass?elt.htmlClass:"" %>"><%= children %></div>'},hidden:{template:'<input type="hidden" id="<%= id %>" name="<%= node.name %>" value="<%= escape(value) %>" <%= (node.disabled? " disabled" : "")%> />',inputfield:!0},selectfieldset:{template:'<fieldset class="tab-container <%= elt.htmlClass?elt.htmlClass:"" %>"><% if (node.legend) { %><legend><%= node.legend %></legend><% } %><% if (node.formElement.key) { %><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><% } else { %><a id="<%= node.id %>"></a><% } %><div class="tabbable"><div class="<%= cls.groupClass %><%= node.formElement.hideMenu ? " hide" : "" %>"><% if (node.title && !elt.notitle) { %><label class="<%= cls.labelClass %>" for="<%= node.id %>"><%= node.title %></label><% } %><div class="<%= cls.controlClass %>"><%= tabs %></div></div><div class="tab-content"><%= children %></div></div></fieldset>',inputfield:!0,getElement:function(e){return a(e).parent().get(0)},childTemplate:function(e){return'<div data-idx="<%= node.childPos %>" class="tab-pane<% if (node.active) { %> active<% } %>">'+e+"</div>"},onBeforeRender:function(e,t){var a=null,i=[];t.schemaElement&&(i=t.schemaElement.enum||[]),a=t.options?n.map(t.options,function(e,a){var o=t.children[a];return e instanceof Object?((e=n.extend({node:o},e)).title=e.title||o.legend||o.title||"Option "+(o.childPos+1),e.value=d(e.value)?e.value:d(i[a])?i[a]:a,e):{title:e,value:d(i[o.childPos])?i[o.childPos]:o.childPos,node:o}}):n.map(t.children,function(e,t){return{title:e.legend||e.title||"Option "+(e.childPos+1),value:i[e.childPos]||e.childPos,node:e}});var o=null;e.value&&(o=n.find(a,function(e){return e.value===t.value})),o||(o=n.find(a,function(e){return e.node.hasNonDefaultValue()})),o||(o=a[0]),o.node.active=!0,e.value=o.value;t.formElement;var l='<select class="nav '+e.cls.textualInputClass+'"'+(t.disabled?" disabled":"")+">";return n.each(a,function(e,t){l+='<option data-idx="'+t+'" value="'+e.value+'"'+(e.node.active?' class="active"':"")+">"+p(e.title)+"</option>"}),l+="</select>",e.tabs=l,e},onInsert:function(e,t){a(t.el).find("select.nav").first().on("change",function(e){var n=a(this).find("option:selected");a(t.el).find('input[type="hidden"]').first().val(n.attr("value"))})}},optionfieldset:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %>><%= children %></div>'},section:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %> class="jsonform-node jsonform-error-<%= keydash %> <%= elt.htmlClass?elt.htmlClass:"" %>"><%= children %></div>'},questions:{template:'<div><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><%= children %></div>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return a(e).parent().get(0)},onInsert:function(e,t){t.children&&0!==t.children.length&&(n.each(t.children,function(e){a(e.el).hide()}),a(t.children[0].el).show())}},question:{template:'<div id="<%= node.id %>"><% _.each(node.options, function(key, val) { %><% if (elt.optionsType === "radiobuttons") { %><label class="<%= cls.buttonClass%> <%= ((key instanceof Object && key.htmlClass) ? " " + key.htmlClass : "") %>"><% } else { %><% if (!elt.inline) { %><div class="radio"><% } %><label class="<%= elt.inline ? "radio"+cls.inlineClassSuffix : "" %> <%= ((key instanceof Object && key.htmlClass) ? " " + key.htmlClass : "") %>"><% } %><input type="radio" <% if (elt.optionsType === "radiobuttons") { %> style="position:absolute;left:-9999px;" <% } %>name="<%= node.id %>" value="<%= val %>"<%= (node.disabled? " disabled" : "")%>/><span><%= (key instanceof Object ? key.title : key) %></span></label><%= elt.optionsType !== "radiobuttons" && !elt.inline ? "</div>" : "" %> <% }); %></div>',fieldtemplate:!0,onInsert:function(e,t){var i="active",o=t.formElement||{};o.activeClass&&(i+=" "+o.activeClass),a(t.el).find('input[type="radio"]').on("change",function(e){var o=null,l=t.options[a(this).val()];t.parentNode&&t.parentNode.el&&(a(t.el).find("label").removeClass(i),a(this).parent().addClass(i),a(t.el).nextAll().hide(),a(t.el).nextAll().find('input[type="radio"]').prop("checked",!1),l.value&&a(t.parentNode.el).find('input[type="hidden"]').val(l.value),l.next&&(o=n.find(t.parentNode.children,function(e){return e.formElement&&e.formElement.qid===l.next}),a(o.el).show(),a(o.el).nextAll().hide(),a(o.el).nextAll().find('input[type="radio"]').prop("checked",!1)),l.href&&(l.target?window.open(l.href,l.target):window.location=l.href),l.submit&&setTimeout(function(){t.ownerTree.submit()},0))})}}},u.util.getObjKey=function(e,t,a){for(var i=e,l=t.split("."),s=null,r=null,d=null,c=0;c<l.length;c++){if(null===i||"object"!=typeof i)return null;if(d=(s=l[c]).replace(o,""),o.lastIndex=0,r=o.exec(s))for(i=i[d];;){if(!n.isArray(i))return null;if(i=i[parseInt(r[1],10)],!(r=o.exec(s)))break}else i=a&&!i[d]&&n.isArray(i)&&i[0]?i[0][d]:i[d]}return a&&n.isArray(i)&&i[0]?i[0]:i},u.util.getObjKeyEx=function(e,t,a){var n=e;if(null===t||void 0===t||""===t)return e;if("string"==typeof a&&a.length>0){if(t.slice(0,a.length)!==a)throw P([a,e,t]),new Error("key ["+t+"] does not match the objKey ["+a+"]");"."===(t=t.slice(a.length))[0]&&(t=t.slice(1))}var i=t.match(/^((([^\\\[.]|\\.)+)|\[(\d+)\])\.?(.*)$/);if(!i)throw new Error("bad format key: "+t);if("string"==typeof i[2]&&i[2].length>0)n=n[i[2]];else{if(!("string"==typeof i[4]&&i[4].length>0))throw new Error("impossible reach here");n=n[Number(i[4])]}return n&&i[5].length>0&&(n=this.getObjKeyEx(n,i[5])),n},u.util.setObjKey=function(e,t,a){for(var i=e,l=t.split("."),s=null,r=null,d=null,c=0;c<l.length-1;c++)if(d=(s=l[c]).replace(o,""),o.lastIndex=0,r=o.exec(s)){for(;n.isArray(i[d])||(i[d]=[]),i=i[d],d=parseInt(r[1],10),r=o.exec(s););"object"==typeof i[d]&&null!==i[d]||(i[d]={}),i=i[d]}else"object"==typeof i[d]&&null!==i[d]||(i[d]={}),i=i[d];if(d=(s=l[l.length-1]).replace(o,""),o.lastIndex=0,r=o.exec(s)){for(;n.isArray(i[d])||(i[d]=[]),i=i[d],d=parseInt(r[1],10),r=o.exec(s););i[d]=a}else i[d]=a};var v=function(e,t){var a=t.replace(/\./g,".properties.").replace(/\[[0-9]*\]/g,".items"),n=u.util.getObjKey(e,a,!0);if(n&&n.$ref)throw new Error("JSONForm does not yet support schemas that use the $ref keyword. See: https://github.com/joshfire/jsonform/issues/54");return n},b=function(e,t,a){a=a||0;var n=void 0;if(d(t)&&""!==t)if(e.default&&0==a)n=u.util.getObjKeyEx(e.default,t);else{var i=t.match(/^((([^\\\[.]|\\.)+)|\[(\d+)\])\.?(.*)$/);if(!i)throw new Error("bad format key: "+t);if("string"==typeof i[2]&&i[2].length>0)e=e.properties[i[2]];else{if(!("string"==typeof i[4]&&i[4].length>0))throw new Error("impossible reach here");e=e.items,a>0&&--a}e&&(n=e.default&&0==a?u.util.getObjKeyEx(e.default,i[5]):b(e,i[5],a))}else 0==a&&(n=e.default);return n},y=function(e,t){var a=0;return e?t&&0!==t.length?e.replace(o,function(e,n){var i=e;return d(t[a])&&(i="["+t[a]+"]"),a+=1,i}):e:null},w=function(e,t,a,i,o){var l=null;(i=i||{}).idx=i.idx||(a?a[a.length-1]:1),i.value=d(i.value)?i.value:"",i.getValue=i.getValue||function(t){return w(e,t,a,i,o)};var p=function(e,t){var a=null;return e&&e.length?(n.each(e,function(e){a||(e!==t?n.isString(e)||(e.key===t?a=e:e.items&&(a=p(e.items,t))):a={key:e})}),a):null},h=p(e.form||[],t),m=v(e.schema.properties,t);return o&&e.value&&(l=u.util.getObjKey(e.value,y(t,a))),d(l)||(h&&void 0!==h.value?l=h.value:m&&d(m.default)&&(l=m.default),l&&-1!==l.indexOf("{{values.")&&(l=l.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}')),l&&(l=r(l,i,s))),d(l)&&h&&c(h.titleMap,l)&&(l=r(h.titleMap[l],i,s)),l&&n.isString(l)&&m&&m.maxLength&&l.length>m.maxLength&&(l=l.substr(0,m.maxLength-1)+"â€¦"),d(l)?l:null},_=function(){this.id=null,this.key=null,this.el=null,this.formElement=null,this.schemaElement=null,this.view=null,this.children=[],this.ownerTree=null,this.parentNode=null,this.childTemplate=null,this.legendChild=null,this.arrayPath=[],this.childPos=0};_.prototype.clone=function(e){var t=new _;return t.childPos=this.childPos,t.arrayPath=n.clone(this.arrayPath),t.ownerTree=this.ownerTree,t.parentNode=e||this.parentNode,t.formElement=this.formElement,t.schemaElement=this.schemaElement,t.view=this.view,t.children=n.map(this.children,function(e){return e.clone(t)}),t},_.prototype.hasNonDefaultValue=function(){return(!this.formElement||"hidden"!=this.formElement.type)&&(!(!this.value||this.defaultValue)||!!n.find(this.children,function(e){return e.hasNonDefaultValue()}))},_.prototype.getProperty=function(e,t){var a=this[e];return void 0===a&&t&&this.parentNode?this.parentNode.getProperty(e,!0):a},_.prototype.isReadOnly=function(){return this.getProperty("readOnly",!0)},_.prototype.appendChild=function(e){return e.parentNode=this,e.childPos=this.children.length,this.children.push(e),e},_.prototype.removeChild=function(){var e=this.children[this.children.length-1];if(e)return a(e.el).remove(),this.children.pop()},_.prototype.moveValuesTo=function(e){var t=this.getFormValues(e.arrayPath);e.resetValues(),e.computeInitialValues(t,!0)},_.prototype.switchValuesWith=function(e){var t=this.getFormValues(e.arrayPath),a=e.getFormValues(this.arrayPath);e.resetValues(),e.computeInitialValues(t,!0),this.resetValues(),this.computeInitialValues(a,!0)},_.prototype.resetValues=function(){var e=null;if(this.value=null,this.parentNode?(this.arrayPath=n.clone(this.parentNode.arrayPath),this.parentNode.view&&this.parentNode.view.array&&this.arrayPath.push(this.childPos)):this.arrayPath=[],this.view&&this.view.inputfield)e=a(":input",this.el).serializeArray(),n.each(e,function(e){a('[name="'+h(e.name)+'"]',a(this.el)).val("")},this);else if(this.view&&this.view.array)for(;this.children.length>0;)this.removeChild();n.each(this.children,function(e){e.resetValues()})},_.prototype.setChildTemplate=function(e){this.childTemplate=e,e.parentNode=this},_.prototype.getChildTemplate=function(){return this.childTemplate||this.view.array&&(this.formElement.items?key=this.formElement.items[0]||this.formElement.items:key=this.formElement.key+"[]",n.isString(key)&&(key={key:key}),this.setChildTemplate(this.ownerTree.buildFromLayout(key))),this.childTemplate},_.prototype.computeInitialValues=function(e,t,a){var i=this,o=null,l=1,c=0,p=this.ownerTree.formDesc.tpldata||{};if(a=a||0,this.parentNode?(this.arrayPath=n.clone(this.parentNode.arrayPath),this.parentNode.view&&this.parentNode.view.array&&this.arrayPath.push(this.childPos)):this.arrayPath=[],p.idx=this.arrayPath.length>0?this.arrayPath[this.arrayPath.length-1]+1:this.childPos+1,p.value="",p.getValue=function(t){return w(i.ownerTree.formDesc,t,i.arrayPath,p,!!e)},this.formElement&&(this.formElement.id?this.id=y(this.formElement.id,this.arrayPath):this.view&&this.view.array?this.id=h(this.ownerTree.formDesc.prefix)+"-elt-counter-"+n.uniqueId():this.parentNode&&this.parentNode.view&&this.parentNode.view.array?this.id=h(this.ownerTree.formDesc.prefix)+"-elt-counter-"+n.uniqueId():"button"!==this.formElement.type&&"selectfieldset"!==this.formElement.type&&"question"!==this.formElement.type&&"buttonquestion"!==this.formElement.type||(this.id=h(this.ownerTree.formDesc.prefix)+"-elt-counter-"+n.uniqueId()),this.formElement.key&&(this.key=y(this.formElement.key,this.arrayPath),this.keydash=this.key.replace(/\./g,"---")),this.name=y(this.formElement.name,this.arrayPath),n.each(["title","legend","description","append","prepend","inlinetitle","helpvalue","value","disabled","required","placeholder","readOnly"],function(e){n.isString(this.formElement[e])?(-1!==this.formElement[e].indexOf("{{values.")?this[e]=this.formElement[e].replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):this[e]=y(this.formElement[e],this.arrayPath),this[e]&&(this[e]=r(this[e],p,s))):this[e]=this.formElement[e]},this),this.formElement.options&&(this.options=n.map(this.formElement.options,function(e){var t=null;return n.isObject(e)&&e.title?(t=-1!==e.title.indexOf("{{values.")?e.title.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):y(e.title,i.arrayPath),n.extend({},e,{value:d(e.value)?e.value:"",title:r(t,p,s)})):e}))),this.view&&this.view.inputfield&&this.schemaElement){if(e)d(u.util.getObjKey(e,this.key))&&(this.value=u.util.getObjKey(e,this.key));else if(!t&&!d(this.value)){var m=b(i.ownerTree.formDesc.schema,this.key,a);d(m)&&(this.value=m,n.isString(this.value)&&(-1!==this.value.indexOf("{{values.")?this.value=this.value.replace(/\{\{values\.([^\}]+)\}\}/g,'{{getValue("$1")}}'):this.value=y(this.value,this.arrayPath),this.value&&(this.value=r(this.value,p,s))),this.defaultValue=!0)}}else if(this.view&&this.view.array){l=1;var f=this.getArrayBoundaries().minItems;if(e){var g=u.util.getObjKeyEx(e,this.key);g&&Array.isArray(g)&&(l=g.length)}else if(t)f>=0&&(l=0);else{(m=b(i.ownerTree.formDesc.schema,this.key,a))&&Array.isArray(m)&&(l=m.length)}for(c=0;c<l;c++)this.appendChild(this.getChildTemplate().clone())}if(n.each(this.children,function(n){n.computeInitialValues(e,t,a)}),this.formElement&&this.formElement.valueInLegend)for(o=this;o;){if(o.parentNode&&o.parentNode.view&&o.parentNode.view.array&&(o.legendChild=this,o.formElement&&o.formElement.legend)){o.legend=y(o.formElement.legend,o.arrayPath),p.idx=o.arrayPath.length>0?o.arrayPath[o.arrayPath.length-1]+1:o.childPos+1,p.value=d(this.value)?this.value:"",o.legend=r(o.legend,p,s);break}o=o.parentNode}},_.prototype.getFormValues=function(e){var t={};if(!this.el)throw new Error("formNode.getFormValues can only be called on nodes that are associated with a DOM element in the tree");var o=a(":input",this.el).serializeArray();o=o.concat(a(":input[type=checkbox]:not(:disabled):not(:checked)[name]",this.el).map(function(){return{name:this.name,value:this.checked}}).get()),e&&n.each(o,function(t){t.name=y(t.name,e)});for(var l=this.ownerTree.formDesc.schema,s=0;s<o.length;s++){var r=o[s].name,d=v(l.properties,r),c=null,p=null;if(d)if(d._jsonform_checkboxes_as_array&&(c=r.match(/\[([0-9]*)\]$/)))r=r.replace(/\[([0-9]*)\]$/,""),p=u.util.getObjKey(t,r)||[],"value"===d._jsonform_checkboxes_as_array&&!1!==o[s].value&&""!==o[s].value?p.push(o[s].value):!0===d._jsonform_checkboxes_as_array&&"1"===o[s].value&&p.push(d.enum[parseInt(c[1],10)]),u.util.setObjKey(t,r,p);else if("tagsinput"!==d._jsonform_get_value_by_tagsinput)if("[]"!==r.slice(-2)||(r=r.slice(0,-2),"array"!==(d=v(l.properties,r)).type)){if("boolean"===d.type&&("0"===o[s].value||"false"===o[s].value?o[s].value=!1:""===o[s].value?o[s].value=null:o[s].value=!!o[s].value),"number"!==d.type&&"integer"!==d.type||n.isString(o[s].value)&&(o[s].value.length?isNaN(Number(o[s].value))||(o[s].value=Number(o[s].value)):o[s].value=null),"string"!==d.type||""!==o[s].value||d._jsonform_allowEmpty||(o[s].value=null),"object"===d.type&&n.isString(o[s].value)&&"{"===o[s].value.substring(0,1))try{o[s].value=i.parse(o[s].value)}catch(e){o[s].value={}}if("array"===d.type&&n.isString(o[s].value))if("["===o[s].value.substring(0,1))try{o[s].value=i.parse(o[s].value)}catch(e){o[s].value=[]}else o[s].value=null;"object"!==d.type||"null"!==o[s].value&&""!==o[s].value||(o[s].value=null),o[s].name&&null!==o[s].value&&u.util.setObjKey(t,o[s].name,o[s].value)}else(p=u.util.getObjKey(t,r)||[]).indexOf(o[s].value)<0&&(p.push(o[s].value),u.util.setObjKey(t,r,p));else{var h;if(e){var m=y(r,this.arrayPath);h=a(':input[name="'+m+'"]',this.el).tagsinput("items")}else h=a(':input[name="'+r+'"]',this.el).tagsinput("items");u.util.setObjKey(t,r,h)}}return t},_.prototype.render=function(e){var t=this.generate();this.setContent(t,e),this.enhance()},_.prototype.setContent=function(e,t){var n=a(e),i=t||(this.parentNode?this.parentNode.el:this.ownerTree.domRoot),o=null;this.el?a(this.el).replaceWith(n):(o=a(i).children().get(this.childPos))?a(o).before(n):a(i).append(n),this.el=n,this.updateElement(this.el)},_.prototype.updateElement=function(e){this.id&&(this.el=a("#"+h(this.id),e).get(0),this.view&&this.view.getElement&&(this.el=this.view.getElement(this.el)),!1!==this.fieldtemplate&&this.view&&this.view.fieldtemplate&&(this.el=a(this.el).parent().parent(),(this.prepend||this.append)&&(this.el=this.el.parent()),this.el=this.el.get(0)),this.parentNode&&this.parentNode.view&&this.parentNode.view.childTemplate&&(this.el=a(this.el).parent().get(0))),n.each(this.children,function(t){t.updateElement(this.el||e)})},_.prototype.generate=function(){var e={id:this.id,keydash:this.keydash,elt:this.formElement,schema:this.schemaElement,node:this,value:d(this.value)?this.value:"",cls:this.ownerTree.defaultClasses,escape:p},t=null;this.ownerTree.formDesc.onBeforeRender&&this.ownerTree.formDesc.onBeforeRender(e,this),this.view.onBeforeRender&&this.view.onBeforeRender(e,this),t=this.template?this.template:this.formElement&&this.formElement.template?this.formElement.template:this.view.template,!1!==this.fieldtemplate&&(this.fieldtemplate||this.view.fieldtemplate)&&(t=u.fieldTemplate(t)),this.parentNode&&this.parentNode.view&&this.parentNode.view.childTemplate&&(t=this.parentNode.view.childTemplate(t,this.parentNode));var a="";return n.each(this.children,function(e){a+=e.generate()}),e.children=a,e.fieldHtmlClass="",this.ownerTree&&this.ownerTree.formDesc&&this.ownerTree.formDesc.params&&this.ownerTree.formDesc.params.fieldHtmlClass&&(e.fieldHtmlClass=this.ownerTree.formDesc.params.fieldHtmlClass),this.formElement&&void 0!==this.formElement.fieldHtmlClass&&(e.fieldHtmlClass=this.formElement.fieldHtmlClass),r(t,e,l)},_.prototype.enhance=function(){var e=this,t=null,i=null,o=n.clone(this.ownerTree.formDesc.tpldata)||{};if(this.formElement&&(this.view.onInsert&&this.view.onInsert({target:a(this.el)},this),t=this.handlers||this.formElement.handlers,(i=this.onInsert||this.formElement.onInsert)&&i({target:a(this.el)},this),t&&n.each(t,function(e,t){"insert"===t&&e({target:a(this.el)},this)},this),this.el&&(this.onChange&&a(this.el).bind("change",function(t){e.onChange(t,e)}),this.view.onChange&&a(this.el).bind("change",function(t){e.view.onChange(t,e)}),this.formElement.onChange&&a(this.el).bind("change",function(t){e.formElement.onChange(t,e)}),this.onClick&&a(this.el).bind("click",function(t){e.onClick(t,e)}),this.view.onClick&&a(this.el).bind("click",function(t){e.view.onClick(t,e)}),this.formElement.onClick&&a(this.el).bind("click",function(t){e.formElement.onClick(t,e)}),this.onKeyUp&&a(this.el).bind("keyup",function(t){e.onKeyUp(t,e)}),this.view.onKeyUp&&a(this.el).bind("keyup",function(t){e.view.onKeyUp(t,e)}),this.formElement.onKeyUp&&a(this.el).bind("keyup",function(t){e.formElement.onKeyUp(t,e)}),t&&n.each(t,function(t,n){"insert"!==n&&a(this.el).bind(n,function(a){t(a,e)})},this)),this.formElement.legend&&this.legendChild&&this.legendChild.formElement)){function l(t){e.formElement&&e.formElement.legend&&e.parentNode&&(e.legend=y(e.formElement.legend,e.arrayPath),o.idx=e.arrayPath.length>0?e.arrayPath[e.arrayPath.length-1]+1:e.childPos+1,o.value=a(t.target).val(),e.legend=r(e.legend,o,s),a(e.parentNode.el).trigger("legendUpdated"))}a(this.legendChild.el).on("keyup",l),a(this.legendChild.el).on("change",l)}n.each(this.children,function(e){e.enhance()})},_.prototype.insertArrayItem=function(e,t){var a=0;void 0===e&&(e=this.children.length);var n=this.getChildTemplate().clone();for(this.appendChild(n),n.resetValues(),a=this.children.length-2;a>=e;a--)this.children[a].moveValuesTo(this.children[a+1]);for(this.children[e].resetValues(),this.children[e].computeInitialValues(null,!1,this.children[e].arrayPath.length),a=e;a<this.children.length;a++)this.children[a].render(t)},_.prototype.deleteArrayItem=function(e){var t=0;for(void 0===e&&(e=this.children.length-1),t=e;t<this.children.length-1;t++)this.children[t+1].moveValuesTo(this.children[t]),this.children[t].render();this.removeChild()},_.prototype.getArrayBoundaries=function(){if(!this.view||!this.view.array)return{minItems:-1,maxItems:-1};var e=function(t,a){var i=null,o=null,l={minItems:-1,maxItems:-1};return a=a||t,t.view&&t.view.array&&t!==a?l:t.key?(o=t.key.replace(/\[[0-9]+\]/g,"[]"),t!==a&&(o=o.replace(/\[\][^\[\]]*$/,"")),(i=v(t.ownerTree.formDesc.schema.properties,o))?(i.minItems>=0&&(l.minItems=i.minItems),i.minLength>=0&&(l.minItems=i.minLength),i.maxItems>=0&&(l.maxItems=i.maxItems),i.maxLength>=0&&(l.maxItems=i.maxLength),l):l):(n.each(t.children,function(t){var n=e(t,a);-1!==n.minItems&&(-1!==l.minItems?l.minItems=Math.max(l.minItems,n.minItems):l.minItems=n.minItems),-1!==n.maxItems&&(-1!==l.maxItems?l.maxItems=Math.min(l.maxItems,n.maxItems):l.maxItems=n.maxItems)}),l)};return e(this)};var x=function(){this.eventhandlers=[],this.root=null,this.formDesc=null};x.prototype.initialize=function(e){e=e||{},this.formDesc=n.clone(e),u.defaultClasses=this.formDesc.isBootstrap2||u.isBootstrap2?{groupClass:"control-group",groupMarkClassPrefix:"",labelClass:"control-label",controlClass:"controls",iconClassPrefix:"icon",buttonClass:"btn",textualInputClass:"",prependClass:"input-prepend",appendClass:"input-append",addonClass:"add-on",inlineClassSuffix:" inline"}:{groupClass:"form-group",groupMarkClassPrefix:"has-",labelClass:"control-label",controlClass:"controls",iconClassPrefix:"glyphicon glyphicon",buttonClass:"btn btn-default",textualInputClass:"form-control",prependClass:"input-group",appendClass:"input-group",addonClass:"input-group-addon",buttonAddonClass:"input-group-btn",inlineClassSuffix:"-inline"},this.defaultClasses=n.clone(u.defaultClasses),this.formDesc.defaultClasses&&n.extend(this.defaultClasses,this.formDesc.defaultClasses),this.formDesc.prefix=this.formDesc.prefix||"jsonform-"+n.uniqueId(),this.formDesc.schema&&!this.formDesc.schema.properties&&(this.formDesc.schema={properties:this.formDesc.schema});var t=[];function a(e){if(e&&e.properties){var n=Array.isArray(e.required)?e.required:[];for(var i in e.properties){var o=e.properties[i];if(!0===o.required)n.indexOf(i)<0&&n.push(i);else if(void 0!==o.required&&!1!==o.required&&!Array.isArray(o.required))throw new Error("field "+i+"'s required property should be either boolean or array of strings");if("object"===o.type?t.indexOf(o)<0&&(t.push(o),a(o)):delete o.required,"array"===o.type&&o.items){if(Array.isArray(o.items))throw new Error("the items property of array property "+i+" in the schema definition must be an object");"object"===o.items.type&&t.indexOf(o.items)<0&&(t.push(o.items),a(o.items))}}n.length>0?e.required=n:delete e.required}}if(a(this.formDesc.schema),this.formDesc.schema.definitions)for(var o in this.formDesc.schema.definitions)a(this.formDesc.schema.definitions[o]);this.formDesc._originalSchema=this.formDesc.schema,this.formDesc.schema=i.parse(i.stringify(this.formDesc.schema));var l=[];this.formDesc.schema.definitions&&function e(t,a){Object.keys(t).forEach(function(n,i,o){var s=t[n];if(null!==s&&"object"==typeof s)if(s.$ref)if("#/definitions/"===s.$ref.slice(0,14)){var r=s.$ref.replace(/^#\/definitions\//,"");t[n]=a[r]}else P("Unresolved $ref: "+s.$ref);else l.indexOf(s)<0&&(e(s,a),l.push(s))})}(this.formDesc.schema,this.formDesc.schema.definitions),this.formDesc.form=this.formDesc.form||["*",{type:"actions",items:[{type:"submit",value:"Submit"}]}],this.formDesc.form=n.isArray(this.formDesc.form)?this.formDesc.form:[this.formDesc.form],this.formDesc.params=this.formDesc.params||{},this.root=new _,this.root.ownerTree=this,this.root.view=u.elementTypes.root,this.buildTree(),this.computeInitialValues()},x.prototype.buildTree=function(){n.each(this.formDesc.form,function(e){"*"===e?n.each(this.formDesc.schema.properties,function(e,t){this.formDesc.nonDefaultFormItems&&this.formDesc.nonDefaultFormItems.indexOf(t)>=0||this.root.appendChild(this.buildFromLayout({key:t}))},this):(n.isString(e)&&(e={key:e}),this.root.appendChild(this.buildFromLayout(e)))},this)},x.prototype.buildFromLayout=function(e,t){var a,i=null,o=new _;if(e.key&&this.formDesc.customFormItems){var l=this.formDesc.customFormItems[e.key];void 0!==l&&(l.key=e.key,e=l)}if((e=n.clone(e)).items&&(n.isArray(e.items)?e.items=n.map(e.items,n.clone):e.items=[n.clone(e.items)]),e.key){if(!(i=v(this.formDesc.schema.properties,e.key)))throw new Error('The JSONForm object references the schema key "'+e.key+'" but that key does not exist in the JSON schema');function s(e,t){e.options?Array.isArray(e.options)?e.options=e.options.map(function(e){return c(e,"value")?e:{value:e,title:e}}):"object"==typeof e.options&&(e.options=Object.keys(e.options).map(function(t){return{value:t,title:e.options[t]}})):e.titleMap?e.options=n.map(t,function(t){var a=t.toString();return{value:t,title:c(e.titleMap,a)?e.titleMap[a]:a}}):e.options=t.map(function(e){return{value:e,title:e.toString()}})}if(this.formDesc.onElementSchema&&this.formDesc.onElementSchema(e,i),e.name=e.name||e.key,e.title=e.title||i.title,e.description=e.description||i.description,e.readOnly=e.readOnly||i.readOnly||e.readonly||i.readonly,e.required=!0===e.required||!0===i.required||function e(t,a){var n=t.split("."),i=n.pop();if("[]"==i.slice(-2))return!1;var o=n.join("."),l=!1;if(o){var s=v(a.properties,o);(l=s.required&&s.required.indexOf(i)>=0)&&(l="[]"==o.slice(-2)||e(o,a))}else l=a.required&&a.required.indexOf(i)>=0;return l}(e.key,this.formDesc.schema),e.id||(e.id=h(this.formDesc.prefix)+"-elt-"+e.key),e.allowEmpty&&(i._jsonform_allowEmpty=!0),e.type||("string"===i.type&&"color"===i.format?e.type="color":"number"!==i.type&&"integer"!==i.type||i.enum?"string"!==i.type&&"any"!==i.type||i.enum?"boolean"===i.type?e.type="checkbox":"object"===i.type?i.properties?e.type="fieldset":e.type="textarea":n.isUndefined(i.enum)?e.type=i.type:e.type="select":e.type="text":e.type="number"),e.options)s(e);else if(i.enum||"boolean"===i.type){(r=i.enum)?e.optionsAsEnumOrder=!0:r="select"===e.type?["",!0,!1]:[!0,!1],s(e,r)}if(("checkboxes"===e.type||"checkboxbuttons"===e.type)&&i.items){var r,d=Array.isArray(i.items)?i.items[0]:i.items;if(e.options)s(e),d._jsonform_checkboxes_as_array="value";else(r=d.enum)&&(s(e,r),e.optionsAsEnumOrder=!0,d._jsonform_checkboxes_as_array="checkboxes"===e.type||"value")}"tagsinput"===e.getValue&&(i._jsonform_get_value_by_tagsinput="tagsinput"),"object"===i.type&&n.each(i.properties,function(t,a){var n=e.key+"."+a;this.formDesc.nonDefaultFormItems&&this.formDesc.nonDefaultFormItems.indexOf(n)>=0||o.appendChild(this.buildFromLayout({key:n}))},this)}if(e.type||(e.type="text"),!(a=u.elementTypes[e.type]))throw new Error('The JSONForm contains an element whose type is unknown: "'+e.type+'"');if(i){if(!a.inputfield&&!a.array&&"selectfieldset"!==e.type&&"object"!==i.type)throw new Error('The JSONForm contains an element that links to an element in the JSON schema (key: "'+e.key+'") and that should not based on its type ("'+e.type+'")')}else if(a.inputfield&&"selectfieldset"!==e.type)throw new Error('The JSONForm defines an element of type "'+e.type+'" but no "key" property to link the input field to the JSON schema');if(e.iddot=h(e.id||""),o.formElement=e,o.schemaElement=i,o.view=a,o.ownerTree=this,e.handlers||(e.handlers={}),o.view.array);else if(e.items)n.each(e.items,function(e){n.isString(e)&&(e={key:e}),o.appendChild(this.buildFromLayout(e))},this);else if(e.otherField){var p=e.otherField;n.isString(p)?p=e.otherField={key:p,notitle:!0}:void 0===p.notitle&&(p.notitle=!0),void 0===p.inline&&(p.inline=e.inline),o.appendChild(this.buildFromLayout(p))}return o},x.prototype.computeInitialValues=function(){this.root.computeInitialValues(this.formDesc.value)},x.prototype.render=function(e){e&&(this.domRoot=e,this.root.render(),this.hasRequiredField()&&a(e).addClass("jsonform-hasrequired"),a(e).addClass("jsonform"))},x.prototype.forEachElement=function(e){var t=function(a){for(var n=0;n<a.children.length;n++)e(a.children[n]),t(a.children[n])};t(this.root)},x.prototype.validate=function(e){var n=u.getFormValue(this.domRoot),i=!1,o=this.formDesc;if(!1!==o.validate){var l=!1;if("object"!=typeof o.validate?t.ZSchema?(l=new t.ZSchema)._vendor="z-schema":t.jjv?(l=t.jjv())._vendor="jjv":t.JSONFormValidator&&((l=t.JSONFormValidator.createEnvironment("json-schema-draft-03"))._vendor="jsv"):l=o.validate,l)if(a(this.domRoot).jsonFormErrors(!1,o),"jjv"==l._vendor){(s=l.validate(this.formDesc._originalSchema,n))&&(i=[s])}else{var s=l.validate(n,this.formDesc._originalSchema);"z-schema"==l._vendor?(i=l.getLastErrors(),s=s?null:{errors:i}):s&&s.errors&&s.errors.length&&(i||(i=[]),i=i.concat(s.errors))}}return i&&!e&&(o.displayErrors?o.displayErrors(i,this.domRoot):a(this.domRoot).jsonFormErrors(i,o)),{errors:i,values:n}},x.prototype.submit=function(e){var t=function(){return e&&(e.preventDefault(),e.stopPropagation()),!1},a=u.getFormValue(this.domRoot),n=this.formDesc,i=!1;if(this.forEachElement(function(t){i||t.view.onSubmit&&(i=!t.view.onSubmit(e,t))}),i)return t();var o=this.validate();return n.onSubmit&&!n.onSubmit(o.errors,a)?t():o.errors?t():!(!n.onSubmitValid||n.onSubmitValid(a))&&t()},x.prototype.hasRequiredField=function(){return a(this.domRoot).find(".jsonform-required").length>0},u.getFormValue=function(e){var t=a(e).data("jsonform-tree");return t?t.root.getFormValues():null},a.fn.jsonFormErrors=function(e,t){var n=a(this).data("jsonform-tree");if(a("."+n.defaultClasses.groupMarkClassPrefix+"error",this).removeClass(n.defaultClasses.groupMarkClassPrefix+"error"),a("."+n.defaultClasses.groupMarkClassPrefix+"warning",this).removeClass(n.defaultClasses.groupMarkClassPrefix+"warning"),a(".jsonform-errortext",this).hide(),e){for(var i=[],o=0;o<e.length;o++){var l=e[o].uri||e[o].path;if(["OBJECT_DEPENDENCY_KEY","OBJECT_MISSING_REQUIRED_PROPERTY"].indexOf(e[o].code)>=0&&("/"!=l.slice(-1)&&(l+="/"),l+=e[o].params[0]),l){l=l.replace(/.*#\//,"").replace(/\//g,".").replace(/\.([0-9]+)(?=\.|$)/g,"[$1]");var s=".jsonform-error-"+h(l.replace(/\./g,"---"));i.push(s);var r=e[o].type||"error",d=a(s,this);"ARRAY_LENGTH_SHORT"==e[o].code&&["checkboxes","checkboxbuttons"].indexOf(d.data("jsonform-type"))>=0&&(e[o].message="Please select at least "+e[o].params[1]+(e[o].params[1]>1?" options":" option")+" above."),d.addClass(n.defaultClasses.groupMarkClassPrefix+r),d.find("> div > .jsonform-errortext, > .jsonform-errortext").text(e[o].message).show()}}i=i.join(",");var c=a(i,this),u=c.parents(".tab-pane"),p=a();u.each(function(){var e=a(this);p=p.add(e.closest(".tabbable").find("> .nav > li").eq(e.index()).addClass(n.defaultClasses.groupMarkClassPrefix+"error"))});var m=c.filter(":visible").get(0);!m&&p.length>0&&(m=p.get(0)),m&&m.scrollIntoView&&m.scrollIntoView(!0,{behavior:"smooth"})}},a.fn.jsonForm=function(e,t){if("values"===e)return u.getFormValue(this);if("submit"===e)return(o=this.data("jsonform-tree"))?o.submit():null;if("validate"===e)return(o=this.data("jsonform-tree"))?o.validate(t):null;var o,l,s,r,d;return e=n.defaults({},e,{submitEvent:"submit"}),(o=new x).initialize(e),o.render(this.get(0)),e.transloadit&&this.append('<input type="hidden" name="params" value=\''+p(i.stringify(e.transloadit.params))+"'>"),this.data("jsonform-tree",o),e.submitEvent&&(this.unbind(e.submitEvent+".jsonform"),this.bind(e.submitEvent+".jsonform",function(e){o.submit(e)})),l=function(e,t){t.find("> .active").removeClass("active"),e.addClass("active")},s=function(e,t){e.find("input, textarea, select").removeAttr("disabled"),e.parent().children(":not([data-idx="+t+"])").find("input, textarea, select").attr("disabled","disabled")},r=function(e){var t,n=a("option:selected",a(this)),i=a(this),o=n.get(0).getAttribute("data-idx")||n.attr("value");e.preventDefault(),n.hasClass("active")||(t=a(this).parents(".tabbable").eq(0).find("> .tab-content > [data-idx="+o+"]"),l(n,i),l(t,t.parent()),s(t,o))},d=function(e){a("a",a(this));var t=a(this).parents(".tabbable").first().find(".tab-content").first(),n=a(this).index(),i=t.find("[data-idx="+n+"]");e.preventDefault(),l(a(this),a(this).parent()),l(i,i.parent()),a(this).parent().hasClass("jsonform-alternative")&&s(i,n)},this.each(function(){a(this).delegate("select.nav","change",r),a(this).find("select.nav").each(function(){a(this).val(a(this).find(".active").attr("value"));var e=a(this).find("option:selected").get(0).getAttribute("data-idx")||a(this).find("option:selected").attr("value"),t=a(this).parents(".tabbable").eq(0).find("> .tab-content > [data-idx="+e+"]");s(t,e)}),a(this).delegate("ul.nav li","click",d),a(this).find("ul.nav li.active").click()}),a(".expandable > div, .expandable > fieldset",this).hide(),this.on("click",".expandable > legend",function(){var e=a(this).parent();e.toggleClass("expanded"),a("> div",e).slideToggle(100)}),o},a.fn.jsonFormValue=function(){return u.getFormValue(this)},t.JSONForm||(t.JSONForm=u)}("undefined"!=typeof exports,"undefined"!=typeof exports?exports:window,"undefined"!=typeof jQuery?jQuery:{fn:{}},"undefined"!=typeof _?_:null,JSON),jQuery&&function(e){e.extend(e.fn,{fileTree:function(t,a){if(!t)t={};void 0==t.root&&(t.root="/"),void 0==t.script&&(t.script="jqueryFileTree.php"),void 0==t.folderEvent&&(t.folderEvent="click"),void 0==t.expandSpeed&&(t.expandSpeed=500),void 0==t.collapseSpeed&&(t.collapseSpeed=500),void 0==t.expandEasing&&(t.expandEasing=null),void 0==t.collapseEasing&&(t.collapseEasing=null),void 0==t.multiFolder&&(t.multiFolder=!0),void 0==t.loadMessage&&(t.loadMessage="Loading..."),e(this).each(function(){function n(a,n){if(n.search("%")>=0){var o=n.split("%"),l=o.length-1;o[l]=o[l].replace("/",""),e.get("filemanager_js/utf-8.txt",function(l){var s=l.split("\n"),r="";for(var d in o)if(d>0)for(var c in s)s[c].indexOf(o[d])>-1&&(r=(r=s[c].split(";"))[1].split("\t"),o[d]=r[1]);o=o.join(""),n=o+"/",e(a).addClass("wait"),e(".jqueryFileTree.start").remove(),e.post(t.script,{dir:n,sign:here},function(o){e(a).find(".start").html(""),e(a).removeClass("wait").append(o),t.root==n?e(a).find("UL:hidden").show():e(a).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing}),i(a)})})}else e(a).addClass("wait"),e(".jqueryFileTree.start").remove(),e.post(t.script,{dir:n,sign:here},function(o){e(a).find(".start").html(""),e(a).removeClass("wait").append(o),t.root==n?e(a).find("UL:hidden").show():e(a).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing}),i(a)})}function i(i){e(i).find("LI A").bind(t.folderEvent,function(){return e(this).parent().hasClass("directory")?e(this).parent().hasClass("collapsed")?(t.multiFolder||(e(this).parent().parent().find("UL").slideUp({duration:t.collapseSpeed,easing:t.collapseEasing}),e(this).parent().parent().find("LI.directory").removeClass("expanded").addClass("collapsed")),e(this).parent().find("UL").remove(),n(e(this).parent(),escape(e(this).attr("rel").match(/.*\//))),e(this).parent().removeClass("collapsed").addClass("expanded")):(e(this).parent().find("UL").slideUp({duration:t.collapseSpeed,easing:t.collapseEasing}),e(this).parent().removeClass("expanded").addClass("collapsed")):a(e(this).attr("rel")),!1}),"click"!=t.folderEvent.toLowerCase&&e(i).find("LI A").bind("click",function(){this_dir_selected=a(e(this).attr("rel"))})}e(this).html('<ul class="jqueryFileTree start"><li class="wait">'+t.loadMessage+"<li></ul>"),n(e(this),escape(t.root))})}}),e.extend(e.fn,{leftFileTree:function(t,a){if(!t)t={};void 0==t.root&&(t.root="/"),void 0==t.script&&(t.script="folderMenu.php"),void 0==t.folderEvent&&(t.folderEvent="click"),void 0==t.expandSpeed&&(t.expandSpeed=500),void 0==t.collapseSpeed&&(t.collapseSpeed=500),void 0==t.expandEasing&&(t.expandEasing=null),void 0==t.collapseEasing&&(t.collapseEasing=null),void 0==t.multiFolder&&(t.multiFolder=!0),void 0==t.loadMessage&&(t.loadMessage="Loading..."),e(this).each(function(){var a,n;1==first_flag&&(e(this).html('<ul class="jqueryFileTree start"><li class="wait">'+t.loadMessage+"<li></ul>"),a=e(this),n=escape(t.root),e(a).addClass("wait"),e(".jqueryFileTree.start").remove(),e.post(t.script,{dir:n,sign:here},function(i){e(a).find(".start").html(""),e(a).removeClass("wait").append(i),t.root==n?e(a).find("UL:hidden").show():e(a).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing})}))})}})}(jQuery);var A=new Array,F=!0,D=!0,N=!0;function R(e,t){if(D){if(!a)var a={};void 0==a.root&&(a.root="/"),void 0==a.script&&(a.script=e+"folderMenu.php"),void 0==a.folderEvent&&(a.folderEvent="click"),void 0==a.expandSpeed&&(a.expandSpeed=100),void 0==a.collapseSpeed&&(a.collapseSpeed=100),void 0==a.expandEasing&&(a.expandEasing=null),void 0==a.collapseEasing&&(a.collapseEasing=null),void 0==a.multiFolder&&(a.multiFolder=!0),void 0==a.loadMessage&&(a.loadMessage="Loading..."),M($("#left_folder_menu_box"),a,t)}}function M(e,t,a){$(e).attr("id");if(F){F=!1;var n=a.id;if("FILEMANAGER_NO_COLLAPSE"!=a.id){var i=document.getElementById(n).getAttribute("rel");document.getElementById(n).getAttribute("data-children");$(e).addClass("wait"),$(".jqueryFileTree.start").remove(),bt(A,a.id)?($("#"+n+" ul").remove(),vt(A,a.id),$("#"+n).removeClass("expanded"),first_flag=$("#show_left_sidebar").html(),setTimeout(function(){F=!0},500)):$.post(t.script,{dir:i,sign:here},function(o){$(e).find(".start").html(""),$(e).removeClass("wait").append(o),t.root==i?$(e).find("UL:hidden").show():($("#"+n+" ul").remove(),$(e).find("UL:hidden").appendTo("#"+n),$(e).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing}),A.push(a.id),$("#"+n).addClass("expanded"),first_flag=$("#show_left_sidebar").html(),F=!0),q(a,t)})}}}function q(e,t){$(e).bind(t.folderEvent,function(){first_flag=$("#show_left_sidebar").html()})}function L(e,t,a){$(e).attr("id");F=!1;var n=a.id;if("FILEMANAGER_NO_COLLAPSE"!=a.id){var i=document.getElementById(n).getAttribute("rel");document.getElementById(n).getAttribute("data-children");$(e).addClass("wait"),$(".jqueryFileTree.start").remove(),bt(A,a.id)?($("#"+n+" ul").remove(),vt(A,a.id),$("#"+n).removeClass("expanded"),first_flag=$("#show_left_sidebar").html(),setTimeout(function(){F=!0},500)):$.post(t.script,{dir:i,sign:here},function(o){$(e).find(".start").html(""),$(e).removeClass("wait").append(o),t.root==i?$(e).find("UL:hidden").show():($("#"+n+" ul").remove(),$(e).find("UL:hidden").appendTo("#"+n),$(e).find("UL:hidden").slideDown({duration:t.expandSpeed,easing:t.expandEasing}),A.push(a.id),$("#"+n).addClass("expanded"),first_flag=$("#show_left_sidebar").html(),F=!0),q(a,t)})}}function z(e){var t=$(".left_open_all_dir");t.children().each(function(){if(""!=$(this).attr("data-class")&&$(this).addClass($(this).attr("data-class")),"yes"==$(this).attr("data-children")){if(!a)var a={};void 0==a.root&&(a.root="/"),void 0==a.script&&(a.script=e+"folderMenu.php"),void 0==a.folderEvent&&(a.folderEvent="click"),void 0==a.expandSpeed&&(a.expandSpeed=100),void 0==a.collapseSpeed&&(a.collapseSpeed=100),void 0==a.expandEasing&&(a.expandEasing=null),void 0==a.collapseEasing&&(a.collapseEasing=null),void 0==a.multiFolder&&(a.multiFolder=!0),void 0==a.loadMessage&&(a.loadMessage="Loading..."),L($("#left_folder_menu_box"),a,this),t.removeClass("left_open_all_dir"),setTimeout(function(){z(e)},1e3,e)}})}window.onload=setTimeout(function(){z(fileTreeUserFolder)},1e3,fileTreeUserFolder),$(document).bind("drop dragover",function(e){e.preventDefault()}),$(document).bind("dragover",function(e){var t=$("#dropzone"),a=window.dropZoneTimeout;a?clearTimeout(a):t.addClass("in");var n=!1,i=e.target;do{if(i===t[0]){n=!0;break}i=i.parentNode}while(null!=i);n?t.addClass("hover"):t.removeClass("hover"),window.dropZoneTimeout=setTimeout(function(){window.dropZoneTimeout=null,t.removeClass("in hover")},100)}),function(){var e={collapsed:!0,close_same_level:!0,duration:300,list_animation:!0,easing:"easeOutQuart",use_nodes:!1,skip_init:!1};function t(t,a){this.$el=$(t);var n=this;this.options=$.extend(e,a,this.$el.data("options")),$.fn.notNodeClick=function(){var e=$(this);e.closest("ul.mtree").find(".mtree-active").removeClass("mtree-active"),e.addClass("mtree-active")},$.fn.nodeClick=function(){var e=$(this),t=e.hasClass("mtree-open");t||e.closest("ul.mtree").find(".mtree-active").removeClass("mtree-active"),e.toggleClass("mtree-active",!t),n.options.close_same_level&&!t&&e.closest("ul").children(".mtree-open").closeNodes(),e.toggleClass("mtree-open mtree-closed"),e.children("ul").first().toggleList(!t),!t&&n.options.list_animation&&e.find("> ul > li, li.mtree-open > ul > li").css({opacity:0}).velocity("stop").velocity("list")},$.fn.closeNodes=function(){var e=$(this);e.children("ul").toggleList(!1,n.options.duration/3),e.toggleClass("mtree-open mtree-closed")},$.fn.toggleList=function(e,t){var a=$(this);if(e){var i=a.css("height");a.css({height:"auto",display:"block"});var o=a.outerHeight();a.css({height:i})}a.velocity("stop").velocity({height:e?o:0},{duration:n.options.duration,delay:t||0,easing:n.options.easing,display:e?"block":"none",complete:function(){e&&a.css("height","auto")}})},$.Velocity.Sequences.list=function(e,t,a,i){$.Velocity.animate(e,{opacity:[1,0],translateY:[0,-(a+1)]},{delay:a*(n.options.duration/i/2),duration:n.options.duration,easing:n.options.easing})},this.init()}t.prototype.init=function(){var e=this.$el.find("li");this.$nodes=e.has("ul"),this.$notNodes=e.not(":has(ul)"),this.$sublists=this.$el.find("ul"),this.options.use_nodes&&this.$nodes.prepend("<span class=mtree-icon></span>"),this.$nodeButtons=this.$nodes.children(":first-child"),this.$notNodeButtons=this.$notNodes.children(":first-child"),this.options.skip_init||this.setClasses(),this.$nodeButtons.on("click.mtree-node",function(e){$t(e)||($(this).parent("li").first().nodeClick(),e.preventDefault())}),this.$notNodeButtons.on("click.mtree-notNode",function(e){$t(e)||$(this).parent("li").first().notNodeClick()})},t.prototype.setClasses=function(){this.$el.addClass("mtree"),this.$nodes.addClass("mtree-node mtree-"+(this.options.collapsed?"closed":"open")),this.$sublists.css({overflow:"hidden",height:this.options.collapsed?0:"auto",display:this.options.collapsed?"none":"block"}),this.$nodeButtons.css("cursor","pointer"),this.$sublists.each(function(e,t){var a=$(this);a.addClass("mtree-level-"+(a.parentsUntil($("ul.mtree"),"ul").length+1))})},$.fn.mtree=function(e){return this.each(function(){$.data(this,"plugin_mtree")||$.data(this,"plugin_mtree",new t(this,e))})}}();var U={layouts:{"topbar-center":"topbar-center topbar-fixed-up","topbar-float":"topbar-float topbar-fixed-up",sidebar:"sidebar","sidebar-right":"sidebar-right",slidemenu:"slidemenu topbar-center"},skins:{DAYLIGHT:"header","daylight 78a642":"daylight 78a642","daylight darkorange":"daylight darkorange","daylight tomato":"daylight tomato","daylight ffc000":"daylight ffc000","daylight salmon":"daylight salmon","daylight burlywood":"daylight burlywood","daylight yellowgreen":"daylight yellowgreen","daylight darkseagreen":"daylight darkseagreen","daylight skyblue":"daylight skyblue","daylight deeppink":"daylight deeppink","daylight palevioletred":"daylight palevioletred",TWILIGHT:"header","twilight brown":"twilight brown","twilight goldenrod":"twilight goldenrod","twilight peru":"twilight peru","twilight crimson":"twilight crimson","twilight mediumvioletred":"twilight mediumvioletred","twilight deeppink":"twilight deeppink","twilight steelblue":"twilight steelblue","twilight darkcyan":"twilight darkcyan","twilight seagreen":"twilight seagreen","twilight 78a642":"twilight 78a642",WHITE:"header","white coral":"white coral","white hotpink":"white hotpink","white lightskyblue":"white lightskyblue","white mediumaquamarine":"white mediumaquamarine","white yellowgreen":"white yellowgreen",BLACK:"header","black crimson":"black crimson","black mediumvioletred":"black mediumvioletred","black orange":"black orange","black olivedrab":"black olivedrab","black steelblue":"black steelblue",MELLOW:"header","mellow indianred":"mellow indianred","mellow darksalmon":"mellow darksalmon","mellow tan":"mellow tan","mellow darkseagreen":"mellow darkseagreen","mellow palevioletred":"mellow palevioletred",ORGANIC:"header","organic 78a642":"organic 78a642","organic indianred":"organic indianred","organic crimson":"organic crimson","organic hotpink":"organic hotpink","organic burlywood":"organic burlywood",SCIENCE:"header","science palevioletred":"science palevioletred","science indianred":"science indianred","science salmon":"science salmon","science burlywood":"science burlywood","science darkseagreen":"science darkseagreen"},fonts:{"EDITORS FAVORITES":"header","Lato Skinny":"Lato:300,300i,400,400i|paragraph:300|body:300|subheader:italic|topbar:uppercase|sidebar:uppercase,small|footer:italic|styled:italic",Lato:"Lato:400,400italic,700,700italic|subheader:italic|topbar:uppercase,large|sidebar:uppercase,small|footer:italic|styled:italic","Lato Fat":"Lato:400,700,900,400italic,700italic,900italic|logo:italic,900|header:italic,bold|subheader:italic|topbar:bold,uppercase|sidebar:bold,uppercase,small|footer:italic|styled:italic","Raleway - Amaranth":"Raleway:400,600|Amaranth","Open Sans - Fauna One":"Open+Sans:300,300italic,600,600italic|Fauna One|subheader:small|topbar:Fauna One,uppercase,small|sidebar:Fauna One,uppercase,xsmall","Ubuntu - Raleway":"Ubuntu:300,300italic,600,600italic|Raleway:300|topbar:uppercase,small","Merriweather - Alegreya Sans":"Merriweather:300,300italic,700,700italic|Alegreya+Sans:400,700|logo:700|header:700|menu:Alegreya Sans|topbar:uppercase|sidebar:uppercase|subheader:small","Ubuntu - Roboto Slab":"Ubuntu:300,300italic|Roboto+Slab:400|logo:small","Merriweather - Raleway":"Merriweather:300,300italic,700|Raleway:300|menu:Raleway|subheader:Raleway",custom0:"-","Raleway - Lobster":"Raleway:300,600,300italic|Lobster+Two:400|styled:italic|footer:italic","Merriweather - Berkshire Swash":"Merriweather:300,700,300italic|Berkshire+Swash|subheader:small","Open Sans - Paytone One":"Open+Sans:300italic,400,600|Paytone+One|subheader:small","Lato - Bubblegum Sans":"Lato:400,700,400italic|Bubblegum+Sans|subheader:small","Roboto - Shadows Into Light":"Roboto:300,300italic,700|Shadows Into Light Two|topbar:Shadows Into Light Two|sidebar:Shadows Into Light Two","Gudea - Rancho":"Gudea:400,700,400italic|Rancho|logo:large|topbar:Rancho,uppercase|sidebar:Rancho,uppercase,small|subheader:small",custom1:"-","Roboto [+Slab]":"Roboto:300italic,300|Roboto Slab:300,400|topbar:Roboto Slab|sidebar:Roboto Slab","PT Sans [+Narrow]":"PT Sans:400,700,400italic|PT Sans Narrow:400,700|logo:700|header:700|subheader:PT Sans Narrow|menu:PT Sans Narrow|topbar:uppercase|sidebar:uppercase","Roboto [+Condensed]":"Roboto:300,300italic,700|Roboto+Condensed:300|menu:Roboto+Condensed|sidebar:uppercase,small|topbar:small,uppercase|subheader:small|styled:Roboto+Condensed|footer:Roboto+Condensed","Alegreya Sans [+SC]":"Alegreya Sans:300,300italic,700|Alegreya Sans SC:400,400italic|styled:italic|footer:italic|topbar:Alegreya Sans SC|sidebar:Alegreya Sans SC","Alegreya [+SC]":"Alegreya:400,400italic,700|Alegreya SC:400|topbar:Alegreya SC|sidebar:Alegreya SC",Raleway:"Raleway:300,300italic,400,600|paragraph:300|logo:400|header:400|sidebar:uppercase,small|topbar:400,uppercase,small",Neuton:"Neuton:300,400,700,300italic|header:400|logo:400|subheader:300|paragraph:300,xxlarge|topbar:uppercase|sidebar:uppercase,small",Dosis:"Dosis:400,500,600|logo:500|header:500","SUPER STYLISH":"header","Cabin [+Sketch]":"Cabin:400,400italic,700|Cabin Sketch:700|logo:700|header:700|styled:Cabin|footer:Cabin","Handlee - Roboto":"Roboto:300,700,300italic|Handlee","Roboto Slab - Megrim":"Roboto Slab:300,700|Megrim|header:uppercase|logo:uppercase|subheader:small|topbar:uppercase","Noto Sans - Pacifico":"Noto Sans:400,700,400italic|Pacifico|subheader:small","PT Sans - Indie Flower":"PT Sans:400,700,400italic|Indie Flower|subheader:small|topbar:uppercase,small|sidebar:uppercase,small","Open Sans - Dancing Script":"Open+Sans:300,600,300italic|Dancing+Script:400,700|header:bold|logo:bold,xlarge|topbar:large","Lato - Just Another Hand":"Lato:300,300italic|Just Another Hand|logo:xxlarge|styled:large|topbar:Just Another Hand,xxlarge|sidebar:Just Another Hand,xxlarge|subheader:small","Droid Sans - Oleo Script":"Droid+Sans:400,400italic,700|Oleo+Script:400,700|sidebar:Oleo+Script|topbar:Oleo+Script,large|subheader:small","Open Sans - Lobster Two":"Open+Sans:300,600,300italic|Lobster+Two:400,700","Lato - Great Vibes":"Lato:300,300italic|Great+Vibes|logo:xxlarge|subheader:300|paragraph:300|styled:xlarge","Lato - Oldenburg":"Lato:300,300italic|Oldenburg|topbar:Oldenburg|sidebar:Oldenburg|subheader:small","Open Sans - Playfair Display":"Open+Sans:300italic,300,600|Playfair+Display:400|subheader:small","Roboto Condensed - Amatic SC":"Roboto+Condensed:300,300italic,700|Amatic+SC:700|topbar:Amatic SC,large|sidebar:Amatic SC,large","Nobile - Corben":"Open+Sans:300,300italic,600|Corben:400,700|logo:700,xsmall|subheader:small","Inconsolata - Special Elite":"Inconsolata:400,700|Special%20Elite|logo:small|topbar:Special Elite|sidebar:Special Elite|subheader:small|styled:Inconsolata","BEAUTIFUL SIBLINGS":"header","Open Sans [+Condensed]":"Open+Sans:300italic,300,600|Open Sans Condensed:300,700|menu:Open Sans Condensed|header:700|logo:700|subheader:Open Sans Condensed|topbar:uppercase|sidebar:uppercase","[+Slab] Roboto":"Roboto Slab:300,700|Roboto:900|logo:bold|header:bold","Ubuntu [+Condensed]":"Ubuntu:300,300italic,700|Ubuntu Condensed","[+Sans] Merriweather":"Merriweather Sans:300,300italic,700|Merriweather:400italic,700|logo:700|header:700|styled:italic|footer:italic|subheader:italic","Josefin Slab [+Sans]":"Josefin Slab:400,400italic,700|Josefin Sans:400|menu:Josefin Sans","Varela [+Round]":"Varela|Varela+Round|topbar:Varela+Round|sidebar:Varela+Round","POWERFUL SINGLES":"header",Roboto:"Roboto:300italic,300","Roboto Slab":"Roboto+Slab:300,400,700|paragraph:300|subheader:300","Roboto Condensed":"Roboto+Condensed:300italic,700italic,300,400,700|logo:700|header:700|paragraph:300|subheader:300|sidebar:uppercase,300|menu:300|topbar:400,uppercase,small|sidebar:uppercase,small","Droid Serif":"Droid+Serif:400,700,400italic|header:bold|logo:bold,small|subheader:italic,small|styled:italic|footer:italic","Open Sans":"Open+Sans:300,300italic,600,600italic|topbar:uppercase,small|sidebar:uppercase,small",Montserrat:"Montserrat:400,700|topbar:uppercase,small|sidebar:uppercase,xsmall",Ubuntu:"Ubuntu:300,300italic,400,400italic|subheader:300|paragraph:300",Merriweather:"Merriweather:300,300italic,400,400italic|paragraph:300|header:400|logo:400|subheader:italic|styled:italic|footer:italic|menu:italic",Lora:"Lora:400,700,400italic,700italic|subheader:italic|styled:italic|footer:italic|menu:italic","PT Sans":"PT+Sans:400,700,400italic,700italic|logo:700|header:700|subheader:italic|topbar:uppercase|sidebar:uppercase","PT Sans Narrow":"PT Sans Narrow:400,700|logo:bold|header:bold|topbar:uppercase|sidebar:uppercase,small","Noto Sans":"Noto Sans:400,700,400italic|subheader:italic,small|styled:italic|footer:italic","Yanone Kaffeesatz":"Yanone Kaffeesatz:300,400|logo:400|header:400|subheader:300|paragraph:300|menu:300|topbar:uppercase","Source Sans Pro":"Source Sans Pro:300,300italic,600,600italic|subheader:small|paragraph:300|topbar:uppercase",Cabin:"Cabin:400,600,400italic|subheader:italic|styled:italic,normal|footer:italic","Josefin Sans":"Josefin Sans:400,400italic",Marvel:"Marvel:400,400italic,700|header:700|logo:700","Titillium Web":"Titillium Web:300,300italic,600,600italic","GOOD COMBINATIONS":"header","Raleway - Bitter":"Raleway:300,600,300italic,600italic|Bitter:400|sidebar:small","Dosis - Cinzel":"Dosis:300,600|Cinzel|sidebar:large|styled:Dosis","Oxygen - Volkhov":"Oxygen:300,700|Volkhov:400|paragraph:300|subheader:300|logo:small","Gentium Basic - Open+Sans":"Gentium Basic:400,700,400italic|body:small|Open+Sans:400,600,800|header:800,uppercase|logo:bold,uppercase,xsmall|menu:Open+Sans|sidebar:uppercase,xsmall|topbar:uppercase,small|subheader:large","Open Sans - Bree Serif":"Open+Sans:300italic,300,600|Bree+Serif","Source Sans Pro - Bitter":"Source Sans Pro:300,300italic,600|Bitter:400|topbar:uppercase|small","PT Sans - Arvo":"PT+Sans:400,700,400italic|Arvo:400,400italic,700|topbar:|sidebar:|subheader:Arvo,small|styled:PT+Sans","Josefin Sans - Montaga":"Josefin+Sans:400,700,400italic|Montaga","Roboto - Yanone Kaffeesatz":"Roboto:300,300italic,700|Yanone+Kaffeesatz:400,700|logo:bold|header:bold|subheader:small|topbar:Yanone+Kaffeesatz,uppercase|sidebar:Yanone+Kaffeesatz,uppercase","Sintony - Rufina":"Sintony:400,700|Rufina:400,700|subheader:small|logo:bold|header:bold|topbar:|sidebar:","Source Sans Pro - Oxygen":"Source Sans Pro:300,600,300italic|Oxygen:400|sidebar:Oxygen|topbar:Oxygen","Lato - Oswald":"Lato:300,700,400italic|Oswald:300|sidebar:Oswald|topbar:Oswald|subheader:300","Lora - Ubuntu":"Lora:400,700,400italic|Ubuntu:300|menu:300,Ubuntu|subheader:small","Noto Sans - Montserrat":"Noto+Sans:400,700,400italic|Montserrat|menu:Montserrat",none:"none"},classes:""};U.favs={"&#9733; RECOMMENDED &#9733;":"mine",Akaishi:["topbar-center topbar-fixed-up","twilight brown",U.fonts["[+Sans] Merriweather"],"clear"],Andes:["topbar-center topbar-fixed-up","white coral",U.fonts["Open Sans - Fauna One"],"clear"],Apennines:["topbar-center topbar-fixed-up","white hotpink",U.fonts.Raleway,"clear"],Appalachian:["topbar-center topbar-fixed-up","daylight yellowgreen",U.fonts["Sintony - Rufina"],"clear"],Aravalli:["topbar-center topbar-fixed-up","black crimson",U.fonts["Open Sans - Bree Serif"],"clear"],Atlantika:["topbar-center topbar-fixed-up","organic 78a642",U.fonts["[+Slab] Roboto"],"filled"],Atlas:["topbar-center topbar-fixed-up","twilight brown",U.fonts["Roboto Condensed - Amatic SC"],"clear"],Bakossi:["topbar-center topbar-fixed-up","science salmon",U.fonts["Gudea - Rancho"],"filled"],Beaufort:["topbar-center topbar-fixed-up","twilight goldenrod",U.fonts.Marvel,"filled"],Belasitsa:["topbar-center topbar-fixed-up","twilight brown",U.fonts["PT Sans Narrow"],"clear"],Bergamo:["topbar-center topbar-fixed-up","organic indianred",U.fonts["Raleway - Amaranth"],"clear"],Bitterroot:["topbar-center topbar-fixed-up","daylight yellowgreen",U.fonts.Neuton,"clear"],Camelsfoot:["topbar-center topbar-fixed-up","daylight palevioletred",U.fonts["Open Sans - Lobster Two"],"clear"],Cantabrian:["topbar-center topbar-fixed-up","twilight darkcyan",U.fonts["Alegreya Sans [+SC]"],"filled"],Carpathian:["topbar-center topbar-fixed-up","organic 78a642",U.fonts["Droid Sans - Oleo Script"],"filled"],Caucasus:["topbar-center topbar-fixed-up","twilight mediumvioletred",U.fonts["Open Sans - Paytone One"],"filled"],Cederberg:["topbar-center topbar-fixed-up","twilight seagreen",U.fonts["Raleway - Amaranth"],"filled"],Chittagong:["topbar-center topbar-fixed-up","twilight steelblue",U.fonts["PT Sans - Arvo"],"filled"],Chuckwalla:["topbar-center topbar-fixed-up","white mediumaquamarine",U.fonts["Noto Sans - Pacifico"],"clear"],Cordillera:["topbar-center topbar-fixed-up","mellow indianred",U.fonts["Alegreya Sans [+SC]"],"clear"],Dachstein:["topbar-center topbar-fixed-up","daylight yellowgreen",U.fonts["PT Sans - Indie Flower"],"clear"],Dolomites:["topbar-center topbar-fixed-up","daylight salmon",U.fonts["Merriweather - Alegreya Sans"],"filled"],Drakensberg:["topbar-center topbar-fixed-up","daylight palevioletred",U.fonts["Sintony - Rufina"],"clear"],Genevieve:["topbar-center topbar-fixed-up","twilight steelblue",U.fonts["Open Sans - Fauna One"],"clear"],Granatspitze:["topbar-center topbar-fixed-up","twilight seagreen",U.fonts["Ubuntu - Raleway"],"clear"],Grossglockner:["topbar-float topbar-fixed-up","daylight ffc000",U.fonts["Source Sans Pro - Bitter"],"clear"],Himalayas:["topbar-float topbar-fixed-up","daylight darkorange",U.fonts["Open Sans - Fauna One"],"clear"],"Hindu Kush":["topbar-float topbar-fixed-up","twilight brown",U.fonts["Merriweather - Raleway"],"filled"],Jayawijaya:["topbar-float topbar-fixed-up","mellow darksalmon",U.fonts["Sintony - Rufina"],"clear"],Jotunheimen:["topbar-float topbar-fixed-up","twilight 78a642",U.fonts.Dosis,"clear"],Karakoram:["topbar-float topbar-fixed-up","science darkseagreen",U.fonts["Lato - Bubblegum Sans"],"filled"],Karwendel:["topbar-float topbar-fixed-up","organic hotpink",U.fonts["Dosis - Cinzel"],"filled"],Khibinsky:["topbar-float topbar-fixed-up","black olivedrab",U.fonts["Roboto [+Slab]"],"clear"],Kilimanjaro:["sidebar","mellow indianred",U.fonts["Josefin Sans"],"clear"],Livigno:["sidebar","twilight brown",U.fonts["Inconsolata - Special Elite"],"filled"],Lebombo:["sidebar","black olivedrab",U.fonts["Merriweather - Alegreya Sans"],"filled"],Mandara:["sidebar","mellow palevioletred",U.fonts["Open Sans - Paytone One"],"filled"],Mantiqueira:["sidebar","daylight yellowgreen",U.fonts["Titillium Web"],"filled"],Pyrenees:["sidebar","black crimson",U.fonts["Source Sans Pro - Bitter"],"clear"],"Saint Elias":["sidebar","daylight darkseagreen",U.fonts["Merriweather - Berkshire Swash"],"clear"],"Santa Catalina":["sidebar","white hotpink",U.fonts["PT Sans - Indie Flower"],"filled"],"Sierra Nevada":["sidebar","twilight steelblue",U.fonts["Lato - Oswald"],"filled"],Snowdonia:["sidebar","daylight darkseagreen",U.fonts["Roboto Slab - Megrim"],"clear"],Stanovoi:["sidebar","daylight salmon",U.fonts.Ubuntu,"filled"],Swartberg:["sidebar","daylight darkseagreen",U.fonts["[+Slab] Roboto"],"filled"],"Tian Shan":["sidebar","science darkseagreen",U.fonts["Josefin Sans"],"filled"],Transantarctic:["sidebar","twilight peru",U.fonts["Roboto Slab"],"clear"],Trollheimen:["sidebar","twilight brown",U.fonts["Roboto - Shadows Into Light"],"filled"],Vanoise:["sidebar","daylight skyblue",U.fonts["Roboto Slab - Megrim"],"filled"],Zagros:["sidebar","organic burlywood",U.fonts["Ubuntu - Roboto Slab"],"filled"]},function(){n.on("click","[data-popup-window]",function(e){if(!$t(e)){e.preventDefault(),e.stopImmediatePropagation();var t=$(this),a=t.data("href")||t.attr("href"),n=t.data("popup-window").split(","),i=n[0]||"mywindow";width=Math.min(screen.width,parseInt(n[1])||600),height=Math.min(screen.height,parseInt(n[2])||500),function(e,t,a,n){var i=Math.round(screen.width/2-a/2),o=Math.round(screen.height/2-n/2),l=window.open(e,t,"toolbar=no, location=yes, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no, width="+a+", height="+n+", top="+o+", left="+i);window.focus&&l.focus()}(a,i,width,height)}})}();var B={"Markdown Sample":"## Intro\nWe recommend using [markdown](https://help.github.com/articles/markdown-basics/) for basic content editing, because it is easy to read, faster to write and prevents html-coding mistakes which make break the page. You can use the markdown-syntax in the examples below, the toolbar or keyboard-shortcuts like `cmd-b` and `ctrl-b`.\n\nNew paragraphs should be separated by two blank lines. Styles *italic*, **bold** and ~~strikethrough~~ are easily added. Add links like [flamepix](https://flamepix.com) by using syntax `[text](url)`. Add a horizontal rule by including three hyphens:\n\n---\n\n## Links\nEasily add links into your content by adding `[link text]` in brackets, immediately followed by the `(url)` in parenthesis. Optionally, you can surround a link address in angle-brackets `<https://flamepix.com>`, and it will automtically be formatted as a link. Examples:\n\n* <https://www.photo.gallery>\n* [mjau-mjau](https://mjau-mjau.com)\n* [relative link ../](../)\n\n## Lists\nUnordered lists can be started using the toolbar, or by typing `*`, `-` or `+`. Ordered lists can be started by typing `1.`.\n\n* Lists are piece of cake ...\n* They will auto-continue as you type ...\n* Double-enter will end a list\n\t* Tabs and shift-tabs works also ...\n\t* ... for nested lists\n\n## Image\nEmbed images by adding the image `[title]` in brackets, immediately followed by the image `(img url)` in parenthesis. **Tip!** Use `{{path}}` to refer the path of the current page, for example `![title]({{path}}/file.jpg)`.\n\n![Monkey](https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f648.svg)\n\n## Blockquote\nAdd blockquotes by preceding text on a new line with the `>` tag.\n\n> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi eget sem et dui pulvinar aliquam. Etiam sit amet nulla erat. Mauris aliquam euismod tellus, ac varius velit tincidunt ut.","Font Awesome Icons":'\x3c!-- Find your icon name here http://fontawesome.io/icons/ --\x3e\nHere is a camera <i class="fa fa-camera"></i> icon.\n<i class="fa fa-heart fa-2x" style="color:tomato;"></i>\n<i class="fa fa-trophy fa-5x"  style="color:gold;"></i>',"Comparison-slider plugin":'\x3c!-- Comparison slider demo and documentation: https://demo.photo.gallery/examples/features/comparison-slider/ --\x3e\n<div class="comparison-slider x3-style-frame" data-orientation="horizontal" data-offset="0.5" data-hover="true">\n<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f648.svg">\n<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f435.svg">\n</div>',"Contact Form (simple)":'<form data-abide class="contactform">\n\t<div>\n\t\t<input type="text" name="name" placeholder="Name" required>\n\t</div>\n\t<div>\n\t\t<input type="email" name="email" placeholder="Email" required>\n\t</div>\n\t<div>\n\t\t<textarea rows="6" name="message" placeholder="Message" required></textarea>\n\t</div>\n\t\x3c!-- Uncomment below section to include GDPR required email consent --\x3e\n\t\x3c!--\n\t<div>\n\t\t<input type="checkbox" id="consent" name="consent" required>\n\t\t<label for="consent">By using this form you agree with the handling of your data by this website.</label>\n\t</div>\n\t--\x3e\n\t<button type="submit">Send</button>\n</form>',"Columns 6/6":'<div class="row">\n  <div class="medium-6 columns">\n\t\t<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f98e.svg" alt="lizard">\n  </div>\n  <div class="medium-6 columns">\n  \t<p>Both left and right columns are set to 6/12 width. This creates a two columns equal-width columns, which collapse into a single column on small screens. Read more about the grid <a href=http://foundation.zurb.com/docs/components/grid.html>here</a>.</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus fringilla, risus ac lacinia consequat, ipsum augue posuere quam, eget commodo lorem augue vel dui. Sed elementum quis risus a volutpat. Vivamus fringilla, risus ac lacinia consequat, ipsum augue posuere quam, eget commodo lorem augue vel dui. Sed elementum quis risus a volutpat.</p>\n  </div>\n</div>',"Columns 4/8":'<div class="row">\n  <div class="medium-4 columns">\n\t\t<img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f40a.svg" alt="crocodile">\n  </div>\n  <div class="medium-8 columns">\n  \t<p>Left column is set to use 4/12 columns width, while right column is set to take 8/12 columns width. This creates a two columns layout, which collapse into a single column on small screens. Read more about the grid <a href=http://foundation.zurb.com/docs/components/grid.html>here</a>.</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus fringilla, risus ac lacinia consequat, ipsum augue posuere quam, eget commodo lorem augue vel dui. Sed elementum quis risus a volutpat.</p>\n  </div>\n</div>',"Block-Grid 3,2,1":'\x3c!-- Evenly adjust content within a block-grid --\x3e\n\x3c!-- Read more: http://foundation.zurb.com/sites/docs/v/5.5.3/components/block_grid.html --\x3e\n<ul class=\'small-block-grid-1 medium-block-grid-2 large-block-grid-3\'>\n<li><div data-alert class="alert-box bg2"><strong>Block Grid</strong><br>Block grids give you a way to evenly separate contents of a list within a grid. If you want to create a row with a specific amount of elements that need to stay evenly spaced, the block grid is your friend.</div></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f693.svg"></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f691.svg"></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f692.svg"></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f699.svg"></li>\n<li><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f695.svg"></li>\n</ul>',"About Me Example":'---\n\n<div class="row text-left">\n  <div class="medium-6 columns">\n    <div class="frame">\n      <figure>\x3c!-- Add your own image in below src --\x3e\n        <img alt="profile" src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f3c2.svg">\n      </figure>\n    </div>\n  </div>\n\n  <div class="medium-6 columns">\n  <p><strong>Howdy!</strong><br>\n  My name is Bob Dobalina, and this website is my blog as well as a playground\n  for the X3 Photo gallery website CMS. <a href="https://www.photo.gallery" target="_blank">View Demo</a></p>\n\n  <p><strong>About me</strong><br>\n  I am interested in design, functionality, minimalism and performance. My hobbies are: sleeping, snoozing and watching TV.</p>\n\n  <p><strong>Article</strong><br>\n  More than a decade ago, when SWF was an emerging technology, this website became a very popular showcase of Flash. <a href="https://mjau-mjau.com/blog/rewind-web-2002/">See Post</a></p>\n  </div>\n</div>',"Embed Youtube":"<div class='flex-video widescreen x3-style-frame'>\n\t<iframe src='//www.youtube.com/embed/A3PDXmYoF5U' frameborder='0' allowfullscreen></iframe>\n</div>","Embed Vimeo":"<div class='flex-video widescreen vimeo x3-style-frame'>\n<iframe src='//player.vimeo.com/video/84067859' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>\n</div>","Embed Google Maps":"<div class='flex-video x3-style-frame' style='height:auto;'>\n<iframe src='https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d424396.3176723366!2d150.92243255000002!3d-33.7969235!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6b129838f39a743f%3A0x3017d681632a850!2sSydney+NSW%2C+Australia!5e0!3m2!1sen!2sth!4v1415268600966' frameborder='0' style='border:0'></iframe>\n</div>","Embed MP4 Video":'\x3c!-- Upload an MP4 video file to your page, and use the code below to embed the video into your content. The {{path}} variable will dynamically convert to the folder path --\x3e\n<video width="100%" preload="metadata" controls controlsList="nodownload">\n<source src="{{path}}videofilename.mp4" type="video/mp4">\n</video>',"Popup Links":'\x3c!-- Basic image popup. You can replace the href tag with "{{path}}/filename.jpg" to load an image within the same folder. Demo and documentation: https://demo.photo.gallery/examples/samples/popup/ --\x3e\n<a href="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f405.svg" data-popup>Tiger</a>\n\n\x3c!-- Open Youtube video in popup --\x3e\n<a href="https://www.youtube.com/embed/G46ygBKsTZI" data-popup>Youtube Video</a>\n\n\x3c!-- Open a website in browser popup-window. You can set window name, width and height  --\x3e\n<a href="https://flamepix.com" data-popup-window="name,800,600">flamepix.com</a>',"Carousel Plugin":'\x3c!-- content carousel. More info: https://demo.photo.gallery/examples/plugins/carousel/ --\x3e\n<div data-carousel data-carousel-items=3 data-carousel-loop=true data-carousel-dots=true data-carousel-autoplay=3000 data-carousel-responsive=true data-carousel-shuffle=false>\n<div><h3>Camel</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f42b.svg" /></div>\n<div><h3>Fish</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f41f.svg" /></div>\n<div><h3>Squirrel</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f43f.svg" /></div>\n<div><h3>Goat</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f410.svg" /></div>\n<div><h3>Elephant</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f418.svg" /></div>\n<div><h3>Ox</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f402.svg" /></div>\n<div><h3>Whale</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f433.svg" /></div>\n<div><h3>Blowfish</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f421.svg" /></div>\n<div><h3>Turtle</h3><img src="https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.6/assets/svg/1f422.svg" /></div>\n</div>',"Modal Plugin":'\x3c!-- Add the modal element anywhere in your content. It will be hidden until triggered. --\x3e\n<div id="modal_id1" class="reveal-modal" data-reveal aria-hidden="true" role="dialog">\n<a class="close-reveal-modal" aria-label="Close"><i class="fa fa-close"></i></a>\n<h2>Modal Title</h2>\n<p>Modal content/html here.</p>\n</div>\n\n\x3c!-- Include a link anywhere in your content to trigger a modal with a specific ID on click. Make sure the id of the modal element matches the data-reveal-id in the link! --\x3e\n<a href="#" data-reveal-id="modal_id1">Open Modal link</a>',"Tabs Plugin":'\x3c!-- Wrap all code inside a <section> with tabs-container class --\x3e\n\x3c!-- Optional style classes that can be included: tabs-style-1 OR tabs-style-2 --\x3e\n<section class="tabs-container tabs-radius tabs-anim tabs-color-active">\n\n\x3c!-- Create a ul list that contains the tab links --\x3e\n\x3c!-- include the vertical class if you want to use vertical orientation --\x3e\n<ul class="tabs" data-tab>\n<li class="tab-title active"><a href="#panel1">Tab 1</a></li>\n<li class="tab-title"><a href="#panel2">Tab 2</a></li>\n<li class="tab-title"><a href="#panel3">Tab 3</a></li>\n<li class="tab-title"><a href="#panel4">Tab 4</a></li>\n</ul>\n\n\x3c!-- Create a tabs content element that contains all tab contents  --\x3e\n\x3c!-- include the vertical class if you want to use vertical orientation --\x3e\n<div class="tabs-content">\n<div class="content active" id="panel1">\n<p>This is the first panel of the basic tab example.</p>\n</div>\n<div class="content" id="panel2">\n<p>This is the second panel of the basic tab example.</p>\n</div>\n<div class="content" id="panel3">\n<p>This is the third panel of the basic tab example.</p>\n</div>\n<div class="content" id="panel4">\n<p>This is the fourth panel of the basic tab example.</p>\n</div>\n</div>\n\n\x3c!-- Make sure #links in the <a> anchor tags correspond with id\'s in the tabs-content! --\x3e\n</section>',"Alert Box":'\x3c!-- You can use any of the following color-tags: success alert bg2 bg3 primary warning info --\x3e\n<div data-alert class="alert-box success">\n\n\x3c!-- close button below is optional --\x3e\n<a href="#" class="close close-x"></a>\n\nAdd your content/html here.\n</div>',"Toggle Content":'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus tristique quis justo luctus pulvinar. Nulla venenatis lacus eget sapien pretium dignissim. <span class="toggle-content">Duis feugiat magna vitae fermentum euismod. Sed venenatis finibus lorem. Phasellus vel ante nibh. Praesent nec metus condimentum, vulputate ex vel, molestie sem. Praesent molestie tortor in mi tristique, at commodo lorem volutpat. Integer elementum facilisis erat, in pellentesque turpis venenatis ac.</span><br><a href="#" class="toggle-button" data-close-text="less">more</a>\n\n<a href="#" class="toggle-button">What is a tomato?</a>\n<div class="toggle-content">The <strong style="color: tomato;">tomato</strong> is the edible, red fruit of Solanum lycopersicum, commonly known as a tomato plant, which belongs to the nightshade family, Solanaceae. The species originated in Central and South America. The Nahuatl (Aztec language) word tomatl gave rise to the Spanish word "tomate", from which the English word tomato originates.</div>',"Contact Form (advanced)":'\x3c!-- More info on HTML forms: http://foundation.zurb.com/sites/docs/v/5.5.3/components/forms.html --\x3e\n\x3c!-- Always start your <form> with DATA-ABIDE attribute and "contactform" class --\x3e\n<form data-abide class="contactform text-left">\n\n\x3c!-- All form elements must contain NAME attributes--\x3e\n<div>\n<input type="text" name="name" placeholder="Name" required>\n</div>\n\n\x3c!-- Notice the REQUIRED attribute, which makes the input required --\x3e\n<div>\n<input type=\'email\' name=\'email\' placeholder=\'Email\' required>\n</div>\n\n<div>\n<input type="tel" name="Phone Number" placeholder="Phone number">\n</div>\n\n\x3c!--  Select lists --\x3e\n<div>\n<strong>Ice Cream Flavor</strong>\n<select name="Ice Cream Flavour">\n<option value="Vanilla flavor">Vanilla</option>\n<option value="Chocolate flavor">Chocolate</option>\n<option value="Strawberry flavor">Strawberry</option>\n<option value="Pistachio flavor">Pistachio</option>\n</select>\n</div>\n\n\x3c!--  With radio groups NAME should be the same across all radios in the group. --\x3e\n\x3c!--  Include CHECKED attribute to set default checked value --\x3e\n<div>\n<strong>Favorite color</strong><br>\n<input type="radio" name="Favorite Color" value="Red" id="radio1" checked><label for="radio1">Red</label>\n<input type="radio" name="Favorite Color" value="Blue" id="radio2"><label for="radio2">Blue</label>\n<input type="radio" name="Favorite Color" value="Green" id="radio3"><label for="radio3">Green</label>\n</div>\n\n\x3c!--  With checkboxes, set different NAME attributes. --\x3e\n\x3c!--  Include CHECKED attribute to set default checked values --\x3e\n<div>\n<strong>I like to</strong><br>\n<input type="checkbox" name="sleep" value="Yes!" id="check1" checked><label for="check1">Sleep</label>\n<input type="checkbox" name="snooze" value="As long as possble" id="check2"><label for="check2">Snooze</label>\n<input type="checkbox" name="doze" value="All the time" id="check3"><label for="check3">Doze</label>\n</div>\n\n\x3c!--  textarea input --\x3e\n<div>\n<strong>Message</strong>\n<textarea required rows="6" name="message" placeholder="Add your message"></textarea>\n</div>\n\n\x3c!-- Uncomment below section to include GDPR required email consent --\x3e\n\x3c!--\n<div>\n\t<input type="checkbox" id="consent" name="consent" required>\n\t<label for="consent">By using this form you agree with the handling of your data by this website.</label>\n</div>\n--\x3e\n\n\x3c!--  SEND button --\x3e\n<button type="submit">Send</button>\n\n\x3c!-- End form --\x3e\n</form>',"Code Highlighter":"<pre data-lang=\"javascript\"><code>\nvar googoo = 'gaga';\nfunction get_googoo(){\n\treturn googoo;\n}\nget_googoo(); // returns 'gaga'\n</code></pre>"};function V(){$.post("cloudflare.php",{action:"zones"},function(e){e.success&&e.result.length>0?(K=e.result[0].id,localStorage.setItem("cf_domain_id",K),G()):cloudflare=!1},"json")}function H(){var e=location.pathname.split("/");return e[e.length-1].length<1&&e.pop(),e.pop(),location.protocol+"//"+location.host+e.join("/")+"/"}function W(e){var t=e.replace("../../content/","").replace("../content/","").split("/");return $.each(t,function(e,a){a.indexOf(".")>-1&&$.isNumeric(a.split(".")[0])&&(t[e]=a.split(".")[1])}),t=t.join("/").replace(/\/?$/,"/").replace("index/","")}function X(){var e=H(),t=[];return $.each(fe,function(a,n){0!==n.link.indexOf("custom/")&&t.push(e+n.link)}),t.push(e),t.push(e+"custom/404/"),t.push(e+"sitemap"),t.push(e+"sitemap.xml"),t.push(e+"feed/"),t.push(e+"feed.xml"),t}function Y(){var e=H(),t=W(localStorage.getItem("current_page")),a=[];return a.push("/"==t?e:e+t),a}function J(e){if(!E()){var t=e?X():Y();show_preloader(),o.addClass("cf-busy"),$.post("cloudflare.php",{action:"purge_files",zone_identifier:K,files:t},function(e){e.success?show_errors_on_nav(language.Cloudflare_Flush_Success,"green"):show_errors_on_nav(language.Cloudflare_Flush_Fail,"red"),o.removeClass("cf-busy")},"json")}}function G(){c.append('<li class="dropdown cloudflare-dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><span class="glyphicon glyphicon-cloud"></span></a><ul class="dropdown-menu pull-right dropdown-menu-right" role="menu"><li role="presentation" class="dropdown-header">CLOUDFLARE</li><li id=cf_flush_current><a href="#"><span class="glyphicon glyphicon-trash"></span>&nbsp; '+language.Cloudflare_Flush_Current_Page+'</a></li><li id=cf_flush_all><a href="#"><span class="glyphicon glyphicon-trash"></span>&nbsp; '+language.Cloudflare_Flush_All_Pages+"</a></li></ul></li>");var e=c.children(".cloudflare-dropdown"),t=e.children(".dropdown-menu");e.hoverIntent({over:function(a){t.velocity({opacity:1},{duration:200,display:"block"}),e.addClass("open")},out:function(){t.velocity("stop").css({opacity:0,display:"none"}),e.removeClass("open")},timeout:300}),e.on("click","#cf_flush_current",function(e){e.preventDefault(),J(!1)}),e.on("click","#cf_flush_all",function(e){e.preventDefault(),J(!0)})}!function(e){var t={allowFloat:!1,allowNegative:!1};function a(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var a=e.createTextRange(),n=a.duplicate();return a.moveToBookmark(t.getBookmark()),n.setEndPoint("EndToStart",a),n.text.length}return 0}e.fn.numericInput=function(n){var i=e.extend({},t,n),o=i.allowFloat,l=i.allowNegative;return this.keypress(function(t){var n=t.which,i=e(this).val();if(n>0&&(n<48||n>57))if(1==o&&46==n){if(1==l&&0==a(this)&&"-"==i.charAt(0))return!1;if(i.match(/[.]/))return!1}else{if(1!=l||45!=n)return 8==n;if("-"==i.charAt(0))return!1;if(0!=a(this))return!1}else if(n>0&&n>=48&&n<=57&&1==l&&"-"==i.charAt(0)&&0==a(this))return!1}),this}}(jQuery);var K,Q=!1;function Z(){cloudflare&&!Q&&k()&&(Q=!0,null!==localStorage.getItem("cf_domain_id")?(K=localStorage.getItem("cf_domain_id"),G()):setTimeout(function(){V()},1e3))}function ee(e,t,a){e||(e=Qe.filter('[data-path="'+a+'"]'));var n=ft(t?"Unhide":"Hide");e.toggleClass("is-hidden",t),e.find("span.hide-file").toggleClass("fa-eye",!t).toggleClass("fa-eye-slash",t).attr("title",n),e.find("a.hide-file").text(n)}function te(e,t,a){e||(e=o.find("#left_folder_menu_box").find('a[data-href="'+a.replace(/"/g,"&quot;")+'"]').parent()),e.length&&e.toggleClass("is-hidden",t)}function ae(e){var t={};return e.each(function(e,a){var n=$(this),i=n.find(".file-data"),o=n.data("name"),l=i.children(".file-title").val();description=i.children(".file-description").val(),link=i.children(".file-link").val(),target=i.find("label.active").data("name"),params=i.children(".file-params").val(),custom_index=n.attr("data-custom"),hidden=n.hasClass("is-hidden");var s={};l&&(s.title=l),description&&(s.description=description),link&&(s.link=link,"auto"!==target&&(s.target=target)),params&&(s.params=params),custom_index&&(s.index=parseInt(custom_index)),hidden&&(s.hidden=!0),Object.keys(s).length&&(t[o]=s)}),!!Object.keys(t).length&&t}function ne(e,t){if(!E()){l.modal("show");var a={folders:JSON.stringify(e)};$.post("x3_settings.php",a).done(function(a){a.success?(t&&t(),$.extend(!0,folders,e),Object.keys(e).forEach(function(e){folders.hasOwnProperty(e)&&folders[e].hasOwnProperty("index")&&!folders[e].index&&delete folders[e].index}),P("set folders:",folders)):pt(a.error?a.error:"Error in x3_settings.php",null,null,"danger")}).fail(function(e){pt("Failed to POST to x3_settings.php"+(e.statusText?": "+e.statusText:"."),null,null,"danger")}).always(function(){l.modal("hide")})}}function ie(e,t,a,n){if(e&&t&&a){if(-1==a.indexOf("./content")&&0===a.indexOf(".")){var i=a.split("..");a=i[i.length-1]?"../content"+i[i.length-1]:"../content"}Array.isArray(e)||(e=[e]);var o=[],l=[];(e=re(e)).length&&(e.forEach(function(e){o.push(t+"/"+e),l.push(a+"/"+e)}),oe(o,l,n))}}function oe(e,t,a){if(Object.keys(folders).length&&e&&t&&(Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]),e.length&&t.length))for(var n=0;n<e.length;n++){var i=se(e[n]),o=se(t[n]);i&&o&&Object.keys(folders).forEach(function(e){0===e.indexOf(i)&&(folders[e.replace(i,o)]=folders[e],a||delete folders[e])})}}function le(e,t){if(e&&Object.keys(folders).length)if(Array.isArray(e)&&t){if(!e.length)return;if(!(e=re(e)).length)return;for(var a=0;a<e.length;a++){(n=se(t+"/"+e[a]))&&Object.keys(folders).forEach(function(e){0===e.indexOf(n)&&delete folders[e]})}}else{var n;(n=se(e))&&Object.keys(folders).forEach(function(e){0===e.indexOf(n)&&delete folders[e]})}}function se(e){var t="/content/";if(t=e.indexOf("."+t)>-1?"."+t:t,-1==e.indexOf(t))return e.replace(/\/\/+/g,"/").replace(/\/$/,"");var a=e.replace(/\/\/+/g,"/").replace(/\/$/,"").split(t);return a.shift(),a.join(t)}function re(e){return e.filter(function(e){var t=e.split(".");return t.length<2||"jpg"!==t.pop().toLowerCase()})}function de(e,t){var a={};a[e]=t,$.extend(folders,a)}function ce(e,t){Object.keys(e).forEach(function(a){var n=t.filter('[data-name="'+a.replace(/"/g,'\\"')+'"]');if(n.length){var i=e[a];i.hasOwnProperty("title")&&n.data("title",i.title),i.hasOwnProperty("description")&&n.data("description",i.description),i.hasOwnProperty("link")&&n.data("link",i.link),i.hasOwnProperty("target")&&n.data("link-target",i.target),i.hasOwnProperty("params")&&n.data("params",i.params),i.hasOwnProperty("index")&&n.data("index",i.index)}})}function ue(e){var t={};return e.each(function(e){var a=$(this),n=a.data("name"),i=a.find(".file-data"),o=i.children(".file-title").val(),l=i.children(".file-description").val(),s=i.children(".file-link").val(),r="auto"==(r=i.find("label.active").data("name"))?"":r,d=i.children(".file-params").val(),c=a.attr("data-custom"),u={};pe(o,a.data("title"))&&(u.title=o),pe(l,a.data("description"))&&(u.description=l),pe(s,a.data("link"))&&(u.link=s),pe(r,a.data("link-target"))&&(u.target=r),pe(d,a.data("params"))&&(u.params=d),pe(c,a.data("index"))&&(u.index=parseInt(c)),Object.keys(u).length&&(t[n]=u,t[n].path=a.data("path").replace("../../","../"),t[n].date=a.data("date"))}),!!Object.keys(t).length&&t}function pe(e,t){return!(!e&&!t)&&e!=t}n.on("keypress.nospace, keyup.nospace",'input.file-link, [name="gallery.image.link"]',function(e){if(32==e.which)return!1;var t=$(this);t.parent().toggleClass("has-link",t.val().length>0)}).on("mouseenter",".file-data > a",function(e){var t=$(this),a=s.find("a.view-page").attr("href"),n=t.closest("tr").data("name"),i=n.substr(0,n.lastIndexOf(".")),o=t.parent().children("input.file-link").val().replace("{file_name}",i).replace("{file_name_ext}",n),l=0===o.toLowerCase().indexOf("http")?o:0===o.indexOf("/")?".."+o:a+o;t.attr("href",l),"popup"===t.parent().find("label.active").data("name")?t.attr("data-popup-window",""):t.removeAttr("data-popup-window")}).on("focus","input.file-link",function(e){$(this).parent().addClass("has-focus")}).on("blur","input.file-link",function(e){$(this).parent().removeClass("has-focus")}).on("mouseenter",".file-data > input, .file-data > textarea",function(e){$(this).prev().addClass("has-hover")}).on("mouseleave",".file-data > input, .file-data > textarea",function(e){$(this).prev().removeClass("has-hover")}).on("click","a.set-preview, span.set-preview",function(e){e.preventDefault();var t=$(this).closest("tr").data("name");Dt({image:t},function(e){if(e){var a=s.find('input.form-control.selectized[name="image"]');a.length&&a[0].selectize.addItem(t,!0)}},"Changed folder preview image.")}).on("click",".hide-file",function(e){e.preventDefault();var t=$(this).closest("tr"),a=t.data("name"),n=t.hasClass("is-folder"),i=!n&&$.inArray(t.data("ext"),["jpg","jpeg","pjpeg"])>-1,o=!t.hasClass("is-hidden"),l=a+" "+ft(o?"Hide":"Unhide"),s={};if(n){var r=t.data("path");s[r.split("./content/")[1]]={hidden:o},ne(s,function(){ee(t,o),te(null,o,r),pt(l,null,null,"success")})}else s[a]={hidden:o},i&&At.back.use_iptc&&(s.iptc_inject={},s.iptc_inject[a]={hidden:o?"1":"",path:t.data("path").replace("../../","../"),date:t.data("date")}),Dt(s,function(e){ee(t,o)},l)}).on("click",".td-folder",function(e){$(this).next().children("a").click()}).on("click",'input[name="settings.menu_manual"]',function(e){c.children("li#refresh").toggleClass("hidden",!$(this).is(":checked"))}).on("click",".previews-log td.dir > a",function(e){e.preventDefault(),showFileManager($(this).attr("href"))}),x3_help={new_folder:"<h3>Create New Folder</h3><p>Creates a new child-page (subfolder) inside the current page. The name you give to the folder represents the page URL (slug) in browser, and should be short and simple.</p><h4>Numbered Folder Names</h4><em>* Optional</em><p>Unless you intend to use custom sorting (by drag and drop), you can add a number in front of the folder name to indicate the sort order of the page. The number will not display in the actual URL.</p><p>The following example creates a page with sort order 4:<br><strong><code>4.foldername</code></strong> : <code>yourwebsite.com/foldername/</code><br><em>* The initial number in folder name will NOT display in the URL.</em></p><h4>Folder names are <u>NOT</u> page titles</h4><p>Folder names are only used for the URL and to identify the page. You should use the page <code>title</code> option for extensive page titles, and the <code>label</code> setting for menu labels. The folder name should be as simple as possible, preferably a single lowercase word, without special characters or empty spaces.</p><h4>Empty spaces not allowed</h4><p>Empty spaces are NOT allowed in folder names. Even if they were allowed, it would create ugly url's that are bad for SEO: <code>/not%20nice%20url/</code>. If you need to use multiple words, separate them with hyphens- instead: <code>/nice-url/</code>.</p><h4>Other disallowed characters</h4><p>Other characters that are not allowed in folder names include <code>#$%^&*()+=[]'\"/\\|{}`~!@</code>. Most of these characters are simply not allowed in URL's, while some characters are disallowed because they break the functionality of X3.</p>",protect:'<h3>Page Password Protection</h3><p>Here you can add passwords to your pages. Simply locate the page in the <code>link</code> field, add a <code>username</code> and <code>password</code>, and click save. The specific page will now require login when accessed by any visitor.</p><h4>Users</h4><p><em>* Optional</em></p><p>Instead of adding a username and password per page link, you can instead include <code>users</code> to give specific users access to a page. Users are added separately from the <code>users</code> tab. The benefit of "users", is that you can assign a single login for a user, which may allow them access to multiple protected pages without re-entering login credentials. Also, it is sometimes easier to manage usernames and passwords in a users section for persistent usage.</p><p><em>* You should select either a user <strong>OR</strong> username+password, not both.</em></p><h4>Recursive Protection</h4><p>Link protection is recursive, which means the login for a specific link will inherit upon child pages. For example, a password applied to <code>galleries/</code> would also apply for child-pages <code>galleries/food/</code> and <code>galleries/landscape/</code>. If you are specifically protecting child-pages of already-protected parent-pages, the child-page login will outrank the parent-page login.</p><h4>Global Protect</h4><p>Use the special <code>*Global</code> link to protect your entire X3 website. Basically this is like protecting the / root page, and since link-protection is recursive, it will protect ALL pages - your entire website. <em>* You can still apply passwords to child-pages, which will outrank the global protection.</em></p><h4>Super Users</h4><p>There is a special <code>superuser</code> user, which can access ALL password-protected pages without even being assigned specifically for the link. A super-user should normally be reserved for gallery-owners who want to remember a single login that works on all password-protected pages. Create a super-user in the users-section by simply appending an asterisk* behind the username, for example <code>superuser*</code>. Since super-users are allowed access to ALL password-protected pages, they do not show up in the list of available users to assign from the links tab.</p><p><em>* The asterisk* character is part of the username, and needs to be included when logging in.</em></p><h4>Sessions</h4><p>Login uses WWW-Authenticate, which basically creates "sessions" in the browser that remembers the current authentication. This helps so the visitor doesn\'t need to re-authenticate, and it also allows a "user" to access all pages they are assigned to without having to enter login details more than once. This is a good thing of course, but since there is no "logout" for these sessions, it can make testing difficult from your browser since you may be logged in to a session already. Therefore, if you are testing your protected pages, you may need to use "New Incognito Window" (Google Chrome), or "New Private Window" (Safari, Firefox) for each test. These special windows do not inherit your browser sessions, so you can test properly. Just remember to to open/close the window for each test, because even private windows have temporary sessions until they are closed.</p>',"page-examples":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong class=title>Examples</strong><span class=content>This folder contains examples of various layouts for your pages. You can delete or hide this page. <strong>NB!</strong> For the sake of demonstration, all galleries in the examples section are set to load images from the <em>3.examples/assets</em> folder.</span></div>',"page-logo":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong class=title>Logo</strong><span class=content>Upload your logo here if you have selected <strong>image logo</strong> in <em>Settings &rsaquo; Style &rsaquo; Logo</em>.</span></div>',"page-audio":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong class=title>Audio Player Files</strong><span class=content>To enable audio, upload one or more mp3 files, and enable the audio player plugin from <em>settings &rsaquo; plugins &rsaquo; audio player</em>. If you get errors on mp3 file upload, it is likely because your server has a <strong>2MB upload_max_filesize</strong> limit in php.ini (see <a href="../?diagnostics" target=_blank>diagnostics</a>). If so, you will need to either increase upload_max_filesize on your server, or upload mp3 files by FTP.</span></div>',"page-404":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><strong class=title>404 "Page Not Found" Template</strong><span class=content>This page can be edited to change text and appearance of the page that appears when a page is not found.</span></div>',"page-custom":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom</strong><span class=content>This folder is for special features and custom files.</span></div>',"page-files":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom Files</strong><span class=content>Contains folders where you can store custom files to use in your website.</span></div>',"page-files-generic":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><span class=content>* Files in this folder can be used in pages and plugins with dynamic source path <strong>{{files}}/{{foldername}}/</strong>filename.jpg.</span></div>',"page-javascript":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom Javascript Files <span style=\'font-weight: 400;\'>[Advanced]</span></strong><span class=content>Upload custom javascript files here. <br><br>* Files with "include" in the name (for example <strong>"myscript.include.js"</strong>) will automatically load into the website.</span></div>',"page-images":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom images</strong><span class=content>Upload custom images here which can be used in your pages and plugins.<br><br>* Images in this folder can be used in pages and plugins with dynamic source path <strong>{{files}}/images/</strong>filename.jpg.</span></div>',"page-css":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Custom CSS Files <span style=\'font-weight: 400;\'>[Advanced]</span></strong><span class=content>Upload custom css files here.<br><br>* Files with "include" in the name (for example <strong>"mystyle.include.css"</strong>) will automatically load into the website.</span></div>',"page-index":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Home Page</strong><span class=content>The folder name <em>index</em> represents your home page. You can hide it from the menu by clicking the "hide" button. The index page cannot contain child pages (subfolders) and is just a placeholder for your home page.</span></div>',"page-content":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Content Folder</strong><span class=content>This is your main content folder where you add your page structure. This folder does not represent any page and is just the container for all your pages. Do not upload images into this folder.</span></div>',"page-assets":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Examples Gallery Assets</strong><span class=content>This is where we store images for galleries in the examples sample pages.</span></div>',"page-favicon":'<div class="alert alert-warning alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close" style=\'visibility: visible;\'><span aria-hidden="true">&times;</span></button><strong class=title>Favicon</strong><span class=content>Add a custom favicon <a href=https://en.wikipedia.org/wiki/Favicon target=_blank>[wiki]</a> by deleting the default "favicon.png", and uploading your own icon in PNG format [32 x 32 px].<br><br><strong>Tip!</strong> Use a new filename (for example "favicon2.png") to prevent browser from caching old favicon file.</span></div>',preload:'<h3>Preload Website</h3><p>When set to <strong>auto</strong> or <strong>create</strong>, your website will preload a compressed data file containing all pages in your website. This will make your website seem super-fast to visitors, as pages will display instantaneously on page navigation.</p><p>Visit the <a href="https://demo.photo.gallery" target="_blank">X3 Demo</a> and navigate the menu to try this feature in effect.</p><p><code>no</code><br>No preloading will occur and data file will not be created.</p><p><code>auto</code> <em>* default</em><br>X3 will automatically build the data file as your pages are navigated. This means the data file will populate progressively until all your pages are visited once. When you edit anything from the panel, the data file will become invalid and start re-building from scratch again. The advantage of this option, is that it is an automatic process with no management required.</p><p><code>create</code><br>When set to \'create\', you will have the option to CREATE the full website data file directly from the panel. The advantage of this option, is that you can create the FULL website data file up front, directly from the panel. This is the most powerful option, but it requires that you manually create the website data file every time you wish to publish changes you have made from the panel.</p><p><strong>Warning:</strong> If your website is very large and/or you have a slow server, the manual create process may take a long time to complete and in some cases fail.</p><hr><ul><li>Loading of the data file occurs as an invisible process after first page is loaded.</li><li>Data file will only cache page navigation requests (navigating internally in the website).</li><li>The data file does not cache images or other static assets.</li><li>Password protected pages are never cached</li><li>Data file size is limited to 1MB when set to <strong>[auto]</strong>.</li></ul>',authorize:"<h3>Authorize</h3><p>Checks if your domain is authorized to used X3.</p>",menu:"<h3>Create Menu</h3><p>Click the button to create- and <u>cache</u> your X3 website menu. Once the menu is created, it will be cached until next time you make any changes to your X3 website. The cached menu fragment will allow separate pages to build faster.</p><h4>Do I need this?</h4><p>No - This operation is optional because the menu will be created- and cached on the first page visit regardless. This process may be helpful for X3 websites with a heavy menu structure where you wish to pre-cache the menu before loading any pages.</p><h4>About Menu Caching</h4><p>Every time you make <u>any</u> change to your X3 website, the menu needs to get re-created and cached. The menu creation is a relatively heavy process, because it requires X3 to loop through <u>all</u> folders in your content, read the data file and gather information about all files. The speed of this process is proportional to the amount of folders and files in your content, and the speed of your server.</p>",htaccess:"<h2>"+(conf_editor||"")+"</h2><p><em>* This is an advanced feature. Do NOT edit this file unless you know what you are doing.</em></p><p>This page displays the content of the <code>"+(conf_editor||"")+"</code> file in your root X3 directory. The "+(conf_editor||"")+" file is necessary for X3 to be able to run properly. This feature is mainly used to diagnose issues, but can also be used to edit the "+(conf_editor||"")+" file if it is writable.</p>"+("htaccess"===conf_editor?"<h3>Custom rules</h3><p>If you need to add custom rules, you should wrap them inside <code># custom rules start</code> and <code># custom rules end</code> tags, so they are copied when you apply X3 updates. For example:</p><pre><code># custom rules start<br><br>YOUR CUSTOM RULES HERE<br><br># custom rules end</code></pre>":""),reset:"<h3>Reset</h3><p>This setting resets your global settings to default, by simply deleting the <code>config/config.user.json</code> file. It does NOT affect page-settings stored in your pages/folders. </p>",templates:"<h3>Setting Templates</h3><p>Setting templates are tested combinations of settings, which can be applied to folders- and gallery. Basically, they are just shortcuts for certain layout-combinations, which you otherwise can apply normally. You don't need to use setting templates, but they offer a quick way to achieve specific layouts.</p><p><strong>Important</strong><br>Default setting templates only change a <em>few</em> related options each, and many settings will remain default. Therefore, it is likely you may wish to make some adjustments after applying a template. Templates may not affect specific layout details, tooltips- or captions, so results may depend on your defaults.</p><h4>Custom Templates</h4><p>Create your own templates by selecting the <code>Save Current Settings As...</code> option. This will allow you to save current settings as a custom template.</p><p><em>* You still need to click SAVE after applying a template.</em></p>",image_title:"<h3>Image Title</h3><p>Add a unique title for your image. Titles may display in gallery layouts and in the image popup. <em>* You can use any characters in image title</em>.</p><h4>Some html allowed</h4><p>You are allowed to use the following html tags in image titles:<br><code>&lt;code&gt;&lt;a&gt;&lt;span&gt;&lt;em&gt;&lt;i&gt;&lt;b&gt;&lt;strong&gt;&lt;small&gt;&lt;s&gt;</code></p><h4>Dynamic Values</h4><p>You can use the following values in titles, which are replaced dynamically. This may be useful if you are including file names, or links that refer to the image name.</p><p><code>{file_name_ext}</code> is replaced by the file name.<br><code>{file_name}</code> is replaced by the file name <em>without</em> extension.<br><code>{path}</code> is replaced by the path of current folder.<br><code>{image_path}</code> is replaced by the path to the image.</p>",image_description:"<h3>Image Description</h3><p>Add a unique description for your image. Descriptions may display in gallery layouts and in the image popup. <em>* You can use any characters in image description</em>.</p><h4>Some html allowed</h4><p>You are allowed to use the following html tags in image descriptions:<br><code>&lt;a&gt;&lt;span&gt;&lt;em&gt;&lt;i&gt;&lt;b&gt;&lt;strong&gt;&lt;small&gt;&lt;s&gt;&lt;br&gt;&lt;mark&gt;&lt;img&gt;&lt;kbd&gt;&lt;code&gt;&lt;button&gt;</code></p><h4>Dynamic Values</h4><p>You can use the following values in default description, which are replaced dynamically. This may be useful if you are including file names, or links that refer to the image name.</p><p><code>{file_name_ext}</code> is replaced by the file name.<br><code>{file_name}</code> is replaced by the file name <em>without</em> extension.<br><code>{path}</code> is replaced by the path of current folder.<br><code>{image_path}</code> is replaced by the path to the image.</p>",image_link:"<h3>Image Link</h3><p>If you set an image link, clicking an image will open the link instead of the image. You can use absolute- or relative links. <em>* If you want to link to an X3 page, you should use a relative path so that the link is loaded by ajax.</em></p><p><code>https://flamepix.com</code><br><em>* Absolute link.</em></p><p><code>/pagex/pagey/</code><br><em>* Link is relative to domain name.</em></p><p><code>pagex/pagey/</code><br><em>* Link is relative to current page.</em></p><h4>Dynamic Values</h4><p>You can use the following variables in your links, which are replaced dynamically:</p><p><code>{file_name_ext}</code> is replaced by the file name.<br><code>{file_name}</code> is replaced by the file name <em>without</em> extension.<br><code>{path}</code> is replaced by the file path of current folder.<br><code>{image_path}</code> is replaced by the path to the image.</p><h3>Target</h3><p>Target decides in what window to open the link.</p><p><code>auto</code> Uses default target, or automatically determines target depending on the link.<br><code>_self</code> Opens the link in the same window.<br><code>_blank</code> Opens the link in a new window (normally a new tab).<br><code>popup</code> Opens the link in a popup window.<br><code>X3 popup</code> Opens link in native X3 popup. <em>* Good for Youtube embeds, images and simple content, but should <u>not</u> be used when linking to full websites.</em></p>",params:'<h3>Parameters</h3><p>Custom image parameters for various plugins. Options are added in a querystring format:<br><pre><code>option1=2&option2=hello&option3=false</code></pre></p><h4>Panorama plugin options</h4><p><span class="code-inline-block"><code>id</code><code>title</code><code>open</code><code>width</code><code>height</code><code>type</code><code>source</code><code>source_4096</code><code>preview</code><code>levels</code><code>path</code><code>url_format</code><code>zero_padding</code><code>index_start</code><code>tilesize</code><code>yaw</code><code>pitch</code><code>fov</code><code>maxVFov</code><code>maxHFov</code><code>pitch_min</code><code>pitch_max</code><code>maxResolution</code><code>pinFirstLevel</code><code>zoom</code><code>scene_id</code><code>scene_index</code><code>geo</code><code>geo_zoom</code></span></p>',custom_sort:"<h2>Custom Sort</h2><p>This mode allows you to drag-and-drop items into a custom sorting order. After you have sorted items, click the &quot;save&quot; button.</p><p>Files and folders are by default sorted by name. When you add new files or folders, they will automatically be sorted by name also. However, if you have already applied custom sorting, new files and folders will be added to the top of the list.</p>",previews:"<h2>Update Preview Images</h2><p>This tool will attempt to set preview images for your pages, unless already set correctly.</p><p><em>What are page preview images?</em><br>Page preview image is a unique image that identifies a page. It is used in category listing pages, in the mega menu, and also when sharing the page.</p><p><em>Do my pages need preview images?</em><br>No, but if you are using the mega menu, you may want to have unique preview images for each page. If you don't set a unique preview image, default preview image will be used.</p><p><em>Why isn't this process automatic?</em><br>This process is too slow to be handled automatically by the frontend.</p><p><em>How does this tool help?</em><br>You might have forgotten to set a preview image? Perhaps you want your category pages to inherit preview image from a child folder? Maybe you renamed an image that is used for preview? This tool will correct issues for you.</p><p><em>This tool will attempt to perform the following on all your pages:</em></p><strong>If preview image is set</strong><ol><li>Checks if the preview image is valid.</li><li>Checks if <code>preview.jpg</code> exists in folder.</li><li>Tries to set first image from the page gallery.</li><li>If the page has no images, tries to set first image from page gallery assets.</li><li>If no success, you will be notified 'Cannot locate image'.</li></ol><strong>If preview image is <u>NOT</u> set</strong><ol><li>Checks if <code>preview.jpg</code> exists in folder.</li><li>Tries to set first image from the page gallery.</li><li>If page has no images, tries to set first image from gallery assets.</li><li>If page has no assets assigned, tries to set image from first image in last child folder.</li><li>If no success, preview will be left empty.</li></ol>",refresh:"<h2>Refresh Menu</h2><p>Click this button to refresh your site main menu.</p><h4>Why isn't this process automatic?</h4><p>Building the menu can be a slow process because it requires looping through all pages, extracting data, and looping through images. Why re-build the menu each time you make a change if the change does not affect the menu? Use this button to publish your site menu when required. Pages will get created faster when the menu is cached.</p><h4>Can I set it to automatic?</h4><p><strong>Yes.</strong> Go to <em>Settings â€º Advanced â€º Menu Processing</em>, and disable <em>Manual refresh</em>. If you disable this feature, the site menu will be re-created every time you make <em>any</em> changes from the panel. Depending on the depth of your content and the speed of your server, this could drastically slow down page creation time.</p><p><em>* Manual menu refresh does not affect output speed of already-cached pages.</em></p>",vertical_split:"<h3>Split View</h3><p>The split view setting allows you to split each item into two columns, with image on one side and caption on the other. This setting works best with the <code>vertical</code> layout, but can also be used with <code>grid</code> and <code>carousel</code>.</p><p><em>* Below is an example of an item displaying in split view.</em></p><div style='overflow:auto;'><div style='width:50%; padding: .5em; float:left;'><div style='background:#CCC; padding: 2em 0;text-align: center;font-size:2em;'>image</div></div><div style='width:50%; padding: .5em; float:left;'><div style=''><strong>Title</strong><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean accumsan justo vulputate arcu posuere scelerisque. Mauris at sollicitudin ante.</p></div></div></div><h4>Ratio</h4><p>The split view is based on a 12-column grid, and default ratio <strong>6</strong> means the columns will split into two equally-sized columns. If you increase the ratio, the left column will occupy more space. The ratio can be set from <strong>2 to 10</strong>, indicating how many columns the left side should occupy. Normally, you should be considering values between 4 and 8 for any functional layout.</p><p><em>* Example of ratio to set 4, which means left side will occupy 33.3% of the available width</em></p><div style='overflow:auto;'><div style='width:33.3%; padding: .5em; float:left;'><div style='background:#CCC; padding: 2em 0;text-align: center;font-size:2em;'>image</div></div><div style='width:66.6%; padding: .5em; float:left;'><div style=''><strong>Title</strong><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean accumsan justo vulputate arcu posuere scelerisque. Mauris at sollicitudin ante.</p></div></div></div><h4>Invert</h4><p>By default, the split is inverted so that preview-image is on the left, and text is on the right. If you disable invert, the text will be on the left, and image on the right.</p>",page_title:"<h2>Page Title</h2><p>This is the main title of your page. If you don't set a page title, title will be inherited from <em>folder name</em>. Page title is used for the following:</p><ul><li><code>&lt;h1&gt;</code> large title at the top of page content.</li><li><code>&lt;title&gt;</code> meta tag used for SEO and social sharing.</li><li>Page/folder listing pages.</li><li>Carousel- and list mega menu.</li></ul><h4>HTML Tags</h4><p><em>Some</em> html tags are allowed in the page title:<br><span class=code-inline-block><code>&lt;a&gt;</code><code>&lt;span&gt;</code><code>&lt;em&gt;</code><code>&lt;i&gt;</code><code>&lt;b&gt;</code><code>&lt;strong&gt;</code><code>&lt;small&gt;</code><code>&lt;s&gt;</code></span></p><p><em>*Html tags are stripped from menu items.</em></p>",menu_label:"<h2>Menu Label</h2><p>Use the menu label to set a short title for the main menu. If you don't set a menu label, label will be inherited from <em>folder name</em>. Unlike titles, menu labels should be as short as possible, so they fit nicely into the menu.</p><h4>HTML Tags</h4><p><em>Some</em> html tags are allowed in the menu label:<br><span class=code-inline-block><code>&lt;span&gt;</code><code>&lt;em&gt;</code><code>&lt;i&gt;</code><code>&lt;b&gt;</code><code>&lt;strong&gt;</code><code>&lt;small&gt;</code><code>&lt;img&gt;</code><code>&lt;svg&gt;</code></span></p><p><em>* Mega menu <em>carousel</em> will use titles instead of label.</em><br><em>* label can also be used in folders-listings.</em></p>",page_link:"<h2>Link URL</h2><p>If you want to create the page as alink to another page/website, add the URL for the page you want to link to. You can use <em>root-relative</em> urls to other pages in your X3 website, <em>relative</em> urls to child-pages of the current page, or <em>absolute</em> links to external websites.</p><h3>Examples</h3><p><code>/galleries/food/</code><br>Link to another page in your website with a root-relative url. When you include a slash before the relative url, it will look for the url relative to your website root. <em> * When linking to a page within your X3 website, the page will load with AJAX in the same window.</em></p><p><code>child-folder/</code><br>Link to a child-page of the current page by omitting the opening slash.</p><p><code>https://www.photo.gallery</code><br>Link to an external website by adding absolute url.</p><p><code>file.pdf</code><br>Link to a file located in the page.</p>",page_link_target:"<h2>Link Target</h2><p>Use this setting to decide the target for the link.</p><p><strong>auto</strong><br>Window target will be determined automatically: Relative links will open in same <code>_self</code> window, while absolute links and files will open in a new <code>_blank</code> window.</p><p><strong>_self</strong><br>Link will always open in the same <code>_self</code> browser window.</p><p><strong>_blank</strong><br>Link will always open in a new <code>_blank</code> browser window.</p><p><strong>Popup Window</strong><br>Link will open in a native browser popup window. <em>* Mobile devices will revert to a new tab/window.</em></p><p><strong>X3 Popup</strong><br>Link will open in the native X3 popup, useful and elegant for image and video links.</p><p><strong>X3 Modal</strong><br>Displays the content of this page in an X3 modal popup. <em>* ignores the link</em></p>",page_hidden:"<h2>Hide Page</h2><p>Hidden pages will not display in the menu or page layouts, but are still available by URL.<p>",panorama:'<h2>Panorama Plugin</h2><span class="x3-not-pro"></span><p>The X3 panorama plugin allows you to display spherical panoramas and multi-resolution gigapixel images. X3 supports three panorama formats:</p><h4>Equirectangular</h4><p>Equirectanular is a single-file spherical 360/180 panorama format. It is easy to include equirect panoramas in X3 since they are single files, although there are some limitations to this format. Simply upload your equirect images into a gallery and they will display in the panorama viewer. Safe image size is 4096 px wide <a href=http://webglstats.com/webgl/parameter/MAX_TEXTURE_SIZE target=_blank>(supported by most browsers)</a>. If you want higher quality 8192 px, you will need to make sure your server can resize large images down to 4096 px.</p><h4>Cube</h4><p>Cube is a multi-file spherical panorama format. It is more powerful than the equirect format, because it loads tiles progressively and supports higher resolutions, but more tedious to implement.</p><ol><li>Create your cube format project from <a href=http://www.marzipano.net/tool/index.html target=_blank>Maripano Tools</a>.</li><li>Upload a placeholder image that will represent the cube panorama in your gallery.</li><li>By FTP, upload the folder downloaded from Marzipano Tools into the same gallery folder.</li><li>Make sure the placeholder image and project folder have the same name, for example image <code>my_cube_panorama.jpg</code> and folder <code>my_cube_panorama</code>.</li><li>From the panel, make sure to HIDE the project folder so that it doesn\'t display as a page in X3.</li></ol><h4>Flat multi-resolution</h4><p>The X3 panorama plugin also supports flat (non-spherical) multi-resolution gigapixel images exported from tools like Pano2VR and Krpano.</p><ol><li>Upload a placeholder image that will represent the flat panorama in your gallery.</li><li>Upload your flat project folder into the same gallery folder by FTP.</li><li>Make sure the placeholder image and project folder have the same _name, for example image <code>flat_pano.jpg</code> and folder <code>_flat_pano</code>.</li><li>Done! If your pano folder contains a pano.xml config file (Krpano or Pano2VR), X3 will auto-detect configuration.</li></ol><p><strong>Manual configuration</strong><br>If your exported project doesn\'t contain a pano.xml file or the exporter tool is unknown, you will need manually apply flat parameters <code>url_format</code>, <code>tilesize</code>, <code>width</code> and <code>height</code>.<br><code style="word-break: break-word;">url_format=l1/%0v/l1_%0v_%0h.jpg&tilesize=1024&width=1024,3072,6144,12288,23552&height=404,1208,2416,4832,9260</code></p><h3>Panorama in content</h3><p>You can also add panoramas directly to your page content section. Examples:</p><p><strong>Equirect</strong><br>At it\'s most basic, add a link with <code>data-panorama</code> attribute, and path to the equirect format in the href tag. X3 will assume the image width is 4096 px.</p><p><code>&lt;a href=&quot;{{path}}sunset.jpg&quot; data-panorama&gt;sunset&lt;/a&gt;</code><br><code>data-panorama="width=8192"</code><br><code>data-panorama="source=sunset.jpg&width=8192&open" title="Nice sunset!"</code></p><p><strong>Cube</strong><br><code>data-panorama="path=cube_folder&levels=3"</code></p><p><strong>Flat</strong><br><code>data-panorama="path=folder&index_start=1&zero_padding=0"</code></p><h3>Parameters</h3><p>The following options are available to be used both in gallery parameters and content <code>data-panorama</code> parameters. Assign parameters in query-string style: <code>title=hello&open=true</code>.</p><p><span class="code-inline-block"><code>id</code><code>title</code><code>open</code><code>width</code><code>height</code><code>type</code><code>source</code><code>source_4096</code><code>preview</code><code>levels</code><code>path</code><code>url_format</code><code>zero_padding</code><code>index_start</code><code>tilesize</code><code>yaw</code><code>pitch</code><code>fov</code><code>maxVFov</code><code>maxHFov</code><code>pitch_min</code><code>pitch_max</code><code>maxResolution</code><code>pinFirstLevel</code><code>zoom</code><code>scene_id</code><code>scene_index</code><code>geo</code><code>geo</code></span></p>'};var he,me,fe,ge,ve=!1,be=[],ye=!1,we=!1,_e={},xe=[],ke="user"===user?core_user_dir:root_dir_name;function Ce(){n.append('<div id="context-menu" style="" class="dropdown">\t<ul class="dropdown-menu" role="menu" aria-labelledby="context-menu">\t<li role="presentation" class="dropdown-header">Content</li>\t<li role="presentation" class="cm-hide"><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-pencil"></span></a></li>\t<li role="presentation" class=cm-rename><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-pencil"></span>'+language.Rename+'</a></li>\t<li role="presentation" class="cm-delete"><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-remove"></span>'+language.Delete+'</a></li>\t<li role="presentation" class=cm-move><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-move"></span>'+language.Move+'</a></li>\t<li role="presentation" class=cm-copy><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-transfer"></span>'+language.Copy+'</a></li>\t<li role="presentation" class=cm-upload><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-plus"></span>'+language.Upload+'</a></li>\t<li role="presentation" class=cm-new><a role="menuitem" tabindex="-1"><span class="glyphicon glyphicon-file"></span>'+language.Create_New_Folder+"</a></li>\t</ul>\t</div>");var e=n.children("#context-menu");e.find("li.cm-rename > a, li.cm-move > a, li.cm-copy > a").click(function(t){t.preventDefault();var a=here;here=e.data("path").replace(/\/$/,""),s.children("#showConf").on("hidden.bs.modal",function(e){setTimeout(function(){here=a},1),s.children("#showConf").off("hidden.bs.modal")})}),e.find("li.cm-hide > a").click(function(t){t.preventDefault();var a=e.data("path"),n=!e.data("hidden"),i={};i[a.split("./content/")[1]]={hidden:n},ne(i,function(){ee(null,n,a),te(e.data("listitem"),n,a),a===me&&s.children(".x3-manager").toggleClass("is-hidden",n).find(".btn-hide").toggleClass("active",n),pt(e.data("name")+" "+ft(n?"Hide":"Unhide"),null,null,"success")})}),e.find("li.cm-delete > a").click(function(t){t.preventDefault(),remove_dir(e.data("path"),e.data("name"),"first"),s.children("#showConf").modal("show")}),e.find("li.cm-rename > a").click(function(t){t.preventDefault(),rename_dir(e.data("path"),e.data("name"),"first"),s.children("#showConf").modal("show")}),e.find("li.cm-move > a").click(function(t){t.preventDefault(),rename_dir(e.data("path"),e.data("name"),"move"),s.children("#showConf").modal("show")}),e.find("li.cm-copy > a").click(function(t){t.preventDefault(),copy_dir(e.data("path"),e.data("name"),"first"),s.children("#showConf").modal("show")}),e.find("li.cm-upload > a").click(function(t){t.preventDefault(),showUploader(e.data("path"));var a=s.children(".modal#uploader"),n=a.find(".modal-title").text();a.find(".modal-title").text("Upload to "+e.data("name")),a.find(".modal-footer > button").hide(),a.find(".modal-footer").append('<button type="button" class="btn btn-default btn-temp" data-dismiss="modal" onclick="show_preloader(); setTimeout(function(){loading_from_file = false; hide_preloader(); have_action = \'yes\'; active_page_tab = \'#gallery\'; showFileManager(\''+e.data("path")+"')}, 1000);\">Click to see uploaded files.</button>"),a.on("hidden.bs.modal",function(e){var t=$(this);t.find(".modal-title").text(n),t.find(".modal-footer > button.btn-temp").remove(),t.find(".modal-footer > button").show(),a.off("hidden.bs.modal")}),a.modal("show")}),e.find("li.cm-new > a").click(function(t){t.preventDefault(),x3_modal_new_folder.data("there",e.data("path")),x3_modal_new_folder.modal("show")}),s.on("show.bs.modal","#newFolder",function(e){var t=$(this),a=(t.data("there")||here)+"//";t.find("label > span.path").html(a.replace(/\.\.\//g,"").replace(/\.\//g,"").replace("content/","").replace("///","").replace("//",""))}).on("hidden.bs.modal","#newFolder",function(e){$(this).removeData("there")})}function Se(e){var t=o.find("#left_folder_menu_box > ul");t.mtree({use_nodes:!0,skip_init:!1,close_same_level:!1}),fe=[],It(),t.find("a").each(function(e,t){var a=$(this),n=a.parent("li"),i=a.text(),o=a.data("href").split("./content/")[1],l=o.split("/"),s=0===i.indexOf("_"),r=s||folders&&folders.hasOwnProperty(o)&&folders[o].hasOwnProperty("hidden")&&folders[o].hidden;n.append('<span class="mtree-tools">&nbsp;<span class="glyphicon glyphicon-wrench"></span></span>'),r&&n.addClass("is-hidden"+(s?" is-name-hidden":"")),$.each(l,function(e,t){t.indexOf(".")>-1&&$.isNumeric(t.split(".")[0])&&(l[e]=t.split(".")[1])}),(l=l.join("/").replace(/\/?$/,"/").replace("index/","")).length>0&&(0!=l.indexOf("custom/")||0===l.indexOf("custom/files/")&&"custom/files/"!==l)&&0!=l.indexOf("services/")&&fe.push({link:l,label:l,path:o})});var a=t.children("#_custom");a.add(a.find("ul, li")).addClass("no-drag"),a.appendTo(t),a.find("#_custom__files").appendTo(a.children("ul")),Z(),t.siblings("#menu-expand").length<1&&t.before('<button id="menu-expand">+ '+language.Menu_Expand+"</button>"),n.children("#context-menu").length<1&&Ce(),ye||(k()&&null!==localStorage.getItem("mtree_state")&&(be=JSON.parse(localStorage.getItem("mtree_state"))),ye=!0),Ee()}function Te(){o.find("#left_folder_menu_box > ul").mtree({use_nodes:!1,skip_init:!0,close_same_level:!1}),Ee()}function je(){var e=s.find("#menu-container");e.length&&(clearTimeout(ge),ge=setTimeout(function(){$.isScrollToFixed(e)&&(e.height()>a.height()-50||a.width()<992)?e.trigger("detach.ScrollToFixed"):!$.isScrollToFixed(e)&&e.height()<a.height()-50&&a.width()>=992&&e.scrollToFixed({zIndex:2,marginTop:40})},300))}function Ee(){var e=o.find("#left_folder_menu_box"),t=e.children("ul"),i=n.children("#context-menu");"ontouchstart"in window&&!(a.width()>=992)||t.find("ul:not(.no-drag)").add(t).filter(function(e){return $(this).children().length>1}).each(function(e,t){var a=$(t);a.addClass("is-sortable"),Sortable.create(t,{animation:100,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",filter:".no-drag",onSort:function(){var e=!0,t=a.children(":not(#_custom)"),n={};t.each(function(t,a){a.setAttribute("data-custom",t+1),n[a.getAttribute("data-content-path")]={index:t+1},e&&t!==parseInt(a.getAttribute("data-sort"))&&(e=!1)}),e&&(t.attr("data-custom","0"),Object.keys(n).forEach(function(e){n[e].index=0})),Object.keys(n).length&&ne(n,function(){if(Qe.length){var t=a.parent("li"),i=t.length?t.attr("data-dir"):ke;(i===me||!me&&ke===i)&&(Qe.each(function(e,t){var a=se(t.getAttribute("data-path"));n.hasOwnProperty(a)&&t.setAttribute("data-custom",n[a].index)}),3===it&&st(Qe,"custom"),at.toggleClass("disabled",e))}pt("Sorted!",null,null,"success"),e&&pt("Sorting reset to alphabetic order",null,null,"success")})}})});t.on("click",".mtree-icon",function(){Ie(t),je()}),Oe(t),t.hoverIntent({over:function(e){var a=$(this).siblings(".mtree-tools");a.addClass("current_intent"),t.find(".current_hover").not(".current_intent").hide().removeClass("current_hover"),a.hasClass("current_hover")||a.velocity({opacity:1},{duration:200,display:"block"}).addClass("current_hover"),a.removeClass("current_intent")},out:function(){},selector:"a"}).on("mouseover","a",function(e){t.contextmenu("closemenu",e),i.off("mouseleave.closemenu"),t.find("li.current-li-active").removeClass("current-li-active"),$(this).parent("li").addClass("current-li-active")}).on("mouseleave",function(e){t.find(".current_hover").hide().removeClass("current_hover")}),t.hoverIntent({over:function(e){t.contextmenu("show",e),i.on("mouseleave.closemenu",function(e){t.contextmenu("closemenu",e),i.off("mouseleave.closemenu")})},out:function(){},selector:".mtree-tools"}),t.find("a").click(function(e){e.preventDefault();var a=$(this);t.find(".menu_active").removeClass("menu_active"),a.parent("li").addClass("menu_active"),showFileManager(a.data("href"))});var l=i;t.contextmenu({target:"#context-menu",before:function(e,a){e.preventDefault();var n=t.find(".current-li-active");n.addClass("current-context-active");var i=n.children("a").data("href"),o=i.split("/"),s=o[o.length-1],r=n.hasClass("is-hidden"),d=n.hasClass("is-name-hidden");return l.data("path",i),l.data("name",s),l.data("listitem",n),l.data("hidden",r),l.find(".dropdown-header").text(s),l.find(".hidden").removeClass("hidden"),l.find(".cm-hide > a").text(ft(r?"Unhide":"Hide")),i.indexOf("content/custom/files/")>-1?l.find(".cm-hide, .cm-move, .cm-copy, .cm-new").addClass("hidden"):i.endsWith("content/custom/files")?l.find(".cm-hide, .cm-rename, .cm-delete, .cm-move, .cm-copy, .cm-upload").addClass("hidden"):i.indexOf("content/custom/")>-1?l.find(".cm-hide, .cm-rename, .cm-delete, .cm-move, .cm-copy, .cm-new").addClass("hidden"):i.endsWith("content/custom")?l.find(".cm-hide, .cm-rename, .cm-delete, .cm-move, .cm-upload, .cm-new").addClass("hidden"):(i.endsWith("content/1.index")||i.endsWith("content/index"))&&l.find(".cm-new").addClass("hidden"),d&&l.find(".cm-hide").addClass("hidden"),!0}}),l.on("hide.bs.context",function(){t.find(".current-context-active").removeClass("current-context-active")}),e.children("#menu-expand").click(function(e){ve?t.find(".mtree-open").removeClass("mtree-open mtree-active").addClass("mtree-closed").children("ul").css({height:"0px",display:"none"}):t.find(".mtree-closed").removeClass("mtree-closed").addClass("mtree-open").children("ul").css({height:"auto",display:"block"}),je(),Ie(t)}),mtreeActive(t),t.show()}function mtreeActive(e){(e=e||o.find("#left_folder_menu_box > ul")).find(".menu_active").removeClass("menu_active"),e.find('a[data-href="'+here.replace(/\/+$/,"").replace(/"/g,'\\"')+'"]').parent("li").addClass("menu_active")}function Ie(e){be.length=0,e.find(".mtree-open").has("ul").each(function(e,t){var a=$(this).attr("id");-1===a.indexOf("/")&&be.push(a)}),k()&&localStorage.setItem("mtree_state",JSON.stringify(be)),$e(e)}function Oe(e){e.find(".mtree-open").removeClass("mtree-open mtree-active").addClass("mtree-closed").children("ul").css({height:"0px",display:"none"}),$.each(be,function(t,a){e.find("#"+a).has("ul").removeClass("mtree-closed").addClass("mtree-open").children("ul").css({height:"auto",display:"block"})}),$e(e)}function $e(e){ve=0!==be.length&&0!==e.children(".mtree-open").has("ul").length,s.find("#menu-expand").text(ve?"- "+language.Menu_Collapse:"+ "+language.Menu_Expand)}a.on("resize.menu_scrolltofixed",$.debounce(500,je)),s.on("keyup",".modal input.form-control",function(e){if(13==e.keyCode){var t=$(this).closest(".modal");t.find(".btn-key").length&&t.find(".btn-key").click()}}),o.find("#searchInput").on("keyup",function(e){13==e.keyCode&&$(this).parent().siblings(".top_search_btn").click()}),s.on("click.tablerow",".manage-table tr",function(e){var t=e.target.nodeName.toLowerCase();"td"!=t&&"tr"!=t||$(this).find('input[type="checkbox"]').click()});var Pe,Ae=k()&&null!==localStorage.getItem("active_page_tab")?localStorage.getItem("active_page_tab"):"#page";function Fe(){var e=s.height();s.css("height",e),a.scrollTop()>300&&t.velocity("stop").velocity("scroll",{duration:600,easing:"easeInOutCubic"})}function De(){var e=k()&&null!==localStorage.getItem("current_page")?localStorage.getItem("current_page"):"";here=e,showFileManager(e)}function Ne(e,t,a){return e.replace("{{dynamic_path}}","Files in this folder can be accessed from content and plugins by using dynamic path <strong>{{files}}/"+t+"/</strong>filename."+a)}function Re(e){var t=e.closest("tr"),a=e.data("action"),n=e.data("time")||"first";t.length&&t.data("path")&&t.data("name")&&window[a](t.data("path"),t.data("name"),n,!0)}function Me(e){x3_show_conf=s.children("#showConf"),x3_conf_button=x3_show_conf.find("#confButton"),x3_mtree=s.find("ul.mtree"),x3_modal_new_folder=s.children("#newFolder"),x3_modal_new_zip_file=s.children("#newzipFile"),x3_modal_copy_selected=s.children("#copySelected"),x3_modal_move_selected=s.children("#moveSelected"),x3_modal_remove_selected=s.children("#removeSelected"),x3_modal_uploader=s.children("#uploader"),container_id_tree=x3_show_conf.find("#container_id_tree"),container_id_tree2=x3_modal_move_selected.find("#container_id_tree2"),container_id_tree3=x3_modal_copy_selected.find("#container_id_tree3");var t=s.children(".x3-manager"),a=t.find(".manage_box_show"),n=a.children(".col-md-3"),i=a.children(".col-md-9"),o=(tt=i.find(".manage-container")).children(".table.manage-table"),l=o.children(".popup-parent"),r=l.children("tr"),d=i.children(".current-folder-btns"),u=i.find(".selected-actions");if(t.addClass("level-"+(e?se(e).split("/").length:0)),Qe=r.filter('[data-isfile="0"]'),Ze=r.filter('[data-isfile="1"]'),et=l,x3_modal_new_folder.find("#new_folder_link").on("keypress keyup focus",function(e){x3_modal_new_folder.find(".new-folder-target-container").toggleClass("hidden",!$(this).val())}),k()){var p=!(null==localStorage.getItem("new_folder_options_open")||!localStorage.getItem("new_folder_options_open")),h=x3_modal_new_folder.find('a[data-toggle="collapse"]');x3_modal_new_folder.find(".new-folder-options").toggleClass("in",p),h.text(p?"- Less settings":"+ More settings"),h.on("click",function(e){p=!p,localStorage.setItem("new_folder_options_open",p?"1":""),h.text(p?"- Less settings":"+ More settings")})}if(x3_show_conf.add(x3_modal_new_folder).add(x3_modal_new_zip_file).on("shown.bs.modal",function(){$(this).find("input.form-control").first().focus().select()}),o.on("click",".dropdown-menu a",function(e){e.preventDefault()}),d.children(".btn-group").on("click","button",function(t){var a=$(this),n=a.data("action"),i=a.data("time")||"first";x3_show_conf.modal("show"),window[n](e,j,i,!0)}),d.children(".btn-uploader").on("click",function(e){x3_modal_uploader.modal("show")}),d.children(".btn-new").on("click",function(e){x3_modal_new_folder.modal("show")}),l.on("click",".td-button a:not(.set-preview):not(.hide-file)",function(e){e.preventDefault(),Re($(this)),x3_show_conf.modal("show")}),l.on("click",".is-folder > .td-name > a",function(e){e.preventDefault(),this_dir_path=$(this).closest("tr").attr("data-path"),showFileManager(this_dir_path)}),!t.is("#page_search")&&(!k()||k()&&"hide"!==localStorage.getItem("help-"+e))){var m=e.split("/").pop(),g=i.children("hr"),v="";"3.examples"==m?v=x3_help["page-examples"]:e.endsWith("content/1.index")?v=x3_help["page-index"]:e.endsWith("content/custom")?v=x3_help["page-custom"]:e.endsWith("content/custom/logo")?v=x3_help["page-logo"]:e.endsWith("content/custom/audio")?v=x3_help["page-audio"]:e.endsWith("content/custom/404")?v=x3_help["page-404"]:e.endsWith("content/custom/favicon")?v=x3_help["page-favicon"]:e.endsWith("content/custom/files")?v=x3_help["page-files"]:e.endsWith("content/custom/files/javascript")?v=x3_help["page-javascript"]:e.endsWith("content/custom/files/css")?v=x3_help["page-css"]:e.endsWith("content/custom/files/images")?v=x3_help["page-images"]:e.indexOf("content/custom/files/")>-1?v=x3_help["page-files-generic"].replace(/{{foldername}}/g,m):e.indexOf("examples/assets")>-1?v=x3_help["page-assets"]:e.length<1&&(v=x3_help["page-content"]),v&&g.after(v);var b=g.siblings(".alert");b.data("path",e),b.one("closed.bs.alert",f),f(!0)}n.find(".new-root-page").click(function(e){var t="user"===user?core_user_dir:root_dir_name;x3_modal_new_folder.data("there",t).modal("show")}),xe=[],r.length&&r.each(function(e,t){"1"==t.getAttribute("data-isimage")&&xe.push(t.getAttribute("data-name"))}),je(),me=e,k()&&localStorage.setItem("current_page",e);var w=i.children("#myTab"),_=w.find("a");if(_.length>1){var x=_.filter('a[href="'+Ae+'"]');x.length&&x.is(":visible")?x.tab("show"):_.filter(":visible").tab("show")}else _.tab("show");w.on("click","a",function(e){Ae=$(this).attr("href"),k()&&localStorage.setItem("active_page_tab",Ae)}).on("shown.bs.tab","a",function(e){f(!0)}),s.css("height","");var C=e||ke,S=C.endsWith("./content")?"":C.split("./content/")[1],T=S.split("/"),j=T[T.length-1],E="custom"==T[0],I=folders&&folders.hasOwnProperty(S)&&folders[S].hasOwnProperty("hidden")&&folders[S].hidden,O=!1;if($.each(T,function(e,t){if(0===t.indexOf("_"))return I=O=!0,!1;t.indexOf(".")>-1&&$.isNumeric(t.split(".")[0])&&(T[e]=t.split(".")[1])}),"/"===(T=T.join("/").replace(/\/?$/,"/").replace("index/",""))&&(T=""),!O&&S&&i.find(".page-title").prepend('<a href="../'+T.replace(/"/g,"&quot;")+'" target="_blank" class="view-page" title="'+language.View_Page+'"><span class="glyphicon glyphicon-new-window"></span></a>'),S&&!E&&!O){d.children(".btn-group").prepend('<button type="button" class="btn btn-default btn-group-filemanager btn-hide'+(I?" active":"")+'">'+ft("Hide")+"</button>");var P=d.find(".btn-hide");P.on("click",function(e){e.stopImmediatePropagation();var a={};a[S]={hidden:!I},ne(a,function(){I=!I,P.toggleClass("active",I),t.toggleClass("is-hidden",I),te(null,I,C),pt(j+" "+ft(I?"Hide":"Unhide"),null,null,"success")})})}E&&t.addClass("is-custom"),I&&t.addClass("is-hidden"),O&&t.addClass("is-name-hidden"),c.find("#website-link > a").attr("href","../"+(0===T.indexOf("custom/")||O?"":T)),O||i.children(".title-url").attr("href","../"+T).children("span").first().text(location.hostname+y()+"/"+T),we=!1,u.find("button").addClass("disabled"),Ye(),Je(),Le(),ot=!1,lt=!1;var A=0,F=0;r.each(function(e,t){var a="0"==(t=$(this)).attr("data-isfile"),n=t.attr("data-name"),i=t.attr("data-path").split("./content/")[1],o=void 0!=t.data("hidden");if(t.addClass(a?"is-folder":"is-file"),a?A++:F++,a&&folders&&folders.hasOwnProperty(i)&&(folders[i].hasOwnProperty("hidden")&&folders[i].hidden&&(o=!0),folders[i].hasOwnProperty("index")&&t.attr("data-custom",folders[i].index)),void 0!=Ft&&!a&&Ft.hasOwnProperty(n)){var l=Ft[n];l.hasOwnProperty("index")&&t.attr("data-custom",l.index),l.hasOwnProperty("hidden")&&(o=l.hidden)}var s=0===n.indexOf("_"+(a?"":"_"));(s&&(o=!0),o&&t.addClass("is-hidden"+(s?" is-name-hidden":"")),t.is('[data-isimage="1"]'))&&(t.find("ul.dropdown-menu").children('[role="presentation"]').after('<li><a href=# class="set-preview">Set as preview image</a></li>'),t.children(".td-name").prepend('<span class="fa fa-flag set-preview" title="Set as folder preview image"></span>'));if(!s){var r=ft(o?"Unhide":"Hide");t.children(".td-name").prepend('<span class="fa fa-eye'+(o?"-slash":"")+' hide-file" title="'+r+'"></span>'),t.find("ul.dropdown-menu").children('[role="presentation"]').after('<li><a href=# class="hide-file">'+r+"</a></li>")}}),tt.addClass(A>0?"has-folders":"no-folders").addClass(F>0?"has-files":"no-files").toggleClass("is-empty",0===A&&0===F),dt(it,0==it),ze(),Be(Ue);var D=i.find(".manage-list-buttons");D.children(".selected-actions").css("min-height",D.children(".list-actions").outerHeight(!0)),D.scrollToFixed({zIndex:5})}function qe(e){var t=e?e.data("name"):null;setTimeout(function(){Dt({image:t},function(a){if(a&&e){var n=s.find('input.form-control.selectized[name="image"]');n.length&&n[0].selectize.addItem(t,!0),e.addClass("preview-image")}},"Updated preview image: "+t,!1)},500)}function Le(){var e=s.children(".x3-manager").not("#page_search");if(e.length){var t=e.find(".manage-table"),a=t.find('tr[data-isimage="1"]');if(t.find("tr.preview-image").removeClass("preview-image"),a.length)if(Ft.image&&-1===Ft.image.indexOf("/")){var n=a.filter('[data-name="'+Ft.image.replace(/"/g,'\\"')+'"]');if(n.length)n.addClass("preview-image");else if(!Ft.gallery.assets){qe(n=(i=a.filter('[data-name="preview.jpg"]')).length?i:a.first())}}else if(!Ft.image&&a.length){var i;qe(n=(i=a.filter('[data-name="preview.jpg"]')).length?i:a.first())}}}function ze(){var e=[],t=window.devicePixelRatio>1?"200":"100",a=s.find(".manage-table");a.find("tr").each(function(a,n){n=$(this);e[a]={name:n.attr("data-name").replace(/"/g,"&quot;"),path:n.attr("data-path").replace("../content/../content/","../content/").replace("../../","../"),ext:n.data("ext"),isfile:n.data("isfile"),isimage:n.data("isimage")};var i=e[a].ext.toLowerCase();if(-1!==$.inArray(i,["jpg","jpeg","png","gif"])){var o=n.find(".td-name .popup"),l=e[a].path.replace(/"/g,"&quot;"),s=l.replace("content","render/w"+t+"-c1:1"),r='<td class="td-thumb td-jpg"><span class="glyphicon glyphicon-picture"></span><a href="'+l+'" class="popup" data-width="'+o.data("width")+'" data-height="'+o.data("height")+'" data-name="'+e[a].name+'" data-filesize="'+o.data("filesize")+'" rel="group2"><img src="'+s+'" /></a></td>';o.attr("href")!==e[a].path&&o.attr("href",e[a].path)}else r="zip"===i?'<td class="td-thumb td-file"><span class="fa fa-file-zip-o"></span></td>':"js"===i||"css"===i?'<td class="td-thumb td-file"><span class="fa fa-code"></span></td>':"mp3"===i?'<td class="td-thumb td-file"><span class="glyphicon glyphicon-volume-up"></span></td>':"mp4"==i?'<td class="td-thumb td-file"><span class="fa fa-film"></span></td>':"1"==e[a].isimage?'<td class="td-thumb td-picture"><span class="glyphicon glyphicon-picture"></span></td>':"1"==e[a].isfile?'<td class="td-thumb td-file"><span class="glyphicon glyphicon-file"></span></td>':'<td class="td-thumb td-folder"><span class="glyphicon glyphicon-folder-close"></span></td>';if(n.find(".td-checkbox").after(r),"1"==e[a].isfile){var d=n.data("title"),c=n.data("description")||"",u=n.data("link"),p=n.data("link-target"),h=n.data("params")||"";if(void 0!=Ft&&e[a].name in Ft){var m=Ft[e[a].name];m.title&&(d=m.title),m.description&&(c=m.description),m.link&&(u=m.link),m.target&&(p=m.target),m.params&&(h=m.params)}p="auto"!=p&&p,(r=n.children(".td-name")).append('<div class="file-data'+(u?" has-link":"")+'"><i class="fa fa-question panel-help" data-help="image_title"></i><input type="text" class="form-control file-title" placeholder="Title"><i class="fa fa-question panel-help" data-help="image_description"></i><textarea class="form-control file-description" rows="3" placeholder="Description">'+c+'</textarea><a href="#" class="fa fa-link" target="_blank"></a><i class="fa fa-question panel-help" data-help="image_link"></i><input type="text" class="form-control file-link" placeholder="Link"><div class="btn-group btn-group-sm" data-toggle="buttons"><label class="btn btn-default'+(p?"":" active")+'" data-name="auto"><input type="radio"'+(p?"":" checked")+'>auto</label><label class="btn btn-default" data-name="_self"><input type="radio">_self</label><label class="btn btn-default" data-name="_blank"><input type="radio">_blank</label><label class="btn btn-default" data-name="popup"><input type="radio">popup window</label><label class="btn btn-default" data-name="x3_popup"><input type="radio">X3 popup</label></div><i class="fa fa-question panel-help" data-help="params"></i><textarea class="form-control file-params" rows="1" placeholder="Parameters">'+h+"</textarea></div>"),d&&r.find(".file-title").val(d),u&&r.find(".file-link").val(u),p&&r.find('[data-name="'+p+'"]').addClass("active").children("input").prop("checked",!0)}else n.children(".td-name").append('<div class="folder-data"><span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span></div>')}),setTimeout(function(){autosize(a.find("textarea"))},1)}k()&&s.on("click",".col-md-9 > .alert > .close",function(e){e.preventDefault();var t=$(this).parent().data("path");localStorage.setItem("help-"+t,"hide")});var Ue=k()&&null!==localStorage.getItem("active_gallery_view")?Math.min(4,Number(localStorage.getItem("active_gallery_view"))):1;function Be(e){var t=s.find(".manage-container");t.removeClass("view-list view-small view-big view-edit view-grid").addClass("view-"+Pe[e][0]),t.siblings(".manage-list-buttons").find(".btn-view > span").removeClass().addClass("glyphicon glyphicon-"+Pe[e][1]),t.find(".td-button button").removeClass("btn-xs btn-sm").addClass(Pe[e][2]),Ve(3==e)}function Ve(e){s.find(".manage-table").find('a, button, input[type="checkbox"]').prop("tabIndex",!e||-1)}function select_all(){var e=s.find(".manage-table tr");we=!we,e.find(".td-checkbox > input").prop("checked",we),selected.length=0,we&&e.each(function(e,t){selected.push($(this).data("name"))}),e.toggleClass("is-checked",we),He(),We(),Xe()}function He(){var select_all=s.find("#select_all"),e=we?select_all.data("unselect"):select_all.data("select");select_all.toggleClass("active",we).data("title",e),select_all.siblings(".button-helper").text(e)}function We(){var e=s.find(".manage-table"),t=s.find(".manage-list-buttons"),a=e.find("input:checkbox"),n=a.length,i=a.filter(":checked").length,o=t.find(".selected-text"),l=i>0;o.text(i+" "+o.data("lang")).toggleClass("has-selection",i>0),t.find(".selected-actions button").toggleClass("disabled",!l).toggleClass("btn-primary",l),we&&i<n?(we=!1,He()):we||n!=i||(we=!0,He())}function Xe(){_e[here]=[],s.find(".manage-table tr").each(function(e,t){(t=$(this)).hasClass("is-checked")&&_e[here].push(t.data("name"))}),k()&&localStorage.setItem("selected_"+here,JSON.stringify(_e[here]))}function Ye(){var e=[];if(void 0!=_e[here]&&_e[here].length>0?e=_e[here]:k()&&null!==localStorage.getItem("selected_"+here)&&(e=JSON.parse(localStorage.getItem("selected_"+here))),e.length>0){selected.length=0;var t=s.find(".manage-table tr");$.each(e,function(e,a){var n=t.filter('[data-name="'+a.replace(/"/g,'\\"')+'"]');n.length&&(n.addClass("is-checked").find(".td-checkbox > input").prop("checked",!0),selected.push(n.data("name")))}),Xe(),We()}}function Je(){s.find(".manage-table tr").each(function(e,t){var a=(t=$(this)).data("filesize")||"";a.indexOf("GB")>-1?a=1e9*parseInt(a):a.indexOf("MB")>-1?a=1e6*parseInt(a):a.indexOf("KB")>-1&&(a=1e3*parseInt(a)),t.attr("data-filesize",parseInt(a)),t.data("filesize",parseInt(a))})}$(document).ready(function(){Pe=[["list","align-justify","btn-xs",language.List],["small","list","btn-sm",language.Small_Thumbs],["big","th-list","btn-sm",language.Large_Thumbs],["edit","pencil","btn-sm",language.Edit_Mode],["grid","th","btn-sm","grid"]]}),s.on("click.view",".btn-view",function(e){Ue=Ue>=Pe.length-1?0:Ue+1,k()&&localStorage.setItem("active_gallery_view",Ue),Be(Ue),s.find(".list-actions > .button-helper").text(Pe[Ue][3])}),s.hoverIntent({over:function(e){var t=$(this);t.siblings(".button-helper").text(t.data("title")).velocity({opacity:1},{duration:200})},out:function(e){$(this).siblings(".button-helper").text("").velocity("stop").css("opacity",0)},selector:".list-actions > *"}),s.tooltip({container:"body",delay:{show:200,hide:0},selector:".selected-actions .btn-primary",trigger:"hover",title:function(){return this.innerHTML+" "+selected.length+" "+language.selected_Folders_Files}}),s.hoverIntent({over:function(e){var t=$(this);t.data("hover-items")||t.data("hover-items",t.find(".td-button .btn-group, span.set-preview, span.hide-file")),t.data("hover-items").velocity({opacity:1},{duration:200})},out:function(){$(this).data("hover-items").velocity("stop").css("opacity",0)},timeout:200,selector:".manage-table tr"}),s.hoverIntent({over:function(e){$(this).find(".dropdown-menu").velocity({opacity:1},{duration:200,display:"block"})},out:function(){$(this).find(".dropdown-menu").velocity("stop").hide()},timeout:200,selector:".td-button .btn-group"}),s.on("click.checkbox",".td-checkbox > input",function(e){var t=$(this);t.closest("tr").toggleClass("is-checked",t.is(":checked")),Xe(),We()});var Ge,Ke,Qe,Ze,et,tt,at,nt=[["sort","-by-alphabet"],["filesize","-by-attributes-alt"],["date","-by-order"],["custom",""]],it=k()&&null!==localStorage.getItem("active_gallery_sort")?Math.min(3,Number(localStorage.getItem("active_gallery_sort"))):0,ot=!1,lt=!1;function st(e,t,a){e.sort(function(e,a){var n=e.getAttribute("data-"+t)-a.getAttribute("data-"+t);return n?"filesize"!=t&&"date"!=t||(n*=-1):n=e.getAttribute("data-sort")-a.getAttribute("data-sort"),n}),e.detach().prependTo(a||et)}function rt(){var e={};function t(e){if(pt("Folder sorting reset to alphabetic order",null,null,"success"),st(Qe,"sort"),Qe.removeAttr("data-custom"),!e){var t=o.find("#left_folder_menu_box"),a=me?t.find('li[data-dir="'+me+'"]').children("ul"):t.children("ul"),n=a.children(":not(#_custom)");n.length&&(n.attr("data-custom","0"),st(n,"sort",a))}}Qe.each(function(){var t=se(this.getAttribute("data-path")),a=this.getAttribute("data-custom");t&&a&&folders.hasOwnProperty(t)&&folders[t].hasOwnProperty("index")&&0!==folders[t].index&&(e[t]={index:0})}),Object.keys(e).length?ne(e,t):t(!0),at.addClass("disabled")}function dt(e,t){var a=nt[e][0];t||st(Ze,a),st(Qe,a),ut(e),"custom"===a&&(Ze.length||Qe.length)?tt.hasClass("custom-sort")||(tt.prepend('<div class=custom-sort-help><a href=# class="text-help" data-help="custom_sort">Custom Sort</a><span class="can-sort"> - Drag items into order, and click <em>save</em>.</span></div>'),tt.addClass("custom-sort"),Ge=Ze.length>1&&ct(!0),Ke=Qe.length>1&&ct()):tt.hasClass("custom-sort")&&(tt.children(".custom-sort-help").remove(),tt.removeClass("custom-sort"),Ge&&Ge.destroy(),Ke&&Ke.destroy());var n="custom"===a&&Qe.length>1,i=tt.parent().children(".manage-list-buttons"),o=Qe.last(),l=n&&o.attr("data-custom")&&"0"!==o.attr("data-custom");(at=i.find(".reset-sort")).toggleClass("hidden",!n).toggleClass("disabled",!l),i.find(".button-helper").toggleClass("hidden",n)}function ct(e){return Sortable.create(et[0],{filter:e?".is-folder":".is-file",draggable:e?".is-file":".is-folder",animation:100,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",onStart:function(e){tt.addClass("is-sorting")},onEnd:function(t){e&&(ot=!0),e||(lt=!0),tt.removeClass("is-sorting"),setTimeout(function(){},100);for(var a=e?'[data-isfile="1"]':'[data-isfile="0"]',n=et.children("tr").filter(a),i=!0,o=e?Qe.length:0,l=0;l<n.length;l++)n[l].setAttribute("data-custom",l+1),i&&l+o!==parseInt(n[l].getAttribute("data-sort"))&&(i=!1);i&&n.attr("data-custom","0"),i||e||at.removeClass("disabled")}})}function ut(e){var t=s.find(".btn-sort");t.html('<span class="glyphicon glyphicon-sort'+nt[e][1]+'"></span> '+t.data(nt[e][0])).data("title",t.data("sortby")+" "+t.data(nt[it][0]))}function x3NavPage(){if(he="fileManager",k()){var e=localStorage.getItem("current_nav");null!==e?"setting"==e?(St(),he="setting"):"users"==e?(Tt(),he="users"):"editProfile"==e?(showEditProfile(),he="editProfile"):"protect"==e?(Et(),he="protect"):"tools"==e?(Lt(),he="tools"):"auth"==e?(Nt(),he="auth"):De():De()}else De();"fileManager"===he&&o.addClass("fileManager")}function pt(e,t,a,n){var i="danger"==n?"ban":"warning"==n?"warning":"check";$.bootstrapGrowl('<i class="fa fa-'+i+'"></i>&nbsp;&nbsp;'+e||"nothing.",{type:n||"info x3-note",offset:{from:"bottom",amount:20},align:"right",width:a||"auto",delay:t||1e3,allow_dismiss:!1})}s.on("click.sort",".btn-sort",function(e){it=it>=nt.length-1?0:it+1,k()&&localStorage.setItem("active_gallery_sort",it),dt(it),s.find(".list-actions > .button-helper").text($(this).data("title"))}),s.on("click.sort",".reset-sort:not(.disabled)",rt),c.on("click.pageclass","li:not(.dropdown)",function(e){var t=$(this).attr("id");o.toggleClass("fileManager","fileManager"==t),he=t,k()&&void 0!==t&&localStorage.setItem("current_nav",t)});var ht=k()&&null!==localStorage.getItem("x3_settings")?JSON.parse(localStorage.getItem("x3_settings")):{};function mt(e){$.extend(ht,e),k()&&localStorage.setItem("x3_settings",JSON.stringify(ht))}function ft(e){if(e){var t=e.replace(/\s+/g,"_");return language[t]?language[t]:e}}s.on("click","a.popup",function(e){e.preventDefault();var t=$(this),a=t.closest(".popup-parent"),n=t.closest("tr").index('tr[data-isimage="1"]'),i=t.attr("rel"),o=[];(void 0===i?t:a.find('a.popup[rel="'+i+'"]')).each(function(e,t){var a="<span>"+(t=$(this)).data("name")+"</span><span>"+t.data("width")+" x "+t.data("height")+"</span><span>"+t.data("filesize")+"</span>",n=t.closest("tr").find(".file-data"),i=n.children(".file-title").val(),l=n.children(".file-description").val();(i||l)&&(a+="<div>",i&&(a+='<span class="caption-title">'+i+"</span>"),l&&(a+=l),a+="</div>"),o.push({src:t.attr("href"),w:t.data("width"),h:t.data("height"),title:a})});var l={index:n,showHideOpacity:!0,bgOpacity:.95,history:!1,barsSize:{top:0,bottom:0},captionEl:!0,shareEl:!1};new PhotoSwipe(Ot[0],PhotoSwipeUI_Default,o,l).init()}),k()&&(null!==localStorage.getItem("last_user")&&localStorage.getItem("last_user")!==user&&(localStorage.removeItem("current_nav"),localStorage.removeItem("current_page")),localStorage.setItem("last_user",user));var gt="user"===user?"filemanager_user/":"";function navigate_to_path(e){if(""==e)return alert(ft("Select_nav_error")),!1;"../"==e&&(e=""),show_preloader(),setTimeout(function(){hide_preloader(),showFileManager(e)},1e3)}function copy_selected(){P("new_name1: "+new_name),P("COPY > From: "+here+" > TO: "+new_name),new_name?(x3_modal_copy_selected.find("#selected_copy").val(""),x3_modal_copy_selected.modal("hide"),E()||(show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{copy_selected:selected,this_path:here,copy_path:new_name},function(e,t){"success"==t?(have_action="yes","true"==e?(loading_from_file=ft("Files and folders has been copied."),loading_from_file_status="green",reload_sidebar=!0,ie(selected,here,new_name,!0)):(loading_from_file='<div class="alert alert-error"><center>'+ft("Error! Can not copy")+" "+e+".</center></div>",loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3))):alert("Please input path!")}function move_selected(){P("MOVE_SELECTED > From: "+here+" > TO: "+new_name),new_name?(x3_modal_move_selected.modal("hide"),E()||(show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{move_selected:selected,this_path:here,move_path:new_name},function(e,t){have_action="yes","success"==t?("true"==e?(loading_from_file=ft("Files and folders has been moved."),loading_from_file_status="green",reload_sidebar=!0,ie(selected,here,new_name,!1)):(loading_from_file=ft("Error! Can not move")+" "+e+".",loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3))):alert("Please input path!")}function remove_selected(){x3_modal_remove_selected.modal("hide"),E()||(show_preloader(),P("remove_selected: "+selected),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{remove_selected:selected,this_path:here},function(e,t){"success"==t?(have_action="yes","true"==e?(loading_from_file=ft("Files and folders has been removed."),loading_from_file_status="green",reload_sidebar=!0,le(selected,here)):(loading_from_file=ft("Error! Can not remove")+" "+e+". "+ft("Please Wait..."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3))}function showUploader(e){var t=e||me;P("showUploader("+t+")"),$.post(gt+"filemanager_uploader.php",{upload_dir:t},function(e,t){"success"==t?x3_modal_uploader.find("#show_uploader").html(e):alert("Error: "+t)})}function set_new_zipFile_name(e){if(-1!=e.indexOf(".zip"))return alert(ft("Please write zip file name without extension.")),!1;zip_file_name=e}function set_selected(e,t,a){var n=$.inArray(e,selected);a?-1===n&&selected.push(e):n>-1&&selected.splice(n,1)}function vt(e,t){var a=$.inArray(t,e);a>-1&&e.splice(a,1)}function bt(e,t){return $.inArray(t,e)>-1}function yt(e){for(var t=new Array,a=0;a<e.length;a++)e[a]&&t.push(e[a]);return t}function wt(){return".."==core_user_dir||"../"==core_user_dir}function rename_file(e,t,a){filext=e.substr((Math.max(0,e.lastIndexOf("."))||1/0)+1),filext="."+filext;var n=t.replace(/\.[^/.]+$/,"");if(P("new_name1: "+new_name),"first"==a)is_rename=!0,x3_show_conf.find("#confLable").html(ft("Rename")+" "+t),x3_show_conf.find("#container_id_tree").html(ft("Write a new name.")),x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control" id="rename_new_name" placeholder="'+ft("New File Name")+'" style="float: left; margin-top: 0px;" onchange="is_rename = true; set_new_name(this.value);" value="'+n.replace(/"/g,"&quot;")+'" /><input type="hidden" class="input-small" id="rename_new_ext" value="'+filext+'" style="float: left; margin-top: 0px;" onchange="//filext = this.value;"/></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+ft("Cancel")+'</button><button class="btn btn-success btn-key">'+ft("Rename")+"</button></div></div>"),x3_show_conf.find(".btn-success").one("click",function(a){a.preventDefault(),rename_file(e,t,"r")});else if("move"==a)x3_show_conf.find("#confLable").html(ft("Move")+" "+t),x3_show_conf.find("#container_id_tree").html(ft("Choose your target directory.")),old_name=e.replace(here,""),old_name=old_name.replace(filext,""),is_move=!0,x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control input-move" id="rename_new_name" placeholder="'+ft("New File Path")+'" style="float: left; margin-top: 0px;" onchange="is_move = true; set_new_name(this.value);"/><input type="hidden" class="input-small" id="rename_new_ext" value="'+filext+'" style="float: left; margin-top: 0px;" onchange="//filext = this.value;"/></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+ft("Cancel")+'</button><button class="btn btn-info" onclick="showInlineTree()">'+ft("Browse")+'</button><button class="btn btn-success">'+ft("Move")+"</button></div></div>"),x3_show_conf.find(".btn-success").one("click",function(a){a.preventDefault(),rename_file(e,t,"m")});else{x3_show_conf.modal("hide");new_name;if(!is_move){var i=e.split("/");i[i.length-1]=i[i.length-1].replace(t,new_name),new_name=i.join("/")}if(P("rename_file("+e+", "+t+")"),P("new_name2: "+new_name),new_name=Ct(new_name),P("new_name3: "+new_name),E())return;show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{filename:e,newName:new_name},function(e,t){if(have_action="yes","success"==t){if("true"==e){if("r"==a)var n=ft("File has been renamed");if("m"==a)n=ft("File has been moved");loading_from_file=n,loading_from_file_status="green"}else{if("r"==a)n=ft("File has not been renamed");if("m"==a)n=ft("File has not been moved");loading_from_file=n,loading_from_file_status="red"}"true"==is_root?showFileManager(""):showFileManager(here)}else alert("Error: "+t),hide_preloader()})},1e3)}}function copy_file(e,t,a){if(filext=e.substr((Math.max(0,e.lastIndexOf("."))||1/0)+1),filext="."+filext,"first"==a)x3_show_conf.find("#confLable").html(ft("Copy")+" "+t),x3_show_conf.find("#container_id_tree").html(ft("Choose your target directory.")),old_name=e.replace(here,""),old_name=old_name.replace(filext,""),x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control" id="copy_new_name" placeholder="'+ft("New Folder Path")+'" style="float: left; margin-top: 0px;" onchange="set_new_name(this.value);"/></div><input type="hidden" class="form-control" id="rename_new_ext" value="'+filext+'" style="float: left; margin-top: 0px;" onchange="//filext = this.value;"/><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+ft("Cancel")+'</button><button class="btn btn-info" onclick="showInlineTree()">'+ft("Browse")+'</button><button class="btn btn-success">'+ft("Copy")+"</button></div></div>"),x3_show_conf.find(".btn-success").one("click",function(a){a.preventDefault(),copy_file(e,t,"rename")});else{x3_show_conf.modal("hide");new_name;if(P("copy_file("+e+", "+t+")"),P("new_name2: "+new_name),new_name=Ct(new_name),P("new_name3: "+new_name),E())return;show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{filename:e,newName:new_name,copy_this:"ok"},function(e,t){have_action="yes","success"==t?("true"==e?(loading_from_file=ft("File has been copied."),loading_from_file_status="green"):(loading_from_file=ft("File has not been copied."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3)}}function _t(e){return{name:(e=$(e)).closest("tr").data("path")}}function remove_file(e,t,a){if("first"==a)x3_show_conf.find("#confLable").html(ft("Remove")+" "+t),x3_show_conf.find("#container_id_tree").html(ft("Do you want to remove this file")),x3_show_conf.find("#confButton").html('<button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+ft("Cancel")+'</button><button class="btn btn-danger">'+ft("Remove")+"</button>"),x3_show_conf.find(".btn-danger").one("click",function(a){a.preventDefault(),remove_file(e,t,"rename")});else{if(x3_show_conf.modal("hide"),E())return;show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{removeFileName:e},function(e,t){have_action="yes","success"==t?("true"==e?(loading_from_file=ft("File has been deleted."),loading_from_file_status="green"):(loading_from_file=ft("File has not been deleted."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(here)):(alert("Error: "+t),hide_preloader())})},1e3)}}function xt(e){return e.replace(/\\/g,"\\\\").replace(/\u0008/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/'/g,"\\'").replace(/"/g,'\\"')}function kt(e){if(x3_modal_new_folder.modal("hide"),!E()){show_preloader();var t=e||here,a={mkdir_path:new_folder_path,this_place:t};P("mkdir("+e+")"),P("new_here: "+t),P("new_folder_path: "+new_folder_path);["title","label","link","target"].forEach(function(e){var t=x3_modal_new_folder.find("#new_folder_"+e).val();t&&"auto"!=t&&(a[e]=t)});var n=x3_modal_new_folder.find("#new_folder_hidden").prop("checked");if(n){a.hidden=!0;var i=se(t+"/"+new_folder_path)}setTimeout(function(){$.post(gt+"ajax_manage_dir.php",a,function(e,a){"success"==a?(have_action="yes",reload_sidebar=!0,"already"===e?(loading_from_file=ft("already exists."),loading_from_file_status="red"):"true"==e?(loading_from_file=ft("Folder has been created."),loading_from_file_status="green",n&&de(i,{hidden:!0})):(loading_from_file=ft("Folder has not been created."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):showFileManager(t)):(alert("Error: "+a),hide_preloader())}),new_folder_path=""},100)}}function create_zip(){if(P("create_zip("+here+"/"+zip_file_name+")"),""==selected||null==selected)alert(ft("Please select files and folders"));else{if(x3_modal_new_zip_file.modal("hide"),E())return;show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{create_zip:selected,this_place:here,zip_name:zip_file_name},function(e,t){"success"==t?("true"==e?(loading_from_file=ft("Zip file has been created."),loading_from_file_status="green"):(loading_from_file=ft("Zip file has not been created."),loading_from_file_status="red"),showFileManager(here)):(alert("Error: "+t),hide_preloader())}),zip_file_name=""},1e3)}}function set_new_name(e){if(1==is_rename&&!is_guest&&("super"===user&&(is_rename=!1),-1!=e.indexOf("/")))return alert(ft("Please write new folder/file name.")),!1;if(1==is_move&&!is_guest&&-1==e.indexOf("/"))return alert(ft("Please write new folder/file path.")),!1;if(-1!=e.indexOf("'"))return alert(ft("Please don't use quotation in server folders.")),!1;if(-1!=e.indexOf('"'))return alert(ft("Please don't use quotation in server folders.")),!1;var t=x3_show_conf.find("#rename_new_ext");t.length&&(filext=t.val()),new_name=e.replace(/\/\//g,"/")+filext,P("set_new_name: "+new_name),filext=""}function rename_dir(e,t,a){var n=(e=Pt(e)).match(".index$")||e.match("/index$")?'<div class="alert alert-danger" role="alert">Are you sure you want to rename the index home page?</div>':"";if("first"==a)x3_show_conf.find("#confLable").html(ft("Rename")+" "+t),x3_show_conf.find("#container_id_tree").html(n+ft("Write a new name.")+"<div class=modal-help>* Make sure to save any unsaved settings before you rename a folder.</div>"),x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control is-dir" id="rename_new_name" placeholder="'+ft("New Folder Name")+'" style="float: left; margin-top: 0px;" onchange="is_rename = true; set_new_name(this.value);" value="'+t.replace(/"/g,"&quot;")+'" /></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+ft("Cancel")+'</button><button class="btn btn-success btn-key">'+ft("Rename")+"</button></div></div>"),x3_show_conf.find(".btn-success").one("click",function(a){a.preventDefault(),rename_dir(e,t,"r")});else if("move"==a)x3_show_conf.find("#confLable").html(ft("Move")+" "+t),x3_show_conf.find("#container_id_tree").html(ft("Choose your target directory.")),old_name=e.replace(here,""),old_name=old_name.replace(filext,""),is_move=!0,x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control is-dir" id="rename_new_name_dir" placeholder="'+ft("New Folder Path")+'" style="float: left; margin-top: 0px;" onchange="is_move = true; set_new_name(this.value);"/></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+ft("Cancel")+'</button><button class="btn btn-info" onclick="showInlineTree()">'+ft("Browse")+'</button><button class="btn btn-success">'+ft("Move")+"</button></div></div>"),x3_show_conf.find(".btn-success").one("click",function(a){a.preventDefault(),is_move=!0,rename_dir(e,t,"m")});else{if(P("[RENAME/MOVE]"),!new_name)return alert("Please input a new "+(is_move?"path":"name")+"!"),void(is_move=!1);x3_show_conf.modal("hide"),here==e&&is_move&&(new_name=new_name.replace("../",""));var i=new_name;if(!is_move){var o=e.split("/");o[o.length-1]=o[o.length-1].replace(t,new_name),new_name=o.join("/")}here==e&&is_move&&(new_name=new_name+"/"+t);var l=here;if(P("new_name2: "+new_name),new_name=Ct(new_name),P("new_name3: "+new_name),0===new_name.indexOf(e)&&is_move)new_name="",is_move=!1,alert("Can't move folder into itself!");else{if(is_move=!1,E())return;show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{dirname:e,newName:new_name},function(n,o){if(have_action="yes","success"==o){if("true"==n){if("r"==a)var s=ft("Folder has been renamed.");if("m"==a)s=ft("Folder has been moved.");this_dir_path=new_name.replace(i,""),e==l&&"m"==a&&(this_dir_path=e.replace(t,"")),e==l&&"r"==a&&(this_dir_path=new_name),loading_from_file=s,loading_from_file_status="green",reload_sidebar=!0;var r=e.split("/"),d="menu_"+r[r.length-1].replace(".","_"),c="menu_"+i.replace(".","_"),u=x3_mtree.find("#"+d);u.length&&u.hasClass("mtree-open")&&(u.attr("id",c),Ie()),oe(e,new_name,!1)}else{if("r"==a)s=ft("Folder has not been renamed.");if("m"==a)s=ft("Folder has not been moved.");this_dir_path=e.replace(t,""),loading_from_file=s,loading_from_file_status="red"}"true"==is_root?showFileManager(""):showFileManager(this_dir_path)}else alert("Error: "+o),hide_preloader()})},1e3)}}}function Ct(e){if(P("normalize_new_name("+e+")"),e.indexOf("/content/")>-1)e=e.split("/content/")[1];else if(e.indexOf("./")>-1){var t=e.split("./");e=t[t.length-1]}return P("normalized: "+(e=("super"===user?"":"../")+("../content/"+e).replace(/\/\//g,"/").replace(/\/$/,""))),e}function copy_dir(e,t,a){if(e=Pt(e),"first"==a)x3_show_conf.find("#confLable").html(ft("Copy")+" "+t),x3_show_conf.find("#container_id_tree").html(ft("Choose your target directory.")),old_name=e.replace(here,""),old_name=old_name.replace(filext,""),x3_show_conf.find("#confButton").html('<div class="row"><div class="col-xs-6"><input type="text" class="form-control" id="copy_new_name_dir" placeholder="'+ft("New Folder Path")+'" style="float: left; margin-top: 0px;" onchange="set_new_name(this.value);"/></div><div class="col-xs-6"><button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+ft("Cancel")+'</button><button class="btn btn-info" onclick="showInlineTree()">'+ft("Browse")+'</button><button class="btn btn-success">'+ft("Copy")+"</button></div></div>"),x3_show_conf.find(".btn-success").one("click",function(a){a.preventDefault(),copy_dir(e,t,"rename")});else{if(P("copy_dir("+e+")"),P("new_name1: "+new_name),!new_name)return alert("Please input a new path!"),void(is_move=!1);x3_show_conf.modal("hide"),here==e&&(new_name=new_name.replace("../",""));var n=new_name;P("new_name2: "+new_name),here==e&&(new_name=new_name+"/"+t);var i=here;if(new_name=Ct(new_name),P("new_name3: "+new_name),0===new_name.indexOf(e))alert("Can't copy dir into itself!"),new_name="";else{if(E())return;show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{dirname:e,newName:new_name,copy_this:"ok"},function(a,o){have_action="yes","success"==o?("true"==a?(this_dir_path=new_name.replace(n,""),reload_sidebar=!0,loading_from_file=ft("Folder has been copied."),loading_from_file_status="green",oe(e,new_name,!0)):(this_dir_path=e.replace(t,""),loading_from_file=ft("Folder has not been copied."),loading_from_file_status="red"),"true"==is_root?showFileManager(""):(i==e&&(this_dir_path=i),showFileManager(this_dir_path))):(alert("Error: "+o),hide_preloader())})},1e3)}}}function remove_dir(e,t,a){var n=(e=e.replace(/\/$/,"")).match(".index$")||e.match("/index$")?'<div class="alert alert-danger" role="alert">Are you sure you want to delete your home page?</div>':"";if("first"==a)x3_show_conf.find("#confLable").html(ft("Remove")+" "+t),x3_show_conf.find("#container_id_tree").html(n+ft("Do you want to remove this folder")),x3_show_conf.find("#confButton").html('<button class="btn btn-default" data-dismiss="modal" aria-hidden="true">'+ft("Cancel")+'</button><button class="btn btn-danger">'+ft("Remove")+"</button>"),x3_show_conf.find(".btn-danger").one("click",function(a){a.preventDefault(),remove_dir(e,t,"rename")});else{if(x3_show_conf.modal("hide"),E())return;P("remove_dir("+e+")"),P("normalize_new_name(name) == "+(e=Ct(e))),show_preloader(),setTimeout(function(){$.post(gt+"ajax_manage_dir.php",{removeDirName:e},function(a,n){if(have_action="yes","success"==n){"true"==a?(reload_sidebar=!0,loading_from_file=ft("Folder has been deleted."),loading_from_file_status="green",le(e)):(loading_from_file=ft("Folder has not been deleted."),loading_from_file_status="red");var i=e.split("/");i[i.length-1]=i[i.length-1].replace(t,""),this_dir_path=i.join("/"),"true"==is_root?showFileManager(""):showFileManager(this_dir_path)}else alert("Error: "+n),hide_preloader()})},1e3)}}function showInlineTree(){if("super"===user){var e=root_dir_name_parent_count;container_id_tree.is(":visible")&&container_id_tree.fileTree({root:root_dir_name+"/",script:gt+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(t){var a="";if("truez"==is_root)var n=t.replace(root_dir_name+"/","");else{n=t.replace(root_dir_name+"/","../");var i=here.split("/");vt(i,""),i=i.length;var o=here.split("/");vt(o,""),i-=2;for(var l=0;l<o.length;l++)if(""==o[l]&&l!=o.length-1){i+=2,i-=3;break}if(i>=1)for(var s=e;s<i;s++)a+="../"}n=n.substring(0,n.length-1);var r=x3_show_conf.find("#copy_new_name");r.length&&("true"==is_root?r.val(n+old_name):r.val(a+n+old_name),filext=x3_show_conf.find("#rename_new_ext"));var d=x3_show_conf.find("#rename_new_name");d.length&&("true"==is_root?d.val(n+old_name):d.val(a+n+old_name),filext=x3_show_conf.find("#rename_new_ext"));var c=x3_show_conf.find("#copy_new_name_dir");c.length&&("true"==is_root?c.val(n+old_name):c.val(a+n+old_name),filext="");var u=x3_show_conf.find("#rename_new_name_dir");u.length&&("true"==is_root?u.val(n+old_name):u.val(a+n+old_name),filext=""),set_new_name(a+n+old_name)}),container_id_tree2.is(":visible")&&container_id_tree2.fileTree({root:root_dir_name+"/",script:gt+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(t){var a="";if("true"==is_root)var n=t.replace(root_dir_name+"/","");else{n=t.replace(root_dir_name+"/","../");var i=here.split("/");vt(i,""),i=i.length;var o=here.split("/");vt(o,""),i-=2;for(var l=0;l<o.length;l++)if(""==o[l]&&l!=o.length-1){i+=2,i-=3;break}if(i>=1)for(var s=e;s<i;s++)a+="../"}n=n.substring(0,n.length-1);var r=x3_modal_move_selected.find("#selected_move");r.length&&("true"==is_root?r.val(n+old_name):r.val(a+n+old_name)),set_new_name(a+n)}),container_id_tree3.is(":visible")&&container_id_tree3.fileTree({root:root_dir_name+"/",script:gt+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(t){var a="";if("true"==is_root)var n=t.replace(root_dir_name+"/","");else{n=t.replace(root_dir_name+"/","../");var i=here.split("/");vt(i,""),i=i.length;var o=here.split("/");vt(o,""),i-=2;for(var l=0;l<o.length;l++)if(""==o[l]&&l!=o.length-1){i+=2,i-=3;break}if(i>=1)for(var s=e;s<i;s++)a+="../"}n=n.substring(0,n.length-1);var r=x3_modal_copy_selected.find("#selected_copy");r.length&&("true"==is_root?r.val(n+old_name):r.val(a+n+old_name)),set_new_name(a+n)})}else container_id_tree.is(":visible")&&container_id_tree.fileTree({root:map_path,script:gt+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(e){var t="",a=e,n=here.split("/");vt(n,""),n=n.length;var i=here.split("/");vt(i,""),n-=2;for(var o=0;o<i.length;o++)if(""==i[o]&&o!=i.length-1){n+=2,n-=3;break}if(n>=1)for(var l=0;l<n;l++)t+="../";a=a.substring(0,a.length-1);var s=x3_show_conf.find("#copy_new_name");if(s.length){var r=(p=a.split("/")).indexOf(user_folder_name);for(l=0;l<=r;l++)delete p[l];h=(h=yt(p)).join("/"),s.val(h+old_name),filext=x3_show_conf.find("#rename_new_ext").val()}var d=x3_show_conf.find("#rename_new_name");if(d.length){for(r=(p=a.split("/")).indexOf(user_folder_name),l=0;l<=r;l++)delete p[l];h=(h=yt(p)).join("/"),d.val(h+old_name),filext=x3_show_conf.find("#rename_new_ext").val()}var c=x3_show_conf.find("#copy_new_name_dir");if(c.length){for(r=(p=a.split("/")).indexOf(user_folder_name),l=0;l<=r;l++)delete p[l];h=(h=(h=yt(p)).join("/")).replace("//","/"),c.val(h+old_name),filext=""}var u=x3_show_conf.find("#rename_new_name_dir");if(u.length){var p;for(r=(p=a.split("/")).indexOf(user_folder_name),l=0;l<=r;l++)delete p[l];var h;h=(h=yt(p)).join("/"),u.val(h+old_name),filext=""}var m=t+a;m.split("../").length-1<=1&&wt()&&(m=m.replace("../","")),set_new_name(a+"/"+old_name)}),container_id_tree2.is(":visible")&&container_id_tree2.fileTree({root:map_path,script:gt+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(e){var t="",a=e,n=here.split("/");vt(n,""),n=n.length;var i=here.split("/");vt(i,""),n-=2;for(var o=0;o<i.length;o++)if(""==i[o]&&o!=i.length-1){n+=2,n-=3;break}if(n>=1)for(var l=0;l<n;l++)t+="../";a=a.substring(0,a.length-1);var s=x3_modal_move_selected.find("#selected_move");if(s.length){var r=a.split("/"),d=r.indexOf(user_folder_name);for(l=0;l<=d;l++)delete r[l];var c=yt(r);c=(c=c.join("/")).replace("//","/"),s.val(c+old_name)}var u=t+a;u.split("../").length-1<=1&&wt()&&(u=u.replace("../","")),set_new_name(a)}),container_id_tree3.is(":visible")&&container_id_tree3.fileTree({root:map_path,script:gt+"jqueryFileTree.php",expandSpeed:500,collapseSpeed:500,multiFolder:!1},function(e){var t="",a=e,n=here.split("/");vt(n,""),n=n.length;var i=here.split("/");vt(i,""),n-=2;for(var o=0;o<i.length;o++)if(""==i[o]&&o!=i.length-1){n+=2,n-=3;break}if(n>=1)for(var l=0;l<n;l++)t+="../";a=a.substring(0,a.length-1);var s=x3_modal_copy_selected.find("#selected_copy");if(s.length){var r=a.split("/"),d=r.indexOf(user_folder_name);for(l=0;l<=d;l++)delete r[l];var c=yt(r);c=c.join("/"),s.val(c+old_name)}var u=t+a;u.split("../").length-1<=1&&wt()&&(u=u.replace("../","")),set_new_name(a)})}function showFileManager(e,t){e="here"===e?me:e;t&&(Ae=t),"undefined"==typeof my_sort&&(my_sort="name"),"undefined"==typeof loading_from_file_status&&(loading_from_file_status="blue"),"undefined"==typeof page&&(page=1),"undefined"==typeof countShow&&(countShow=10),"undefined"==typeof search&&(search=""),"undefined"==typeof have_action&&(have_action="no");var a="super"===user?root_dir_name:"../",n=""==e||e==a?1:0;0==loading_from_file&&l.modal("show"),Fe(),$.post(gt+"ajax_show_filemanager.php",{showFilemanager:"super"===user?core_admin_id:core_user_id,root:n,my_dir_path:e,sort_type:my_sort,page:page,countShow:countShow,have_action:have_action,search:search},function(t,a){if(t.trim())if("success"==a){var n=s.find("#show_left_sidebar");!0!==first_flag&&n.length>0&&(first_flag=n.html()),b("#fileManager"),0==loading_from_file?l.modal("hide"):show_errors_on_nav(loading_from_file,loading_from_file_status),loading_from_file=!1,search="",have_action="no",s.show(),s.html(t);var i=s.find("#show_left_sidebar");reload_sidebar?show_left_folder_menu():1==first_flag?(u.children("#left_folder_menu_box").appendTo(i),first_flag=i.html()):(i.html(first_flag),Te()),D=!0,Me(e)}else D=!0,alert("<center>Can not load page, click to exit. SERVER STATUS: "+a+"</center>");else window.location.replace("login.php")})}function show_left_folder_menu(){if(reload_sidebar){reload_sidebar=!1;var e=s.find("#show_left_sidebar");e.children("#left_folder_menu_box").remove(),u.html('<div id="left_folder_menu_box"></div>');var t=u.children("#left_folder_menu_box");e.html("Please wait..."),t.load("x3_menu.php",{dir:"super"===user?root_dir_name+"/":core_user_dir+"/",user:user,is_guest:is_guest},function(){e.html(""),t.appendTo(e),Se(),first_flag=e.html()})}else u.children("#left_folder_menu_box").load("x3_menu.php",{dir:"super"===user?root_dir_name+"/":core_user_dir+"/",user:user,is_guest:is_guest},function(e){Se(),initShowFileManager()})}function St(){l.modal("show"),$.post(gt+"ajax_show_setting.php",{showSetting:"super"===user?core_admin_id:core_user_id},function(e,t){if(!e.trim())return window.location.replace("login.php"),!1;"success"==t?(b("#setting"),l.modal("hide"),s.show(),s.html(e)):alert("<center>Can not load page, click to exit. SERVER STATUS: "+t+"</center>")})}function showEditProfile(){l.modal("show"),$.post(gt+"ajax_show_profile.php",{showProfile:"super"===user?core_admin_id:core_user_id},function(e,t){"success"==t?(b("#editProfile"),l.modal("hide"),s.show(),s.html(e)):alert("<center>Can not load page, click to exit. SERVER STATUS: "+t+"</center>")})}function Tt(){l.modal("show"),$.post(gt+"ajax_show_users.php",{showUser:"super"===user?core_admin_id:core_user_id},function(e,t){"success"==t?(b("#users"),l.modal("hide"),s.show(),s.html(e)):alert("<center>Can not load page, click to exit. SERVER STATUS: "+t+"</center>")})}function jt(){P("showAddUser()"),l.modal("show"),$.post(gt+"ajax_add_user.php",{showAddUser:"super"===user?core_admin_id:core_user_id},function(e,t){"success"==t?(b("#users"),l.modal("hide"),s.show(),s.html(e)):alert("<center>Can not load page, click to exit. SERVER STATUS: "+t+"</center>")})}function show_errors_on_nav(e,t){"red"==t?t="#D9534F":"green"==t?t="#5CB85C":"blue"==t&&(t="#428BCA"),g(),d.attr("data-content","<center><span style='color: "+t+";'>"+e+"</span></center>"),d.popover("show"),setTimeout(function(){d.popover("hide")},3e3)}function show_preloader(){g(),a.scrollTop()>75&&t.velocity("stop").velocity("scroll",{duration:500,easing:"easeInOutCubic",complete:function(){v||(v=!0,p.velocity("stop").velocity("fadeOut",{duration:200}))}}),d.attr("data-content","<center><img src='filemanager_assets/ajax-loader.gif'/></center>"),d.popover("show")}function hide_preloader(){g(),d.attr("data-content",""),d.popover("hide")}c.children("#editProfile").add(r.find(".editProfile")).click(function(e){loading_from_file=!1,showEditProfile()}),c.children("#fileManager").click(function(e){loading_from_file=!1,page=1,De()}),c.children("#setting").click(function(e){loading_from_file=!1,St()}),c.children("#users").click(function(e){loading_from_file=!1,Tt()}),c.children("#addUser").click(function(e){loading_from_file=!1,jt()}),c.find('a[href="#"]').click(function(e){e.preventDefault()}),i.after('<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><div class="pswp__bg"></div><div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button><button class="pswp__button pswp__button--share" title="Share"></button><button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button><button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button><button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div>');var Et,It,Ot=n.children(".pswp");function $t(e){if((e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey)&&void 0!==e.currentTarget.href&&e.currentTarget.href.length>0)return!0}function Pt(e){return e.replace(/\/\/+/g,"/").replace(/\/$/,"")}!function(){if(session_maxlifetime&&session_maxlifetime>=300){var e=Math.round(800*session_maxlifetime);setTimeout(function t(){$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",data:{session_refresh:!0}}).done(function(a){a&&a.success&&setTimeout(t,e)})},e)}}(),selected_lang&&k&&localStorage.setItem("selected_lang",selected_lang),function(){var e=[],t=!1,n=k()&&null!==localStorage.getItem("protected_tab")?localStorage.getItem("protected_tab"):"#protect-access";s.on("keyup","#form-users .row:first-child input",function(e){var t=$(this).closest(".row"),a=t.find(".users_username_form").val(),n=t.find(".users_password_form").val();if(a.length>0&&n.length>0&&t.is(":first-child")){var i=s.find("#protect-users #form-users");i.prepend(u("","")),i.find(".row:first-child").css("display","none").velocity("slideDown",{duration:500,delay:10,easing:"easeOutQuart"})}}),s.on("click",".x3-protect .btn-remove",function(e){var t=$(this).closest(".row");t.velocity("slideUp",{duration:200,complete:function(){t.remove()}})}),c.on("click","#protect",function(e){e.preventDefault(),Et()}),s.on("click",".btn-save-protect",function(e){e.preventDefault(),function(){if(E())return;l.modal("show");var e={},t=s.find("#form-access");if(e.access={},t.children().length>1){var a=[];t.children().each(function(t,n){var i=$(this),o=i.find(".link_form").val()||"",l=i.find(".users_form").val()||"",s=i.find(".username_form").val().replace(/:/g,"")||"",r=i.find(".password_form").val()||"";o.length>0&&($.inArray(o,a)>-1&&pt('<strong>Warning: Link "'+o+'"</strong><br>'+language.warning_multiple_links,3e3,null,"warning"),a.push(o),e.access[o]={},s.length>0&&(e.access[o].username=s),r.length>0&&(e.access[o].password=r),l.length>0&&(e.access[o].users=[],$.each(l,function(t,a){e.access[o].users.push(a)})))})}e.users={};var n=s.find("#form-users");if(n.children().length>1){var o=[];n.children().each(function(t,a){var n=$(this),i=n.find(".users_username_form").val().replace(/:/g,"")||"",l=n.find(".users_password_form").val()||"";i.length>0&&l.length>0&&(e.users[i]=l),$.inArray(i,o)>-1&&l.length>0&&pt('<strong>Warning: Username "'+i+'"</strong><br>'+language.warning_multiple_usernames,3e3,null,"warning"),i.length>0&&0==l.length&&pt("<strong>Warning</strong><br>"+language.usernames_without_passwords,3e3,null,"warning"),0==i.length&&l.length>0&&pt("<strong>Warning</strong><br>"+language.passwords_without_usernames,3e3,null,"warning"),i.length>0&&l.length>0&&o.push(i)})}$.ajax({method:"POST",url:"x3_protect.php",dataType:"json",data:{action:"protect",protect:e}}).done(function(e,t,a){void 0!=e.error?(P("Error: "+e.error),pt(language.Error+": "+e.error,null,null,"danger")):(P("success"),pt(language.Saved,null,null,"success"),i=e,d())}).fail(function(e,t,a){P("error"),e.responseText?(pt(language.Error+" -> textStatus: "+t,null,null,"danger"),P("textStatus: "+t),P("errorThrown: "+a)):window.location.replace("login.php")}).always(function(){l.modal("hide")})}()}),s.on("click",".x3-protect .nav-tabs a",function(t){var o=$(this);n=o.attr("href"),k()&&localStorage.setItem("protected_tab",n);var l=s.children(".x3-protect"),r=l.offset().top;if(a.scrollTop()>r&&a.scrollTop(r),"#protect-access"===o.attr("href")){var d=[],c=[],u=l.find("#form-users").children();u.length>0&&u.each(function(e,t){var a=$(this),n=a.find(".users_username_form").val()||"",i=a.find(".users_password_form").val()||"";n.length>0&&"*"!==n.slice(-1)&&(d.push(n),c.push(i))}),i.users={},$.each(d,function(e,t){i.users[t]=c[e]});var p=l.find("#form-access").children(".access-item");0===$(d).not(e).length&&0===$(e).not(d).length&&0!=d.length||($.each(p,function(e,t){var a=$(this).find(".select-users")[0].selectize;d.length>0&&$.each(d,function(e,t){a.addOption({value:t,text:t})}),$.each(a.options,function(e,t){-1==$.inArray(e,d)&&a.removeOption(e)}),0==d.length?a.disable():a.enable()}),e=d)}});var i,o="\t<div class='x3-panel-section x3-protect'>\t\t<div class=protect-controls>\t\t<button type=button class='btn btn-primary btn-save-protect'>"+language.Save+"</button>\t\t<button type=button data-help=protect class='btn btn-default btn-protect-help panel-help'><i class='fa fa-question'></i></button>    <ul class='nav nav-tabs' role='tablist'>\t    <li role=presentation class=active><a href=#protect-access aria-controls=protect-access role=tab data-toggle=tab>"+language.Links+"</a></li>\t    <li role=presentation><a href=#protect-users aria-controls=protect-users role=tab data-toggle=tab>"+language.Users+"</a></li>    </ul>    </div>    <div id=myTabContent class=tab-content>      <div role=tabpanel class='tab-pane active in' id=protect-access></div>      <div role=tabpanel class='tab-pane fade' id=protect-users></div>    </div>  </div>";function r(){t=!1,l.modal("hide"),s.html(o);var e=s.children(".x3-protect");e.find(".nav-tabs").find('a[href="'+n+'"]').tab("show"),s.velocity("fadeIn",{duration:500}),d(),e.find(".protect-controls").scrollToFixed({zIndex:2})}function d(){!function(){var e='<form id="form-access" name="form-access">';$.each(i.access,function(t,a){var n=void 0==t||0==t.length?"":t,i=void 0==a.username?"":a.username,o=void 0==a.password?"":a.password;e+=p(n,a.users,i,o)}),e+="</form>";var t=s.find("#protect-access");t.html(e);var a=t.children("#form-access");a.prepend(p("","","",""));var n=a.children(".access-item");$.each(n,function(e,t){!function e(t){var a=t.find(".select-link");var n=[];fe.forEach(function(e){0!==e.link.indexOf("custom/")&&n.push(e)});var o=a.val().split(",");-1==$.inArray("*",o)&&n.unshift({link:"*",label:"*GLOBAL"});$.each(o,function(e,t){if(t){var a="*"==t?"*GLOBAL":t;n.unshift({link:t,label:a})}});var l=a.selectize({valueField:"link",labelField:"label",searchField:["link"],options:n});var r=t;l[0].selectize.on("item_add",function(){var t=s.find("#form-access");if(r.is(":first-child")){t.prepend(p("","","",""));var a=t.find(".row:first-child");a.css("display","none").velocity("slideDown",{duration:500,delay:10,easing:"easeOutQuart"}),e(a)}});var d=t.find(".select-users").selectize();!i.users||Object.keys(i.users).length<1?d[0].selectize.disable():d[0].selectize.enable()}($(this))})}(),function(){var e='<form id="form-users" name="form-users">';$.each(i.users,function(t,a){e+=u(t,a)}),e+="</form>";var t=s.find("#protect-users");t.html(e),t.children("#form-users").prepend(u("",""))}()}function u(e,t){var a='<div class="row">\t\t<div class="form-group col-xs-5">\t\t<div class="input-group">\t\t<div class="input-group-addon"><span class="glyphicon glyphicon-user" aria-hidden="true"></span></div>\t\t<input type="text" class="form-control users_username_form" placeholder="'+language.Username+'" value="'+e.replace(/"/g,"&quot;")+'">\t\t</div>\t\t</div>';return a+='\t\t<div class="form-group col-xs-5">\t\t<div class="input-group">\t\t<div class="input-group-addon"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span></div>\t\t<input type="text" class="form-control users_password_form" placeholder="'+language.Password+'" value="'+t.replace(/"/g,"&quot;")+'">\t\t</div>\t\t</div>',a+='\t\t<div class="col-xs-2">\t\t<button type="button" class="btn btn-default btn-remove" tabIndex=-1><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>\t\t</div>',a+="</div>"}function p(e,t,a,n){var o='\t\t<div class="access-item row">\t\t<div class="col-xs-10">\t\t<div class="form-group">    <input type="text" class="form-control select-link link_form" placeholder="'+language.Link+'" value="'+e+'">\t\t</div>',l="";return $.each(i.users,function(e,a){"*"!==e.slice(-1)&&(l+='<option value="'+e.replace(/"/g,"&quot;")+'" '+(void 0!=t&&$.inArray(e,t)>-1?"selected":"")+">"+e.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</option>")}),o+='\t\t<div class="form-group">\t\t<select multiple class="form-control select-users users_form" placeholder="'+language.Users+'">'+l+"</select>\t\t</div>",o+='<div class=row>\t\t<div class="form-group col-sm-6">\t\t<div class="input-group">\t\t<div class="input-group-addon"><span class="glyphicon glyphicon-user" aria-hidden="true"></span></div>\t\t<input type="text" class="form-control username_form" placeholder="'+language.Username+'" value="'+a.replace(/"/g,"&quot;")+'">\t\t</div>\t\t</div>',o+='\t\t<div class="form-group col-sm-6">\t\t<div class="input-group">\t\t<div class="input-group-addon"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span></div>\t\t<input type="text" class="form-control password_form" placeholder="'+language.Password+'" value="'+n.replace(/"/g,"&quot;")+'">\t\t</div>\t\t</div>\t\t</div>\t\t</div>',o+='\t\t<div class=col-xs-2>\t\t<button type="button" class="btn btn-default btn-remove" tabIndex="-1"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>\t\t</div>',0==e.length&&(o+='\t\t\t<div class="col-xs-12 passwords-help">\t\t\t* '+language.passwords_help+"\t\t\t</div>"),o+="</div>"}It=function(){t&&c.children("li#protect").hasClass("active")&&r()},Et=function(){l.modal("show"),void 0==i||t?$.getJSON("x3_protect.php",function(e,a){c.children("li.active").removeClass("active"),c.children("li#protect").addClass("active"),"success"==a?void 0!=e.error?(P("Error: "+e.error),pt(language.Error+": "+e.error,null,null,"danger")):void 0!=fe?(i=e,r()):(i=e,t=!0,P("log: waiting for menu ...")):(P("Error -> success: "+a),pt(language.Error+" -> success: "+a,null,null,"danger"))}).fail(function(){window.location.replace("login.php")}):(c.children("li.active").removeClass("active"),c.children("li#protect").addClass("active"),r())}}(),c.on("click","li#refresh > a",function(e){if(e.preventDefault(),!E()){var t=$(this),a=t.html(),n=new Date;t.attr("disabled",!0).width(t.width()).text("Refreshing ..."),$.getJSON("menu_create.php").done(function(e){if(e.success)var t=new Date,a="Menu refreshed in "+((Number(t)-Number(n))/1e3).toFixed(2)+" seconds.",i="success";else e.error?(a="Error: "+e.error,i="danger"):(a="Error :(",i="danger");pt(a,2e3,null,i)}).fail(function(e,t,a){P("menu create fail:",e),pt(t+" : "+a,2e3,null,"danger")}).always(function(e,i,o){var l=new Date,s=Number(l)-Number(n),r=Math.max(1,1e3-Number(s));setTimeout(function(){t.html(a).attr("disabled",!1)},r)})}}),key.filter=function(e){return!0},key("âŒ˜+s, ctrl+s",function(e,t){var a=s.find("#json-form");return a.length&&a.submit(),!1});var get_x3_settings,At,get_x3_page_settings,Ft,Dt,Nt,Rt=!1;!function(){var e,t,n,i,o,r,d,c=!1,u=!1,p=!(!k()||null===localStorage.getItem("x3_diagnostics_was_disabled")),h={};function f(){function s(){var e=c.filter(":checked").val();f.toggle(e.indexOf("topbar")>-1),v.toggle("slidemenu"===e)}e.value=At,e.onSubmit=function(e,t){e?P("render jsonform errors",e):(P("jsonform valid!"),function(e){if(P("save settings"),!E()&&!u){u=!0;var t=o.children(".btn-settings-save");t.button("loading"),l.modal("show"),j&&(e.x=j),$.ajax({method:"POST",url:"x3_settings.php",dataType:"json",data:{settings:JSON.stringify(e)},success:function(t,n,i){if(t.success){var o=!At.back.panel.use_db&&(At.back.panel.username!==e.back.panel.username||At.back.panel.password!==e.back.panel.password);if(At=e,pt(language.Saved,null,null,"success"),o&&location.replace("logout.php"),g(),!At.settings.diagnostics&&!p){var l=r.children(".diagnostics-alias-container");l.length&&(p=!0,k()&&localStorage.setItem("x3_diagnostics_was_disabled",!0),l.remove(),a.resize())}}else pt(language.Error+": "+t.error,2e3,null,"danger"),P("save settings error: "+t.error)},complete:function(){setTimeout(function(){t.button("reset")},1e3),l.modal("hide"),u=!1}}).fail(function(e,t,a){e.responseText?(pt(language.Error+" -> textStatus: "+t,null,null,"danger"),m(t,a)):window.location.replace("login.php")})}}(t)),P("jsonform values",t)},t.append('<input style="display:none;" type="text" name="somefakename" /><input style="display:none;" type="password" name="anotherfakename" />'),t.jsonForm(e);var d=t.find(".x3-layout-settings"),c=d.find('[name="style.layout.layout"]'),f=d.find(".jsonform-error-style---layout---fixed, .jsonform-error-style---layout---wide"),v=d.find(".jsonform-error-style---layout---overlay");if(c.change(s),s(),!p){var b=t.find('[name="settings.diagnostics"]');if(b.is(":checked")){r.children("h3").after('<div class="diagnostics-alias-container text-center"><div class="alert alert-info text-left" role="alert" style="display: inline-block;"><strong>Diagnostics Active</strong><br><span class="content">To disable diagnostics and activate your X3 website, uncheck the option below and click save.<br><label style="margin: .7em 0;"><input type="checkbox" id="diagnostics_alias" name="diagnostics_alias" checked> &nbsp;Show Diagnostics</label><br><em>* Diagnostics can be re-enabled from the "Advanced" section below.</em></span></div></div>');var y=r.children(".diagnostics-alias-container").find("#diagnostics_alias"),w=b.add(y);w.change(function(e){w.prop("checked",$(this).is(":checked"))})}}a.width()>992&&o.scrollToFixed({zIndex:5}),t.find("a.btn-create-site-object").on("click",function(e){e.preventDefault(),At.settings.diagnostics?pt('Disable "Show Diagnostics", and click SAVE before you run this task.',4e3,null,"danger"):"create"!==At.settings.preload?pt("SAVE settings before you run this task.",4e3,null,"danger"):Bt(!0)});var _=t.find(".json-form-style-settings"),x=_.find('input[name="style.skin.primary_color"]'),C=_.find('input[name="style.skin.skin"]'),S=C.parent("label"),T=_.find('textarea[name="style.font.font"]');var I=x.val();x.selectize({persist:!1,create:!0,maxItems:1,valueField:"item",labelField:"item",searchField:"item",options:h[S.filter(".active").children("input").val()]})[0].selectize.createItem(I),C.change(function(){var e,t,a;e=$(this).val(),t=x[0].selectize,a=t.getValue(),t.clearOptions(),t.load(function(n){n(h[e]),t.createItem(a)})});var O=T.val(),A=[];$.each(U.fonts,function(e,t){"header"!==t&&"-"!==t&&A.push({label:e,link:t})}),T.before("<select></select><label>Source</label>");T.siblings("select").selectize({items:[O],create:!1,maxItems:1,valueField:"link",labelField:"label",searchField:["link"],options:A,onChange:function(e){T.val(e)}});autosize(t.find("textarea")),function(){n=t.children().children("fieldset");var a="";$.each(n,function(t,n){var i=$(this),o=e.form[t].title;a+='<label class="btn btn-primary"><input type="radio" name="options" id="option'+(t+1)+'" autocomplete="off" checked>'+o+"</label>",i.data("height",i.outerHeight(!0))}),o.children(".btn-group").html(a).after('<button data-loading-text="Saving ..." type="button" class="btn btn-settings-save btn-primary">Save</button>'),o.removeClass("invisible"),i=k()&&null!==localStorage.getItem("x3_settings_tab")?Number(localStorage.getItem("x3_settings_tab")):0,o.find("label.btn").eq(i).addClass("active"),n.not(n.eq(i)).css("display","none"),o.on("click","label.btn",function(e){var a,i,o;a=$(this).index(),i=a,o=n.eq(i),t.css("min-height",o.data("height")),n.not(o).filter(":visible").velocity({opacity:0},{duration:100,display:"none",complete:function(){o.filter(":hidden").velocity({opacity:1},{duration:200,display:"block"})}}),k()&&localStorage.setItem("x3_settings_tab",i)})}(),t.find('[data-jsonform-type="ace"]').each(function(e,t){var a=$(this).children(".controls").children("div"),n=a.children("div").attr("id"),i=ace.edit(n);a.css("height","auto"),i.setAutoScrollEditorIntoView(!0),i.setOption("maxLines",100),i.setOption("minLines",5),i.getSession().setUseWrapMode(!0),i.$blockScrolling=1/0}),t.find(".alt-title").each(function(e,t){var a=(t=$(this)).find(".help-block").first().html();t.prev("legend").html(a),t.remove()}),t.find(".settings_selectize").each(function(e,t){var a=$(this),n=a.find(".selectize-items"),i=n.hasClass("selectize-single"),o=n.text().split(","),l=i?[a.find("input").val()]:a.find("input").val().split(","),s=[];$.each(l,function(e,t){-1==$.inArray(t,o)&&o.push(t)}),$.each(o,function(e,t){s.push({item:t})});var r={create:n.hasClass("selectize-create"),valueField:"item",labelField:"item",searchField:"item",options:s};i&&(r.maxItems=1,r.delimiter=null),a.find("input").selectize(r)[0].selectize.enable()}),g(),o.children(".btn-settings-save").on("click",function(e){t.length&&t.submit()})}function g(){var e=t.find("fieldset.settings-plugins"),a=e.find('input[name="plugins.image_background.enabled"]');a.closest("fieldset").toggleClass("is-active",a.is(":checked")&&e.find('input[name="plugins.image_background.src"]').val().length>0);var n=e.find('input[name="plugins.background.enabled"]');n.closest("fieldset").toggleClass("is-active",n.is(":checked")&&(e.find('input[name="plugins.background.src"]').val().length>0||e.find('input[name="plugins.background.color"]').val().length>0));var i=e.find('input[name="plugins.fotomoto.enabled"]');i.closest("fieldset").toggleClass("is-active",i.is(":checked")&&e.find('input[name="plugins.fotomoto.store_id"]').val().length>0);var o=e.find('input[name="plugins.audioplayer.enabled"]');o.closest("fieldset").toggleClass("is-active",o.is(":checked"));var l=e.find('input[name="accounts.chat"]');l.closest("fieldset").toggleClass("is-active",l.val().length>0);var s,r=e.find('input[name="accounts.disqus_shortname"]');r.closest("fieldset").toggleClass("is-active",r.val().length>0),(s=e.find('input[name="settings.pagenav"]')).closest("fieldset").toggleClass("is-active",s.is(":checked")),(s=e.find('input[name="plugins.cookie_consent.enabled"]')).closest("fieldset").toggleClass("is-active",s.is(":checked"))}$.each(U.skins,function(e,t){if("header"!==t){var a=e.split(" ")[0],n=t.split(" ")[1];void 0==h[a]&&(h[a]=[]),h[a].push({item:n})}}),$.getJSON("settings-schema.json?v="+x3_panel_version,function(t){c=!0,e=t}).fail(function(){P("Error: Can't load panel/settings-schema.json")}),$.ajax({method:"POST",url:"x3_settings.php",dataType:"json",data:{get_settings:!0},success:function(e,t,a){Rt=!0,!0===e.settings.preload&&(e.settings.preload="create"),At=e},error:function(e,t,a){P("get settings error: "+t),pt(language.Error+" -> textStatus: "+t,null,null,"danger")}}),get_x3_settings=function(){if(r=s.children(".x3-settings"),o=r.children(".filter-buttons"),t=r.children("#json-form"),c&&Rt)f();else var e=setInterval(function(){c&&Rt&&(clearInterval(e),"setting"==he&&f())},1e3)},s.on("mousedown","a.show-help",function(e){d=$(this).closest(".form-group").find("label.active.btn-primary")}).on("mouseup","a.show-help",function(e){var t=$(this).parent(".control-label");setTimeout(function(){t.removeClass("active btn-primary"),d.addClass("active btn-primary")},1)})}(),function(){var e,t,n,i,r,d,c,u,p,h,f,g,v,b,_=!1,x=!1,C=!1,S=!1,T='<div class="filter-buttons invisible"><div class="btn-group btn-group-sm" data-toggle="buttons"></div></div><form id=json-form></form>',j="<a href=# class=show-help></a><div class=hidden>"+x3_help.templates+"</div>",I={},O={},A={},F=custom_setting_templates?0:1;function D(){2===++F&&($.extend(!0,I,A,O),x=!0)}function N(a,n,i,s,r){if(P("save page"),!E()&&!C){void 0===r&&(r=!0),C=!0,void 0!==c&&c.button("loading"),r&&l.modal("show");var u={},p=!1,h={};function f(e){3===it&&"#gallery"===Ae&&(pt("Changed to "+e+' "custom" sorting',null,null,"success"),a[e].sortby="custom",t.find("."+e+"-sorting").find('input[value="custom"]').click())}if(n)u.inject=!0,a.hasOwnProperty("iptc_inject")&&(u.files=$.extend(!0,{},a.iptc_inject),delete a.iptc_inject);else{var g=Ze;if(g.length){if(At.back.use_iptc){var v=g.filter(function(){return $.inArray(this.getAttribute("data-ext"),["jpg","jpeg","pjpeg"])>-1});v.length&&(p=ue(v))&&(u.files=p)}if(g.length){var b=ae(g);b&&$.extend(!0,a,b)}ot&&"custom"!==Ft.gallery.sortby&&f("gallery"),ot=!1}Qe.length&&lt&&(Qe.each(function(){var e=se(this.getAttribute("data-path")),t=this.getAttribute("data-custom");e&&t&&(h[e]={index:parseInt(t)})}),Object.keys(h).length&&(u.folders=JSON.stringify(h),"custom"!==Ft.folders.sortby&&f("folders")),lt=!1)}u.page_settings=JSON.stringify(a),u.path=d,P("iptc OB:",p),$.ajax({method:"POST",url:"x3_settings.php",dataType:"json",data:u,success:function(t,l,r){if(t.success){if(pt(s||language.Saved,null,null,"success"),$.extend(!0,Ft,a),n&&(e.value=Ft,i&&i(!0)),p&&ce(p,v),Object.keys(h).length){$.extend(!0,folders,h);var d=o.find("#left_folder_menu_box"),c=me?d.find('li[data-dir="'+me+'"]').children("ul"):d.children("ul");if(c.length){var u=c.children(":not(#_custom)");u.each(function(e,t){var a=t.getAttribute("data-content-path");h.hasOwnProperty(a)&&t.setAttribute("data-custom",h[a].index)}),st(u,"custom",c)}}Le(),q()}else pt(language.Error+": "+t.error,2e3,null,"danger"),P("save settings error: "+t.error)},complete:function(){setTimeout(function(){c.button("reset")},1e3),r&&l.modal("hide"),C=!1}}).fail(function(e,t,a){e.responseText?(pt(language.Error+" -> textStatus: "+t,null,null,"danger"),P("save settings error: "+t),n&&i&&i(!1),m(t,a)):window.location.replace("login.php")})}}function R(){var e=t.find('input[name="gallery.assets"], input[name="folders.assets"]'),a=fe.slice();e.each(function(e,t){$(this).selectize({create:!1,maxItems:1,valueField:"link",labelField:"label",searchField:["link"],options:a})})}function M(o){var d=s.find(".x3-page-settings-container");d.append(T),t=d.children("#json-form"),o.content&&(o.content=o.content.replace(/</g,"&lt;").replace(/>/g,"&gt;")),e.value=o,S||(e.onSubmit=function(e,t){var a="markdown"===At.back.panel.editor?u.value():b.summernote("code");if(t.content=a,m.val(a),e)P("jsonform errors: ",e);else{if(P("jsonform valid: ",t),"apply"==S||"paste"==S||"paste-all"==S){if(d.css("height",d.outerHeight()),d.empty(),"paste"==S){$.each(["title","label","description","date","image","content","link","menu"],function(e,t){t in g&&delete g[t]})}var n="apply"==S?p:g;M($.extend(!0,{},At,t,n)),d.css("height","auto"),pt("apply"==S?f+" template applied to "+h+" settings.":"Successfully pasted settings from clipboard.",null,null,"success")}else"get"==S?v=t:"copy"==S?(pt("Current settings successfully copied.",null,null,"success"),r.find("a.settings-paste, a.settings-paste-all").parent("li").removeClass("disabled"),g=t):N(t);S=!1}}),t.jsonForm(e);var m=t.find('textarea[name="content"]');function _(e,t){("gallery"===e?C.add(F):L.add(z)).toggle("grid"===t||"vertical"===t||"carousel"===t)}var x=t.find(".gallery-layout-selector").find(".tabbable").children(".form-group").find("select"),C=t.find(".gallery-split-view-setting"),F=t.find(".gallery-crop-setting"),D=t.find(".folders-layout-selector").find(".tabbable").children(".form-group").find("select"),L=t.find(".folders-split-view-setting"),z=t.find(".folders-crop-setting");if(x.on("change",function(e){_("gallery",this.value)}),_("gallery",x.val()),D.on("change",function(e){_("folders",this.value)}),_("folders",D.val()),autosize(t.find("textarea")),t.find('[data-jsonform-type="ace"]').each(function(e,t){var a=$(this).children(".controls").children("div"),n=a.children("div").attr("id"),i=ace.edit(n);a.css("height","auto"),i.setAutoScrollEditorIntoView(!0),i.setOption("maxLines",100),i.setOption("minLines",5),i.getSession().setUseWrapMode(!0),i.$blockScrolling=1/0}),t.find(".alt-title").each(function(e,t){var a=(t=$(this)).find(".help-block").first().html();t.prev("legend").html(a),t.remove()}),void 0!==fe)R();else var U=setInterval(function(){void 0!==fe&&(clearInterval(U),R())},500);if(t.find(".settings_selectize").each(function(e,t){var a=$(this),n=a.find(".selectize-items"),i=n.text().split(","),o=a.find("input").val().split(","),l=[];$.each(o,function(e,t){-1==$.inArray(t,i)&&i.push(t)}),$.each(i,function(e,t){l.push({item:t})});var s={create:n.hasClass("selectize-create"),valueField:"item",labelField:"item",searchField:"item",options:l};n.hasClass("selectize-single")&&(s.maxItems=1,s.delimiter=null),a.find("input").selectize(s)[0].selectize.enable()}),setTimeout(function(){xe.length&&t.find('input[name="image"], input[name="plugins.image_background.src"], input[name="plugins.background.src"]').each(function(e,t){var a=[];t=$(this);$.each(xe,function(e,t){a.push({item:t})}),-1==$.inArray(t.val(),xe)&&a.unshift({item:t.val()}),t.selectize({create:!0,maxItems:1,delimiter:null,valueField:"item",labelField:"item",searchField:"item",options:a})[0].selectize.enable()})},10),"html"===At.back.panel.editor){m.css("display","none"),m.after('<div class="html-editor"></div>'),b=m.siblings(".html-editor");var V={minHeight:300,codemirror:{theme:"default",lineWrapping:!0,viewportMargin:1/0},toolbar:[["style",["style"]],["format",["bold","italic","underline","clear"]],["color",["color"]],["size",["fontsize"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","video","hr"]],["right",["codeview","fullscreen"]]]};summernote_lang&&(V.lang=summernote_lang),b.summernote(V),b.summernote("code",m.text())}else{u=new SimpleMDE({element:m[0],spellChecker:!1,autoDownloadFontAwesome:!1,toolbar:["preview","side-by-side","fullscreen","bold","italic","heading-1","heading-2","heading-3","|","quote","unordered-list","ordered-list",{name:"center",action:function(e){w(e,"center","<center markdown=1>","</center>")},className:"fa fa-align-center",title:"Align center"},"horizontal-rule","|","link","image","|"],previewRender:function(e){return SimpleMDE.prototype.markdown(e.replace(/{{path}}/g,here+"/"))}}),1===i&&setTimeout(function(){u.codemirror.refresh()},10);var H=t.find(".editor-toolbar"),W="",X=Object.keys(B).sort();$.each(X,function(e,t){W+='<li><a href="#">'+t+"</a></li>"});var Y="";setTimeout(function(){if(here&&xe.length){var e=H.children(".fa-picture-o");e.hide();var t=y()+"/content/"+here.split("../content/")[1].replace(/"/g,"&quot;")+"/",a=k()&&null!==localStorage.getItem("dropdown_images_popup")&&localStorage.getItem("dropdown_images_popup")?" checked":"",n=k()&&null!==localStorage.getItem("dropdown_images_frame")&&localStorage.getItem("dropdown_images_frame")?" checked":"",i=xe.length>15,l=i?10:5,s=!i&&"devicePixelRatio"in window&&window.devicePixelRatio>1?"w200":"w100",r=t.replace("/content/","/render/"+s+"-c1:1/");Y+='<div class="dropdown editor-dropdown"><a class="btn-images dropdown-toggle fa fa-picture-o" data-toggle="dropdown" role="button" aria-expanded="true"></a><div class="dropdown-images dropdown-menu pull-right dropdown-menu-right'+(i?" dropdown-images-small":"")+'" role="menu"><div class="dropdown-images-name"><span>Select image</span></div>';var d=0;image_count=0,$.each(xe,function(e,a){if(d++,image_count++,a=a.replace(/"/g,"&quot;"),Y+='<img data-name="'+a+'" data-path="'+t+a+'" data-src="'+r+a+'">',image_count>=100)return!1;d===l&&(d=0,e<xe.length-1&&(Y+="<br>"))}),Y+='<div class="dropdown-images-options"><input type="checkbox" id="dropdown_images_popup" name="dropdown_images_popup"'+a+'><label for="dropdown_images_popup">Popup link</label><input type="checkbox" id="dropdown_images_frame" name="dropdown_images_frame"'+n+'><label for="dropdown_images_frame">Frame</label></div></div></div>'}Y+='<div class="dropdown editor-dropdown"><a class="btn-templates dropdown-toggle fa fa-magic" data-toggle="dropdown" role="button" aria-expanded="false"></a><ul class="dropdown-templates dropdown-menu pull-right dropdown-menu-right" role="menu" aria-labelledby="dropdown-templates"><li class="dropdown-header">Insert Template</li>'+W+"</ul></div>",H.append(Y),H.find(".dropdown-templates").on("click","a",function(e){e.preventDefault();var t=B[$(this).text()];u.codemirror.replaceSelection(t),u.codemirror.focus()});var c=H.find(".dropdown-images");if(c.length){var p=c.parent(".dropdown"),h=c.children(".dropdown-images-name"),m=c.find("#dropdown_images_popup"),f=c.find("#dropdown_images_frame");k()&&m.add(f).change(function(){localStorage.setItem(this.id,this.checked?1:"")}),H.find(".btn-images").click(function(t){p.is(":visible")&&(c.velocity("stop").css({opacity:0,display:"none"}),p.removeClass("open")),e.click()}).one("mouseenter touchstart",function(e){c.find("img").each(function(e){this.hasAttribute("src")||this.setAttribute("src",this.getAttribute("data-src"))})}),c.on("click","img",function(e){var t=this.getAttribute("data-name"),a=t.replace(/"/g,"&quot;"),n='<img src="'+("{{path}}"+a)+'" '+(f.prop("checked")?'class="x3-style-frame" ':"")+'alt="" />',i="";o.hasOwnProperty(t)&&(i+=o[t].hasOwnProperty("title")?"<strong>"+o[t].title+"</strong>":"",(i+=o[t].hasOwnProperty("description")?(i?"<br>":"")+o[t].description:"")&&(i=' data-popup-title="'+i.replace(/"/g,"&quot;")+'"')),m.prop("checked")&&(n='<a href="{{path}}'+a+'"'+i+" data-popup>"+n+"</a>"),h.addClass("inserted").html(a+' &nbsp;<i class="glyphicon glyphicon-ok"></i>'),u.codemirror.replaceSelection(n+"\n"),u.codemirror.focus()}).on("mouseenter","img",function(e){h.html(this.getAttribute("data-name"))}).on("mouseleave","img",function(e){h.removeClass("inserted").html("<span>Select image</span>")})}},10),H.prepend('<button data-loading-text="Saving ..." type="button" class="btn btn-settings-save editor-save btn-primary">Save</button>')}t.find(".template-selector").each(function(e,a){var n=$(this),i=n.hasClass("template-gallery")?"Gallery":"Folders";n.prepend("<div class=setting_templates>"+j+'<select><option value="" disabled selected>'+i+" Setting Templates</option></select></div>"),i=i.toLowerCase();var o=n.find("select"),s="",r=Object.keys(A[i]).length,d=[];$.each(Object.keys(I[i]),function(e,t){e===r&&(s+='<option value="" disabled>---</option>'),s+="<option>"+t+"</option>",d.push(t)}),k()&&(s+='<option class=last-option disabled>---</option><option value="save">Save Current Settings As...</option>'),o.append(s),o.on("change",function(){if("save"==$(this).val()){if(E())return;var e=prompt("Save current "+i+"-settings as template:");if(e&&$.inArray(e,d)>-1)pt("Please use a unique name!",3e3,null,"danger");else if(e){S="get",t.length&&t.submit();var a={};a[i]={},a[i][e]={},a[i][e][i]=v[i],l.modal("show"),$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",cache:!1,data:{save_template:JSON.stringify(a)},success:function(t,a,n){t.success?pt('Template "'+e+'" saved.',null,null,"success"):(pt("Save template error:<br>"+t.fail+"<br><br>Template will be available temporarily until you refresh page.",3e3,null,"warning"),P("Save template error: "+t.fail))},error:function(e,t,a){pt("Save template error:<br>"+t+"<br><br>Template will be available temporarily until you refresh page.",3e3,null,"warning"),P("Save template error: "+t)},complete:function(){l.modal("hide")}});var n="";$.isEmptyObject(O[i])&&(n+="<option class=last-option disabled>---</option>"),n+="<option>"+e+"</option>",o.children('[value="save"]').prev().before(n),d.push(e),$.extend(!0,O,a),$.extend(!0,I,a)}o.val("")}else f=$(this).val(),h=i,p=I[i][f],S="apply",t.length&&t.submit()})}),q(),(c=s.find(".btn-settings-save, .save-page")).on("click",function(e){t.length&&t.submit()}),function(){n=t.children().children("fieldset");var o="";$.each(n,function(t,a){var n=e.form[t].title;o+='<label class="btn btn-default"><input type="radio" name="options" id="option'+(t+1)+'" autocomplete="off" checked>'+n+"</label>";var i=$(this);i.data("height",i.outerHeight(!0))});var l=(r=s.find(".filter-buttons")).children(".btn-group");r.prepend("<h3>"+s.find(".col-md-9 > h3").text()+"</h3>"),l.html(o).after('<button data-loading-text="Saving ..." type="button" class="btn btn-settings-save btn-primary">Save</button>'),r.removeClass("invisible"),i=k()&&null!==localStorage.getItem("x3_settings_page_tab")?Number(localStorage.getItem("x3_settings_page_tab")):0,l.children("label.btn").eq(i).addClass("active"),n.not(n.eq(i)).css("display","none");l.after('<div class="dropdown dropdown-copy-paste"><button type="button" class="btn btn-sm btn-default btn-copy-paste dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-paste"></i></button>    <ul class="dropdown-menu pull-right dropdown-menu-right" role="menu" aria-labelledby="copymenu">    <li class="dropdown-header">Copy-Paste Settings</li>    <li><a href="#" class=settings-copy data-process=copy><i class="fa fa-copy"></i> Copy</a></li>    <li><a href="#" class=settings-paste data-process=paste><i class="fa fa-paste"></i> Paste</a></li>    <li><a href="#" class=settings-paste-all data-process=paste-all><i class="fa fa-paste"></i> Paste All</a></li>    <li role="separator" class="divider"></li>    <li><a href="#" class="settings-copy-help text-help" data-process=copy-paste-help><i class="fa fa-question-circle"></i> Help</a><div class=hidden><h3>Copy-Paste Page Settings</h3><p>This feature allows you to copy settings from one page to another. This is useful when you want to create a page with an identical layout as an existing page. Simply navigate to the source page, click <code>copy</code>, then navigate to the new page and click <code>paste</code>.</p><h4>Copy</h4><p>Copies settings from the current page into clipboard.</p><h4>Paste</h4><p>Pastes settings from clipboard into the current page. This function will only paste layout-related settings, and will <em>ignore</em> unique page details, content, link and menu.</p><h4>Paste All</h4><p>Same as above, but this function will paste <em>all</em> page settings, including details, content, link and menu. This will basically paste an identical copy of the source page, overwriting all existing settings, so it is likely you will want to make some changes after paste.</p><p><em>* You still need to click save after pasting settings.</em></p></div></li>  \t</ul></div>'),setTimeout(function(){r.children(".dropdown-copy-paste").add(t.find(".editor-dropdown")).hoverIntent({over:function(e){var t=$(this),a=t.find(".dropdown-menu");a.velocity({opacity:1},{duration:200,display:"block"}),t.addClass("open")},out:function(){var e=$(this),t=e.find(".dropdown-menu");t.velocity("stop").css({opacity:0,display:"none"}),e.removeClass("open")},timeout:300})},11),r.find("a.settings-paste, a.settings-paste-all").parent("li").toggleClass("disabled",void 0===g),l.on("click",".btn",function(e){var i=$(this);!function(e){var i=s.find(".x3-page-settings-container"),o=i.offset().top,l=e,r=n.eq(l);a.scrollTop()>o?i.velocity("scroll",{duration:500,easing:"easeInOutCubic",complete:function(){t.css("min-height",r.data("height")),n.not(r).filter(":visible").hide(),r.filter(":hidden").show()}}):(t.css("min-height",r.data("height")),n.not(r).filter(":visible").hide(),r.filter(":hidden").show());setTimeout(function(){t.css("min-height",r.data("height"))},1e3),k()&&localStorage.setItem("x3_settings_page_tab",l)}(i.index()),"markdown"===At.back.panel.editor&&1==i.index()&&u.codemirror.refresh()}),r.find(".dropdown-menu").on("click","a",function(e){e.preventDefault();var a=$(this);"copy-paste-help"!==a.data("process")&&(S=a.data("process"),t.length&&t.submit())})}(),a.width()>992&&r.scrollToFixed({zIndex:5})}function q(){if(void 0!==t){var e=t.find("fieldset.plugins"),a=e.find('input[name="plugins.image_background.enabled"]');a.closest("fieldset").toggleClass("is-active",a.is(":checked")&&e.find('input[name="plugins.image_background.src"]').val().length>0);var n=e.find('input[name="plugins.background.enabled"]');n.closest("fieldset").toggleClass("is-active",n.is(":checked")&&(e.find('input[name="plugins.background.src"]').val().length>0||e.find('input[name="plugins.background.color"]').val().length>0));var i=e.find('input[name="plugins.video_background.src"]');i.closest("fieldset").toggleClass("is-active",i.val().length>0);var o=e.find('input[name="plugins.fotomoto.enabled_page"]').closest("fieldset");Ft.plugins.fotomoto.enabled&&Ft.plugins.fotomoto.store_id?o.toggleClass("is-active",Ft.plugins.fotomoto.enabled_page):o.hide();var l=e.find('input[name="layout.disqus"]').closest("fieldset");Ft.accounts&&Ft.accounts.disqus_shortname?l.toggleClass("is-active",Ft.layout.disqus):l.hide();var s=e.find('input[name="plugins.panorama.enabled"]');s.closest("fieldset").toggleClass("is-active",s.is(":checked"))}}$.getJSON("setting-templates.json?v="+x3_panel_version,function(e){A=e,D()}).fail(function(){pt(language.Error+": Can't load panel/setting-templates.json",null,null,"danger"),P("Error: Can't load panel/setting-templates.json")}),custom_setting_templates&&$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",cache:!1,data:{get_templates:!0},success:function(e,t,a){O=e,D()},error:function(e,t,a){pt(language.Error+" -> textStatus: "+t,null,null,"danger"),P("Templates Error: "+t)}}),$.getJSON("settings-page-schema.json?v="+x3_panel_version,function(t){_=!0,e=t}).fail(function(){P("Error: Can't load panel/settings-page-schema.json")}),Dt=function(e,t,a,n){N(e,!0,t,a,n)},s.on("click",".save-page, .x3-page-settings .btn-settings-save",function(e){t.length&&t.submit()}),get_x3_page_settings=function(e,t){if(P("page settings: ",Ft=$.extend(!0,{},At,e)),d=t,_&&Rt&&x)M(Ft);else var a=setInterval(function(){_&&Rt&&x&&(clearInterval(a),"fileManager"==he&&M(Ft))},1e3)}}(),function(){var e,t,a,i,o=S("aHR0cHM6Ly9hdXRoLnBob3RvLmdhbGxlcnkv"),l=C(),r=!1,d={domain:l,product:3};function c(e){j=200===e.status?e.parameters&&e.parameters.type&&"2"==e.parameters.type?2:1:0,k()&&localStorage.setItem("x3_license",j),n.removeClass("x3-auth-0 x3-auth-1 x3-auth-2").addClass("x3-auth-"+j),location.search.indexOf("override")>-1&&n.addClass("x3-override"),r=[e.status,e.message]}function u(){T?p(200):(e.button("loading"),i.html('<div><span class="label label-default">...</span></div>'),$.ajax({type:"POST",data:d,url:o,dataType:"json",success:function(e){P("X3 license:",e),c(e),p(e.status,e.message)}}).fail(function(){p(300,"Can't connect to "+o)}).always(function(){e.button("reset")}))}function p(e,t){var a=200==parseInt(e)?"success":"danger",n=200==parseInt(e)?"ok":"remove";t=301==parseInt(e)?"No license found for this domain.":t;j&&200==parseInt(e)&&(t=2===j?"X3 Private License":"X3 Professional License");var o='<span class="label label-'+a+'"><span class="glyphicon glyphicon-'+n+'" aria-hidden="true"></span>'+t+"</span>";301==parseInt(e)&&(o+='<br><a href="https://www.photo.gallery/buy/" target=_blank class="btn btn-primary" style="margin-top:1.5em; font-size: 12px;">Purchase X3 License</a>'),i.html(o),pt(t,2e3,null,a)}T&&n.addClass("x3-auth-"+j),T||$.post(o,d,function(e){(c(e),0===j&&k())&&(null!==localStorage.getItem("x3_license_time")?Date.now()-parseInt(localStorage.getItem("x3_license_time"))>2592e5&&(h('<p><span class="label label-danger" style="font-size: 1.5em; display: inline-block;">No X3 License Found</span></p><p>The website <strong>'+l+'</strong> is not licensed to use X3. If you wish to continue using X3, please consider purchasing a license.</p><p><a href="https://www.photo.gallery/buy/" target="_blank" class="btn btn-primary">Purchase X3 License</a></p>'),localStorage.setItem("x3_license_time",Date.now())):localStorage.setItem("x3_license_time",Date.now()))},"json"),Nt=function(){t=s.find(".x3-auth"),a=t.children(".auth-res"),i=a.children("div"),e=t.children(".btn-auth"),r?p(r[0],r[1]):u(),e.on("click",u)}}();var Mt,qt="\t<div class=x3-auth>\t\t<h3>Authorize X3<i class='help-icon panel-help pull-right fa fa-question-circle' data-help='authorize'></i></h3>\t\t<div class=auth-res>\t\t\t<strong>domain:</strong> "+window.location.hostname+"\t\t\t<div><span class='label label-default'>...</span></div>\t\t</div><br>\t\t<button type=button class='btn btn-primary btn-auth' data-loading-text='Checking License ...'><span class='glyphicon glyphicon-repeat' aria-hidden=true></span> &nbsp;Re-check</button>  </div>";!function(){var e,t,a,n=!0,i=!1;function o(e,t){var a=s.find("#tools-htaccess");a.find(".alert").remove();var n='<div class="alert alert-'+t+' alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+e+"</div>";a.append(n)}function l(a){if(!E()){e.button("loading");var n=t.getValue();$.ajax({url:"x3_htaccess.php",method:"POST",dataType:"html",cache:!1,data:{data:n}}).done(function(e){"ok"==e?(i=n,pt(".htaccess file saved!",2e3,null,"success")):pt("Can't write to .htaccess file!",2e3,null,"danger")}).fail(function(e,t,a){P("htaccess save error:",e),pt(t+": "+a,3e3,null,"danger")}).always(function(){setTimeout(function(){e.button("reset")},1e3)})}}function r(i){0==i.indexOf("nowrite")&&(i=i.replace("nowrite",""),o("If this file was writeable, you could save changes directly from the panel.","warning"),n=!1),a.append('<div id="htaccess-editor"></div>'),(t=ace.edit("htaccess-editor")).setOption("maxLines",1/0),t.setOption("minLines",5),t.setAutoScrollEditorIntoView(!0),t.getSession().setUseWrapMode(!0),t.$blockScrolling=1/0,t.setTheme("ace/theme/tomorrow_night");var s="htaccess"===conf_editor?"apache_conf":"xml";t.getSession().setMode("ace/mode/"+s),t.setValue(i,-1),n&&(a.append('<button type="button" class="btn btn-primary btn-process btn-save-htaccess" data-loading-text="Saving ...">Save</button>'),(e=a.children(".btn-save-htaccess")).on("click",l))}Mt=function(){(a=s.find("#tools-htaccess")).children("#htaccess-editor").length<1&&(i?r(i):(show_preloader(),$.ajax({url:"x3_htaccess.php",method:"POST",dataType:"html",cache:!1,data:{action:"load"}}).done(function(e){if("nofile"==e)pt(t="Cannot find .htaccess file in application root!",2e3,null,"danger"),o(t,"danger");else if("noread"==e)pt(t=".htaccess file is not readable!",2e3,null,"warning"),o(t,"warning");else if(e.length<1){var t;pt(t=".htaccess file seems to be empty!",2e3,null,"warning"),o(t,"warning")}else pt(".htaccess loaded!",2e3,null,"success"),i=e,r(e)}).fail(function(e,t){P("htaccess load error:",jqxhr);var a=e.status+" "+e.statusText;pt(a,2e3,null,"danger"),o(a,"danger")}).always(function(){hide_preloader()})))}}();var Lt,zt,Ut="<h3>"+(conf_editor||"")+" editor<i class='help-icon panel-help pull-right fa fa-question-circle' data-help='htaccess'></i></h3>";!function(){window.location.hostname;var e,t="<li role=presentation id=tab-tools-auth class=active><a href=#tools-auth aria-controls=tools-auth role=tab data-toggle=tab>Authorize</a></li>",a=conf_editor?"<li role=presentation id=tab-tools-htaccess><a href=#tools-htaccess aria-controls=tools-htaccess role=tab data-toggle=tab>"+conf_editor+"</a></li>":"";Lt=function(){b("#tools"),s.html(e||(e="\t\t<div class='x3-panel-section x3-tools'>\t\t\t<div class='tabs-container'>\t    <ul class='nav nav-tabs' role='tablist'>\t    \t"+t+a+"\t    \t<li role=presentation id=tab-tools-phpinfo class=flamepix-hidden><a href=#tools-phpinfo aria-controls=tools-phpinfo role=tab data-toggle=tab>PHPinfo</a></li>\t\t    <li role=presentation><a href=#tools-site aria-controls=tools-site role=tab data-toggle=tab>Preload</a></li>\t\t    <li role=presentation><a href=#tools-reset aria-controls=tools-reset role=tab data-toggle=tab>Reset</a></li>\t\t    <li role=presentation id=tab-tools-touch><a href=#tools-touch aria-controls=tools-touch role=tab data-toggle=tab>Cache</a></li>\t\t    <li role=presentation id=tab-tools-previews><a href=#tools-previews aria-controls=tools-previews role=tab data-toggle=tab>Previews</a></li>\t\t    <li role=presentation id=tab-tools-updates><a href=#tools-updates aria-controls=tools-upates role=tab data-toggle=tab>X3 Updates</a></li>\t    </ul>\t    </div>\t    <div id=myTabContent class=tab-content>\t      <div role=tabpanel class='tab-pane fade tools-mini active in' id=tools-auth>"+qt+"</div>\t      <div role=tabpanel class='tab-pane fade' id=tools-htaccess>"+Ut+"</div>\t      <div role=tabpanel class='tab-pane fade flamepix-hidden' id=tools-phpinfo>"+Ht+"</div>\t      <div role=tabpanel class='tab-pane fade tools-mini' id=tools-site>"+Xt+"</div>\t      <div role=tabpanel class='tab-pane fade tools-mini' id=tools-reset>"+Kt+"</div>\t      <div role=tabpanel class='tab-pane fade tools-mini' id=tools-touch>"+Zt+"</div>\t      <div role=tabpanel class='tab-pane fade' id=tools-previews>"+Jt+"</div>\t      <div role=tabpanel class='tab-pane fade tools-mini' id=tools-updates>"+ea+"</div>\t    </div>\t  </div>"));var n=s.children(".x3-tools").children(".tabs-container").children(".nav-tabs");n.find('a[href="#tools-previews"]').one("shown.bs.tab",function(e){Wt()}).end().find('a[href="#tools-touch"]').one("shown.bs.tab",function(e){Gt()}).end().find('a[href="#tools-reset"]').one("shown.bs.tab",function(e){Yt()}).end().find('a[href="#tools-site"]').one("shown.bs.tab",function(e){Vt()}).end().find('a[href="#tools-phpinfo"]').one("shown.bs.tab",function(e){zt()}).end().find('a[href="#tools-htaccess"]').one("shown.bs.tab",function(e){Mt()}).end().find('a[href="#tools-updates"]').one("shown.bs.tab",function(e){Qt()});var i=k()&&null!==localStorage.getItem("panel_tools_tab")?localStorage.getItem("panel_tools_tab"):"tools-auth",o=n.find('a[href="#'+i+'"]');o.length&&o.tab("show"),s.velocity("fadeIn",{duration:500}),"tools-auth"===i?Nt():n.find('a[href="#tools-auth"]').one("shown.bs.tab",function(e){Nt()}),n.on("shown.bs.tab",'a[data-toggle="tab"]',function(e){k()&&localStorage.setItem("panel_tools_tab",String(e.target).split("#")[1])})},c.find("li#tools > a").on("click",function(e){e.preventDefault(),Lt()})}(),function(){var e=!1;zt=function(){e?s.find("#myphpinfo").html(e):(show_preloader(),$.ajax({url:"x3_tools.php",method:"POST",dataType:"html",cache:!1,data:{phpinfo:!0}}).done(function(t){t.length<1?pt("phpinfo() seems to be empty :(",2e3,null,"warning"):(pt("phpinfo loaded!",2e3,null,"success"),e=t,s.find("#myphpinfo").html(t))}).fail(function(e,t){P("PHPinfo error:",jqxhr);var a=e.status+" "+e.statusText;pt(a,2e3,null,"danger"),s.find("#myphpinfo").html(a)}).always(function(){hide_preloader()}))}}();var Bt,Vt,Ht="<div id=myphpinfo></div>";!function(){var e;Bt=function(t){if(At.settings.diagnostics)pt("You cannot create site object while diagnostics are enabled.",3e3,null,"warning");else if("create"!==At.settings.preload)pt("This feature requires you to have <strong>Preload Website: [create]</strong> in Settings > Advanced.",3e3,null,"warning");else{if(E())return;var a=t?s.find(".btn-create-site-object"):e,n=a.text(),i=new Date;a.attr("disabled",!0).text("Creating site object ..."),$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",data:{site_object:!0}}).done(function(e){if(e.success){var t=new Date;pt("Site object created in "+((Number(t)-Number(i))/1e3).toFixed(2)+" seconds.",2e3,null,"success")}else void 0!==e.error?pt(e.error,2e3,null,"danger"):pt("Error",2e3,null,"danger")}).fail(function(e,t,a){P("site object error: ",e),pt(t+": "+a,2e3,null,"danger")}).always(function(){a.text(n).attr("disabled",!1)})}},Vt=function(){(e=s.find(".btn-preload")).on("click",function(){Bt(!1)})}}();var Wt,Xt="<h3>Preload Site Object <i class='help-icon panel-help pull-right fa fa-question-circle' data-help='preload'></i></h3><p class=boxed>Click the button below to refresh the site object, required if you are using the <em>preload</em> option in settings. <strong><a href=# class=show-help data-hidden='.preload_help'>More Info [?]</a></strong></p><p><em>*Depending on the amount of folders and the speed of your server, this process could take up to 60 seconds or even fail.</em></p><button type=button class='btn btn-primary btn-process btn-preload' data-loading-text='Creating Site Object ...'>Create site object</button>";!function(){var e,t,a="";function n(){if(!E()&&e.length){e.children(".previews-log").remove();var n=t.text();t.attr("disabled",!0).text("Updating ..."),$.ajax({method:"POST",url:"x3_previews.php",dataType:"html"}).done(function(t){pt("Previews updated",2e3,null,"success"),a="<div class=previews-log>"+t+"</div>",e.append(a)}).fail(function(e,t,a){P("previews error:",e),pt(t+": "+a,2e3,null,"danger")}).always(function(){setTimeout(function(){t.attr("disabled",!1).text(n)},1e3)})}}Wt=function(){e=s.find("#tools-previews"),t=e.find(".btn-previews"),a&&e.find("table").length<1&&e.append(a),c.find("li#refresh").is(":visible")&&e.find(".remember").length<1&&e.find(".boxed").append('<em class="remember"><br><br>* Remember to refresh menu after update, if there are changes.<em>'),t.on("click",n)}}();var Yt,Jt="<h3>Update Preview Images<i class='help-icon panel-help pull-right fa fa-question-circle' data-help='previews'></i></h3><p class=boxed>This tool will try to automatically set preview images for your pages, unless they are already set correctly.</p><button type=button class='btn btn-primary btn-process btn-previews' data-setting-text='Updating ...'>Update Preview Images</button>";!function(){var e;function t(){E()||(e.button("loading"),$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",data:{reset_settings:!0}}).done(function(e){"already"==e.success?pt("Settings are already deleted",2e3,null,"primary"):e.success?(pt("Settings Successfully Reset. Logging out ...",2e3,null,"success"),setTimeout(function(){location.replace("logout.php")},2e3)):void 0!==e.error?pt(e.error,2e3,null,"danger"):pt("Error",2e3,null,"danger")}).fail(function(e,t,a){P("reset error:",e),pt(t+": "+a,2e3,null,"danger")}).always(function(){setTimeout(function(){e.button("reset")},1e3)}))}Yt=function(){(e=s.find(".btn-reset")).on("click",t)}}();var Gt,Kt="<h3>Reset Settings<i class='help-icon panel-help pull-right fa fa-question-circle' data-help='reset'></i></h3><p class=boxed>Click below button to reset settings to default. The reset includes username and password, so you will automatically be logged out after reset.</p><p><em>*Reset will not affect your individual page settings.</em></p><button type=button class='btn btn-primary btn-process btn-reset' data-loading-text='Resetting settings to default ...'>Reset Settings</button>";!function(){var e;function t(){if(!E()){var t=e.text();e.attr("disabled",!0).text("Clearing ..."),$.ajax({method:"POST",url:"x3_tools.php",dataType:"json",data:{touch:!0}}).done(function(e){e.success?pt(e.success,2e3,null,"success"):void 0!==e.warning?pt(e.warning,2e3,null,"warning"):void 0!==e.error?pt(e.error,2e3,null,"danger"):pt("Error",2e3,null,"danger")}).fail(function(e,t,a){P("touch error:",e),pt(t+": "+a,2e3,null,"danger")}).always(function(){setTimeout(function(){e.text(t).attr("disabled",!1)},1e3)})}}Gt=function(){(e=s.find(".btn-touch")).on("click",t)}}();var Qt,Zt="<h3>Clear Page Cache</h3><p class=boxed>This tool allows you to clear the X3 page cache, so that new pages are created. This process is not necessary, because pages are <em>always</em> recreated if you make any changes from the panel. It may however be useful if you are making changes by FTP, or if you simply want to clear the page cache as part of maintenance.</p><button type=button class='btn btn-primary btn-process btn-touch' data-invalidating-text='Clearing ...'>Clear Page Cache</button>";!function(){var e,t,a="https://www.photo.gallery",n=a+"/d/",i=a+"/download/";function o(){show_preloader(),$.post(n,{latest:!0,json:!0}).done(function(e){P("load updates:",e),e&&e.status?(pt("X3 updates loaded",2e3,null,"success"),function(e){var a=location.search.indexOf("force_update")>-1,n=!!e.version&&"X"+e.version,o=e.text?e.text:'<strong>X3 Updater</strong> <span class="label label-warning">Beta</span><br>We recommend using the X3 updater to automatically install latest version of X3.',l='<div style="margin-bottom:0;" class="alert alert-danger" role="alert">';if(a||function(e,t){if(!e||!t)return!1;var a=e.split(".").map(function(e){return parseInt(e)}),n=t.split(".").map(function(e){return parseInt(e)});if(a[0]>n[0])return!0;if(a[0]===n[0])return a[1]>n[1]||a[1]===n[1]&&a[2]>n[2];return!1}(e.version,x3_version)){var s="<br><br>";if(has_ziparchive?root_writeable?has_curl?s+=j||location.search.indexOf("ignore_license")>-1?'<button class="btn btn-primary btn-updater">Update to '+n+" now!</button>":'<div class="alert alert-danger text-center" role="alert" style="font-size: inherit; margin-bottom: 0;">A valid X3 license is required to update X3.<br><a href="https://www.photo.gallery/buy/" target="_blank" class="btn btn-danger" style="margin-top: .7em;">Purchase X3 License</a></div>':s+=l+'You server is missing PHP <a href=http://php.net/manual/en/book.curl.php target="_blank">cURL</a>, required to download update from remote server.</div>':s+=l+"You will need to enable <strong>write permissions</strong> on your root X3 directory before you can proceed with the X3 updater.</div>":s+=l+'You server is missing PHP <a href=http://php.net/manual/en/class.ziparchive.php target="_blank">ZipArchive</a> class.</div>',t.append('<div class="panel panel-primary text-left"><div class="panel-heading">New version <strong>'+n+'</strong> available!</div><div class="panel-body">'+o+s+'</div></div><div class="panel panel-default text-left"><div class="panel-heading">Manually update to <strong>'+n+'</strong></div><div class="panel-body">If you for technical reasons can\'t use the X3 updater above, you can update X3 manually:<br><br>1. <a href="'+i+'X3.latest.update.zip">Download</a> latest X3 update.<br>2. Unzip the downloaded ZIP file.<br>3. Upload update files into your X3 directory by FTP.<br>4. After update, go to your <a href="../?diagnostics">diagnostics</a> page.</div></div>'),!j)return;var r=t.find(".btn-updater");r.length&&r.on("click",function(e){E()||(r.addClass("disabled").text("Loading updater ..."),show_preloader(),$.post("x3_tools.php",{copy_updater:!0}).done(function(e){if(e.success)pt("Updater loaded!",2e3,null,"success"),r.text("Redirecting ..."),window.location.href="../x3_updater.php";else{var t=e.msg?e.msg:"Failed to download X3 updater.";pt(t,2e3,null,"danger"),r.after(l+t+"</div>"),r.remove()}}).fail(function(e){pt("Failed to start updater",2e3,null,"danger")}).always(function(e){hide_preloader()}))})}else t.append('<div class="alert alert-success">You are already using latest release <strong>X'+x3_version+"</strong>!</div>")}(e)):pt("Failed to load X3 updates",2e3,null,"danger")}).fail(function(e){pt("Failed to load X3 updates",2e3,null,"danger"),t.append('<div id="ad-container" style="position:absolute;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=" id="ad"></div>');var a=t.children("#ad-container");a.is(":visible")||t.append('<div class="alert alert-danger" role="alert">You seem to have an <strong>Adblock</strong> extension which is preventing X3 from loading remote data. Please disable adblock for this page.</div>'),a.remove()}).always(function(e){hide_preloader()})}Qt=function(){e=s.find("#tools-updates"),t=e.children(".x3-updates"),o()}}();var x3Uploader,ea="<div class=x3-updates>\t<h3>X3 Updates</h3></div>",thumbsize=window.devicePixelRatio>1?"200":"100";!function(){var e,t,a,n,i,o,l=window.devicePixelRatio>1?2:1,r=!/Android(?!.*Chrome)|Opera/.test(window.navigator&&navigator.userAgent);function d(t){(i+=t)>0&&!e.hasClass("hasqueue")?e.addClass("hasqueue"):i<1&&e.hasClass("hasqueue")&&e.removeClass("hasqueue"),e.find(".queue-text").text(i+" files in upload queue.")}function c(){var e={disableImageResize:!a.is(":checked")||!r,imageMaxWidth:Number(n.find("#resize-width").val()),imageMaxHeight:Number(n.find("#resize-height").val()),imageQuality:Number(n.find("#resize-quality").val())/100};mt(e),o.fileupload("option",e)}x3Uploader=function(u){e=s.children(".modal#uploader"),o=e.find("#fileupload"),t=e.find(".resize-options"),a=t.find(".resize-toggle input"),n=t.find(".resize-inputs"),i=0;var p={disableImageResize:Boolean(ht.disableImageResize)||!Boolean(u.img_resize)||!r,imageMaxWidth:Number(ht.imageMaxWidth||u.img_resize_width),imageMaxHeight:Number(ht.imageMaxHeight||u.img_resize_height),imageQuality:Number(ht.imageQuality||Number(u.img_resize_quality)/100)};a.prop("checked",!p.disableImageResize).parent("label").toggleClass("active",!p.disableImageResize),n.toggle(!p.disableImageResize),n.find("#resize-width").val(p.imageMaxWidth),n.find("#resize-height").val(p.imageMaxHeight),n.find("#resize-quality").val(100*p.imageQuality),e.removeClass("hasqueue isuploaded"),n.on("change","input",function(e){c()}),a.change(function(){setTimeout(function(){var e=a.is(":checked");n.toggle(e),c()},10)}),e.find('.resize-options input[type="number"]').on("input",function(e){var t=Number($(this).attr("maxlength"));this.value.length>t&&(this.value=this.value.slice(0,t))}).on("blur",function(e){0==this.value.length?this.value=$(this).attr("placeholder"):Number(this.value)<parseInt($(this).attr("min"))?this.value=$(this).attr("min"):Number(this.value)>parseInt($(this).attr("max"))&&(this.value=$(this).attr("max")),this.value=Number(this.value)}).numericInput(),e.find("button.view").click(function(t){e.find(".modal-footer > button").last().click()}),is_guest&&o.find("button.start").on("click",function(e){E("Guest user cannot upload.")&&(e.preventDefault(),e.stopImmediatePropagation())}),o.fileupload({dropZone:o.find("#dropzone"),url:u.path,disableImageResize:p.disableImageResize,imageMaxWidth:p.imageMaxWidth,imageMaxHeight:p.imageMaxHeight,imageQuality:p.imageQuality,loadImageMaxFileSize:4e7,disableVideoPreview:!0,previewMaxWidth:100*l,previewMaxHeight:50*l,previewMinWidth:100*l,previewMinHeight:50*l,previewOrientation:u.orientation,imageOrientation:u.orientation,acceptFileTypes:u.acceptFileTypes}).bind("fileuploadadded",function(t,a){var n=e.find("tr.template-download");e.hasClass("isuploaded")&&n.length&&n.remove(),!0!==a.files.error&&d(1)}).bind("fileuploadfailed",function(e,t){!0!==t.files.error&&d(-1)}).bind("fileuploadstart",function(t,a){e.addClass("isuploading")}).bind("fileuploadstop",function(t){e.removeClass("isuploading").addClass("isuploaded"),i=0,d(0)})}}();