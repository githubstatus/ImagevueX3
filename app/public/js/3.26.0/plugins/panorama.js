/* www.photo.gallery X3.26.0 2018-12-09 */

!function(){function e(e,t){E&&(console.log("X3 panorama // "+e),t&&console.dir(t))}var t=!1,n=0;if(window.WebGLRenderingContext)try{var i=document.createElement("canvas");if(i.getContext){var a=i.getContext("webgl")||i.getContext("experimental-webgl");(t=!!(a&&a instanceof WebGLRenderingContext))&&(n=a.getParameter(a.MAX_TEXTURE_SIZE)),e("webgl_support: "+t),e("max_texture_size: "+n)}}catch(t){e("error while trying to detect WebGL")}var r,s,l,c,p,u,d,f,h,v,m,g,_,y,w,x,b,z,C,O,M,P=x3_settings.plugins.panorama,k="hide"!==P.zoom,R=!1,L=!1,T=P.autorotate_start,j=T&&P.autorotate_restart,F=!1,q=!1,A=0,W=!1,I=!1,N=x3_tests.is_pointer,V=!1,D=[],U={yaw:0,pitch:0,fov:.79},H=window.devicePixelRatio||1,G=window.screen.availWidth*H>=640?640:320;function X(t,o,i){var a=-1,r=0,s={items:[],open:-1};return t.each(function(t,l){var c=$(l);"object"!=typeof c.data("panorama")&&function(t,o){var i=o.data("panorama"),a={},r=!1;i&&"string"==typeof i?i.split("&").forEach(function(e,t){var n=e.split("=");if(n.length>1&&n[1].length){var o=n[1];a[n[0]]=isNaN(o)?"true"===o||"false"!==o&&o:Number(o)}else isNaN(e)?["equirect","cube","flat"].indexOf(e)>-1?a.type=e:e.indexOf("/")>-1||e.match(/\.(jpeg|jpg)$/i)?r=e:a[n[0]]=null:(a.hasOwnProperty("width")?a.hasOwnProperty("height")||(a.height=Number(e)):a.width=Number(e),a.type="equirect")}):i&&"number"==typeof i&&(a.type="equirect",a.width=i),a.hasOwnProperty("type")||(a.hasOwnProperty("width")?a.type=isNaN(a.width)?"flat":"equirect":a.hasOwnProperty("levels")||a.hasOwnProperty("path")?a.type="cube":a.type="equirect");var s="equirect"===a.type?"source":"path",l=a[s]||r||t.getAttribute("data-href")||t.getAttribute("href")||!1;if(l&&(l=l.trim()),l&&(0!==l.toLowerCase().indexOf("http")&&(l.indexOf("content/")>-1?l=x3_settings.path+"/content/"+l.split("content/")[1]:0!==l.indexOf("/")&&(l=x3_settings.path+x3_settings.file_path+"/"+l)),"path"===s&&(l=l.replace(/\.(jpeg|jpg)$/i,""))),a[s]=l?S(l).chompRight("/").s:"none","equirect"===a.type){var c=a.width||o.data("width")||!1,p=a.height||o.data("height")||!1;c&&p||(c?p=Math.floor(c/2):p?c=Math.floor(2*p):(c=4096,p=2048)),a.width=c,a.height=p,c>n&&a.hasOwnProperty("source_4096")&&(null===a.source_4096||!0===a.source_4096)&&(a.source_4096=a.source.replace(/\.(jpeg|jpg)$/i,"_4096.$1"))}else if("flat"===a.type){var u=a.width.split(","),d=a.height.split(",");a.levels=[],u.forEach(function(e,t){a.levels.push({width:parseInt(e),height:parseInt(d[t])})}),delete a.width,delete a.height}e("params_to_object: "+i,a),o.data("panorama",a)}(l,c);var p=c.data("panorama");if(["equirect","cube"].indexOf(p.type)>-1){var u={};Object.keys(U).forEach(function(e){var t=p.hasOwnProperty(e)?p[e]:P[e];t!==U[e]&&(3.14===Math.abs(t)&&(t=Math.PI*(t>0?1:-1)),u[e]=t)});var d=p.hasOwnProperty("maxVFov")?p.maxVFov:P.max_vfov,f=p.hasOwnProperty("maxHFov")?p.maxHFov:P.max_hfov;0===f&&(f=null)}if("equirect"===p.type){var h=p.source.indexOf("/content/")>-1&&0!==p.source.toLowerCase().indexOf("http"),v=p.source,m=p.width;if(m>n)if(n>=4096&&p.hasOwnProperty("source_4096"))v=p.source_4096,m=4096;else{if(!h||!P.equirect_resize)return e("Error: Source ["+v+"] width ["+m+"] is > device max_texture_size ["+n+"] and equirect_resize option is disabled, or source is not in content path."),i?ue(c):c.removeClass("x3-panorama"),!0;v=ge(v,n),m=n}var g=[{width:m}],_=[v];if(h)if(p.hasOwnProperty("preview")?p.preview:P.equirect_preview){g.unshift({width:G});var y=p.hasOwnProperty("source_4096")?p.source_4096:p.source;_.unshift(ge(y,G))}var w=p.maxResolution||P.maxres_multiplier*m/4;p.hasOwnProperty("maxResolution")||(p.maxResolution=w);var x=new Marzipano.ImageUrlSource(function(e){return{url:_[e.z]}}),b=new Marzipano.EquirectGeometry(g),z=new Marzipano.RectilinearView(u,Marzipano.RectilinearView.limit.traditional(w,d,f))}else if("cube"===p.type){x=Marzipano.ImageUrlSource.fromString(p.path+"/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:p.path+"/preview.jpg"});var C=function(e){if("object"==typeof e)return e;for(var t=256,n=[{tileSize:256,size:256,fallbackOnly:!0}],o=0;o<e;o++)n.push({tileSize:512,size:t*=2});return n}(p.levels||3);b=new Marzipano.CubeGeometry(C),w=p.maxResolution||P.maxres_multiplier*(p.face_size||C[C.length-1].size);p.hasOwnProperty("maxResolution")||(p.maxResolution=w);z=new Marzipano.RectilinearView(u,Marzipano.RectilinearView.limit.traditional(w,d,f))}else{if("flat"!==p.type)return!0;var O=p.tilesize||P.flat_tile_size,M=p.levels,k=M[M.length-1];x=function(e){var t=e.url_format||P.flat_url_format,n=e.hasOwnProperty("zero_padding")?e.zero_padding:P.flat_zero_padding,o=e.hasOwnProperty("index_start")?e.index_start:P.flat_index_start;return new Marzipano.ImageUrlSource(function(i){return{url:e.path+"/"+t.replace(/{z}|{y}|{x}/gi,function(e){return"{z}"===e?i.z+o:"{y}"===e?S(i.y+o).padLeft(n,"0").s:"{x}"===e?S(i.x+o).padLeft(n,"0").s:void 0})}})}(p);M.forEach(function(e){e.tileWidth=O,e.tileHeight=O}),k.width<M[0].width&&M.reverse();b=new Marzipano.FlatGeometry(M);var E=k.width/k.height,R=window.innerWidth/window.innerHeight,L=E>R?R/E:1;z=new Marzipano.FlatView({mediaAspectRatio:E,zoom:L},Marzipano.util.compose(Marzipano.FlatView.limit.resolution(k.width),Marzipano.FlatView.limit.letterbox()))}i&&c.addClass("x3-panorama"),p.index=r,p.hasOwnProperty("id")||(p.id=l.getAttribute("id")||(p.source||p.path).split("/").filter(Boolean).pop().replace(/\.(jpeg|jpg)$/i,"")),p.hasOwnProperty("title")||(p.title=l.getAttribute("data-title")||l.getAttribute("title")||p.id),p.title&&(p.title=p.title.charAt(0).toUpperCase()+p.title.slice(1)),-1===s.open&&(o===p.id?s.open=r:-1===a&&p.hasOwnProperty("open")&&(o?a=r:s.open=r)),p.scene_ob={source:x,geometry:b,view:z,pinFirstLevel:!!p.pinFirstLevel},p.original_view=z.parameters(),s.items.push(p),r++}),-1===s.open&&(s.open=a),e("pano_data:",s),s}function K(e,t,n){if(R)return!1;R=!0,r=e,A=t,_e(!0);var o=r.items[t],i=P.scene_nav?r.items.length:1;i>1?r.items.forEach(function(e,t){e.scene=s.createScene(e.scene_ob)}):o.scene=s.createScene(o.scene_ob),P.reset_view&&o.scene_ob.view.setParameters(o.original_view),P.scene_nav&&w.toggleClass("hide",i<=1),P.index&&m.toggleClass("hide",i<=1),J(o,i),p.velocity("fadeIn",{duration:200,complete:function(){s.updateSize(),function(){if(!x3_tests.ios)return;Sc.on("orientationchange.pano",function(e){var t=u[0].clientWidth,n=u[0].clientHeight;setTimeout(function(){u[0].clientWidth===t&&u[0].clientHeight===n||s.updateSize()},500)})}(),function(){if(!x3_tests.touch||!N)return;var e;Lc.on("touchend.pano",function(t){V=!0,clearTimeout(e),e=setTimeout(function(){V=!1},300)})}(),o.scene.switchTo({transitionDuration:Ce,transitionUpdate:be()},function(){!function(){!x3_tests.touch||x3_tests.mouse_used&&!x3_tests.touched?f.add(h).on("mouseenter.pano mouseleave.pano",function(e){$(this).toggleClass("pano-hover","mouseenter"===e.type)}):f.add(h).addClass("pano-touch");if(!P.hide_interface)return void le(!1);pe(),u.on("mousemove.pano",$.throttle(Math.floor(P.hide_interface_timeout/10),!1,pe)),x3_tests.touch&&(ce(f),ce(h))}(),(T||j)&&ne(!0),s.stage().addEventListener("renderComplete",me),function(){if("auto"!==P.zoom||!N)return;Sc.on("resize.pano",$.debounce(500,function(e){Z(r.items[A])}))}(),fe(o,i)}),W=n||bi("pano")!=o.id&&!navigator.userAgent.match("CriOS"),history.pushState(null,o.id,"#pano="+o.id),Sc.one("popstate.pano",function(e){B(!1)}),function(e){Lc.on("keydown.pano",function(e){[32,38,40].indexOf(e.which)>-1&&e.preventDefault()}),P.keyboard&&Re.length&&(Ee=!1,_.find(".active").removeClass("active"),Lc.on("keydown.pano",function(t){var n=t.which;if(Ee!==n){if(t.shiftKey&&e>1&&P.nav&&[37,39].indexOf(n)>-1)return!1;Ee=n,Le(n,!0)}}));P.keyboard&&Lc.on("keyup.pano",function(t){var n=t.which;if(t.shiftKey&&e>1&&[37,39].indexOf(n)>-1)Q(37===n?-1:1);else{if(27===n)return void B(!0);if(32===n)return le(!re),void(re&&f.add(h).removeClass("pano-hover"))}Re.length&&Le(n,!1)})}(i)}})}function B(e){if(!R)return!1;R=!1,P.autorotate_start?ie():ne(!1),[Sc,Lc,u,d,f,h].forEach(function(e){e.length&&e.off(".pano")}),W?e&&history.back():history.replaceState(null,document.title,location.pathname+location.search),L&&screenfull.exit(p[0]),p.velocity("fadeOut",{duration:200,complete:function(){_e(!1),s.destroyAllScenes(),s.stage().removeEventListener("renderComplete",me),me(!0),le(!0),f.add(h).removeClass("pano-hover")}})}function Q(e){var t=A+e,n=r.items.length;if(t<0||t>=n){if(!P.scene_loop)return;t=t<0?n-1:0}A=t;var o=r.items[A];P.reset_view&&o.scene_ob.view.setParameters(o.original_view),P.title&&"0"!=f.css("opacity")&&v.css("display","none"),n>1&&N&&z.add(C).css("display","none"),J(o,n),se&&P.show_interface_after_nav&&pe(),ie(),"opacity"!==we&&o.scene.layer().setEffects({opacity:0}),o.scene.switchTo({transitionDuration:ze,transitionUpdate:xe()},function(){T?oe():j&&ne(!0),P.title&&!v.is(":visible")&&Y(v,!0,3*e,300),n>1&&N&&!V&&(x.is(":hover")&&Y(z,!0,3*e,200),b.is(":hover")&&Y(C,!0,3*e,200)),P.show_interface_after_nav&&(!P.hide_interface&&P.keyboard?le(!1):re&&pe()),fe(o,n)}),history.replaceState(null,o.id,"#pano="+o.id)}function Y(e,t,n,o,i){e.velocity("stop").velocity({opacity:t?[1,0]:[0,1],translateX:t?[0,n]:[n,0]},{duration:o||300,easing:"easeOutQuint",display:t?i||"auto":"none"})}function Z(e){if("auto"===P.zoom&&N){var t=e.hasOwnProperty("zoom")?e.zoom:"flat"===e.type||e.maxResolution>window.innerWidth*H;y.toggleClass("pano-zoom-hidden",!t)}}function J(e,t){if(M.length&&M.toggleClass("hide","flat"===e.type),O.data("visible")&&O.toggleClass("hide","flat"===e.type),Z(e),P.scene_nav&&t>1){var n=A<=0?t-1:A-1,o=A>=t-1?0:A+1,i=!1,a=!1;P.scene_loop||(i=n>=A,x.toggleClass("hide",i),a=o<=A,b.toggleClass("hide",a),N&&(z.toggleClass("hide",i),C.toggleClass("hide",a))),N&&(i||z.html(r.items[n].title),a||C.html(r.items[o].title))}P.index&&t>1&&m.text(A+1+" / "+t),P.title&&g.html(e.title)}e("Settings:",P),wi.panorama.init_page=function(e,n){var o=e.is(".context");if(t){var i=X(n,!R&&bi("pano"),o);i.items.length&&(e.on("click",".x3-panorama",function(e){e.stopImmediatePropagation(),e.preventDefault(),K(i,$(this).data("panorama").index,!0)}),R||(i.open>-1?K(i,i.open):P.auto_open&&!o&&K(i,0)))}else o?n.each(function(e,t){ue($(t))}):n.removeClass("x3-panorama")},wi.panorama.init_pano=function(){if(t){!function(){var e="",t="";P.buttons&&P.buttons.split(",").forEach(function(e,n){t+='<button type="button" class="pano-button pano-'+e+(["deviceorientation","fullscreen"].indexOf(e)>-1?" hide":"")+'"></button>'}),t&&(e+='<div class="pano-controls">'+t+"</div>");var n="";P.index&&(n+='<span class="pano-index"></span>'),P.title&&(n+='<span class="pano-title"></span>'),(n+='<span class="pano-spinner"></span>')&&(e+='<div class="pano-text">'+n+"</div>"),e&&(e='<div class="pano-topbar">'+e+"</div>");var o="";P.scene_nav&&(o+='<div class="pano-scene-nav"><button type="button" class="pano-button pano-previous"></button><div class="pano-text pano-title-previous"></div><button type="button" class="pano-button pano-next"></button><div class="pano-text pano-title-next"></div></div>');var i="";k&&(i+='<div class="pano-zoom"'+(P.nav?' style="margin-right: 1em;"':"")+'><button type="button" class="pano-button pano-zoom-out"></button><button type="button" class="pano-button pano-zoom-in"></button></div>'),P.nav&&(i+='<button type="button" class="pano-button pano-left"></button><div class="pano-up-down"><button type="button" class="pano-button pano-up"></button><button type="button" class="pano-button pano-down"></button></div><button type="button" class="pano-button pano-right"></button>'),i&&(o+='<div class="pano-nav">'+i+"</div>"),o&&(e+='<div class="pano-bottombar">'+o+"</div>"),e&&(e='<div id="pano-interface" class="pano-interface-hide">'+e+"</div>"),Lc.append('<div id="pano-container">'+e+'<div id="pano"></div></div>')}(),p=Lc.find("#pano-container"),u=p.find("#pano"),d=p.find("#pano-interface");var e=(f=d.find(".pano-topbar")).find(".pano-controls");O=e.find(".pano-deviceorientation"),v=f.find(".pano-text"),m=v.find(".pano-index"),g=v.find(".pano-title"),he=v.find(".pano-spinner"),h=d.find(".pano-bottombar"),_=h.find(".pano-nav"),y=_.find(".pano-zoom"),w=h.find(".pano-scene-nav"),x=w.find(".pano-previous"),z=w.find(".pano-title-previous"),b=w.find(".pano-next"),C=w.find(".pano-title-next"),N?d.addClass("pano-pointer"):Lc.one("touchstart.panotest mouseenter.panotest",function(e){Lc.off(".panotest"),"mouseenter"===e.type&&(d.addClass("pano-pointer"),N=!0)});var n=(k?89:0)+(P.nav?134:0);if(n){k&&P.nav&&(n+=16);var i=Math.round(n/2+60);P.scene_nav&&o("@media (min-width: 641px) { .pano-title-previous, .pano-title-next { max-width: calc(50% - "+i+"px); } }"),k&&P.nav&&(o("@media (min-width: 1025px) { .pano-nav { margin-left: -106px; } }"),P.scene_nav&&(o("@media (min-width: 1025px) { .pano-title-previous { max-width: calc(50% - "+(i+53)+"px); } }"),o("@media (min-width: 1025px) { .pano-title-next { max-width: calc(50% - "+(i-53)+"px); }")))}if(s=new Marzipano.Viewer(u[0]),P.nav&&D.push([_.find(".pano-up"),"y",-.5,.75],[_.find(".pano-down"),"y",.5,.75],[_.find(".pano-left"),"x",-1],[_.find(".pano-right"),"x",1]),k&&D.push([_.find(".pano-zoom-in"),"zoom",-1],[_.find(".pano-zoom-out"),"zoom",1]),P.keyboard&&D.push([38,"y",-.5,.75],[40,"y",.5,.75],[37,"x",-1],[39,"x",1],[187,"zoom",-1],[189,"zoom",1],[107,"zoom",-1],[109,"zoom",1],[87,"y",-.5,.75],[65,"x",-1],[83,"y",.5,.75],[68,"x",1],[81,"roll",-4,6],[69,"roll",4,6]),D.length){l=s.controls(),D.forEach(function(e,t){var n=.4*e[2],o=1.2*(e[3]||1),i="number"==typeof e[0]?new Marzipano.KeyControlMethod(e[0],e[1],n,o):new Marzipano.ElementPressControlMethod(e[0][0],e[1],n,o);l.registerMethod("c"+t,i,!0)})}var a=e.find(".pano-close");a.length&&a.on("click",function(e){B(!0)});var S=e.find(".pano-reset-view");S.length&&S.on("click",function(e){S.data("translating")||(S.data("translating",!0),s.lookTo(r.items[A].original_view,{transitionDuration:500},function(){S.data("translating",!1)}))});var E=Marzipano.dependencies.hammerjs,R=e.find(".pano-fullscreen");(P.fullscreen_taps||R.length)&&vi("screenfull",function(e){if(!e)return R.remove(),!1;(R.removeClass("hide").on("click",function(){screenfull.toggle(p[0])}),P.fullscreen_taps)&&new E(u[0]).on(1===P.fullscreen_taps?"tap":"doubletap",function(e){L||screenfull.request(p[0])});function t(){L=screenfull.isFullscreen,R.toggleClass("pano-is-fullscreen",L)}screenfull.on("change",t),t()}),(M=e.find(".pano-rotate")).length&&M.on("click",function(){ne(!T)});var j=P.autorotate_speed;if(c=Marzipano.autorotate({yawSpeed:j,yawAccel:j/2,pitchSpeed:Math.max(j,.1),pitchAccel:Math.max(j/2,.05)}),P.lookto_taps){function F(e,t,n){var o=s["_hammerManager"+e];o.manager().add(new E.Tap({taps:t,posThreshold:n})),o.on("tap",function(e){var t=s.view().screenToCoordinates(e.center);s.lookTo(t,{transitionDuration:500})})}N&&F("Mouse",P.lookto_taps,20),x3_tests.touch&&F("Touch",P.lookto_taps,50)}if(O.length)if(x3_tests.device_orientation){function W(){vi("DeviceOrientationControlMethod",function(e){if(!e)return O.remove(),!1;l.registerMethod("deviceOrientation",new DeviceOrientationControlMethod),O.removeClass("hide").data("visible",!0).on("click",function(e){te(!q)})})}x3_tests.device_oriented?W():Sc.one("deviceorientation.panotest",function(e){var t=e.originalEvent.alpha;null===t||isNaN(t)||W()})}else O.remove();if(P.scene_nav){function I(e,t,n){e.on("click",$.throttle(500,!0,function(){Q(n)})),N&&e.on("mouseenter mouseleave",function(e){V||Y(t,"mouseenter"===e.type,3*n)})}I(x,z,-1),I(b,C,1)}}};var ee=!1;function te(e){q!==e&&(q=e,O.toggleClass("pano-is-deviceorientation",e),e?(ee=T,ne(!1),l.enableMethod("deviceOrientation")):(l.disableMethod("deviceOrientation"),ee&&ne(!0)))}function ne(e){F!==e&&(T=e,M.toggleClass("pano-rotating",e),e?oe():ie())}function oe(){F||(te(!1),s.startMovement(c),s.setIdleMovement(P.autorotate_idlemovement_timeout,c),F=!0)}function ie(){F&&(s.stopMovement(),s.setIdleMovement(1/0),F=!1)}var ae,re=!0,se=!1;function le(e){se&&(se=!1,clearTimeout(ae)),re!==e&&(re=e,d.toggleClass("pano-interface-hide",e))}function ce(e){e.length&&e.on("touchstart.pano",".pano-button",function(t){if("1"!=e.css("opacity"))return!1})}function pe(){le(!1),se=!0,ae=setTimeout(function(){le(!0)},P.hide_interface_timeout)}function ue(e){var t=e.attr("data-href")||e.attr("href");t&&t.indexOf(".")>-1&&e.attr({"data-popup":"",rel:"pano-replacement-popup",href:(-1===t.indexOf("/")?x3_page.file_path+"/":"")+t.trim()})}function de(t){var n=r.items[t];n.scene_ob.pinFirstLevel||n.scene_ob.geometry.levelList.length<2||!s.hasScene(n.scene)||(e("pinFirstLevel: "+n.id),n.scene.layer().pinFirstLevel(),n.scene_ob.pinFirstLevel=!0)}function fe(e,t){t<2||setTimeout(function(){s.hasScene(e.scene)&&e.scene.visible()&&(de(A>=t-1?0:A+1),de(A<=0?t-1:A-1))},2e3)}var he,ve=!1;function me(e){ve===e&&(ve=!ve,he.toggleClass("pano-spinning",ve))}function ge(e,t){return e.replace("/content/","/render/w"+t+"/")}function _e(e){e!==I&&(e?(I=window.innerWidth-document.documentElement.clientWidth)&&(Lc[0].style["padding-right"]=I+"px",Lc[0].style.overflow="hidden"):(Lc[0].style.removeProperty("padding-right"),Lc[0].style.removeProperty("overflow"),I=!1))}var ye={opacity:function(){return function(e,t){var n=ke(e),o={opacity:n};Me&&(o.rect=Me(n)),t.layer().setEffects(o)}},black:function(){return function(e,t,n){var o=ke(e),i=o<.5,a=i?2*o:1-2*(o-.5),r=i?n.layer():t.layer(),s={colorOffset:[-a,-a,-a,0]};!i&&Me&&(s.rect=Me(o)),r.setEffects(s)}},black_first:function(){return function(e,t){var n=ke(e),o=1-n,i={colorOffset:[-o,-o,-o,0]};Me&&(i.rect=Me(n)),t.layer().setEffects(i)}}},we=P.transition,xe=ye[we],be="black"===we?ye.black_first:xe,ze=P.transition_duration,Ce="black"===we?ze/2:ze,Oe=P.transition_scale;if(Oe&&ze)var Me=function(e){return{relativeWidth:Se-e*Oe,relativeHeight:Se-e*Oe,relativeX:e*Pe-Pe,relativeY:e*Pe-Pe}},Se=1+Oe,Pe=Oe/2;else Me=!1;function ke(e){return-(Math.pow(e-1,4)-1)}var Ee=!1,Re=(P.nav?[38,40,37,39]:[]).concat(k?[187,189]:[]);function Le(e,t){var n=Re.indexOf(e);if(n>-1){if(t&&"1"!=h.css("opacity"))return;Ee=!1,D[n][0].toggleClass("active",t)}}}();