/* www.photo.gallery X3.27.6 2019-03-05 */

!function(){function e(e,t,n){k("panorama / "+e,t,n)}var t=!1,n=0;if(window.WebGLRenderingContext)try{var i=document.createElement("canvas");if(i.getContext){var a=i.getContext("webgl")||i.getContext("experimental-webgl");(t=!!(a&&a instanceof WebGLRenderingContext))&&(n=a.getParameter(a.MAX_TEXTURE_SIZE)),e("webgl_support: "+t,null,t?"log":"warn"),e("max_texture_size: "+n)}}catch(t){e("error while trying to detect WebGL",null,"error")}var r,s,l,p,c,u,d,f,h,m,v,g,_,x,w,y,b,z,O,M,C,P,E=x3_settings.plugins.panorama,L="hide"!==E.zoom,R=!1,j=E.autorotate_start,A=j&&E.autorotate_restart,I=!1,T=!1,q=0,F=!1,V=!1,W=x3_tests.is_pointer,N=!1,D=[],U={yaw:0,pitch:0,fov:.79},H=window.devicePixelRatio||1,G=window.screen.availWidth*H>=640?640:320;function X(t,i,a){var o=-1,r=0,s={items:[],open:-1};return t.each(function(t,l){var p=$(l);"object"!=typeof p.data("panorama")&&function(t,i){var a=i.data("panorama"),o={},r=!1;a&&"string"==typeof a?a.split("&").forEach(function(e,t){var n=e.split("=");if(n.length>1&&n[1].length){var i=n[1];o[n[0]]=isNaN(i)?"true"===i||"false"!==i&&i:Number(i)}else isNaN(e)?["equirect","cube","flat"].indexOf(e)>-1?o.type=e:e.indexOf("/")>-1||e.match(/\.(jpeg|jpg)$/i)?r=e:o[n[0]]=null:(o.hasOwnProperty("width")?o.hasOwnProperty("height")||(o.height=Number(e)):o.width=Number(e),o.type="equirect")}):a&&"number"==typeof a&&(o.type="equirect",o.width=a),o.hasOwnProperty("type")||(o.hasOwnProperty("width")?o.type=isNaN(o.width)?"flat":"equirect":o.hasOwnProperty("levels")||o.hasOwnProperty("path")?o.type="cube":o.type="equirect");var s="equirect"===o.type?"source":"path",l=o[s]||r||t.getAttribute("data-href")||t.getAttribute("href")||!1;if(l&&(l=l.trim()),l&&(0!==l.toLowerCase().indexOf("http")&&(l.indexOf("content/")>-1?l=x3_settings.path+"/content/"+l.split("content/")[1]:0!==l.indexOf("/")&&(l=x3_settings.path+x3_settings.file_path+"/"+l)),"path"!==s||o.path||r||(l=l.replace(/\.(jpeg|jpg)$/i,"").replace(/\/(?=[^\/]*$)/,"/_"))),o[s]=l?S(l).chompRight("/").s:"none","equirect"===o.type){var p=o.width||i.data("width")||!1,c=o.height||i.data("height")||!1;p&&c||(p?c=Math.floor(p/2):c?p=Math.floor(2*c):(p=4096,c=2048)),o.width=p,o.height=c,p>n&&o.hasOwnProperty("source_4096")&&(null===o.source_4096||!0===o.source_4096)&&(o.source_4096=o.source.replace(/\.(jpeg|jpg)$/i,"_4096.$1"))}else if("flat"===o.type){if(o.hasOwnProperty("url_format")){var u=o.url_format.trim(),d=u.replace(/%0*?[v|y]/g,"{y}").replace(/%0*?[h|x]/g,"{x}").replace(/%0*?l/g,"{z}").replace(/(^|\/)l[0-9](_|\/)/g,"$1l{z}$2").replace(/%0*?c/g,"0");if(d!==o.url_format&&(o.url_format_original=o.url_format,o.url_format=d),!o.hasOwnProperty("index_start")){var f=u.match(/(^|\/)l([0-9])[_|\/]/);o.index_start=f?Math.min(1,f[2]):0}if(!o.hasOwnProperty("zero_padding")){var h=u.match(/%0+?[h|y]/);o.zero_padding=h?h[0].length-1:0}}if(o.hasOwnProperty("width")&&o.hasOwnProperty("height")){var m=o.width.split(","),v=o.height.split(",");o.levels=[],m.forEach(function(e,t){o.levels.push({width:parseInt(e),height:parseInt(v[t])})}),delete o.width,delete o.height}}e("params_to_object: "+a,o),i.data("panorama",o)}(l,p);var c=p.data("panorama");if(["equirect","cube"].indexOf(c.type)>-1){var u={};Object.keys(U).forEach(function(e){var t=c.hasOwnProperty(e)?c[e]:E[e];t!==U[e]&&(3.14===Math.abs(t)&&(t=Math.PI*(t>0?1:-1)),u[e]=t)});var d=c.hasOwnProperty("maxVFov")?c.maxVFov:E.max_vfov,f=c.hasOwnProperty("maxHFov")?c.maxHFov:E.max_hfov;0===f&&(f=null);var h=c.hasOwnProperty("pitch_min")?c.pitch_min:E.pitch_min,m=c.hasOwnProperty("pitch_max")?c.pitch_max:E.pitch_max,v=(-90!==h||90!==m)&&Marzipano.RectilinearView.limit.pitch(h/180*Math.PI,m/180*Math.PI)}if("equirect"===c.type){var g=c.source.indexOf("/content/")>-1&&0!==c.source.toLowerCase().indexOf("http"),_=c.source,x=c.width;if(x>n)if(n>=4096&&c.hasOwnProperty("source_4096"))_=c.source_4096,x=4096;else{if(!g||!E.equirect_resize)return e("Error: Source ["+_+"] width ["+x+"] is > device max_texture_size ["+n+"] and equirect_resize option is disabled, or source is not in content path.",null,"warn"),a?de(p):p.removeClass("x3-panorama"),!0;_=Mi(_,n),x=n}var w=[{width:x}],y=[_];if(g)if(c.hasOwnProperty("preview")?c.preview:E.equirect_preview){w.unshift({width:G});var b=c.hasOwnProperty("source_4096")?c.source_4096:c.source;y.unshift(Mi(b,G))}var z=c.maxResolution||E.maxres_multiplier*x/4;c.hasOwnProperty("maxResolution")||(c.maxResolution=z);var O=Marzipano.RectilinearView.limit.traditional(z,d,f),M=v?Marzipano.util.compose(O,v):O,C=new Marzipano.ImageUrlSource(function(e){return{url:y[e.z]}}),P=new Marzipano.EquirectGeometry(w),k=new Marzipano.RectilinearView(u,M)}else if("cube"===c.type){C=Marzipano.ImageUrlSource.fromString(c.path+"/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:c.path+"/preview.jpg"});var L=function(e){if("object"==typeof e)return e;for(var t=256,n=[{tileSize:256,size:256,fallbackOnly:!0}],i=0;i<e;i++)n.push({tileSize:512,size:t*=2});return n}(c.levels||3);P=new Marzipano.CubeGeometry(L),z=c.maxResolution||E.maxres_multiplier*(c.face_size||L[L.length-1].size);c.hasOwnProperty("maxResolution")||(c.maxResolution=z);O=Marzipano.RectilinearView.limit.traditional(z,d,f),M=v?Marzipano.util.compose(O,v):O,k=new Marzipano.RectilinearView(u,M)}else{if("flat"!==c.type)return!0;var R=c.tilesize||E.flat_tile_size,j=c.levels;j[1].width<j[0].width&&j.reverse();var A=j[j.length-1];C=function(e){var t=e.url_format||E.flat_url_format,n=e.hasOwnProperty("zero_padding")?e.zero_padding:E.flat_zero_padding,i=e.hasOwnProperty("index_start")?e.index_start:E.flat_index_start;return new Marzipano.ImageUrlSource(function(a){return{url:e.path+"/"+t.replace(/{z}|{y}|{x}/gi,function(e){return"{z}"===e?a.z+i:"{y}"===e?S(a.y+i).padLeft(n,"0").s:"{x}"===e?S(a.x+i).padLeft(n,"0").s:void 0})}})}(c);j.forEach(function(e){e.tileWidth=R,e.tileHeight=R});P=new Marzipano.FlatGeometry(j);var I=A.width/A.height,T=window.innerWidth/window.innerHeight,q=I>T?T/I:1;k=new Marzipano.FlatView({mediaAspectRatio:I,zoom:q},Marzipano.util.compose(Marzipano.FlatView.limit.resolution(A.width),Marzipano.FlatView.limit.letterbox()))}if(a&&p.addClass("x3-panorama"),c.index=r,c.hasOwnProperty("id")||(c.id=l.getAttribute("id")||(c.source||c.path).split("/").filter(Boolean).pop().replace(/\.(jpeg|jpg)$/i,"")),c.hasOwnProperty("title")||(c.title=l.getAttribute("data-title")||l.getAttribute("title")||c.id),c.title&&(c.title=c.title.charAt(0).toUpperCase()+c.title.slice(1)),c.exif=!!l.hasAttribute("data-exif")&&JSON.parse(l.getAttribute("data-exif")),c.description||(c.description=l.getAttribute("data-description")),c.date||(c.date=l.getAttribute("data-date")),c.geo){var F=c.geo.split(",");F.length>2&&(c.geo=F[0]+","+F[1],c.geo_zoom||(c.geo_zoom=parseInt(F[2])))}else c.geo=l.getAttribute("data-geo");-1===s.open&&(i===c.id?s.open=r:-1===o&&c.hasOwnProperty("open")&&(i?o=r:s.open=r)),c.scene_ob={source:C,geometry:P,view:k,pinFirstLevel:!!c.pinFirstLevel},c.original_view=k.parameters(),s.items.push(c),r++}),-1===s.open&&(s.open=o),e("pano_data ["+(a?"content":"gallery")+"]:",s),s}function B(e,t,n){if(wi.panorama.is_open)return!1;wi.panorama.is_open=!0,r=e,q=t,_e(!0);var i=r.items[t],a=E.scene_nav?r.items.length:1;a>1?r.items.forEach(function(e,t){e.scene=s.createScene(e.scene_ob)}):i.scene=s.createScene(i.scene_ob),E.reset_view&&i.scene_ob.view.setParameters(i.original_view),E.scene_nav&&w.toggleClass("hide",a<=1),E.index&&v.toggleClass("hide",a<=1),ee(i,a),c.velocity("fadeIn",{duration:200,complete:function(){s.updateSize(),function(){if(!x3_tests.ios)return;Sc.on("orientationchange.pano",function(e){var t=u[0].clientWidth,n=u[0].clientHeight;setTimeout(function(){u[0].clientWidth===t&&u[0].clientHeight===n||s.updateSize()},500)})}(),function(){if(!x3_tests.dual_input)return;var e;Lc.on("touchend.pano",function(t){N=!0,clearTimeout(e),e=setTimeout(function(){N=!1},300)})}(),i.scene.switchTo({transitionDuration:Oe,transitionUpdate:be()},function(){!function(){x3_tests.mobile?f.add(h).addClass("pano-touch"):f.add(h).on("mouseenter.pano mouseleave.pano",function(e){$(this).toggleClass("pano-hover","mouseenter"===e.type)});if(!E.hide_interface)return void pe(!1);ue(),u.on("mousemove.pano",$.throttle(Math.floor(E.hide_interface_timeout/10),!1,ue)),x3_tests.touch&&(ce(f),ce(h))}(),(j||A)&&ie(!0),s.stage().addEventListener("renderComplete",ge),function(){if("auto"!==E.zoom||!W)return;Sc.on("resize.pano",$.debounce(500,function(e){Y(r.items[q])}))}(),he(i,a),J(i,!0)}),F=n||bi("pano")!=i.id&&!navigator.userAgent.match("CriOS"),history.pushState(null,i.id,"#pano="+i.id),Sc.one("popstate.pano",function(e){K(!1)}),function(e){Lc.on("keydown.pano",function(e){[32,38,40].indexOf(e.which)>-1&&e.preventDefault()}),E.keyboard&&Le.length&&(Ee=!1,_.find(".active").removeClass("active"),Lc.on("keydown.pano",function(t){var n=t.which;if(Ee!==n){if(t.shiftKey&&e>1&&E.nav&&[37,39].indexOf(n)>-1)return!1;Ee=n,Re(n,!0)}}));E.keyboard&&Lc.on("keyup.pano",function(t){var n=t.which;if(t.shiftKey&&e>1&&[37,39].indexOf(n)>-1)Z(37===n?-1:1);else{if(27===n)return void K(!0);if(32===n)return pe(!se),void(se&&f.add(h).removeClass("pano-hover"))}Le.length&&Re(n,!1)})}(a)}})}function K(e){if(!wi.panorama.is_open)return!1;wi.panorama.is_open=!1,E.autorotate_start?oe():ie(!1),[Sc,Lc,u,d,f,h].forEach(function(e){e.length&&e.off(".pano")}),F?e&&history.back():history.replaceState(null,document.title,location.pathname+location.search),R&&screenfull.exit(),c.velocity("fadeOut",{duration:200,complete:function(){_e(!1),s.destroyAllScenes(),s.stage().removeEventListener("renderComplete",ge),ge(!0),pe(!0),f.add(h).removeClass("pano-hover")}})}function Z(e){J(r.items[q]);var t=q+e,n=r.items.length;if(t<0||t>=n){if(!E.scene_loop)return;t=t<0?n-1:0}q=t;var i=r.items[q];E.reset_view&&i.scene_ob.view.setParameters(i.original_view),E.title&&"0"!=f.css("opacity")&&m.css("display","none"),n>1&&W&&z.add(O).css("display","none"),ee(i,n),le&&E.show_interface_after_nav&&ue(),oe(),"opacity"!==we&&i.scene.layer().setEffects({opacity:0}),i.scene.switchTo({transitionDuration:ze,transitionUpdate:ye()},function(){j?ae():A&&ie(!0),E.title&&!m.is(":visible")&&Q(m,!0,3*e,300),n>1&&W&&!N&&(y.is(":hover")&&Q(z,!0,3*e,200),b.is(":hover")&&Q(O,!0,3*e,200)),E.show_interface_after_nav&&(!E.hide_interface&&E.keyboard?pe(!1):se&&ue()),he(i,n),J(i,!0)}),history.replaceState(null,i.id,"#pano="+i.id)}function J(t,n){if("flat"===t.type){var i=Math.min(t.levels.length,t.pin_levels||E.flat_pin_levels);if(!(i<2))for(var a=t.scene.layer(),o=1;o<i;o++)e((n?"pinLevel":"unpinLevel")+"("+o+")"),a[n?"pinLevel":"unpinLevel"](o)}}function Q(e,t,n,i,a){e.velocity("stop").velocity({opacity:t?[1,0]:[0,1],translateX:t?[0,n]:[n,0]},{duration:i||300,easing:"easeOutQuint",display:t?a||"auto":"none"})}function Y(e){if("auto"===E.zoom&&W){var t=e.hasOwnProperty("zoom")?e.zoom:"flat"===e.type||e.maxResolution>window.innerWidth*H;x.toggleClass("pano-zoom-hidden",!t)}}function ee(e,t){var n=!!(e.exif||e.description||e.geo);if(P.length&&P.toggleClass("hide",!n),E.title&&g.toggleClass("pano-title-info",n),C.length&&C.toggleClass("hide","flat"===e.type),M.data("visible")&&M.toggleClass("hide","flat"===e.type),Y(e),E.scene_nav&&t>1){var i=q<=0?t-1:q-1,a=q>=t-1?0:q+1,o=!1,s=!1;E.scene_loop||(o=i>=q,y.toggleClass("hide",o),s=a<=q,b.toggleClass("hide",s),W&&(z.toggleClass("hide",o),O.toggleClass("hide",s))),W&&(o||z.html(r.items[i].title),s||O.html(r.items[a].title))}E.index&&t>1&&v.text(q+1+" / "+t),E.title&&g.html(e.title)}e("Settings:",E),wi.panorama.init_page=function(e,n){var i=e.is(".context");if(t){var a=X(n,!wi.panorama.is_open&&bi("pano"),i);a.items.length&&(e.on("click",".x3-panorama",function(e){e.target!==this&&$(e.target).is("button, .button, [data-href]")||(e.stopImmediatePropagation(),e.preventDefault(),B(a,$(this).data("panorama").index,!0))}),wi.panorama.is_open||(a.open>-1?B(a,a.open):E.auto_open&&!i&&B(a,0)))}else i?n.each(function(e,t){de($(t))}):n.removeClass("x3-panorama")},wi.panorama.init_pano=function(){if(t){!function(){var e="",t="";(E.buttons?(E.buttons+",close").replace("close,","").split(","):["close"]).forEach(function(e,n){t+='<button type="button" class="pano-button pano-'+e+(["deviceorientation","fullscreen"].indexOf(e)>-1?" hide":"")+'"></button>'}),e+='<div class="pano-controls">'+t+"</div>";var n="";E.index&&(n+='<span class="pano-index"></span>'),E.title&&(n+='<span class="pano-title"></span>'),(n+='<span class="pano-spinner"></span>')&&(e+='<div class="pano-text">'+n+"</div>"),e&&(e='<div class="pano-topbar">'+e+"</div>");var i="";E.scene_nav&&(i+='<div class="pano-scene-nav"><button type="button" class="pano-button pano-previous"></button><div class="pano-text pano-title-previous"></div><button type="button" class="pano-button pano-next"></button><div class="pano-text pano-title-next"></div></div>');var a="";L&&(a+='<div class="pano-zoom"'+(E.nav?' style="margin-right: 1em;"':"")+'><button type="button" class="pano-button pano-zoom-out"></button><button type="button" class="pano-button pano-zoom-in"></button></div>'),E.nav&&(a+='<button type="button" class="pano-button pano-left"></button><div class="pano-up-down"><button type="button" class="pano-button pano-up"></button><button type="button" class="pano-button pano-down"></button></div><button type="button" class="pano-button pano-right"></button>'),a&&(i+='<div class="pano-nav">'+a+"</div>"),i&&(e+='<div class="pano-bottombar">'+i+"</div>"),e&&(e='<div id="pano-interface" class="pano-interface-hide'+(W?" pano-pointer":"")+'">'+e+"</div>"),Lc.append('<div id="pano-container">'+e+'<div id="pano"></div></div>')}(),c=Lc.find("#pano-container"),u=c.find("#pano"),d=c.find("#pano-interface");var e=(f=d.find(".pano-topbar")).find(".pano-controls");M=e.find(".pano-deviceorientation"),m=f.find(".pano-text"),v=m.find(".pano-index"),g=m.find(".pano-title"),me=m.find(".pano-spinner"),h=d.find(".pano-bottombar"),_=h.find(".pano-nav"),x=_.find(".pano-zoom"),w=h.find(".pano-scene-nav"),y=w.find(".pano-previous"),z=w.find(".pano-title-previous"),b=w.find(".pano-next"),O=w.find(".pano-title-next");var n=(L?89:0)+(E.nav?134:0);if(n){L&&E.nav&&(n+=16);var i=Math.round(n/2+60);E.scene_nav&&o("@media (min-width: 641px) { .pano-title-previous, .pano-title-next { max-width: calc(50% - "+i+"px); } }"),L&&E.nav&&(o("@media (min-width: 1025px) { .pano-nav { margin-left: -106px; } }"),E.scene_nav&&(o("@media (min-width: 1025px) { .pano-title-previous { max-width: calc(50% - "+(i+53)+"px); } }"),o("@media (min-width: 1025px) { .pano-title-next { max-width: calc(50% - "+(i-53)+"px); }")))}if(s=new Marzipano.Viewer(u[0]),E.nav&&D.push([_.find(".pano-up"),"y",-.5,.75],[_.find(".pano-down"),"y",.5,.75],[_.find(".pano-left"),"x",-1],[_.find(".pano-right"),"x",1]),L&&D.push([_.find(".pano-zoom-in"),"zoom",-1],[_.find(".pano-zoom-out"),"zoom",1]),E.keyboard&&D.push([38,"y",-.5,.75],[40,"y",.5,.75],[37,"x",-1],[39,"x",1],[187,"zoom",-1],[189,"zoom",1],[107,"zoom",-1],[109,"zoom",1],[87,"y",-.5,.75],[65,"x",-1],[83,"y",.5,.75],[68,"x",1],[81,"roll",-4,6],[69,"roll",4,6]),D.length){l=s.controls(),D.forEach(function(e,t){var n=.4*e[2],i=1.2*(e[3]||1),a="number"==typeof e[0]?new Marzipano.KeyControlMethod(e[0],e[1],n,i):new Marzipano.ElementPressControlMethod(e[0][0],e[1],n,i);l.registerMethod("c"+t,a,!0)})}var a=e.find(".pano-close");a.length&&a.on("click",function(e){K(!0)}),(P=e.find(".pano-info")).length&&P.on("click",H),E.title&&g.on("click",function(e){$(this).hasClass("pano-title-info")&&H()});var k=e.find(".pano-reset-view");k.length&&k.on("click",function(e){k.data("translating")||(k.data("translating",!0),s.lookTo(r.items[q].original_view,{transitionDuration:500},function(){k.data("translating",!1)}))});var S=Marzipano.dependencies.hammerjs,A=e.find(".pano-fullscreen");(E.fullscreen_taps||A.length)&&vi("screenfull",function(e){if(!e)return A.remove(),!1;(A.removeClass("hide").on("click",function(){screenfull.toggle()}),E.fullscreen_taps)&&new S(u[0]).on(1===E.fullscreen_taps?"tap":"doubletap",function(e){R||screenfull.request()});function t(){R=screenfull.isFullscreen,A.toggleClass("pano-is-fullscreen",R)}screenfull.on("change",t),t()}),(C=e.find(".pano-rotate")).length&&C.on("click",function(){ie(!j)});var I=E.autorotate_speed;if(p=Marzipano.autorotate({yawSpeed:I,yawAccel:I/2,pitchSpeed:Math.max(I,.1),pitchAccel:Math.max(I/2,.05)}),E.lookto_taps){function F(e,t,n){var i=s["_hammerManager"+e];i.manager().add(new S.Tap({taps:t,posThreshold:n})),i.on("tap",function(e){var t=s.view().screenToCoordinates(e.center);s.lookTo(t,{transitionDuration:500})})}W&&F("Mouse",E.lookto_taps,20),x3_tests.touch&&F("Touch",E.lookto_taps,50)}if(M.length)if(x3_tests.device_orientation){function V(){vi("DeviceOrientationControlMethod",function(e){if(!e)return M.remove(),!1;l.registerMethod("deviceOrientation",new DeviceOrientationControlMethod),M.removeClass("hide").data("visible",!0).on("click",function(e){ne(!T)})})}x3_tests.device_oriented?V():Sc.one("deviceorientation.panotest",function(e){var t=e.originalEvent.alpha;null===t||isNaN(t)||V()})}else M.remove();if(E.scene_nav){function U(e,t,n){e.on("click",$.throttle(500,!0,function(){Z(n)})),W&&e.on("mouseenter mouseleave",function(e){N||Q(t,"mouseenter"===e.type,3*n)})}U(y,z,-1),U(b,O,1)}}function H(){var e=r.items[q],t=!1,n='<h2 class="pano-info-title">'+e.title+"</h3>";if(e.date&&(n+='<time class="pano-info-date">'+e.date+"</time>"),e.exif&&(n+='<div class="pano-info-exif">'+oo(e.exif)+"</div>"),e.description&&(n+='<p class="pano-info-description">'+e.description+"</p>"),e.geo){var i=document.documentElement.clientWidth;if(i<=640)t=Math.min(100*Math.ceil(i/100),640);else{var a=document.documentElement.clientHeight;t=a<800?400:a<950?500:640}n+='<a href="https://www.google.com/maps/search/?api=1&amp;query='+e.geo+'" class="pano-info-map" target="_blank"><div class="pano-info-map-container"><img src="https://maps.googleapis.com/maps/api/staticmap?'+(x3_tests.pixel_ratio>1?"scale=2&amp;":"")+"zoom="+(e.geo_zoom||12)+"&amp;size="+t+"x"+t+"&amp;markers="+e.geo+'&amp;key=AIzaSyDRp6xla9SxUmTBu6l_kprhjjI9e5-EVZk" class="pano-info-map-image"></div></a>'}var o=gc(n,t,"pano-info-modal");if(e.geo){var s=o.find(".pano-info-map-image");s.on("load",function(e){s.css({opacity:1,transform:"scale(1)"})}),o.find(".pano-info-map").on("click",function(t){gi("https://www.google.com/maps/embed/v1/place?q="+e.geo+"&amp;key=AIzaSyDRp6xla9SxUmTBu6l_kprhjjI9e5-EVZk",t).css("z-index",1542)})}}};var te=!1;function ne(e){T!==e&&(T=e,M.toggleClass("pano-is-deviceorientation",e),e?(te=j,ie(!1),l.enableMethod("deviceOrientation")):(l.disableMethod("deviceOrientation"),te&&ie(!0)))}function ie(e){I!==e&&(j=e,C.toggleClass("pano-rotating",e),e?ae():oe())}function ae(){I||(ne(!1),s.startMovement(p),s.setIdleMovement(E.autorotate_idlemovement_timeout,p),I=!0)}function oe(){I&&(s.stopMovement(),s.setIdleMovement(1/0),I=!1)}var re,se=!0,le=!1;function pe(e){le&&(le=!1,clearTimeout(re)),se!==e&&(se=e,d.toggleClass("pano-interface-hide",e))}function ce(e){e.length&&e.on("touchstart.pano",".pano-button",function(t){if("1"!=e.css("opacity"))return!1})}function ue(){pe(!1),le=!0,re=setTimeout(function(){pe(!0)},E.hide_interface_timeout)}function de(e){var t=e.attr("data-href")||e.attr("href");t&&t.indexOf(".")>-1&&e.attr({"data-popup":"",rel:"pano-replacement-popup",href:(-1===t.indexOf("/")?x3_page.file_path+"/":"")+t.trim()})}function fe(t){var n=r.items[t];n.scene_ob.pinFirstLevel||n.scene_ob.geometry.levelList.length<2||!s.hasScene(n.scene)||(e("pinFirstLevel: "+n.id),n.scene.layer().pinFirstLevel(),n.scene_ob.pinFirstLevel=!0)}function he(e,t){t<2||setTimeout(function(){s.hasScene(e.scene)&&e.scene.visible()&&(fe(q>=t-1?0:q+1),fe(q<=0?t-1:q-1))},2e3)}var me,ve=!1;function ge(e){ve===e&&(ve=!ve,me.toggleClass("pano-spinning",ve))}function _e(e){e!==V&&(e?(V=window.innerWidth-document.documentElement.clientWidth)&&(Pc[0].style["padding-right"]=V+"px",Rc[0].style.overflow="hidden"):(Pc[0].style.removeProperty("padding-right"),Rc[0].style.removeProperty("overflow"),V=!1))}var xe={opacity:function(){return function(e,t){var n=Se(e),i={opacity:n};Ce&&(i.rect=Ce(n)),t.layer().setEffects(i)}},black:function(){return function(e,t,n){var i=Se(e),a=i<.5,o=a?2*i:1-2*(i-.5),r=a?n.layer():t.layer(),s={colorOffset:[-o,-o,-o,0]};!a&&Ce&&(s.rect=Ce(i)),r.setEffects(s)}},black_first:function(){return function(e,t){var n=Se(e),i=1-n,a={colorOffset:[-i,-i,-i,0]};Ce&&(a.rect=Ce(n)),t.layer().setEffects(a)}}},we=E.transition,ye=xe[we],be="black"===we?xe.black_first:ye,ze=E.transition_duration,Oe="black"===we?ze/2:ze,Me=E.transition_scale;if(Me&&ze)var Ce=function(e){return{relativeWidth:Pe-e*Me,relativeHeight:Pe-e*Me,relativeX:e*ke-ke,relativeY:e*ke-ke}},Pe=1+Me,ke=Me/2;else Ce=!1;function Se(e){return-(Math.pow(e-1,4)-1)}var Ee=!1,Le=(E.nav?[38,40,37,39]:[]).concat(L?[187,189]:[]);function Re(e,t){var n=Le.indexOf(e);if(n>-1){if(t&&"1"!=h.css("opacity"))return;Ee=!1,D[n][0].toggleClass("active",t)}}}();