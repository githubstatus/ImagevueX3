/* www.photo.gallery X3.27.6 2019-03-05 */

var cc;!function(){var o,t,e,a,i,n,l,s=!1,c=!1,m=x3_settings.plugins.fotomoto,r=m.store_id.trim(),d=!1,f=!1,g=x3_tests.local_storage,p=g&&localStorage.getItem("fotomoto_items")?Number(localStorage.getItem("fotomoto_items")):0,u="yes"===m.buy_button_popup||"mobile"===m.buy_button_popup&&x3_tests.mobile;function h(o){return"x3.locl"===location.hostname?"https://demo.photo.gallery"+o.replace("/x3",""):location.protocol+"//"+location.hostname+o}function _(){if(l.length){var o=l.find("a.item");if(o.length){var t=[];o.each(function(){var o=$(this),e=void 0!==o.data("image")?o.data("image"):o.closest("[data-image]").data("image");if(e){var a={img:h(e)};f&&(a.collection=f),t.push(a)}}),t.length&&(k("Fotomoto / images:",t),$.post("https://widget.fotomoto.com/stores/photo_checkin",{store_key:r,page_url:x3_settings.canonical,imgs:t},function(o){k("Fotomoto / data: "+o)},"json"))}}}function b(){var o=m.collection.toLowerCase();$.each(d,function(t,e){if(e.key.toLowerCase()===o||e.name.toLowerCase()===o)return f=e.key,!1}),f?_():y("Fotomoto collection ID/Name does not exist in your account:<br><strong>"+o+"</strong>")}function O(o){var e=o.data("description")||"";-1===e.indexOf("fotomoto-buy")&&o.data("description",(e.length?e+'<br class="fotomoto-hide">':"")+t)}function y(o){gc('<div class="text-center"><p class="fa fa-warning fa-5x" style="color:#d9534f;display:block;"></p>'+o+"</div>"),i.remove()}function x(){p=FOTOMOTO.API.getTotalItems(),FOTOMOTO.API.isBasketEmpty()?i.removeClass("has-items"):(i.addClass("has-items"),Dc(i,"pulse",300)),n.text(p),g&&localStorage.setItem("fotomoto_items",p)}cc=function(n,g,p){m=x3_settings.plugins.fotomoto,u="yes"===m.buy_button_popup||"mobile"===m.buy_button_popup&&x3_tests.mobile;var h=' class="button small fotomoto-buy button-buy">'+m.buy_button_text.trim();o="<button"+h+"</button>",t="<a"+h+"</a>",l=n,e=g,(a=p)&&e.data("fotomoto-collection")&&(m.collection=e.data("fotomoto-collection").trim()),s||c||(s=!0,Rc.addClass("fotomoto-loading"),(i=kc("fotomoto",!0)).addClass("loading"),window.fotomoto_cart_loaded=x,$.ajax({url:"https://widget.fotomoto.com/stores/script/"+r+".js?api=true",dataType:"script",cache:!0}).done(function(){if("undefined"==typeof FOTOMOTO_CONFIG){var o=40!==r.length?"<p><em>Fotomoto store ID should be 40 characters!</em></p>":"<p><em>Did you enable domain <strong>"+location.hostname+"</strong> in Fotomoto?</em></p>";y("<p>Failed to load Fotomoto script for store ID:<br><strong>"+r+"</strong></p>"+o)}}).fail(function(){y("<p>Failed to load Fotomoto script.</p>")})),function(){if(a){var t=e.find(".gallery"),i=t.siblings(".back"),n=t.find("a.item");e.attr("data-image",t.children(".item").data("image")),i.length&&e.hasClass("file-fotomoto-buybutton")&&0===e.find(".fotomoto-buy").length&&(i.before(o),e.find(".fotomoto-buy").addClass("file-fotomoto-button")),O(n)}else if(m.enabled_page&&m.buy_button&&l.length){var s=l.find("a.item");s.length&&(l.hasClass("layout-slideshow")?u||s.each(function(){var t=$(this).children("span");0===t.find(".fotomoto-buy").length&&t.append("<br>"+o)}):(x3_settings.gallery.caption.enabled||x3_tests.mobile||u||l.addClass("caption-hover").removeClass("hover"),s.each(function(){var t=$(this);if(O(t),!u){var e=t.children("figure"),a=e.children("figcaption");a.length?0===a.find(".fotomoto-buy").length&&a.append(o):e.append('<figcaption itemprop="caption description" class="fotomoto-caption">'+o+"</figcaption>")}})))}}(),f=!1,(m.enabled_page||a)&&(m.collection?d&&b():_())},window.fotomoto_loaded=function(){c=!0,s=!1,Rc.removeClass("fotomoto-loading").addClass("fotomoto-loaded"),i.removeClass("loading").toggleClass("has-items",p>0).prepend('<b class="total-items">'+p+"</b>"),n=i.children(".total-items"),i.on("click",function(o){FOTOMOTO.API.isBasketEmpty()?x3_tests.mobile&&gc('<h3 class=text-center><i class="fa fa-exclamation-circle"></i> &nbsp;Cart is empty</h3>'):(Rc.addClass("fotomoto-widget-open"),FOTOMOTO.API.checkout())}),g&&setTimeout(function(){localStorage.setItem("fotomoto_items",FOTOMOTO.API.getTotalItems())},3e3),FOTOMOTO.API.collectionList(function(o){k("Fotomoto / collectionList:",o),o&&$.isArray(o)&&o.length&&(d=o,m.collection&&b())}),Lc.on("click",".fotomoto-buy",function(o){var t=$(this);o.preventDefault(),o.stopImmediatePropagation();var e=void 0!==t.data("image")?t.data("image"):t.closest("[data-image]").data("image");if(e){var a="x3.locl"===location.hostname||(location.protocol,location.hostname);a=h(e),k("Fotomoto / img: "+a),f?(k("Fotomoto / collection_key: "+f),FOTOMOTO.API.checkinImage(a,function(o){k("Fotomoto / checkinImage:",o)},f)):FOTOMOTO.API.checkinImage(a),FOTOMOTO.API.showWindow(FOTOMOTO.API.PRINT,a),Rc.addClass("fotomoto-widget-open")}}),Rc.addClass("x3-checkout")},window.fotomoto_widget_closed=function(){x(),Rc.removeClass("fotomoto-widget-open")}}();